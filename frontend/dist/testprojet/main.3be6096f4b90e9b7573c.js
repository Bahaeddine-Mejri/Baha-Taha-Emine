(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+qE3":function(t,e,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise(function(n,i){function r(n){t.removeListener(e,s),i(n)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}_(t,e,s,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&_(t,"error",e,{once:!0})}(t,r)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function h(t,e,n,i){var r,s,o;if(c(n),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),void 0===o)o=s[e]=n,++t._eventsCount;else if("function"==typeof o?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=u(t))>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,console&&console.warn&&console.warn(a)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function f(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):g(r,r.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function _(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)s(l,this,e);else{var c=l.length,u=g(l,c);for(n=0;n<c;++n)s(u[n],this,e)}return!0},a.prototype.on=a.prototype.addListener=function(t,e){return h(this,t,e,!1)},a.prototype.prependListener=function(t,e){return h(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,p(this,t,e)),this},a.prototype.off=a.prototype.removeListener=function(t,e){var n,i,r,s,o;if(c(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){o=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return f(this,t,!0)},a.prototype.rawListeners=function(t){return f(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},"/5w7":function(t,e,n){"use strict";t.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648"}}},0:function(t,e,n){t.exports=n("zUnb")},"0KjW":function(t,e,n){"use strict";var i=n("KXza");t.exports=i},"2+Hy":function(t,e,n){"use strict";var i=n("YI60"),r=n("U6jy"),s=n("piyq"),o=n("d0rS"),a=n("jLWS"),l=1;function c(t,e){if(!t)throw new Error("MapiRequest requires a client");if(!e||!e.path||!e.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};e.body&&(n["content-type"]="application/json");var i=r(n,e.headers),o=Object.keys(i).reduce(function(t,e){return t[e.toLowerCase()]=i[e],t},{});this.id=l++,this._options=e,this.emitter=new s,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=e.path,this.method=e.method,this.origin=e.origin||t.origin,this.query=e.query||{},this.params=e.params||{},this.body=e.body||null,this.file=e.file||null,this.encoding=e.encoding||"utf8",this.sendFileAs=e.sendFileAs||null,this.headers=o}c.prototype.url=function(t){var e=o.prependOrigin(this.path,this.origin);e=o.appendQueryObject(e,this.query);var n=this.params,s=null==t?this.client.accessToken:t;if(s){e=o.appendQueryParam(e,"access_token",s);var a=i(s).user;n=r({ownerId:a},n)}return o.interpolateRouteParams(e,n)},c.prototype.send=function(){var t=this;if(t.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return t.sent=!0,t.client.sendRequest(t).then(function(e){return t.response=e,t.emitter.emit(a.EVENT_RESPONSE,e),e},function(e){throw t.error=e,t.emitter.emit(a.EVENT_ERROR,e),e})},c.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},c.prototype.eachPage=function(t){var e=this;function n(n){t(null,n,function(){delete e._nextPageRequest;var t=n.nextPage();t&&(e._nextPageRequest=t,r(t))})}function i(e){t(e,null,function(){})}function r(t){t.send().then(n,i)}r(this)},c.prototype.clone=function(){return this._extend()},c.prototype._extend=function(t){var e=r(this._options,t);return new c(this.client,e)},t.exports=c},"4ZJM":function(t,e,n){t.exports=function(){"use strict";var t,e,n;function i(i,r){if(t)if(e){var s="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",o={};t(o),n=r(o),"undefined"!=typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"})))}else e=r;else t=r}return i(0,function(t){var e="2.2.0",n=i;function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var n,i,r,s,o;for(void 0===e&&(e=1e-6),r=t,o=0;o<8;o++){if(s=this.sampleCurveX(r)-t,Math.abs(s)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=s/a}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(s=this.sampleCurveX(r),Math.abs(s-t)<e)return r;t>s?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var r=s;function s(t,e){this.x=t,this.y=e}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(t){return t instanceof s?t:Array.isArray(t)?new s(t[0],t[1]):t};var o="undefined"!=typeof self?self:{};const a=Math.pow(2,53)-1,l=Math.PI/180,c=180/Math.PI;function u(t){return t*l}function h(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function d(t,e,i,r){const s=new n(t,e,i,r);return function(t){return s.solve(t)}}const p=d(.25,.1,.25,1);function f(t,e,n){return Math.min(n,Math.max(e,t))}function m(t,e,n){const i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function g(t,e,n){if(!t.length)return n(null,[]);let i=t.length;const r=new Array(t.length);let s=null;t.forEach((t,o)=>{e(t,(t,e)=>{t&&(s=t),r[o]=e,0==--i&&n(s,r)})})}function _(t){const e=[];for(const n in t)e.push(t[n]);return e}function y(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let v=1;function x(){return v++}function b(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function w(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function C(t,e){t.forEach(t=>{e[t]&&(e[t]=e[t].bind(e))})}function E(t,e){return-1!==t.indexOf(e,t.length-e.length)}function S(t,e,n){const i={};for(const r in t)i[r]=e.call(n||this,t[r],r,t);return i}function T(t,e,n){const i={};for(const r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function M(t){return Array.isArray(t)?t.map(M):"object"==typeof t&&t?S(t,M):t}const A={};function k(t){A[t]||("undefined"!=typeof console&&console.warn(t),A[t]=!0)}function P(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function I(t){let e=0;for(let n,i,r=0,s=t.length,o=s-1;r<s;o=r++)n=t[r],i=t[o],e+=(i.x-n.x)*(n.y+i.y);return e}function O(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function z(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(t,n,i,r)=>{const s=i||r;return e[n]=!s||s.toLowerCase(),""}),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let D,R,L,F=null;function B(t){if(null==F){const e=t.navigator?t.navigator.userAgent:null;F=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return F}function N(t){try{const e=o[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}const V={now:()=>void 0!==L?L:o.performance.now(),setNow(t){L=t},restoreNow(){L=void 0},frame(t){const e=o.requestAnimationFrame(t);return{cancel:()=>o.cancelAnimationFrame(e)}},getImageData(t,e=0){const n=o.document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(D||(D=o.document.createElement("a")),D.href=t,D.href),get devicePixelRatio(){return o.devicePixelRatio},get prefersReducedMotion(){return!!o.matchMedia&&(null==R&&(R=o.matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}};let U;const j={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==U){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{U=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch(e){U=t}}return U},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},q={supported:!1,testSupport:function(t){!Z&&G&&(H?W(t):$=t)}};let $,G,Z=!1,H=!1;function W(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,G),t.isContextLost())return;q.supported=!0}catch(t){}t.deleteTexture(e),Z=!0}o.document&&(G=o.document.createElement("img"),G.onload=function(){$&&W($),$=null,H=!0},G.onerror=function(){Z=!0,$=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const X="01",K="NO_ACCESS_TOKEN";function Q(t){return 0===t.indexOf("mapbox:")}function Y(t){return j.API_URL_REGEX.test(t)}const J=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function tt(t){const e=t.match(J);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function et(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function nt(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(o.atob(e[1]).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(t){return null}}class it{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=nt(j.ACCESS_TOKEN);let n="";return n=e&&e.u?o.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(Number("0x"+e)))):j.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${n}`:`mapbox.eventData:${n}`}fetchEventData(){const t=N("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{const t=o.localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const i=o.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){k("Unable to read from LocalStorage")}}saveEventData(){const t=N("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{o.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&o.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){k("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,n,i,r){if(!j.EVENTS_URL)return;const s=tt(j.EVENTS_URL);s.params.push(`access_token=${r||j.ACCESS_TOKEN||""}`);const o={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:X,userId:this.anonId},a=n?y(o,n):o,l={url:et(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=Tt(l,t=>{this.pendingRequest=null,i(t),this.saveEventData(),this.processRequests(r)})}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const rt=new class extends it{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){j.EVENTS_URL&&j.ACCESS_TOKEN&&Array.isArray(t)&&t.some(t=>Q(t)||Y(t))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=nt(j.ACCESS_TOKEN),n=e?e.u:j.ACCESS_TOKEN;let i=n!==this.eventData.tokenU;w(this.anonId)||(this.anonId=b(),i=!0);const r=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(r),n=(r-this.eventData.lastSuccess)/864e5;i=i||n>=1||n<-1||t.getDate()!==e.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(r,{"enabled.telemetry":!1},t=>{t||(this.eventData.lastSuccess=r,this.eventData.tokenU=n)},t)}},st=rt.postTurnstileEvent.bind(rt),ot=new class extends it{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,i){this.skuToken=e,this.errorCb=i,j.EVENTS_URL&&(n||j.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(K)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),w(this.anonId)||(this.anonId=b()),this.postEvent(n,{skuToken:this.skuToken},t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t))}},at=ot.postMapLoadEvent.bind(ot),lt=new class extends it{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,i){if(!j.API_URL||!j.SESSION_PATH)return;const r=tt(j.API_URL+j.SESSION_PATH);r.params.push(`sku=${e||""}`),r.params.push(`access_token=${i||j.ACCESS_TOKEN||""}`);const s={url:et(r),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Mt(s,t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(i)})}getSessionAPI(t,e,n,i){this.skuToken=e,this.errorCb=i,j.SESSION_PATH&&j.API_URL&&(n||j.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(K)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t)}},ct=lt.getSessionAPI.bind(lt),ut=new Set,ht="mapbox-tiles";let dt,pt,ft=500,mt=50;function gt(){o.caches&&!dt&&(dt=o.caches.open(ht))}function _t(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let yt,vt=1/0;function xt(){return null==yt&&(yt=o.OffscreenCanvas&&new o.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof o.createImageBitmap),yt}const bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bt);class wt extends Error{constructor(t,e,n){401===e&&Y(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ct=O()?()=>self.worker&&self.worker.referrer:()=>("blob:"===o.location.protocol?o.parent:o).location.href,Et=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Ct())&&!/^\w+:/.test(n))){if(o.fetch&&o.Request&&o.AbortController&&o.Request.prototype.hasOwnProperty("signal"))return function(t,e){const n=new o.AbortController,i=new o.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Ct(),signal:n.signal});let r=!1,s=!1;const a=(l=i.url).indexOf("sku=")>0&&Y(l);var l;"json"===t.type&&i.headers.set("Accept","application/json");const c=(n,r,l)=>{if(s)return;if(n&&"SecurityError"!==n.message&&k(n),r&&l)return u(r);const c=Date.now();o.fetch(i).then(n=>{if(n.ok){const t=a?n.clone():null;return u(n,t,c)}return e(new wt(n.statusText,n.status,t.url))}).catch(t=>{20!==t.code&&e(new Error(t.message))})},u=(n,a,l)=>{("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then(t=>{s||(a&&l&&function(t,e,n){if(gt(),!dt)return;const i={status:e.status,statusText:e.statusText,headers:new o.Headers};e.headers.forEach((t,e)=>i.headers.set(e,t));const r=z(e.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&i.headers.set("Expires",new Date(n+1e3*r["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===pt)try{new Response(new ReadableStream),pt=!0}catch(t){pt=!1}pt?e(t.body):t.blob().then(e)}(e,e=>{const n=new o.Response(e,i);gt(),dt&&dt.then(e=>e.put(_t(t.url),n)).catch(t=>k(t.message))}))}(i,a,l),r=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))}).catch(t=>{s||e(new Error(t.message))})};return a?function(t,e){if(gt(),!dt)return e(null);const n=_t(t.url);dt.then(t=>{t.match(n).then(i=>{const r=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=z(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(i);t.delete(n),r&&t.put(n,i.clone()),e(null,i,r)}).catch(e)}).catch(e)}(i,c):c(null,null),{cancel:()=>{s=!0,r||n.abort()}}}(t,e);if(O()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){const n=new o.XMLHttpRequest;n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer");for(const i in t.headers)n.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=()=>{e(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new wt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:()=>n.abort()}}(t,e)},St=function(t,e){return Et(y(t,{type:"arrayBuffer"}),e)},Tt=function(t,e){return Et(y(t,{method:"POST"}),e)},Mt=function(t,e){return Et(y(t,{method:"GET"}),e)};function At(t){const e=o.document.createElement("a");return e.href=t,e.protocol===o.document.location.protocol&&e.host===o.document.location.host}const kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pt,It;Pt=[],It=0;const Ot=function(t,e){if(q.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),It>=j.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Pt.push(n),n}It++;let n=!1;const i=()=>{if(!n)for(n=!0,It--;Pt.length&&It<j.MAX_PARALLEL_IMAGE_REQUESTS;){const t=Pt.shift(),{requestParameters:e,callback:n,cancelled:i}=t;i||(t.cancel=Ot(e,n).cancel)}},r=St(t,(t,n,r,s)=>{i(),t?e(t):n&&(xt()?function(t,e){const n=new o.Blob([new Uint8Array(t)],{type:"image/png"});o.createImageBitmap(n).then(t=>{e(null,t)}).catch(t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(n,e):function(t,e,n,i){const r=new o.Image,s=o.URL;r.onload=()=>{e(null,r),s.revokeObjectURL(r.src),r.onload=null,o.requestAnimationFrame(()=>{r.src=kt})},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const a=new o.Blob([new Uint8Array(t)],{type:"image/png"});r.cacheControl=n,r.expires=i,r.src=t.byteLength?s.createObjectURL(a):kt}(n,e,r,s))});return{cancel:()=>{r.cancel(),i()}}};function zt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Dt(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}class Rt{constructor(t,e={}){y(this,e),this.type=t}}class Lt extends Rt{constructor(t,e={}){super("error",y({error:t},e))}}class Ft{on(t,e){return this._listeners=this._listeners||{},zt(t,e,this._listeners),this}off(t,e){return Dt(t,e,this._listeners),Dt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},zt(t,e,this._oneTimeListeners),this):new Promise(e=>this.once(t,e))}fire(t,e){"string"==typeof t&&(t=new Rt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const s of i)Dt(n,s,this._oneTimeListeners),s.call(this,t);const r=this._eventedParent;r&&(y(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof Lt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var Bt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Nt{constructor(t,e,n,i){this.message=(t?`${t}: `:"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function Vt(t){const e=t.value;return e?[new Nt(t.key,e,"constants have been deprecated as of v8")]:[]}function Ut(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}function jt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function qt(t){if(Array.isArray(t))return t.map(qt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=qt(t[n]);return e}return jt(t)}class $t extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Gt{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[n,i]of e)this.bindings[n]=i}concat(t){return new Gt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Zt={kind:"null"},Ht={kind:"number"},Wt={kind:"string"},Xt={kind:"boolean"},Kt={kind:"color"},Qt={kind:"object"},Yt={kind:"value"},Jt={kind:"collator"},te={kind:"formatted"},ee={kind:"resolvedImage"};function ne(t,e){return{kind:"array",itemType:t,N:e}}function ie(t){if("array"===t.kind){const e=ie(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const re=[Zt,Ht,Wt,Xt,Kt,te,Qt,ne(Yt),ee];function se(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!se(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of re)if(!se(t,e))return null}return`Expected ${ie(t)} but found ${ie(e)} instead.`}function oe(t,e){return e.some(e=>e.kind===t.kind)}function ae(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}function le(t){var e={exports:{}};return t(e,e.exports),e.exports}var ce=le(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function s(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function o(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,a=t.replace(/ /g,"").toLowerCase();if(a in n)return n[a].slice();if("#"===a[0])return 4===a.length?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===a.length&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=a.indexOf("("),c=a.indexOf(")");if(-1!==l&&c+1===a.length){var u=a.substr(0,l),h=a.substr(l+1,c-(l+1)).split(","),d=1;switch(u){case"rgba":if(4!==h.length)return null;d=s(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),d];case"hsla":if(4!==h.length)return null;d=s(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=s(h[1]),m=s(h[2]),g=m<=.5?m*(f+1):m+f-m*f,_=2*m-g;return[i(255*o(_,g,p+1/3)),i(255*o(_,g,p)),i(255*o(_,g,p-1/3)),d];default:return null}}return null}}catch(t){}});class ue{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static parse(t){if(!t)return;if(t instanceof ue)return t;if("string"!=typeof t)return;const e=ce.parseCSSColor(t);return e?new ue(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,i]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${i})`}toArray(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]}}ue.black=new ue(0,0,0,1),ue.white=new ue(1,1,1,1),ue.transparent=new ue(0,0,0,0),ue.red=new ue(1,0,0,1),ue.blue=new ue(0,0,1,1);class he{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class de{constructor(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}}class pe{constructor(t){this.sections=t}static fromString(t){return new pe([new de(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof pe?t:pe.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function me(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ge(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ue)return!0;if(t instanceof he)return!0;if(t instanceof pe)return!0;if(t instanceof fe)return!0;if(Array.isArray(t)){for(const e of t)if(!ge(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ge(t[e]))return!1;return!0}return!1}function _e(t){if(null===t)return Zt;if("string"==typeof t)return Wt;if("boolean"==typeof t)return Xt;if("number"==typeof t)return Ht;if(t instanceof ue)return Kt;if(t instanceof he)return Jt;if(t instanceof pe)return te;if(t instanceof fe)return ee;if(Array.isArray(t)){const e=t.length;let n;for(const i of t){const t=_e(i);if(n){if(n===t)continue;n=Yt;break}n=t}return ne(n||Yt,e)}return Qt}function ye(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ue||t instanceof pe||t instanceof fe?t.toString():JSON.stringify(t)}class ve{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ge(t[1]))return e.error("invalid value");const n=t[1];let i=_e(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new ve(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ue?["rgba"].concat(this.value.toArray()):this.value instanceof pe?this.value.serialize():this.value}}class xe{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const be={string:Wt,number:Ht,boolean:Xt,object:Qt};class we{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,s;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in be)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=be[n],i++}else r=Yt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],i++}n=ne(r,s)}else n=be[r];const s=[];for(;i<t.length;i++){const n=e.parse(t[i],i,Yt);if(!n)return null;s.push(n)}return new we(n,s)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!se(this.type,_e(n)))return n;if(e===this.args.length-1)throw new xe(`Expected value to be of type ${ie(this.type)}, but found ${ie(_e(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map(t=>t.serialize()))}}class Ce{constructor(t){this.type=te,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let s=1;s<=t.length-1;++s){const n=t[s];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,Ht),!t))return null;let s=null;if(n["text-font"]&&(s=e.parse(n["text-font"],1,ne(Wt)),!s))return null;let o=null;if(n["text-color"]&&(o=e.parse(n["text-color"],1,Kt),!o))return null;const a=i[i.length-1];a.scale=t,a.font=s,a.textColor=o}else{const n=e.parse(t[s],1,Yt);if(!n)return null;const o=n.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null})}}return new Ce(i)}evaluate(t){return new pe(this.sections.map(e=>{const n=e.content.evaluate(t);return _e(n)===ee?new de("",n,null,null,null):new de(ye(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Ee{constructor(t){this.type=ee,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Wt);return n?new Ee(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=fe.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Se={"to-boolean":Xt,"to-color":Kt,"to-number":Ht,"to-string":Wt};class Te{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=Se[n],r=[];for(let s=1;s<t.length;s++){const n=e.parse(t[s],s,Yt);if(!n)return null;r.push(n)}return new Te(i,r)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof ue)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:me(e[0],e[1],e[2],e[3]),!n))return new ue(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new xe(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new xe(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?pe.fromString(ye(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?fe.fromString(ye(this.args[0].evaluate(t))):ye(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ce([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ee(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Me=["Unknown","Point","LineString","Polygon"];class Ae{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Me[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ue.parse(t)),e}}class ke{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const n=t[0],i=ke.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=s.filter(([e])=>!Array.isArray(e)||e.length===t.length-1);let a=null;for(const[l,c]of o){a=new Ye(e.registry,e.path,null,e.scope);const i=[];let s=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(l)?l[e-1]:l.type,o=a.parse(n,1+i.length,r);if(!o){s=!0;break}i.push(o)}if(!s)if(Array.isArray(l)&&l.length!==i.length)a.error(`Expected ${l.length} arguments, but found ${i.length} instead.`);else{for(let t=0;t<i.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=i[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new ke(n,r,c,i)}}if(1===o.length)e.errors.push(...a.errors);else{const n=(o.length?o:s).map(([t])=>{return e=t,Array.isArray(e)?`(${e.map(ie).join(", ")})`:`(${ie(e.type)}...)`;var e}).join(" | "),i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+i.length);if(!n)return null;i.push(ie(n.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){ke.definitions=e;for(const n in e)t[n]=ke}}class Pe{constructor(t,e,n){this.type=Jt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Xt);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Xt);if(!r)return null;let s=null;return n.locale&&(s=e.parse(n.locale,1,Wt),!s)?null:new Pe(i,r,s)}evaluate(t){return new he(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ie=8192;function Oe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ze(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function De(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*Ie),Math.round(i*r*Ie)]}function Re(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],s=t[0]-n[0],o=t[1]-n[1];return i*o-s*r==0&&i*s<=0&&r*o<=0}function Le(t,e){let n=!1;for(let o=0,a=e.length;o<a;o++){const a=e[o];for(let e=0,o=a.length;e<o-1;e++){if(Re(t,a[e],a[e+1]))return!1;(r=a[e])[1]>(i=t)[1]!=(s=a[e+1])[1]>i[1]&&i[0]<(s[0]-r[0])*(i[1]-r[1])/(s[1]-r[1])+r[0]&&(n=!n)}}var i,r,s;return n}function Fe(t,e){for(let n=0;n<e.length;n++)if(Le(t,e[n]))return!0;return!1}function Be(t,e,n,i){const r=i[0]-n[0],s=i[1]-n[1],o=(t[0]-n[0])*s-r*(t[1]-n[1]),a=(e[0]-n[0])*s-r*(e[1]-n[1]);return o>0&&a<0||o<0&&a>0}function Ne(t,e,n){for(const c of n)for(let n=0;n<c.length-1;++n)if(0!=(a=[(o=c[n+1])[0]-(s=c[n])[0],o[1]-s[1]])[0]*(l=[(r=e)[0]-(i=t)[0],r[1]-i[1]])[1]-a[1]*l[0]&&Be(i,r,s,o)&&Be(s,o,i,r))return!0;var i,r,s,o,a,l;return!1}function Ve(t,e){for(let n=0;n<t.length;++n)if(!Le(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Ne(t[n],t[n+1],e))return!1;return!0}function Ue(t,e){for(let n=0;n<e.length;n++)if(Ve(t,e[n]))return!0;return!1}function je(t,e,n){const i=[];for(let r=0;r<t.length;r++){const s=[];for(let i=0;i<t[r].length;i++){const o=De(t[r][i],n);Oe(e,o),s.push(o)}i.push(s)}return i}function qe(t,e,n){const i=[];for(let r=0;r<t.length;r++){const s=je(t[r],e,n);i.push(s)}return i}function $e(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}Oe(e,t)}function Ge(t,e,n,i){const r=Math.pow(2,i.z)*Ie,s=[i.x*Ie,i.y*Ie],o=[];for(const a of t)for(const t of a){const i=[t.x+s[0],t.y+s[1]];$e(i,e,n,r),o.push(i)}return o}function Ze(t,e,n,i){const r=Math.pow(2,i.z)*Ie,s=[i.x*Ie,i.y*Ie],o=[];for(const l of t){const t=[];for(const n of l){const i=[n.x+s[0],n.y+s[1]];Oe(e,i),t.push(i)}o.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of o)for(const i of t)$e(i,e,n,r)}var a;return o}class He{constructor(t,e){this.type=Xt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ge(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new He(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new He(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new He(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const s=je(e.coordinates,i,r),o=Ge(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of o)if(!Le(t,s))return!1}if("MultiPolygon"===e.type){const s=qe(e.coordinates,i,r),o=Ge(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of o)if(!Fe(t,s))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const s=je(e.coordinates,i,r),o=Ze(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of o)if(!Ve(t,s))return!1}if("MultiPolygon"===e.type){const s=qe(e.coordinates,i,r),o=Ze(t.geometry(),n,i,r);if(!ze(n,i))return!1;for(const t of o)if(!Ue(t,s))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function We(t){if(t instanceof ke){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof He)return!1;let e=!0;return t.eachChild(t=>{e&&!We(t)&&(e=!1)}),e}function Xe(t){if(t instanceof ke&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!Xe(t)&&(e=!1)}),e}function Ke(t,e){if(t instanceof ke&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(t=>{n&&!Ke(t,e)&&(n=!1)}),n}class Qe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new Qe(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ye{constructor(t,e=[],n,i=new Gt,r=[]){this.registry=t,this.path=e,this.key=e.map(t=>`[${t}]`).join(""),this.scope=i,this.errors=r,this.expectedType=n}parse(t,e,n,i,r={}){return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new we(e,[t]):"coerce"===n?new Te(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof ve)&&"resolvedImage"!==i.type.kind&&Je(i)){const e=new Ae;try{i=new ve(i.type,i.evaluate(e))}catch(t){return this.error(t.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Ye(this.registry,i,e||null,r,this.errors)}error(t,...e){const n=`${this.key}${e.map(t=>`[${t}]`).join("")}`;this.errors.push(new $t(n,t))}checkSubtype(t,e){const n=se(t,e);return n&&this.error(n),n}}function Je(t){if(t instanceof Qe)return Je(t.boundExpression);if(t instanceof ke&&"error"===t.name)return!1;if(t instanceof Pe)return!1;if(t instanceof He)return!1;const e=t instanceof Te||t instanceof we;let n=!0;return t.eachChild(t=>{n=e?n&&Je(t):n&&t instanceof ve}),!!n&&We(t)&&Ke(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function tn(t,e){const n=t.length-1;let i,r,s=0,o=n,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),i=t[a],r=t[a+1],i<=e){if(a===n||e<r)return a;s=a+1}else{if(!(i>e))throw new xe("Input is not a number.");o=a-1}return 0}class en{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let s=1;s<t.length;s+=2){const n=1===s?-1/0:t[s],o=t[s+1],a=s,l=s+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=e.parse(o,l,r);if(!c)return null;r=r||c.type,i.push([n,c])}return new en(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[tn(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}function nn(t,e,n){return t*(1-n)+e*n}var rn=Object.freeze({__proto__:null,number:nn,color:function(t,e,n){return new ue(nn(t.r,e.r,n),nn(t.g,e.g,n),nn(t.b,e.b,n),nn(t.a,e.a,n))},array:function(t,e,n){return t.map((t,i)=>nn(t,e[i],n))}});const sn=.95047,on=1.08883,an=4/29,ln=6/29,cn=3*ln*ln,un=Math.PI/180,hn=180/Math.PI;function dn(t){return t>.008856451679035631?Math.pow(t,1/3):t/cn+an}function pn(t){return t>ln?t*t*t:cn*(t-an)}function fn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function mn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function gn(t){const e=mn(t.r),n=mn(t.g),i=mn(t.b),r=dn((.4124564*e+.3575761*n+.1804375*i)/sn),s=dn((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*s-16,a:500*(r-s),b:200*(s-dn((.0193339*e+.119192*n+.9503041*i)/on)),alpha:t.a}}function _n(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*pn(e),n=sn*pn(n),i=on*pn(i),new ue(fn(3.2404542*n-1.5371385*e-.4985314*i),fn(-.969266*n+1.8760108*e+.041556*i),fn(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function yn(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const vn={forward:gn,reverse:_n,interpolate:function(t,e,n){return{l:nn(t.l,e.l,n),a:nn(t.a,e.a,n),b:nn(t.b,e.b,n),alpha:nn(t.alpha,e.alpha,n)}}},xn={forward:function(t){const{l:e,a:n,b:i}=gn(t),r=Math.atan2(i,n)*hn;return{h:r<0?r+360:r,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*un,n=t.c;return _n({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:yn(t.h,e.h,n),c:nn(t.c,e.c,n),l:nn(t.l,e.l,n),alpha:nn(t.alpha,e.alpha,n)}}};var bn=Object.freeze({__proto__:null,lab:vn,hcl:xn});class wn{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[s,o]of r)this.labels.push(s),this.outputs.push(o)}static interpolationFactor(t,e,i,r){let s=0;if("exponential"===t.name)s=Cn(e,t.base,i,r);else if("linear"===t.name)s=Cn(e,1,i,r);else if("cubic-bezier"===t.name){const o=t.controlPoints;s=new n(o[0],o[1],o[2],o[3]).solve(Cn(e,1,i,r))}return s}static parse(t,e){let[n,i,r,...s]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,Ht),!r)return null;const o=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=Kt:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let l=0;l<s.length;l+=2){const t=s[l],n=s[l+1],i=l+3,r=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(o.length&&o[o.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=e.parse(n,r,a);if(!c)return null;a=a||c.type,o.push([t,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new wn(a,n,i,r,o):e.error(`Type ${ie(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const s=tn(e,i),o=wn.interpolationFactor(this.interpolation,i,e[s],e[s+1]),a=n[s].evaluate(t),l=n[s+1].evaluate(t);return"interpolate"===this.operator?rn[this.type.kind.toLowerCase()](a,l,o):"interpolate-hcl"===this.operator?xn.reverse(xn.interpolate(xn.forward(a),xn.forward(l),o)):vn.reverse(vn.interpolate(vn.forward(a),vn.forward(l),o))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e}}function Cn(t,e,n,i){const r=i-n,s=t-n;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}class En{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const o of t.slice(1)){const t=e.parse(o,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}const s=i&&r.some(t=>se(i,t.type));return new En(s?Yt:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args)if(i++,n=r.evaluate(t),n&&n instanceof fe&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class Sn{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let r=1;r<t.length-1;r+=2){const i=t[r];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const s=e.parse(t[r+1],r+1);if(!s)return null;n.push([i,s])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new Sn(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}class Tn{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Ht),i=e.parse(t[2],2,ne(e.expectedType||Yt));return n&&i?new Tn(i.type.itemType,n,i):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new xe(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new xe(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new xe(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Mn{constructor(t,e){this.type=Xt,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Yt),i=e.parse(t[2],2,Yt);return n&&i?oe(n.type,[Xt,Wt,Ht,Zt,Yt])?new Mn(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!ae(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ie(_e(e))} instead.`);if(!ae(n,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ie(_e(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class An{constructor(t,e,n){this.type=Ht,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Yt),i=e.parse(t[2],2,Yt);if(!n||!i)return null;if(!oe(n.type,[Xt,Wt,Ht,Zt,Yt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Ht);return r?new An(n,i,r):null}return new An(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!ae(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ie(_e(e))} instead.`);if(!ae(n,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ie(_e(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kn{constructor(t,e,n,i,r,s){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=s}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},s=[];for(let l=2;l<t.length-1;l+=2){let o=t[l];const a=t[l+1];Array.isArray(o)||(o=[o]);const c=e.concat(l);if(0===o.length)return c.error("Expected at least one branch label.");for(const t of o){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,_e(t)))return null}else n=_e(t);if(void 0!==r[String(t)])return c.error("Branch labels must be unique.");r[String(t)]=s.length}const u=e.parse(a,l,i);if(!u)return null;i=i||u.type,s.push(u)}const o=e.parse(t[1],1,Yt);if(!o)return null;const a=e.parse(t[t.length-1],t.length-1,i);return a?"value"!==o.type.kind&&e.concat(1).checkSubtype(n,o.type)?null:new kn(n,i,o,r,s,a):null}evaluate(t){const e=this.input.evaluate(t);return(_e(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],i={};for(const s of e){const t=i[this.cases[s]];void 0===t?(i[this.cases[s]]=n.length,n.push([this.cases[s],[s]])):n[t][1].push(s)}const r=t=>"number"===this.inputType.kind?Number(t):t;for(const[s,o]of n)t.push(1===o.length?r(o[0]):o.map(r)),t.push(this.outputs[s].serialize());return t.push(this.otherwise.serialize()),t}}class Pn{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let s=1;s<t.length-1;s+=2){const r=e.parse(t[s],s,Xt);if(!r)return null;const o=e.parse(t[s+1],s+1,n);if(!o)return null;i.push([r,o]),n=n||o.type}const r=e.parse(t[t.length-1],t.length-1,n);return r?new Pn(n,i,r):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class In{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Yt),i=e.parse(t[2],2,Ht);if(!n||!i)return null;if(!oe(n.type,[ne(Yt),Wt,Yt]))return e.error(`Expected first argument to be of type array or string, but found ${ie(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Ht);return r?new In(n.type,n,i,r):null}return new In(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!ae(e,["string","array"]))throw new xe(`Expected first argument to be of type array or string, but found ${ie(_e(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function On(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function zn(t,e,n,i){return 0===i.compare(e,n)}function Dn(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=Xt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let s=e.parse(t[1],1,Yt);if(!s)return null;if(!On(n,s.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${ie(s.type)}'.`);let o=e.parse(t[2],2,Yt);if(!o)return null;if(!On(n,o.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${ie(o.type)}'.`);if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${ie(s.type)}' and '${ie(o.type)}'.`);i&&("value"===s.type.kind&&"value"!==o.type.kind?s=new we(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new we(s.type,[o])));let a=null;if(4===t.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,Jt),!a)return null}return new r(s,o,a)}evaluate(r){const s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=_e(s),n=_e(o);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new xe(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=_e(s),n=_e(o);if("string"!==t.kind||"string"!==n.kind)return e(r,s,o)}return this.collator?n(r,s,o,this.collator.evaluate(r)):e(r,s,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild(t=>{e.push(t.serialize())}),e}}}const Rn=Dn("==",function(t,e,n){return e===n},zn),Ln=Dn("!=",function(t,e,n){return e!==n},function(t,e,n,i){return!zn(0,e,n,i)}),Fn=Dn("<",function(t,e,n){return e<n},function(t,e,n,i){return i.compare(e,n)<0}),Bn=Dn(">",function(t,e,n){return e>n},function(t,e,n,i){return i.compare(e,n)>0}),Nn=Dn("<=",function(t,e,n){return e<=n},function(t,e,n,i){return i.compare(e,n)<=0}),Vn=Dn(">=",function(t,e,n){return e>=n},function(t,e,n,i){return i.compare(e,n)>=0});class Un{constructor(t,e,n,i,r){this.type=Wt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,Wt),!r))return null;let s=null;if(i.currency&&(s=e.parse(i.currency,1,Wt),!s))return null;let o=null;if(i["min-fraction-digits"]&&(o=e.parse(i["min-fraction-digits"],1,Ht),!o))return null;let a=null;return i["max-fraction-digits"]&&(a=e.parse(i["max-fraction-digits"],1,Ht),!a)?null:new Un(n,r,s,o,a)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class jn{constructor(t){this.type=Ht,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${ie(n.type)} instead.`):new jn(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new xe(`Expected value to be of type string or array, but found ${ie(_e(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const qn={"==":Rn,"!=":Ln,">":Bn,"<":Fn,">=":Vn,"<=":Nn,array:we,at:Tn,boolean:we,case:Pn,coalesce:En,collator:Pe,format:Ce,image:Ee,in:Mn,"index-of":An,interpolate:wn,"interpolate-hcl":wn,"interpolate-lab":wn,length:jn,let:Sn,literal:ve,match:kn,number:we,"number-format":Un,object:we,slice:In,step:en,string:we,"to-boolean":Te,"to-color":Te,"to-number":Te,"to-string":Te,var:Qe,within:He};function $n(t,[e,n,i,r]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const s=r?r.evaluate(t):1,o=me(e,n,i,s);if(o)throw new xe(o);return new ue(e/255*s,n/255*s,i/255*s,s)}function Gn(t,e){return t in e}function Zn(t,e){const n=e[t];return void 0===n?null:n}function Hn(t){return{type:t}}function Wn(t){return{result:"success",value:t}}function Xn(t){return{result:"error",value:t}}function Kn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Qn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Yn(t){return!!t.expression&&t.expression.interpolated}function Jn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function ti(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function ei(t){return t}function ni(t,e){const n="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],r=i||!(i||void 0!==t.property),s=t.type||(Yn(e)?"exponential":"interval");if(n&&((t=Ut({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],ue.parse(t[1])])),t.default=ue.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!bn[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let o,a,l;if("exponential"===s)o=oi;else if("interval"===s)o=si;else if("categorical"===s){o=ri,a=Object.create(null);for(const e of t.stops)a[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==s)throw new Error(`Unknown function type "${s}"`);o=ai}if(i){const n={},i=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],s=r[0].zoom;void 0===n[s]&&(n[s]={zoom:s,type:t.type,property:t.property,default:t.default,stops:[]},i.push(s)),n[s].stops.push([r[0].value,r[1]])}const r=[];for(const t of i)r.push([n[t].zoom,ni(n[t],e)]);const s={name:"linear"};return{kind:"composite",interpolationType:s,interpolationFactor:wn.interpolationFactor.bind(void 0,s),zoomStops:r.map(t=>t[0]),evaluate:({zoom:n},i)=>oi({stops:r,base:t.base},e,n).evaluate(n,i)}}if(r){const n="exponential"===s?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:wn.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map(t=>t[0]),evaluate:({zoom:n})=>o(t,e,n,a,l)}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[t.property]:void 0;return void 0===r?ii(t.default,e.default):o(t,e,r,a,l)}}}function ii(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function ri(t,e,n,i,r){return ii(typeof n===r?i[n]:void 0,t.default,e.default)}function si(t,e,n){if("number"!==Jn(n))return ii(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const r=tn(t.stops.map(t=>t[0]),n);return t.stops[r][1]}function oi(t,e,n){const i=void 0!==t.base?t.base:1;if("number"!==Jn(n))return ii(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const s=tn(t.stops.map(t=>t[0]),n),o=function(t,e,n,i){const r=i-n,s=t-n;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[s][0],t.stops[s+1][0]),a=t.stops[s][1],l=t.stops[s+1][1];let c=rn[e.type]||ei;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=bn[t.colorSpace];c=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),o))}return"function"==typeof a.evaluate?{evaluate(...t){const e=a.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==n)return c(e,n,o)}}:c(a,l,o)}function ai(t,e,n){return"color"===e.type?n=ue.parse(n):"formatted"===e.type?n=pe.fromString(n.toString()):"resolvedImage"===e.type?n=fe.fromString(n.toString()):Jn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),ii(n,t.default,e.default)}ke.register(qn,{error:[{kind:"error"},[Wt],(t,[e])=>{throw new xe(e.evaluate(t))}],typeof:[Wt,[Yt],(t,[e])=>ie(_e(e.evaluate(t)))],"to-rgba":[ne(Ht,4),[Kt],(t,[e])=>e.evaluate(t).toArray()],rgb:[Kt,[Ht,Ht,Ht],$n],rgba:[Kt,[Ht,Ht,Ht,Ht],$n],has:{type:Xt,overloads:[[[Wt],(t,[e])=>Gn(e.evaluate(t),t.properties())],[[Wt,Qt],(t,[e,n])=>Gn(e.evaluate(t),n.evaluate(t))]]},get:{type:Yt,overloads:[[[Wt],(t,[e])=>Zn(e.evaluate(t),t.properties())],[[Wt,Qt],(t,[e,n])=>Zn(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Yt,[Wt],(t,[e])=>Zn(e.evaluate(t),t.featureState||{})],properties:[Qt,[],t=>t.properties()],"geometry-type":[Wt,[],t=>t.geometryType()],id:[Yt,[],t=>t.id()],zoom:[Ht,[],t=>t.globals.zoom],"heatmap-density":[Ht,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ht,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Ht,[],t=>t.globals.skyRadialProgress||0],accumulated:[Yt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Ht,Hn(Ht),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[Ht,Hn(Ht),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:Ht,overloads:[[[Ht,Ht],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Ht],(t,[e])=>-e.evaluate(t)]]},"/":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Ht,[Ht],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ht,[Ht],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ht,[Ht],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ht,[Ht],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ht,[Ht],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ht,[Ht],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ht,[Ht],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ht,Hn(Ht),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[Ht,Hn(Ht),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[Ht,[Ht],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ht,[Ht],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ht,[Ht],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ht,[Ht],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Xt,[Wt,Yt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Xt,[Yt],(t,[e])=>t.id()===e.value],"filter-type-==":[Xt,[Wt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Xt,[Wt,Yt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[Xt,[Yt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[Xt,[Wt,Yt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[Xt,[Yt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[Xt,[Wt,Yt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[Xt,[Yt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[Xt,[Wt,Yt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[Xt,[Yt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[Xt,[Yt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Xt,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Xt,[ne(Wt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Xt,[ne(Yt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Xt,[Wt,ne(Yt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Xt,[Wt,ne(Yt)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Hn(Xt),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Hn(Xt),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Xt,[Xt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Xt,[Wt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Wt,[Wt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Wt,[Wt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Wt,Hn(Yt),(t,e)=>e.map(e=>ye(e.evaluate(t))).join("")],"resolved-locale":[Wt,[Jt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class li{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Ae,this._defaultValue=e?function(t){return"color"===t.type&&ti(t.default)?new ue(0,0,0,0):"color"===t.type?ue.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,i,r,s){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,r,s){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new xe(`Expected value to be one of ${Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function ci(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in qn}function ui(t,e){const n=new Ye(qn,[],e?function(t){const e={color:Kt,string:Wt,number:Ht,enum:Wt,boolean:Xt,formatted:te,resolvedImage:ee};return"array"===t.type?ne(e[t.value]||Yt,t.length):e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?Wn(new li(i,e)):Xn(n.errors)}class hi{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Xe(e.expression)}evaluateWithoutErrorHandling(t,e,n,i,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,s)}evaluate(t,e,n,i,r,s){return this._styleExpression.evaluate(t,e,n,i,r,s)}}class di{constructor(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Xe(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,n,i,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,s)}evaluate(t,e,n,i,r,s){return this._styleExpression.evaluate(t,e,n,i,r,s)}interpolationFactor(t,e,n){return this.interpolationType?wn.interpolationFactor(this.interpolationType,t,e,n):0}}function pi(t,e){if("error"===(t=ui(t,e)).result)return t;const n=t.value.expression,i=We(n);if(!i&&!Kn(e))return Xn([new $t("","data expressions not supported")]);const r=Ke(n,["zoom"]);if(!r&&!Qn(e))return Xn([new $t("","zoom expressions not supported")]);const s=mi(n);return s||r?s instanceof $t?Xn([s]):s instanceof wn&&!Yn(e)?Xn([new $t("",'"interpolate" expressions cannot be used with this property')]):Wn(s?new di(i?"camera":"composite",t.value,s.labels,s instanceof wn?s.interpolation:void 0):new hi(i?"constant":"source",t.value)):Xn([new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fi{constructor(t,e){this._parameters=t,this._specification=e,Ut(this,ni(this._parameters,this._specification))}static deserialize(t){return new fi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function mi(t){let e=null;if(t instanceof Sn)e=mi(t.result);else if(t instanceof En){for(const n of t.args)if(e=mi(n),e)break}else(t instanceof en||t instanceof wn)&&t.input instanceof ke&&"zoom"===t.input.name&&(e=t);return e instanceof $t||t.eachChild(t=>{const n=mi(t);n instanceof $t?e=n:!e&&n?e=new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new $t("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function gi(t){const e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},s=t.style,o=t.styleSpec;let a=[];const l=Jn(n);if("object"!==l)return[new Nt(e,n,`object expected, ${l} found`)];for(const c in n){const t=c.split(".")[0],l=i[t]||i["*"];let u;if(r[t])u=r[t];else if(i[t])u=$i;else if(r["*"])u=r["*"];else{if(!i["*"]){a.push(new Nt(e,n[c],`unknown property "${c}"`));continue}u=$i}a=a.concat(u({key:(e?`${e}.`:e)+c,value:n[c],valueSpec:l,style:s,styleSpec:o,object:n,objectKey:c},n))}for(const c in i)r[c]||i[c].required&&void 0===i[c].default&&void 0===n[c]&&a.push(new Nt(e,n,`missing required property "${c}"`));return a}function _i(t){const e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,s=t.key,o=t.arrayElementValidator||$i;if("array"!==Jn(e))return[new Nt(s,e,`array expected, ${Jn(e)} found`)];if(n.length&&e.length!==n.length)return[new Nt(s,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Nt(s,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum};r.$version<7&&(a.function=n.function),"object"===Jn(n.value)&&(a=n.value);let l=[];for(let c=0;c<e.length;c++)l=l.concat(o({array:e,arrayIndex:c,value:e[c],valueSpec:a,style:i,styleSpec:r,key:`${s}[${c}]`}));return l}function yi(t){const e=t.key,n=t.value,i=t.valueSpec;let r=Jn(n);if("number"===r&&n!=n&&(r="NaN"),"number"!==r)return[new Nt(e,n,`number expected, ${r} found`)];if("minimum"in i){let r=i.minimum;if("array"===Jn(i.minimum)&&(r=i.minimum[t.arrayIndex]),n<r)return[new Nt(e,n,`${n} is less than the minimum value ${r}`)]}if("maximum"in i){let r=i.maximum;if("array"===Jn(i.maximum)&&(r=i.maximum[t.arrayIndex]),n>r)return[new Nt(e,n,`${n} is greater than the maximum value ${r}`)]}return[]}function vi(t){const e=t.valueSpec,n=jt(t.value.type);let i,r,s,o={};const a="categorical"!==n&&void 0===t.value.property,l=!a,c="array"===Jn(t.value.stops)&&"array"===Jn(t.value.stops[0])&&"object"===Jn(t.value.stops[0][0]),u=gi({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new Nt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const i=t.value;return e=e.concat(_i({key:t.key,value:i,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Jn(i)&&0===i.length&&e.push(new Nt(t.key,i,"array must have at least one stop")),e},default:function(t){return $i({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&a&&u.push(new Nt(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||u.push(new Nt(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Yn(t.valueSpec)&&u.push(new Nt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Kn(t.valueSpec)?u.push(new Nt(t.key,t.value,"property functions not supported")):a&&!Qn(t.valueSpec)&&u.push(new Nt(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==t.value.property||u.push(new Nt(t.key,t.value,'"property" property is required')),u;function h(t){let n=[];const i=t.value,a=t.key;if("array"!==Jn(i))return[new Nt(a,i,`array expected, ${Jn(i)} found`)];if(2!==i.length)return[new Nt(a,i,`array length 2 expected, length ${i.length} found`)];if(c){if("object"!==Jn(i[0]))return[new Nt(a,i,`object expected, ${Jn(i[0])} found`)];if(void 0===i[0].zoom)return[new Nt(a,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new Nt(a,i,"object stop key must have value")];if(s&&s>jt(i[0].zoom))return[new Nt(a,i[0].zoom,"stop zoom values must appear in ascending order")];jt(i[0].zoom)!==s&&(s=jt(i[0].zoom),r=void 0,o={}),n=n.concat(gi({key:`${a}[0]`,value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:yi,value:d}}))}else n=n.concat(d({key:`${a}[0]`,value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return ci(qt(i[1]))?n.concat([new Nt(`${a}[1]`,i[1],"expressions are not allowed in function stops.")]):n.concat($i({key:`${a}[1]`,value:i[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function d(t,s){const a=Jn(t.value),l=jt(t.value),c=null!==t.value?t.value:s;if(i){if(a!==i)return[new Nt(t.key,c,`${a} stop domain type must match previous stop domain type ${i}`)]}else i=a;if("number"!==a&&"string"!==a&&"boolean"!==a)return[new Nt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let i=`number expected, ${a} found`;return Kn(e)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Nt(t.key,c,i)]}return"categorical"!==n||"number"!==a||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&void 0!==r&&l<r?[new Nt(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in o?[new Nt(t.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new Nt(t.key,c,`integer expected, found ${l}`)]}}function xi(t){const e=("property"===t.expressionContext?pi:ui)(qt(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new Nt(`${t.key}${e.key}`,t.value,e.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new Nt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Xe(n))return[new Nt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Xe(n))return[new Nt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ke(n,["zoom","feature-state"]))return[new Nt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!We(n))return[new Nt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bi(t){const e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(jt(n))&&r.push(new Nt(e,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(i.values).indexOf(jt(n))&&r.push(new Nt(e,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),r}function wi(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!wi(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Ci={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ei(t){if(null==t)return{filter:()=>!0,needGeometry:!1};wi(t)||(t=Mi(t));const e=ui(t,Ci);if("error"===e.result)throw new Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));return{filter:(t,n,i)=>e.value.evaluate(t,n,{},i),needGeometry:Ti(t)}}function Si(t,e){return t<e?-1:t>e?1:0}function Ti(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Ti(t[e]))return!0;return!1}function Mi(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Ai(t[1],t[2],"=="):"!="===e?Ii(Ai(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ai(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Mi))):"all"===e?["all"].concat(t.slice(1).map(Mi)):"none"===e?["all"].concat(t.slice(1).map(Mi).map(Ii)):"in"===e?ki(t[1],t.slice(2)):"!in"===e?Ii(ki(t[1],t.slice(2))):"has"===e?Pi(t[1]):"!has"===e?Ii(Pi(t[1])):"within"!==e||t;var n}function Ai(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function ki(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Si)]]:["filter-in-small",t,["literal",e]]}}function Pi(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ii(t){return["!",t]}function Oi(t){return wi(qt(t.value))?xi(Ut({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zi(t)}function zi(t){const e=t.value,n=t.key;if("array"!==Jn(e))return[new Nt(n,e,`array expected, ${Jn(e)} found`)];const i=t.styleSpec;let r,s=[];if(e.length<1)return[new Nt(n,e,"filter array must have at least 1 element")];switch(s=s.concat(bi({key:`${n}[0]`,value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),jt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===jt(e[1])&&s.push(new Nt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&s.push(new Nt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(r=Jn(e[1]),"string"!==r&&s.push(new Nt(`${n}[1]`,e[1],`string expected, ${r} found`)));for(let o=2;o<e.length;o++)r=Jn(e[o]),"$type"===jt(e[1])?s=s.concat(bi({key:`${n}[${o}]`,value:e[o],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&s.push(new Nt(`${n}[${o}]`,e[o],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let i=1;i<e.length;i++)s=s.concat(zi({key:`${n}[${i}]`,value:e[i],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Jn(e[1]),2!==e.length?s.push(new Nt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==r&&s.push(new Nt(`${n}[1]`,e[1],`string expected, ${r} found`));break;case"within":r=Jn(e[1]),2!==e.length?s.push(new Nt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==r&&s.push(new Nt(`${n}[1]`,e[1],`object expected, ${r} found`))}return s}function Di(t,e){const n=t.key,i=t.style,r=t.styleSpec,s=t.value,o=t.objectKey,a=r[`${e}_${t.layerType}`];if(!a)return[];const l=o.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return $i({key:n,value:s,valueSpec:r.transition,style:i,styleSpec:r});const c=t.valueSpec||a[o];if(!c)return[new Nt(n,s,`unknown property "${o}"`)];let u;if("string"===Jn(s)&&Kn(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(s)))return[new Nt(n,s,`"${o}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===o&&i&&!i.glyphs&&h.push(new Nt(n,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&ti(qt(s))&&"identity"===jt(s.type)&&h.push(new Nt(n,s,'"text-font" does not support identity functions'))),h.concat($i({key:t.key,value:s,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:o}))}function Ri(t){return Di(t,"paint")}function Li(t){return Di(t,"layout")}function Fi(t){let e=[];const n=t.value,i=t.key,r=t.style,s=t.styleSpec;n.type||n.ref||e.push(new Nt(i,n,'either "type" or "ref" is required'));let o=jt(n.type);const a=jt(n.ref);if(n.id){const s=jt(n.id);for(let o=0;o<t.arrayIndex;o++){const t=r.layers[o];jt(t.id)===s&&e.push(new Nt(i,n.id,`duplicate layer id "${n.id}", previously used at line ${t.id.__line__}`))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in n&&e.push(new Nt(i,n[t],`"${t}" is prohibited for ref layers`))}),r.layers.forEach(e=>{jt(e.id)===a&&(t=e)}),t?t.ref?e.push(new Nt(i,n.ref,"ref cannot reference another ref layer")):o=jt(t.type):e.push(new Nt(i,n.ref,`ref layer "${a}" not found`))}else if("background"!==o&&"sky"!==o)if(n.source){const t=r.sources&&r.sources[n.source],s=t&&jt(t.type);t?"vector"===s&&"raster"===o?e.push(new Nt(i,n.source,`layer "${n.id}" requires a raster source`)):"raster"===s&&"raster"!==o?e.push(new Nt(i,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==s||n["source-layer"]?"raster-dem"===s&&"hillshade"!==o?e.push(new Nt(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!n.paint||!n.paint["line-gradient"]||"geojson"===s&&t.lineMetrics||e.push(new Nt(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Nt(i,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Nt(i,n.source,`source "${n.source}" not found`))}else e.push(new Nt(i,n,'missing required property "source"'));return e=e.concat(gi({key:i,value:n,valueSpec:s.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>$i({key:`${i}.type`,value:n.type,valueSpec:s.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:Oi,layout:t=>gi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Li(Ut({layerType:o},t))}}),paint:t=>gi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Ri(Ut({layerType:o},t))}})}})),e}function Bi(t){const e=t.value,n=t.key,i=Jn(e);return"string"!==i?[new Nt(n,e,`string expected, ${i} found`)]:[]}const Ni={promoteId:function({key:t,value:e}){if("string"===Jn(e))return Bi({key:t,value:e});{const n=[];for(const i in e)n.push(...Bi({key:`${t}.${i}`,value:e[i]}));return n}}};function Vi(t){const e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new Nt(n,e,'"type" is required')];const s=jt(e.type);let o;switch(s){case"vector":case"raster":case"raster-dem":return o=gi({key:n,value:e,valueSpec:i[`source_${s.replace("-","_")}`],style:t.style,styleSpec:i,objectElementValidators:Ni}),o;case"geojson":if(o=gi({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:Ni}),e.cluster)for(const t in e.clusterProperties){const[i,r]=e.clusterProperties[t],s="string"==typeof i?[i,["accumulated"],["get",t]]:i;o.push(...xi({key:`${n}.${t}.map`,value:r,expressionContext:"cluster-map"})),o.push(...xi({key:`${n}.${t}.reduce`,value:s,expressionContext:"cluster-reduce"}))}return o;case"video":return gi({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return gi({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new Nt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bi({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function Ui(t){const e=t.value,n=t.styleSpec,i=n.light,r=t.style;let s=[];const o=Jn(e);if(void 0===e)return s;if("object"!==o)return s=s.concat([new Nt("light",e,`object expected, ${o} found`)]),s;for(const a in e){const t=a.match(/^(.*)-transition$/);s=s.concat(t&&i[t[1]]&&i[t[1]].transition?$i({key:a,value:e[a],valueSpec:n.transition,style:r,styleSpec:n}):i[a]?$i({key:a,value:e[a],valueSpec:i[a],style:r,styleSpec:n}):[new Nt(a,e[a],`unknown property "${a}"`)])}return s}function ji(t){const e=t.value,n=t.key,i=t.style,r=t.styleSpec,s=r.terrain;let o=[];const a=Jn(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new Nt("terrain",e,`object expected, ${a} found`)]),o;for(const l in e){const t=l.match(/^(.*)-transition$/);o=o.concat(t&&s[t[1]]&&s[t[1]].transition?$i({key:l,value:e[l],valueSpec:r.transition,style:i,styleSpec:r}):s[l]?$i({key:l,value:e[l],valueSpec:s[l],style:i,styleSpec:r}):[new Nt(l,e[l],`unknown property "${l}"`)])}if(e.source){const t=i.sources&&i.sources[e.source],r=t&&jt(t.type);t?"raster-dem"!==r&&o.push(new Nt(n,e.source,`terrain cannot be used with a source of type ${r}, it only be used with a "raster-dem" source type`)):o.push(new Nt(n,e.source,`source "${e.source}" not found`))}else o.push(new Nt(n,e,'terrain is missing required property "source"'));return o}const qi={"*":()=>[],array:_i,boolean:function(t){const e=t.value,n=t.key,i=Jn(e);return"boolean"!==i?[new Nt(n,e,`boolean expected, ${i} found`)]:[]},number:yi,color:function(t){const e=t.key,n=t.value,i=Jn(n);return"string"!==i?[new Nt(e,n,`color expected, ${i} found`)]:null===ce.parseCSSColor(n)?[new Nt(e,n,`color expected, "${n}" found`)]:[]},constants:Vt,enum:bi,filter:Oi,function:vi,layer:Fi,object:gi,source:Vi,light:Ui,terrain:ji,string:Bi,formatted:function(t){return 0===Bi(t).length?[]:xi(t)},resolvedImage:function(t){return 0===Bi(t).length?[]:xi(t)}};function $i(t){const e=t.value,n=t.valueSpec,i=t.styleSpec;return n.expression&&ti(jt(e))?vi(t):n.expression&&ci(qt(e))?xi(t):n.type&&qi[n.type]?qi[n.type](t):gi(Ut({},t,{valueSpec:n.type?i[n.type]:n}))}function Gi(t){const e=t.value,n=t.key,i=Bi(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new Nt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new Nt(n,e,'"glyphs" url must include a "{range}" token'))),i}function Zi(t,e=Bt){let n=[];return n=n.concat($i({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Gi,"*":()=>[]}})),t.constants&&(n=n.concat(Vt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Hi(n)}function Hi(t){return[].concat(t).sort((t,e)=>t.line-e.line)}function Wi(t){return function(...e){return Hi(t.apply(this,e))}}Zi.source=Wi(Vi),Zi.light=Wi(Ui),Zi.terrain=Wi(ji),Zi.layer=Wi(Fi),Zi.filter=Wi(Oi),Zi.paintProperty=Wi(Ri),Zi.layoutProperty=Wi(Li);const Xi=Zi,Ki=Xi.light,Qi=Xi.paintProperty,Yi=Xi.layoutProperty;function Ji(t,e){let n=!1;if(e&&e.length)for(const i of e)t.fire(new Lt(new Error(i.message))),n=!0;return n}var tr=er;function er(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(var s=0;s<this.d*this.d;s++){var o=r[3+s],a=r[3+s+1];i.push(o===a?null:r.subarray(o,a))}var l=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var u=n/e*t;this.min=-u,this.max=t+u}er.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},er.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},er.prototype._insertCell=function(t,e,n,i,r,s){this.cells[r].push(s)},er.prototype.query=function(t,e,n,i,r){var s=this.min,o=this.max;if(t<=s&&e<=s&&o<=n&&o<=i&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{},r),a},er.prototype._queryCell=function(t,e,n,i,r,s,o,a){var l=this.cells[r];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===o[d]){var p=4*d;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):t<=u[p+2]&&e<=u[p+3]&&n>=u[p+0]&&i>=u[p+1])?(o[d]=!0,s.push(c[d])):o[d]=!1}}},er.prototype._forEachCell=function(t,e,n,i,r,s,o,a){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&r.call(this,t,e,n,i,f,s,o,a))return}},er.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},er.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},er.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var s=e,o=0;o<t.length;o++){var a=t[o];r[3+o]=s,r.set(a,s),s+=a.length}return r[3+t.length]=s,r.set(this.keys,s),r[3+t.length+1]=s+=this.keys.length,r.set(this.bboxes,s),s+=this.bboxes.length,r.buffer};const{ImageData:nr,ImageBitmap:ir}=o,rr={};function sr(t,e,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),rr[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}sr("Object",Object),tr.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},tr.deserialize=function(t){return new tr(t.buffer)},sr("Grid",tr),sr("Color",ue),sr("Error",Error),sr("ResolvedImage",fe),sr("StylePropertyFunction",fi),sr("StyleExpression",li,{omit:["_evaluator"]}),sr("ZoomDependentExpression",di),sr("ZoomConstantExpression",hi),sr("CompoundExpression",ke,{omit:["_evaluate"]});for(const vd in qn)qn[vd]._classRegistryKey||sr(`Expression_${vd}`,qn[vd]);function or(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ar(t){return ir&&t instanceof ir}function lr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(or(t)||ar(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof nr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(lr(i,e));return n}if("object"==typeof t){const n=t.constructor,i=n._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class");const r=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const n in t){if(!t.hasOwnProperty(n))continue;if(rr[i].omit.indexOf(n)>=0)continue;const s=t[n];r[n]=rr[i].shallow.indexOf(n)>=0?s:lr(s,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(r.$name=i),r}throw new Error("can't serialize object of type "+typeof t)}function cr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||or(t)||ar(t)||ArrayBuffer.isView(t)||t instanceof nr)return t;if(Array.isArray(t))return t.map(cr);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=rr[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const r of Object.keys(t)){if("$name"===r)continue;const n=t[r];i[r]=rr[e].shallow.indexOf(r)>=0?n:cr(n)}return i}throw new Error("can't deserialize object of type "+typeof t)}class ur{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const hr=t=>t>=1536&&t<=1791,dr=t=>t>=1872&&t<=1919,pr=t=>t>=2208&&t<=2303,fr=t=>t>=11904&&t<=12031,mr=t=>t>=12032&&t<=12255,gr=t=>t>=12272&&t<=12287,_r=t=>t>=12288&&t<=12351,yr=t=>t>=12352&&t<=12447,vr=t=>t>=12448&&t<=12543,xr=t=>t>=12544&&t<=12591,br=t=>t>=12704&&t<=12735,wr=t=>t>=12736&&t<=12783,Cr=t=>t>=12784&&t<=12799,Er=t=>t>=12800&&t<=13055,Sr=t=>t>=13056&&t<=13311,Tr=t=>t>=13312&&t<=19903,Mr=t=>t>=19968&&t<=40959,Ar=t=>t>=40960&&t<=42127,kr=t=>t>=42128&&t<=42191,Pr=t=>t>=44032&&t<=55215,Ir=t=>t>=63744&&t<=64255,Or=t=>t>=64336&&t<=65023,zr=t=>t>=65040&&t<=65055,Dr=t=>t>=65072&&t<=65103,Rr=t=>t>=65104&&t<=65135,Lr=t=>t>=65136&&t<=65279,Fr=t=>t>=65280&&t<=65519;function Br(t){for(const e of t)if(Ur(e.charCodeAt(0)))return!0;return!1}function Nr(t){for(const e of t)if(!Vr(e.charCodeAt(0)))return!1;return!0}function Vr(t){return!(hr(t)||dr(t)||pr(t)||Or(t)||Lr(t))}function Ur(t){return!(746!==t&&747!==t&&(t<4352||!(br(t)||xr(t)||Dr(t)&&!(t>=65097&&t<=65103)||Ir(t)||Sr(t)||fr(t)||wr(t)||!(!_r(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Tr(t)||Mr(t)||Er(t)||(t=>t>=12592&&t<=12687)(t)||(t=>t>=43360&&t<=43391)(t)||(t=>t>=55216&&t<=55295)(t)||(t=>t>=4352&&t<=4607)(t)||Pr(t)||yr(t)||gr(t)||(t=>t>=12688&&t<=12703)(t)||mr(t)||Cr(t)||vr(t)&&12540!==t||!(!Fr(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Rr(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(t=>t>=5120&&t<=5759)(t)||(t=>t>=6320&&t<=6399)(t)||zr(t)||(t=>t>=19904&&t<=19967)(t)||Ar(t)||kr(t))))}function jr(t){return!(Ur(t)||function(t){return!!((t=>t>=128&&t<=255)(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||(t=>t>=8192&&t<=8303)(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||(t=>t>=8448&&t<=8527)(t)||(t=>t>=8528&&t<=8591)(t)||(t=>t>=8960&&t<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||(t=>t>=9216&&t<=9279)(t)&&9251!==t||(t=>t>=9280&&t<=9311)(t)||(t=>t>=9312&&t<=9471)(t)||(t=>t>=9632&&t<=9727)(t)||(t=>t>=9728&&t<=9983)(t)&&!(t>=9754&&t<=9759)||(t=>t>=11008&&t<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||_r(t)||vr(t)||(t=>t>=57344&&t<=63743)(t)||Dr(t)||Rr(t)||Fr(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function qr(t){return t>=1424&&t<=2303||Or(t)||Lr(t)}function $r(t,e){return!(!e&&qr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(t=>t>=6016&&t<=6143)(t))}function Gr(t){for(const e of t)if(qr(e.charCodeAt(0)))return!0;return!1}const Zr="deferred",Hr="loading",Wr="loaded";let Xr=null,Kr="unavailable",Qr=null;const Yr=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Kr="error"),Xr&&Xr(t)};function Jr(){ts.fire(new Rt("pluginStateChange",{pluginStatus:Kr,pluginURL:Qr}))}const ts=new Ft,es=function(){return Kr},ns=function(){if(Kr!==Zr||!Qr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kr=Hr,Jr(),Qr&&St({url:Qr},t=>{t?Yr(t):(Kr=Wr,Jr())})},is={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Kr===Wr||null!=is.applyArabicShaping,isLoading:()=>Kr===Hr,setState(t){Kr=t.pluginStatus,Qr=t.pluginURL},isParsed:()=>null!=is.applyArabicShaping&&null!=is.processBidirectionalText&&null!=is.processStyledBidirectionalText,getPluginURL:()=>Qr};class rs{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ur,this.transition={})}isSupportedScript(t){return function(t,e){for(const n of t)if(!$r(n.charCodeAt(0),e))return!1;return!0}(t,is.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}class ss{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(ti(t))return new fi(t,e);if(ci(t)){const n=pi(t,e);if("error"===n.result)throw new Error(n.value.map(t=>`${t.key}: ${t.message}`).join(", "));return n.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=ue.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class os{constructor(t){this.property=t,this.value=new ss(t,void 0)}transitioned(t,e){return new ls(this.property,this.value,e,y({},t.transition,this.transition),t.now)}untransitioned(){return new ls(this.property,this.value,null,{},0)}}class as{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return M(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new os(this._values[t].property)),this._values[t].value=new ss(this._values[t].property,null===e?void 0:M(e))}getTransition(t){return M(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new os(this._values[t].property)),this._values[t].transition=M(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const i=this.getTransition(e);void 0!==i&&(t[`${e}-transition`]=i)}return t}transitioned(t,e){const n=new cs(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,e._values[i]);return n}untransitioned(){const t=new cs(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class ls{constructor(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),s=this.prior;if(s){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return s.possiblyEvaluate(t,e,n);{const o=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(t,e,n),r,h(o))}}return r}}class cs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const i=new ds(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class us{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return M(this._values[t].value)}setValue(t,e){this._values[t]=new ss(this._values[t].property,null===e?void 0:M(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const i=new ds(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}}class hs{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)}}class ds{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ps{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const i=rn[this.specification.type];return i?i(t,e,n):t}}class fs{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,i){return new hs(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new hs(this,{kind:"constant",value:void 0},t.parameters);const i=rn[this.specification.type];return i?new hs(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,i,r,s){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,s)}}class ms extends fs{possiblyEvaluate(t,e,n,i){if(void 0===t.value)return new hs(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i),s="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(s,s,s,e);return new hs(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new hs(this,{kind:"constant",value:n},e)}return new hs(this,t.expression,e)}evaluate(t,e,n,i,r,s){if("source"===t.kind){const o=t.evaluate(e,n,i,r,s);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class gs{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new rs(Math.floor(e.zoom-1),e)),t.expression.evaluate(new rs(Math.floor(e.zoom),e)),t.expression.evaluate(new rs(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class _s{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)}interpolate(){return!1}}class ys{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const i=this.defaultPropertyValues[e]=new ss(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new os(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}}function vs(t,e){return 256*(t=f(Math.floor(t),0,255))+f(Math.floor(e),0,255)}sr("DataDrivenProperty",fs),sr("DataConstantProperty",ps),sr("CrossFadedDataDrivenProperty",ms),sr("CrossFadedProperty",gs),sr("ColorRampProperty",_s);const xs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class bs{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ws{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Cs(t,e=1){let n=0,i=0;return{members:t.map(t=>{const r=xs[t.type].BYTES_PER_ELEMENT,s=n=Es(n,Math.max(e,r)),o=t.components||1;return i=Math.max(i,r),n+=r*o,{name:t.name,type:t.type,components:o,offset:s}}),size:Es(n,Math.max(i,e)),alignment:e}}function Es(t,e){return Math.ceil(t/e)*e}class Ss extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t}}Ss.prototype.bytesPerElement=4,sr("StructArrayLayout2i4",Ss);class Ts extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const s=4*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,t}}Ts.prototype.bytesPerElement=8,sr("StructArrayLayout4i8",Ts);class Ms extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,s,o)}emplace(t,e,n,i,r,s,o,a){const l=6*t,c=12*t,u=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[c+4]=i,this.uint8[c+5]=r,this.uint8[c+6]=s,this.uint8[c+7]=o,this.float32[u+2]=a,t}}Ms.prototype.bytesPerElement=12,sr("StructArrayLayout2i4ub1f12",Ms);class As extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t}}As.prototype.bytesPerElement=8,sr("StructArrayLayout2f8",As);class ks extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o,a,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,s,o,a,l,c)}emplace(t,e,n,i,r,s,o,a,l,c,u){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=s,this.uint16[h+5]=o,this.uint16[h+6]=a,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}ks.prototype.bytesPerElement=20,sr("StructArrayLayout10ui20",ks);class Ps extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,i,r,s,o,a,l,c,u,h)}emplace(t,e,n,i,r,s,o,a,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.uint16[p+4]=s,this.uint16[p+5]=o,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}Ps.prototype.bytesPerElement=24,sr("StructArrayLayout4i4ui4i24",Ps);class Is extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}Is.prototype.bytesPerElement=12,sr("StructArrayLayout3f12",Is);class Os extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Os.prototype.bytesPerElement=4,sr("StructArrayLayout1ul4",Os);class zs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o,a,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,s,o,a,l,c)}emplace(t,e,n,i,r,s,o,a,l,c,u){const h=16*t,d=8*t;return this.int16[h+0]=e,this.int16[h+1]=n,this.float32[d+1]=i,this.float32[d+2]=r,this.float32[d+3]=s,this.float32[d+4]=o,this.int16[h+10]=a,this.uint32[d+6]=l,this.uint16[h+14]=c,this.uint16[h+15]=u,t}}zs.prototype.bytesPerElement=32,sr("StructArrayLayout2i4f1i1ul2ui32",zs);class Ds extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r,s)}emplace(t,e,n,i,r,s,o){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,this.int16[a+4]=s,this.int16[a+5]=o,t}}Ds.prototype.bytesPerElement=12,sr("StructArrayLayout2i2i2i12",Ds);class Rs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r)}emplace(t,e,n,i,r,s){const o=4*t,a=8*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.int16[a+6]=r,this.int16[a+7]=s,t}}Rs.prototype.bytesPerElement=16,sr("StructArrayLayout2f1f2i16",Rs);class Ls extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const s=12*t,o=3*t;return this.uint8[s+0]=e,this.uint8[s+1]=n,this.float32[o+1]=i,this.float32[o+2]=r,t}}Ls.prototype.bytesPerElement=12,sr("StructArrayLayout2ub2f12",Ls);class Fs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t}}Fs.prototype.bytesPerElement=6,sr("StructArrayLayout3ui6",Fs);class Bs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g)}emplace(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_){const y=24*t,v=12*t,x=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=i,this.uint16[y+3]=r,this.uint32[v+2]=s,this.uint32[v+3]=o,this.uint32[v+4]=a,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[v+10]=g,this.int16[y+22]=_,t}}Bs.prototype.bytesPerElement=48,sr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Bs);class Ns extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,E,S,T,M){const A=this.length;return this.resize(A+1),this.emplace(A,t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,E,S,T,M)}emplace(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,E,S,T,M,A){const k=34*t,P=17*t;return this.int16[k+0]=e,this.int16[k+1]=n,this.int16[k+2]=i,this.int16[k+3]=r,this.int16[k+4]=s,this.int16[k+5]=o,this.int16[k+6]=a,this.int16[k+7]=l,this.uint16[k+8]=c,this.uint16[k+9]=u,this.uint16[k+10]=h,this.uint16[k+11]=d,this.uint16[k+12]=p,this.uint16[k+13]=f,this.uint16[k+14]=m,this.uint16[k+15]=g,this.uint16[k+16]=_,this.uint16[k+17]=y,this.uint16[k+18]=v,this.uint16[k+19]=x,this.uint16[k+20]=b,this.uint16[k+21]=w,this.uint16[k+22]=C,this.uint32[P+12]=E,this.float32[P+13]=S,this.float32[P+14]=T,this.float32[P+15]=M,this.float32[P+16]=A,t}}Ns.prototype.bytesPerElement=68,sr("StructArrayLayout8i15ui1ul4f68",Ns);class Vs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Vs.prototype.bytesPerElement=4,sr("StructArrayLayout1f4",Vs);class Us extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t}}Us.prototype.bytesPerElement=6,sr("StructArrayLayout3i6",Us);class js extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const s=6*t;return this.uint32[3*t+0]=e,this.uint16[s+2]=n,this.uint16[s+3]=i,this.uint16[s+4]=r,t}}js.prototype.bytesPerElement=12,sr("StructArrayLayout1ul3ui12",js);class qs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t}}qs.prototype.bytesPerElement=4,sr("StructArrayLayout2ui4",qs);class $s extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}$s.prototype.bytesPerElement=2,sr("StructArrayLayout1ui2",$s);class Gs extends ws{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const s=4*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=i,this.float32[s+3]=r,t}}Gs.prototype.bytesPerElement=16,sr("StructArrayLayout4f16",Gs);class Zs extends bs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.float32[this._pos4+1]}get y1(){return this._structArray.float32[this._pos4+2]}get x2(){return this._structArray.float32[this._pos4+3]}get y2(){return this._structArray.float32[this._pos4+4]}get padding(){return this._structArray.int16[this._pos2+10]}get featureIndex(){return this._structArray.uint32[this._pos4+6]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+14]}get bucketIndex(){return this._structArray.uint16[this._pos2+15]}get anchorPoint(){return new r(this.anchorPointX,this.anchorPointY)}}Zs.prototype.size=32;class Hs extends zs{get(t){return new Zs(this,t)}}sr("CollisionBoxArray",Hs);class Ws extends bs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ws.prototype.size=48;class Xs extends Bs{get(t){return new Ws(this,t)}}sr("PlacedSymbolArray",Xs);class Ks extends bs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ks.prototype.size=68;class Qs extends Ns{get(t){return new Ks(this,t)}}sr("SymbolInstanceArray",Qs);class Ys extends Vs{getoffsetX(t){return this.float32[1*t+0]}}sr("GlyphOffsetArray",Ys);class Js extends Us{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}sr("SymbolLineVertexArray",Js);class to extends bs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}to.prototype.size=12;class eo extends js{get(t){return new to(this,t)}}sr("FeatureIndexArray",eo);class no extends bs{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}no.prototype.size=4;class io extends qs{get(t){return new no(this,t)}}sr("FillExtrusionCentroidArray",io);const ro=Cs([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]);var so=le(function(t){t.exports=function(t,e){var n,i,r,s,o,a,l,c;for(i=t.length-(n=3&t.length),r=e,o=3432918353,a=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(s=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}}),oo=le(function(t){t.exports=function(t,e){for(var n,i=t.length,r=e^i,s=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(s)|(255&t.charCodeAt(++s))<<8|(255&t.charCodeAt(++s))<<16|(255&t.charCodeAt(++s))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++s;switch(i){case 3:r^=(255&t.charCodeAt(s+2))<<16;case 2:r^=(255&t.charCodeAt(s+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(s)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}}),ao=so,lo=oo;ao.murmur3=so,ao.murmur2=lo;class co{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,i){this.ids.push(uo(t)),this.positions.push(e,n,i)}getPositions(t){const e=uo(t);let n=0,i=this.ids.length-1;for(;n<i;){const t=n+i>>1;this.ids[t]>=e?i=t:n=t+1}const r=[];for(;this.ids[n]===e;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(t,e){const n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return ho(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){const e=new co;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function uo(t){const e=+t;return!isNaN(e)&&e<=a?e:ao(String(t))}function ho(t,e,n,i){for(;n<i;){const r=t[n+i>>1];let s=n-1,o=i+1;for(;;){do{s++}while(t[s]<r);do{o--}while(t[o]>r);if(s>=o)break;po(t,s,o),po(e,3*s,3*o),po(e,3*s+1,3*o+1),po(e,3*s+2,3*o+2)}o-n<i-o?(ho(t,e,n,o),n=o+1):(ho(t,e,o+1,i),i=o)}}function po(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}sr("FeaturePositionMap",co);class fo{constructor(t,e){this.gl=t.gl,this.location=e}}class mo extends fo{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class go extends fo{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class _o extends fo{constructor(t,e){super(t,e),this.current=ue.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const yo=new Float32Array(16),vo=new Float32Array(9);function xo(t){return[vs(255*t.r,255*t.g),vs(255*t.b,255*t.a)]}class bo{constructor(t,e,n){this.value=t,this.uniformNames=e.map(t=>`u_${t}`),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new _o(t,e):new mo(t,e)}}class wo{constructor(t,e){this.uniformNames=e.map(t=>`u_${t}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,n,i){const r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,n){return"u_pattern"===n.substr(0,9)?new go(t,e):new mo(t,e)}}class Co{constructor(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:`a_${t}`,type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,e,n,i,r){const s=this.paintVertexArray.length,o=this.expression.evaluate(new rs(0),e,{},i,[],r);this.paintVertexArray.resize(t),this._setPaintValue(s,t,o)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,e,r)}_setPaintValue(t,e,n){if("color"===this.type){const i=xo(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Eo{constructor(t,e,n,i,r,s){this.expression=t,this.uniformNames=e.map(t=>`u_${t}_t`),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:`a_${t}`,type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new s}populatePaintArray(t,e,n,i,r){const s=this.expression.evaluate(new rs(this.zoom),e,{},i,[],r),o=this.expression.evaluate(new rs(this.zoom+1),e,{},i,[],r),a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(a,t,s,o)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:this.zoom},n,i),s=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,e,r,s)}_setPaintValue(t,e,n,i){if("color"===this.type){const r=xo(n),s=xo(i);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],s[0],s[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=f(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,e,n){return new mo(t,e)}}class So{constructor(t,e,n,i,r,s,o){this.expression=t,this.type=n,this.useIntegerZoom=i,this.zoom=r,this.layerId=o;for(let a=0;a<e.length;++a);this.zoomInPaintVertexArray=new s,this.zoomOutPaintVertexArray=new s}populatePaintArray(t,e,n){const i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)}_setPaintValues(t,e,n,i){if(!i||!n)return;const{min:r,mid:s,max:o}=n,a=i[r],l=i[s],c=i[o];if(a&&l&&c)for(let u=t;u<e;u++)this.zoomInPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],l.pixelRatio,a.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ro.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ro.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class To{constructor(t,e,n=(()=>!0)){this.binders={},this._buffers=[];const i=[];for(const r in t.paint._values){if(!n(r))continue;const s=t.paint.get(r);if(!(s instanceof hs&&Kn(s.property.specification)))continue;const o=Ao(r,t.type),a=s.value,l=s.property.specification.type,c=s.property.useIntegerZoom,u=s.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===a.kind)this.binders[r]=h?new wo(a.value,o):new bo(a.value,o,l),i.push(`/u_${r}`);else if("source"===a.kind||h){const n=ko(r,l,"source");this.binders[r]=h?new So(a,o,l,c,e,n,t.id):new Co(a,o,l,n),i.push(`/a_${r}`)}else{const t=ko(r,l,"composite");this.binders[r]=new Eo(a,o,l,c,e,t),i.push(`/z_${r}`)}}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Co||e instanceof Eo?e.maxValue:0}populatePaintArrays(t,e,n,i,r){for(const s in this.binders){const o=this.binders[s];(o instanceof Co||o instanceof Eo||o instanceof So)&&o.populatePaintArray(t,e,n,i,r)}}setConstantPatternPositions(t,e){for(const n in this.binders){const i=this.binders[n];i instanceof wo&&i.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,i,r){let s=!1;for(const o in t){const a=e.getPositions(o);for(const e of a){const a=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof Co||l instanceof Eo||l instanceof So)&&!0===l.expression.isStateDependent){const c=i.paint.get(n);l.expression=c.value,l.updatePaintArray(e.start,e.end,a,t[o],r),s=!0}}}}return s}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof bo||n instanceof wo)&&t.push(...n.uniformNames.map(t=>`#define HAS_UNIFORM_${t}`))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Co||n instanceof Eo)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name);else if(n instanceof So)for(let e=0;e<ro.members.length;e++)t.push(ro.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof bo||n instanceof wo||n instanceof Eo)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof bo||r instanceof wo||r instanceof Eo)for(const s of r.uniformNames)if(e[s]){const o=r.getBinding(t,e[s],s);n.push({name:s,property:i,binding:o})}}return n}setUniforms(t,e,n,i){for(const{name:r,property:s,binding:o}of e)this.binders[s].setUniform(o,i,n.get(s),r)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof So){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof Co||n instanceof Eo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof Co||n instanceof Eo||n instanceof So)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Co||e instanceof Eo||e instanceof So)&&e.destroy()}}}class Mo{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new To(i,e,n);this.needsUpload=!1,this._featureMap=new co,this._bufferOffset=0}populatePaintArrays(t,e,n,i,r,s){for(const o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(t,e,i,r,s);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,i){for(const r of n)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Ao(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function ko(t,e,n){const i={color:{source:As,composite:Gs},number:{source:Vs,composite:As}},r=function(t){return{"line-pattern":{source:ks,composite:ks},"fill-pattern":{source:ks,composite:ks},"fill-extrusion-pattern":{source:ks,composite:ks}}[t]}(t);return r&&r[n]||i[e][n]}sr("ConstantBinder",bo),sr("CrossFadedConstantBinder",wo),sr("SourceExpressionBinder",Co),sr("CrossFadedCompositeBinder",So),sr("CompositeExpressionBinder",Eo),sr("ProgramConfiguration",To,{omit:["_buffers"]}),sr("ProgramConfigurationSet",Mo);const Po="-transition";class Io extends Ft{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new us(e.layout)),e.paint)){this._transitionablePaint=new as(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ds(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,n={}){null!=e&&this._validate(Yi,`layers.${this.id}.layout.${t}`,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return E(t,Po)?this._transitionablePaint.getTransition(t.slice(0,-Po.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,n={}){if(null!=e&&this._validate(Qi,`layers.${this.id}.paint.${t}`,t,e,n))return!1;if(E(t,Po))return this._transitionablePaint.setTransition(t.slice(0,-Po.length),e||void 0),!1;{const n=this._transitionablePaint._values[t],i="cross-faded-data-driven"===n.property.specification["property-type"],r=n.value.isDataDriven(),s=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const o=this._transitionablePaint._values[t].value;return o.isDataDriven()||r||i||this._handleOverridablePaintPropertyUpdate(t,s,o)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),T(t,(t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length))}_validate(t,e,n,i,r={}){return(!r||!1!==r.validate)&&Ji(this,t.call(Xi,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof hs&&Kn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Oo=Cs([{name:"a_pos",components:2,type:"Int16"}],4),{members:zo}=Oo;class Do{constructor(t=[]){this.segments=t}prepareSegment(t,e,n,i){let r=this.segments[this.segments.length-1];return t>Do.MAX_VERTEX_ARRAY_LENGTH&&k(`Max vertices per segment is ${Do.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!r||r.vertexLength+t>Do.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,i){return new Do([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}Do.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,sr("SegmentVector",Do);var Ro=8192;const Lo=Math.pow(2,14)-1,Fo=-Lo-1;function Bo(t){const e=Ro/t.extent,n=t.loadGeometry();for(let i=0;i<n.length;i++){const t=n[i];for(let n=0;n<t.length;n++){const i=t[n],r=Math.round(i.x*e),s=Math.round(i.y*e);i.x=f(r,Fo,Lo),i.y=f(s,Fo,Lo),(r<i.x||r>i.x+1||s<i.y||s>i.y+1)&&k("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function No(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Bo(t):[]}}function Vo(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}class Uo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ss,this.indexArray=new Fs,this.segments=new Do,this.programConfigurations=new Mo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){const i=this.layers[0],r=[];let s=null;"circle"===i.type&&(s=i.layout.get("circle-sort-key"));for(const{feature:o,id:a,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,e=No(o,t);if(!this.layers[0]._featureFilter.filter(new rs(this.zoom),e,n))continue;const i=s?s.evaluate(e,{},n):void 0,u={id:a,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:t?e.geometry:Bo(o),patterns:{},sortKey:i};r.push(u)}s&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const o of r){const{geometry:i,index:r,sourceLayerIndex:s}=o,a=t[r].feature;this.addFeature(o,i,r,n),e.featureIndex.insert(a,i,r,s,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i){for(const r of e)for(const e of r){const n=e.x,i=e.y;if(n<0||n>=Ro||i<0||i>=Ro)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),s=r.vertexLength;Vo(this.layoutVertexArray,n,i,-1,-1),Vo(this.layoutVertexArray,n,i,1,-1),Vo(this.layoutVertexArray,n,i,1,1),Vo(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+3,s+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)}}function jo(t,e){for(let n=0;n<t.length;n++)if(Qo(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Qo(t,e[n]))return!0;return!!Zo(t,e)}function qo(t,e,n){return!!Qo(t,e)||!!Wo(e,t,n)}function $o(t,e){if(1===t.length)return Ko(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++)if(Qo(t,i[e]))return!0}for(let n=0;n<t.length;n++)if(Ko(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Zo(t,e[n]))return!0;return!1}function Go(t,e,n){if(t.length>1){if(Zo(t,e))return!0;for(let i=0;i<e.length;i++)if(Wo(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(Wo(t[i],e,n))return!0;return!1}function Zo(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)if(Ho(i,r,e[t],e[t+1]))return!0}return!1}function Ho(t,e,n,i){return P(t,n,i)!==P(e,n,i)&&P(t,e,n)!==P(t,e,i)}function Wo(t,e,n){const i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(let r=1;r<e.length;r++)if(Xo(t,e[r-1],e[r])<i)return!0;return!1}function Xo(t,e,n){const i=e.distSqr(n);if(0===i)return t.distSqr(e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function Ko(t,e){let n,i,r,s=!1;for(let o=0;o<t.length;o++){n=t[o];for(let t=0,o=n.length-1;t<n.length;o=t++)i=n[t],r=n[o],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(s=!s)}return s}function Qo(t,e){let n=!1;for(let i=0,r=t.length-1;i<t.length;r=i++){const s=t[i],o=t[r];s.y>e.y!=o.y>e.y&&e.x<(o.x-s.x)*(e.y-s.y)/(o.y-s.y)+s.x&&(n=!n)}return n}function Yo(t,e,n,i,s){for(const r of t)if(e<=r.x&&n<=r.y&&i>=r.x&&s>=r.y)return!0;const o=[new r(e,n),new r(e,s),new r(i,s),new r(i,n)];if(t.length>2)for(const r of o)if(Qo(t,r))return!0;for(let r=0;r<t.length-1;r++)if(Jo(t[r],t[r+1],o))return!0;return!1}function Jo(t,e,n){const i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;const s=P(t,e,n[0]);return s!==P(t,e,n[1])||s!==P(t,e,n[2])||s!==P(t,e,n[3])}function ta(t,e,n){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function ea(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function na(t,e,n,i,s){if(!e[0]&&!e[1])return t;const o=r.convert(e)._mult(s);"viewport"===n&&o._rotate(-i);const a=[];for(let r=0;r<t.length;r++)a.push(t[r].sub(o));return a}function ia(t,e,n,i){const s=r.convert(t)._mult(i);return"viewport"===e&&s._rotate(-n),s}sr("CircleBucket",Uo,{omit:["layers"]});const ra=new ys({"circle-sort-key":new fs(Bt.layout_circle["circle-sort-key"])});var sa={paint:new ys({"circle-radius":new fs(Bt.paint_circle["circle-radius"]),"circle-color":new fs(Bt.paint_circle["circle-color"]),"circle-blur":new fs(Bt.paint_circle["circle-blur"]),"circle-opacity":new fs(Bt.paint_circle["circle-opacity"]),"circle-translate":new ps(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new ps(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ps(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ps(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fs(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fs(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fs(Bt.paint_circle["circle-stroke-opacity"])}),layout:ra},oa="undefined"!=typeof Float32Array?Float32Array:Array;function aa(){var t=new oa(9);return oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function la(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ca(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],y=e[15],v=n[0],x=n[1],b=n[2],w=n[3];return t[0]=v*i+x*a+b*h+w*m,t[1]=v*r+x*l+b*d+w*g,t[2]=v*s+x*c+b*p+w*_,t[3]=v*o+x*u+b*f+w*y,t[4]=(v=n[4])*i+(x=n[5])*a+(b=n[6])*h+(w=n[7])*m,t[5]=v*r+x*l+b*d+w*g,t[6]=v*s+x*c+b*p+w*_,t[7]=v*o+x*u+b*f+w*y,t[8]=(v=n[8])*i+(x=n[9])*a+(b=n[10])*h+(w=n[11])*m,t[9]=v*r+x*l+b*d+w*g,t[10]=v*s+x*c+b*p+w*_,t[11]=v*o+x*u+b*f+w*y,t[12]=(v=n[12])*i+(x=n[13])*a+(b=n[14])*h+(w=n[15])*m,t[13]=v*r+x*l+b*d+w*g,t[14]=v*s+x*c+b*p+w*_,t[15]=v*o+x*u+b*f+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ua=ca;function ha(){var t=new oa(3);return oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function da(t){return Math.hypot(t[0],t[1],t[2])}function pa(t,e,n){var i=new oa(3);return i[0]=t,i[1]=e,i[2]=n,i}function fa(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ma(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function ga(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function _a(t,e,n){var i=n[0],r=n[1],s=n[2],o=e[0],a=e[1],l=e[2],c=r*l-s*a,u=s*o-i*l,h=i*a-r*o,d=r*h-s*u,p=s*c-i*h,f=i*u-r*c,m=2*n[3];return u*=m,h*=m,p*=2,f*=2,t[0]=o+(c*=m)+(d*=2),t[1]=a+u+p,t[2]=l+h+f,t}var ya,va=fa,xa=da;function ba(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t}function wa(){var t=new oa(4);return oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ca(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ea(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*a,t[1]=r*l+s*a,t[2]=s*l-r*a,t[3]=o*l-i*a,t}function Sa(t,e,n){const i=ba([],[t.x,t.y,e,1],n);return new r(i[0]/i[3],i[1]/i[3])}ha(),ya=new oa(4),oa!=Float32Array&&(ya[0]=0,ya[1]=0,ya[2]=0,ya[3]=0),ha(),pa(1,0,0),pa(0,1,0),wa(),wa(),aa();const Ta=pa(0,0,0),Ma=pa(0,0,1);function Aa(t,e){const n=ha();return Ta[2]=e,t.intersectsPlane(Ta,Ma,n),new r(n[0],n[1])}class ka extends Uo{}function Pa(t,{width:e,height:n},i,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*n*i)throw new RangeError("mismatched image size")}else r=new Uint8Array(e*n*i);return t.width=e,t.height=n,t.data=r,t}function Ia(t,{width:e,height:n},i){if(e===t.width&&n===t.height)return;const r=Pa({},{width:e,height:n},i);Oa(t,r,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},i),t.width=e,t.height=n,t.data=r.data}function Oa(t,e,n,i,r,s){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=t.data,a=e.data;for(let l=0;l<r.height;l++){const c=((n.y+l)*t.width+n.x)*s,u=((i.y+l)*e.width+i.x)*s;for(let t=0;t<r.width*s;t++)a[u+t]=o[c+t]}return e}sr("HeatmapBucket",ka,{omit:["layers"]});class za{constructor(t,e){Pa(this,t,1,e)}resize(t){Ia(this,t,1)}clone(){return new za({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){Oa(t,e,n,i,r,1)}}class Da{constructor(t,e){Pa(this,t,4,e)}resize(t){Ia(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Da({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){Oa(t,e,n,i,r,4)}}sr("AlphaImage",za),sr("RGBAImage",Da);var Ra={paint:new ys({"heatmap-radius":new fs(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fs(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ps(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _s(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ps(Bt.paint_heatmap["heatmap-opacity"])})};function La(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new Da({width:n,height:i}),s=(n,i,s)=>{e[t.evaluationKey]=s;const o=t.expression.evaluate(e);r.data[n+i+0]=Math.floor(255*o.r/o.a),r.data[n+i+1]=Math.floor(255*o.g/o.a),r.data[n+i+2]=Math.floor(255*o.b/o.a),r.data[n+i+3]=Math.floor(255*o.a)};if(t.clips)for(let o=0,a=0;o<i;++o,a+=4*n)for(let e=0,i=0;e<n;e++,i+=4){const r=e/(n-1),{start:l,end:c}=t.clips[o];s(a,i,l*(1-r)+c*r)}else for(let o=0,a=0;o<n;o++,a+=4)s(0,a,o/(n-1));return r}var Fa={paint:new ys({"hillshade-illumination-direction":new ps(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ps(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ps(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ps(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ps(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ps(Bt.paint_hillshade["hillshade-accent-color"])})};const Ba=Cs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Na}=Ba;var Va=ja,Ua=ja;function ja(t,e,n){n=n||2;var i,r,s,o,a,l,c,u=e&&e.length,h=u?e[0]*n:t.length,d=qa(t,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(t,e,n,i){var r,s,o,a=[];for(r=0,s=e.length;r<s;r++)(o=qa(t,e[r]*i,r<s-1?e[r+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),a.push(tl(o));for(a.sort(Ka),r=0;r<a.length;r++)Qa(a[r],n),n=$a(n,n.next);return n}(t,e,d,n)),t.length>80*n){i=s=t[0],r=o=t[1];for(var f=n;f<h;f+=n)(a=t[f])<i&&(i=a),(l=t[f+1])<r&&(r=l),a>s&&(s=a),l>o&&(o=l);c=0!==(c=Math.max(s-i,o-r))?1/c:0}return Ga(d,p,n,i,r,c),p}function qa(t,e,n,i,r){var s,o;if(r===pl(t,e,n,i)>0)for(s=e;s<n;s+=i)o=ul(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=ul(s,t[s],t[s+1],o);return o&&rl(o,o.next)&&(hl(o),o=o.next),o}function $a(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!rl(i,i.next)&&0!==il(i.prev,i,i.next))i=i.next;else{if(hl(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Ga(t,e,n,i,r,s,o){if(t){!o&&s&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Ja(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(t,i,r,s);for(var a,l,c=t;t.prev!==t.next;)if(a=t.prev,l=t.next,s?Ha(t,i,r,s):Za(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),hl(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?Ga(t=Wa($a(t),e,n),e,n,i,r,s,2):2===o&&Xa(t,e,n,i,r,s):Ga($a(t),e,n,i,r,s,1);break}}}function Za(t){var e=t.prev,n=t,i=t.next;if(il(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(el(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&il(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ha(t,e,n,i){var r=t.prev,s=t,o=t.next;if(il(r,s,o)>=0)return!1;for(var a=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,c=Ja(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,n,i),u=Ja(a,l,e,n,i),h=t.prevZ,d=t.nextZ;h&&h.z>=c&&d&&d.z<=u;){if(h!==t.prev&&h!==t.next&&el(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&il(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&el(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&il(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&el(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&il(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==t.prev&&d!==t.next&&el(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&il(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Wa(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!rl(r,s)&&sl(r,i,i.next,s)&&ll(r,s)&&ll(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),hl(i),hl(i.next),i=t=s),i=i.next}while(i!==t);return $a(i)}function Xa(t,e,n,i,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&nl(o,a)){var l=cl(o,a);return o=$a(o,o.next),l=$a(l,l.next),Ga(o,e,n,i,r,s),void Ga(l,e,n,i,r,s)}a=a.next}o=o.next}while(o!==t)}function Ka(t,e){return t.x-e.x}function Qa(t,e){if(e=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var l,c=n,u=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&el(s<h?r:o,s,u,h,s<h?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),ll(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&Ya(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(t,e)){var n=cl(e,t);$a(e,e.next),$a(n,n.next)}}function Ya(t,e){return il(t.prev,t,e.prev)<0&&il(e.next,t,t.next)<0}function Ja(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function tl(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function el(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function nl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&sl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(ll(t,e)&&ll(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(il(t.prev,t,e.prev)||il(t,e.prev,e))||rl(t,e)&&il(t.prev,t,t.next)>0&&il(e.prev,e,e.next)>0)}function il(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function rl(t,e){return t.x===e.x&&t.y===e.y}function sl(t,e,n,i){var r=al(il(t,e,n)),s=al(il(t,e,i)),o=al(il(n,i,t)),a=al(il(n,i,e));return r!==s&&o!==a||!(0!==r||!ol(t,n,e))||!(0!==s||!ol(t,i,e))||!(0!==o||!ol(n,t,i))||!(0!==a||!ol(n,e,i))}function ol(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function al(t){return t>0?1:t<0?-1:0}function ll(t,e){return il(t.prev,t,t.next)<0?il(t,e,t.next)>=0&&il(t,t.prev,e)>=0:il(t,e,t.prev)<0||il(t,t.next,e)<0}function cl(t,e){var n=new dl(t.i,t.x,t.y),i=new dl(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function ul(t,e,n,i){var r=new dl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function hl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function dl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pl(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}function fl(t,e,n,i,r){ml(t,e,n||0,i||t.length-1,r||_l)}function ml(t,e,n,i,r){for(;i>n;){if(i-n>600){var s=i-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);ml(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(i,Math.floor(e+(s-o)*l/s+c)),r)}var u=t[e],h=n,d=i;for(gl(t,n,e),r(t[i],u)>0&&gl(t,n,i);h<d;){for(gl(t,h,d),h++,d--;r(t[h],u)<0;)h++;for(;r(t[d],u)>0;)d--}0===r(t[n],u)?gl(t,n,d):gl(t,++d,i),d<=e&&(n=d+1),e<=d&&(i=d-1)}}function gl(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function _l(t,e){return t<e?-1:t>e?1:0}function yl(t,e){const n=t.length;if(n<=1)return[t];const i=[];let r,s;for(let o=0;o<n;o++){const e=I(t[o]);0!==e&&(t[o].area=Math.abs(e),void 0===s&&(s=e<0),s===e<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}if(r&&i.push(r),e>1)for(let o=0;o<i.length;o++)i[o].length<=e||(fl(i[o],e,1,i[o].length-1,vl),i[o]=i[o].slice(0,e));return i}function vl(t,e){return e.area-t.area}function xl(t,e,n){const i=n.patternDependencies;let r=!1;for(const s of e){const e=s.paint.get(`${t}-pattern`);e.isConstant()||(r=!0);const n=e.constantOr(null);n&&(r=!0,i[n.to]=!0,i[n.from]=!0)}return r}function bl(t,e,n,i,r){const s=r.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:i-1},n,{},r.availableImages),a=e.evaluate({zoom:i},n,{},r.availableImages),l=e.evaluate({zoom:i+1},n,{},r.availableImages);t=t&&t.name?t.name:t,a=a&&a.name?a.name:a,l=l&&l.name?l.name:l,s[t]=!0,s[a]=!0,s[l]=!0,n.patterns[o.id]={min:t,mid:a,max:l}}}return n}ja.deviation=function(t,e,n,i){var r=e&&e.length,s=Math.abs(pl(t,0,r?e[0]*n:t.length,n));if(r)for(var o=0,a=e.length;o<a;o++)s-=Math.abs(pl(t,e[o]*n,o<a-1?e[o+1]*n:t.length,n));var l=0;for(o=0;o<i.length;o+=3){var c=i[o]*n,u=i[o+1]*n,h=i[o+2]*n;l+=Math.abs((t[c]-t[h])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[h+1]-t[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},ja.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&n.holes.push(i+=t[r-1].length)}return n},Va.default=Ua;class wl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ss,this.indexArray=new Fs,this.indexArray2=new qs,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new Do,this.segments2=new Do,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=xl("fill",this.layers,e);const i=this.layers[0].layout.get("fill-sort-key"),r=[];for(const{feature:s,id:o,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=No(s,t);if(!this.layers[0]._featureFilter.filter(new rs(this.zoom),c,n))continue;const u=i?i.evaluate(c,{},n,e.availableImages):void 0,h={id:o,properties:s.properties,type:s.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:Bo(s),patterns:{},sortKey:u};r.push(h)}i&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const s of r){const{geometry:i,index:r,sourceLayerIndex:o}=s;if(this.hasPattern){const t=bl("fill",this.layers,s,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(s,i,r,n,{});e.featureIndex.insert(t[r].feature,i,r,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Na),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,i,r){for(const s of yl(e,500)){let t=0;for(const a of s)t+=a.length;const e=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=e.vertexLength,i=[],r=[];for(const a of s){if(0===a.length)continue;a!==s[0]&&r.push(i.length/2);const t=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),e=t.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(e+a.length-1,e),i.push(a[0].x),i.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(e+n-1,e+n),i.push(a[n].x),i.push(a[n].y);t.vertexLength+=a.length,t.primitiveLength+=a.length}const o=Va(i,r);for(let s=0;s<o.length;s+=3)this.indexArray.emplaceBack(n+o[s],n+o[s+1],n+o[s+2]);e.vertexLength+=t,e.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}}sr("FillBucket",wl,{omit:["layers","patternFeatures"]});const Cl=new ys({"fill-sort-key":new fs(Bt.layout_fill["fill-sort-key"])});var El={paint:new ys({"fill-antialias":new ps(Bt.paint_fill["fill-antialias"]),"fill-opacity":new fs(Bt.paint_fill["fill-opacity"]),"fill-color":new fs(Bt.paint_fill["fill-color"]),"fill-outline-color":new fs(Bt.paint_fill["fill-outline-color"]),"fill-translate":new ps(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new ps(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ms(Bt.paint_fill["fill-pattern"])}),layout:Cl};const Sl=Cs([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Tl=Cs([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Ml}=Sl;var Al=kl;function kl(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(Pl,this,e)}function Pl(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Il(t){for(var e,n,i=0,r=0,s=t.length,o=s-1;r<s;o=r++)i+=((n=t[o]).x-(e=t[r]).x)*(e.y+n.y);return i}kl.types=["Unknown","Point","LineString","Polygon"],kl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,s=0,o=0,a=0,l=[];t.pos<n;){if(s<=0){var c=t.readVarint();i=7&c,s=c>>3}if(s--,1===i||2===i)o+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new r(o,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},kl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,s=0,o=1/0,a=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<o&&(o=r),r>a&&(a=r),(s+=t.readSVarint())<l&&(l=s),s>c&&(c=s);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,a,c]},kl.prototype.toGeoJSON=function(t,e,n){var i,r,s=this.extent*Math.pow(2,n),o=this.extent*t,a=this.extent*e,l=this.loadGeometry(),c=kl.types[this.type];function u(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+o)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],s=0;s<e;s++){var o=Il(t[s]);0!==o&&(void 0===i&&(i=o<0),i===o<0?(n&&r.push(n),n=[t[s]]):n.push(t[s]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Ol=zl;function zl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Dl,this,e),this.length=this._features.length}function Dl(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function Rl(t,e,n){if(3===t){var i=new Ol(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}zl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Al(this._pbf,e,this.extent,this._keys,this._values)};var Ll={VectorTile:function(t,e){this.layers=t.readFields(Rl,{},e)},VectorTileFeature:Al,VectorTileLayer:Ol};const Fl=Ll.VectorTileFeature.types,Bl=Math.pow(2,13);function Nl(t,e,n,i,r,s,o,a){t.emplaceBack((e<<1)+o,(n<<1)+s,(Math.floor(i*Bl)<<1)+r,Math.round(a))}class Vl{constructor(){this.acc=new r(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new r(t.x,t.y),this.max=new r(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);let n=!!this.borders;const i=this.min,r=this.max;t.x<i.x?(i.x=t.x,n=!0):t.x>r.x&&(r.x=t.x,n=!0),t.y<i.y?(i.y=t.y,n=!0):t.y>r.y&&(r.y=t.y,n=!0),((0===t.x||t.x===Ro)&&t.x===e.x)!=((0===t.y||t.y===Ro)&&t.y===e.y)&&this.processBorderOverlap(t,e),n&&this.checkBorderIntersection(t,e)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,nn(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Ro!=t.x>Ro&&this.addBorderIntersection(1,nn(e.y,t.y,(Ro-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,nn(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Ro!=t.y>Ro&&this.addBorderIntersection(3,nn(e.x,t.x,(Ro-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){const t=this.polyCount.reduce((t,e)=>t+e.edges,0);return 0!==t?this.acc.div(t)._round():new r(0,0)}span(){return new r(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,e)=>t+ +(e[0]!==Number.MAX_VALUE),0)}}class Ul{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ts,this.centroidVertexArray=new io,this.indexArray=new Fs,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new Do,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.enableTerrain=t.enableTerrain}populate(t,e,n){this.features=[],this.hasPattern=xl("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Ro/(1<<t.z)}(n);for(const{feature:i,id:r,index:s,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,a=No(i,t);if(!this.layers[0]._featureFilter.filter(new rs(this.zoom),a,n))continue;const l={id:r,sourceLayerIndex:o,index:s,geometry:t?a.geometry:Bo(i),properties:i.properties,type:i.type,patterns:{}},c=this.layoutVertexArray.length;this.hasPattern?this.features.push(bl("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,s,n,{}),e.featureIndex.insert(i,l.geometry,s,o,this.index,c)}this.sortBorders()}addFeatures(t,e,n){for(const i of this.features){const{geometry:t}=i;this.addFeature(i,t,i.index,e,n)}this.sortBorders()}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ml),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Tl.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i,r){const s=this.enableTerrain&&t.properties&&"Polygon"===Fl[t.type]?new Vl:null;for(const a of yl(e,500)){let e=0,n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===a.length||(o=a[0]).every(t=>t.x<=0)||o.every(t=>t.x>=Ro)||o.every(t=>t.y<=0)||o.every(t=>t.y>=Ro))continue;for(let t=0;t<a.length;t++){const i=a[t];if(0===i.length)continue;e+=i.length;let r=0;s&&s.startRing(i[0]);for(let t=0;t<i.length;t++){const e=i[t];if(t>=1){const o=i[t-1];if(!jl(e,o)){s&&s.append(e,o),n.vertexLength+4>Do.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=e.sub(o)._perp(),i=t.x/(Math.abs(t.x)+Math.abs(t.y)),a=t.y>0?1:0,l=o.dist(e);r+l>32768&&(r=0),Nl(this.layoutVertexArray,e.x,e.y,i,a,0,0,r),Nl(this.layoutVertexArray,e.x,e.y,i,a,0,1,r),r+=l,Nl(this.layoutVertexArray,o.x,o.y,i,a,0,0,r),Nl(this.layoutVertexArray,o.x,o.y,i,a,0,1,r);const c=n.vertexLength;this.indexArray.emplaceBack(c,c+2,c+1),this.indexArray.emplaceBack(c+1,c+2,c+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+e>Do.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==Fl[t.type])continue;const i=[],r=[],l=n.vertexLength;for(let t=0;t<a.length;t++){const e=a[t];if(0!==e.length){e!==a[0]&&r.push(i.length/2);for(let t=0;t<e.length;t++){const n=e[t];Nl(this.layoutVertexArray,n.x,n.y,0,0,1,1,0),i.push(n.x),i.push(n.y),s&&s.currentPolyCount.top++}}}const c=Va(i,r);for(let t=0;t<c.length;t+=3)this.indexArray.emplaceBack(l+c[t],l+c[t+2],l+c[t+1]);n.primitiveLength+=c.length/3,n.vertexLength+=e}var o;if(s&&s.polyCount.length>0){if(s.borders){s.vertexArrayOffset=this.centroidVertexArray.length;const t=s.borders,e=this.featuresOnBorder.push(s)-1;for(let n=0;n<4;n++)t[n][0]!==Number.MAX_VALUE&&this.borders[n].push(e)}this.encodeCentroid(s.borders?void 0:s.centroid(),s)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0])}encodeCentroid(t,e,n=!0){let i,r;if(t)if(0!==t.y){const n=e.span()._mult(this.tileToMeter);i=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(n.x/10)),r=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(n.y/10))}else i=Math.ceil(7.3*t.x),r=0;else i=0,r=+n;let s=n?this.centroidVertexArray.length:e.vertexArrayOffset;for(const o of e.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*o.edges+o.top);for(let t=0;t<2*o.edges;t++)this.centroidVertexArray.emplace(s++,0,r),this.centroidVertexArray.emplace(s++,i,r);for(let t=0;t<o.top;t++)this.centroidVertexArray.emplace(s++,i,r)}}}function jl(t,e){return t.x===e.x&&(t.x<0||t.x>Ro)||t.y===e.y&&(t.y<0||t.y>Ro)}sr("FillExtrusionBucket",Ul,{omit:["layers","features"]}),sr("PartMetadata",Vl);var ql={paint:new ys({"fill-extrusion-opacity":new ps(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fs(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ps(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ps(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ms(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new fs(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fs(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ps(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function $l(t,e){return t.x*e.x+t.y*e.y}function Gl(t,e){if(1===t.length){let n=0;const i=e[n++];let r;for(;!r||i.equals(r);)if(r=e[n++],!r)return 1/0;for(;n<e.length;n++){const s=e[n],o=t[0],a=r.sub(i),l=s.sub(i),c=o.sub(i),u=$l(a,a),h=$l(a,l),d=$l(l,l),p=$l(c,a),f=$l(c,l),m=u*d-h*h,g=(d*p-h*f)/m,_=(u*f-h*p)/m,y=i.z*(1-g-_)+r.z*g+s.z*_;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function Zl(t){const e=new r(t[0],t[1]);return e.z=t[2],e}function Hl(t,e,n,i,r,s,o,a){const l=o*r.getElevationAt(t,e,!0,!0),c=0!==s[0],u=c?0===s[1]?o*(s[0]/7.3):o*function(t,e,n){const i=Math.floor(e[0]/8),r=Math.floor(e[1]/8),s=10*(e[0]-8*i),o=10*(e[1]-8*r),a=t.getElevationAt(i,r,!0,!0),l=t.getMeterToDEM(n),c=Math.floor(.5*(s*l-1)),u=Math.floor(.5*(o*l-1)),h=t.tileCoordToPixel(i,r),d=2*c+1,p=2*u+1,f=function(t,e,n,i,r){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+r,n,!0),t.getElevationAtPixel(e,n+r,!0),t.getElevationAtPixel(e+i,n+r,!0)]}(t,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),_=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),y=Math.min(.25,.5*l*(m+g)/d),v=Math.min(.25,.5*l*_/p);return a+Math.max(y*s,v*o)}(r,s,a):l;return{base:l+(0===n)?-1:n,top:c?Math.max(u+i,l+n+2):l+i}}const Wl=Cs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Xl}=Wl,Kl=Cs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ql}=Kl,Yl=Ll.VectorTileFeature.types,Jl=Math.cos(Math.PI/180*37.5);class tc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Ms,this.layoutVertexArray2=new As,this.indexArray=new Fs,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new Do,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=xl("line",this.layers,e);const i=this.layers[0].layout.get("line-sort-key"),r=[];for(const{feature:s,id:o,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,e=No(s,t);if(!this.layers[0]._featureFilter.filter(new rs(this.zoom),e,n))continue;const c=i?i.evaluate(e,{},n):void 0,u={id:o,properties:s.properties,type:s.type,sourceLayerIndex:l,index:a,geometry:t?e.geometry:Bo(s),patterns:{},sortKey:c};r.push(u)}i&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const s of r){const{geometry:i,index:r,sourceLayerIndex:o}=s;if(this.hasPattern){const t=bl("line",this.layers,s,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(s,i,r,n,{});e.featureIndex.insert(t[r].feature,i,r,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ql)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,i,r){const s=this.layers[0].layout,o=s.get("line-join").evaluate(t,{}),a=s.get("line-cap"),l=s.get("line-miter-limit"),c=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const u of e)this.addLine(u,t,o,a,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}addLine(t,e,n,i,r,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Yl[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(o?3:2))return;"bevel"===n&&(r=1.05);const c=this.overscaling<=16?122880/(512*this.overscaling):0,u=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,d,p,f,m;this.e1=this.e2=-1,o&&(h=t[a-2],m=t[l].sub(h)._unit()._perp());for(let g=l;g<a;g++){if(p=g===a-1?o?t[l+1]:void 0:t[g+1],p&&t[g].equals(p))continue;m&&(f=m),h&&(d=h),h=t[g],m=p?p.sub(h)._unit()._perp():f,f=f||m;let e=f.add(m);0===e.x&&0===e.y||e._unit();const _=f.x*m.x+f.y*m.y,y=e.x*m.x+e.y*m.y,v=0!==y?1/y:1/0,x=2*Math.sqrt(2-2*y),b=y<Jl&&d&&p,w=f.x*m.y-f.y*m.x>0;if(b&&g>l){const t=h.dist(d);if(t>2*c){const e=h.sub(h.sub(d)._mult(c/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,f,0,0,u),d=e}}const C=d&&p;let E=C?n:o?"butt":i;if(C&&"round"===E&&(v<s?E="miter":v<=2&&(E="fakeround")),"miter"===E&&v>r&&(E="bevel"),"bevel"===E&&(v>2&&(E="flipbevel"),v<r&&(E="miter")),d&&this.updateDistance(d,h),"miter"===E)e._mult(v),this.addCurrentVertex(h,e,0,0,u);else if("flipbevel"===E){if(v>100)e=m.mult(-1);else{const t=v*f.add(m).mag()/f.sub(m).mag();e._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,e,0,0,u),this.addCurrentVertex(h,e.mult(-1),0,0,u)}else if("bevel"===E||"fakeround"===E){const t=-Math.sqrt(v*v-1),e=w?t:0,n=w?0:t;if(d&&this.addCurrentVertex(h,f,e,n,u),"fakeround"===E){const t=Math.round(180*x/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*t*t+(.848013+_*(.215638*_-1.06021)))}const i=m.sub(f)._mult(n)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,i.x,i.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,m,-e,-n,u)}else if("butt"===E)this.addCurrentVertex(h,e,0,0,u);else if("square"===E){const t=d?1:-1;this.addCurrentVertex(h,e,t,t,u)}else"round"===E&&(d&&(this.addCurrentVertex(h,f,0,0,u),this.addCurrentVertex(h,f,1,1,u,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,u,!0),this.addCurrentVertex(h,m,0,0,u)));if(b&&g<a-1){const t=h.dist(p);if(t>2*c){const e=h.add(p.sub(h)._mult(c/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,m,0,0,u),h=e}}}}addCurrentVertex(t,e,n,i,r,s=!1){const o=e.y*i-e.x,a=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,s,!1,n,r),this.addHalfVertex(t,o,a,s,!0,-i,r)}addHalfVertex({x:t,y:e},n,i,r,s,o,a){this.layoutVertexArray.emplaceBack((t<<1)+(r?1:0),(e<<1)+(s?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===o?0:o<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length);const l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),s?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}sr("LineBucket",tc,{omit:["layers","patternFeatures"]});const ec=new ys({"line-cap":new ps(Bt.layout_line["line-cap"]),"line-join":new fs(Bt.layout_line["line-join"]),"line-miter-limit":new ps(Bt.layout_line["line-miter-limit"]),"line-round-limit":new ps(Bt.layout_line["line-round-limit"]),"line-sort-key":new fs(Bt.layout_line["line-sort-key"])});var nc={paint:new ys({"line-opacity":new fs(Bt.paint_line["line-opacity"]),"line-color":new fs(Bt.paint_line["line-color"]),"line-translate":new ps(Bt.paint_line["line-translate"]),"line-translate-anchor":new ps(Bt.paint_line["line-translate-anchor"]),"line-width":new fs(Bt.paint_line["line-width"]),"line-gap-width":new fs(Bt.paint_line["line-gap-width"]),"line-offset":new fs(Bt.paint_line["line-offset"]),"line-blur":new fs(Bt.paint_line["line-blur"]),"line-dasharray":new gs(Bt.paint_line["line-dasharray"]),"line-pattern":new ms(Bt.paint_line["line-pattern"]),"line-gradient":new _s(Bt.paint_line["line-gradient"])}),layout:ec};const ic=new class extends fs{possiblyEvaluate(t,e){return e=new rs(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=y({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}(nc.paint.properties["line-width"].specification);function rc(t,e){return e>0?e+2*t:t}ic.useIntegerZoom=!0;const sc=Cs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),oc=Cs([{name:"a_projected_pos",components:3,type:"Float32"}],4);Cs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ac=Cs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),lc=Cs([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Cs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cc=Cs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uc=Cs([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Cs([{name:"triangle",components:3,type:"Uint16"}]),Cs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Cs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Cs([{type:"Float32",name:"offsetX"}]),Cs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var hc=24;const dc=128;function pc(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new rs(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=n;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let s=r;for(;s<e.length&&e[s]<t+1;)s++;s=Math.min(e.length-1,s);const o=e[r],a=e[s];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:a,interpolationType:i}:{kind:"camera",minZoom:o,maxZoom:a,minSize:n.evaluate(new rs(o)),maxSize:n.evaluate(new rs(a)),interpolationType:i}}}function fc(t,{uSize:e,uSizeT:n},{lowerSize:i,upperSize:r}){return"source"===t.kind?i/dc:"composite"===t.kind?nn(i/dc,r/dc,n):e}function mc(t,e){let n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:s,maxZoom:o}=t,a=r?f(wn.interpolationFactor(r,e,s,o),0,1):0;"camera"===t.kind?i=nn(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:i}}var gc=Object.freeze({__proto__:null,getSizeData:pc,evaluateSizeForFeature:fc,evaluateSizeForZoom:mc,SIZE_PACK_FACTOR:dc});function _c(t,e,n){return t.sections.forEach(t=>{t.text=function(t,e,n){const i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),is.applyArabicShaping&&(t=is.applyArabicShaping(t)),t}(t.text,e,n)}),t}const yc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var vc=function(t,e,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=t[e+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+t[e+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=c}return(p?-1:1)*o*Math.pow(2,s-i)},xc=function(t,e,n,i,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*l-1)*Math.pow(2,r),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[n+p]=255&o,p+=f,o/=256,c-=8);t[n+p-f]|=128*m},bc=wc;function wc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}wc.Varint=0,wc.Fixed64=1,wc.Bytes=2,wc.Fixed32=5;var Cc=4294967296,Ec=1/Cc,Sc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Tc(t){return t.type===wc.Bytes?t.readVarint()+t.pos:t.pos+1}function Mc(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Ac(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function kc(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Pc(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Ic(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Oc(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function zc(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Dc(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Rc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Lc(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Fc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Bc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Nc(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Vc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Uc(t,e,n){1===t&&n.readMessage(jc,e)}function jc(t,e,n){if(3===t){const{id:t,bitmap:i,width:r,height:s,left:o,top:a,advance:l}=n.readMessage(qc,{});e.push({id:t,bitmap:new za({width:r+6,height:s+6},i),metrics:{width:r,height:s,left:o,top:a,advance:l}})}}function qc(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function $c(t){let e=0,n=0;for(const o of t)e+=o.w*o.h,n=Math.max(n,o.w);t.sort((t,e)=>e.h-t.h);const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let r=0,s=0;for(const o of t)for(let t=i.length-1;t>=0;t--){const e=i[t];if(!(o.w>e.w||o.h>e.h)){if(o.x=e.x,o.y=e.y,s=Math.max(s,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===e.w&&o.h===e.h){const e=i.pop();t<i.length&&(i[t]=e)}else o.h===e.h?(e.x+=o.w,e.w-=o.w):o.w===e.w?(e.y+=o.h,e.h-=o.h):(i.push({x:e.x+o.w,y:e.y,w:e.w-o.w,h:o.h}),e.y+=o.h,e.h-=o.h);break}}return{w:r,h:s,fill:e/(r*s)||0}}wc.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=7&i,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Bc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Vc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Bc(this.buf,this.pos)+Bc(this.buf,this.pos+4)*Cc;return this.pos+=8,t},readSFixed64:function(){var t=Bc(this.buf,this.pos)+Vc(this.buf,this.pos+4)*Cc;return this.pos+=8,t},readFloat:function(){var t=vc(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=vc(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,s=n.buf;if(i=(112&(r=s[n.pos++]))>>4,r<128)return Mc(t,i,e);if(i|=(127&(r=s[n.pos++]))<<3,r<128)return Mc(t,i,e);if(i|=(127&(r=s[n.pos++]))<<10,r<128)return Mc(t,i,e);if(i|=(127&(r=s[n.pos++]))<<17,r<128)return Mc(t,i,e);if(i|=(127&(r=s[n.pos++]))<<24,r<128)return Mc(t,i,e);if(i|=(1&(r=s[n.pos++]))<<31,r<128)return Mc(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Sc?function(t,e,n){return Sc.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var s,o,a,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(s=t[r+1]))&&(c=(31&l)<<6|63&s)<=127&&(c=null):3===u?(o=t[r+2],128==(192&(s=t[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=t[r+2],a=t[r+3],128==(192&(s=t[r+1]))&&128==(192&o)&&128==(192&a)&&((c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==wc.Bytes)return t.push(this.readVarint(e));var n=Tc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==wc.Bytes)return t.push(this.readSVarint());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==wc.Bytes)return t.push(this.readBoolean());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==wc.Bytes)return t.push(this.readFloat());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==wc.Bytes)return t.push(this.readDouble());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==wc.Bytes)return t.push(this.readFixed32());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==wc.Bytes)return t.push(this.readSFixed32());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==wc.Bytes)return t.push(this.readFixed64());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==wc.Bytes)return t.push(this.readSFixed64());var e=Tc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===wc.Varint)for(;this.buf[this.pos++]>127;);else if(e===wc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===wc.Fixed32)this.pos+=4;else{if(e!==wc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Nc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Nc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Nc(this.buf,-1&t,this.pos),Nc(this.buf,Math.floor(t*Ec),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Nc(this.buf,-1&t,this.pos),Nc(this.buf,Math.floor(t*Ec),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,s=0;s<e.length;s++){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){i>56319||s+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Ac(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),xc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&Ac(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,wc.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,kc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Pc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,zc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Ic,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Oc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Dc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Rc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Lc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Fc,e)},writeBytesField:function(t,e){this.writeTag(t,wc.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,wc.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,wc.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,wc.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,wc.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,wc.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,wc.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,wc.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,wc.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,wc.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Gc{constructor(t,{pixelRatio:e,version:n,stretchX:i,stretchY:r,content:s}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=i,this.stretchY=r,this.content=s,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Zc{constructor(t,e){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,n,r),this.addImages(e,i,r);const{w:s,h:o}=$c(r),a=new Da({width:s||1,height:o||1});for(const l in t){const e=t[l],i=n[l].paddedRect;Da.copy(e.data,a,{x:0,y:0},{x:i.x+1,y:i.y+1},e.data)}for(const l in e){const t=e[l],n=i[l].paddedRect,r=n.x+1,s=n.y+1,o=t.data.width,c=t.data.height;Da.copy(t.data,a,{x:0,y:0},{x:r,y:s},t.data),Da.copy(t.data,a,{x:0,y:c-1},{x:r,y:s-1},{width:o,height:1}),Da.copy(t.data,a,{x:0,y:0},{x:r,y:s+c},{width:o,height:1}),Da.copy(t.data,a,{x:o-1,y:0},{x:r-1,y:s},{width:1,height:c}),Da.copy(t.data,a,{x:0,y:0},{x:r+o,y:s},{width:1,height:c})}this.image=a,this.iconPositions=n,this.patternPositions=i}addImages(t,e,n){for(const i in t){const r=t[i],s={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(s),e[i]=new Gc(s,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,r]=t.tl;n.update(e.data,void 0,{x:i,y:r})}}sr("ImagePosition",Gc),sr("ImageAtlas",Zc);const Hc={horizontal:1,vertical:2,horizontalOnly:3},Wc=-17;class Xc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new Xc;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new Xc;return e.imageName=t,e}}class Kc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new Kc;for(let i=0;i<t.sections.length;i++){const r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&jr(i)&&!yc[t[n+1]]||r&&jr(r)&&!yc[t[n-1]]||!yc[t[n]]?t[n]:yc[t[n]]}return e}(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&Yc[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&Yc[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new Kc;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,e)=>Math.max(t,this.sections[e].scale),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Xc.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let i=0;i<t.text.length;++i)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void k("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Xc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Qc(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const g=Kc.fromFeature(t,r);let _;h===Hc.vertical&&g.verticalizePunctuation();const{processBidirectionalText:y,processStyledBidirectionalText:v}=is;if(y&&1===g.sections.length){_=[];const t=y(g.toString(),su(g,c,s,e,i,p,f));for(const e of t){const t=new Kc;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);_.push(t)}}else if(v){_=[];const t=v(g.text,g.sectionIndex,su(g,c,s,e,i,p,f));for(const e of t){const t=new Kc;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,_.push(t)}}else _=function(t,e){const n=[],i=t.text;let r=0;for(const s of e)n.push(t.substring(r,s)),r=s;return r<i.length&&n.push(t.substring(r,i.length)),n}(g,su(g,c,s,e,i,p,f));const x=[],b={positionedLines:x,text:g.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,n,i,r,s,o,a,l,c,u,h){let d=0,p=Wc,f=0,m=0;const g="right"===a?1:"left"===a?0:.5;let _=0;for(const w of r){w.trim();const r=w.getMaxScale(),o=(r-1)*hc,a={positionedGlyphs:[],lineOffset:0};t.positionedLines[_]=a;const v=a.positionedGlyphs;let x=0;if(!w.length()){p+=s,++_;continue}for(let s=0;s<w.length();s++){const a=w.getSection(s),f=w.getSectionIndex(s),m=w.getCharCode(s);let g=0,_=null,b=null,C=null,E=hc;const S=!(l===Hc.horizontal||!u&&!Ur(m)||u&&(Yc[m]||(y=m,hr(y)||dr(y)||pr(y)||Or(y)||Lr(y))));if(a.imageName){const e=i[a.imageName];if(!e)continue;C=a.imageName,t.iconsInText=t.iconsInText||!0,b=e.paddedRect;const n=e.displaySize;a.scale=a.scale*hc/h,_={width:n[0],height:n[1],left:1,top:-3,advance:S?n[1]:n[0],localGlyph:!1},g=o+(hc-n[1]*a.scale),E=_.advance;const s=S?n[0]*a.scale-hc*r:n[1]*a.scale-hc*r;s>0&&s>x&&(x=s)}else{const t=n[a.fontStack],i=t&&t[m];if(i&&i.rect)b=i.rect,_=i.metrics;else{const t=e[a.fontStack],n=t&&t[m];if(!n)continue;_=n.metrics}g=(r-a.scale)*hc}S?(t.verticalizable=!0,v.push({glyph:m,imageName:C,x:d,y:p+g,vertical:S,scale:a.scale,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:b}),d+=E*a.scale+c):(v.push({glyph:m,imageName:C,x:d,y:p+g,vertical:S,scale:a.scale,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:b}),d+=_.advance*a.scale+c)}0!==v.length&&(f=Math.max(d-c,f),au(v,0,v.length-1,g,x)),d=0;const b=s*r+x;a.lineOffset=Math.max(x,o),p+=b,m=Math.max(b,m),++_}var y;const v=p-Wc,{horizontalAlign:x,verticalAlign:b}=ou(o);(function(t,e,n,i,r,s,o,a,l){const c=(e-n)*r;let u=0;u=s!==o?-a*i-Wc:(-i*l+.5)*o;for(const h of t)for(const t of h.positionedGlyphs)t.x+=c,t.y+=u})(t.positionedLines,g,x,b,f,m,s,v,r.length),t.top+=-b*v,t.bottom=t.top+v,t.left+=-x*f,t.right=t.left+f}(b,e,n,i,_,o,a,l,h,c,d,m),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(x)&&b}const Yc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Jc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tu(t,e,n,i,r,s){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*hc/s+r:0}{const i=n[e.fontStack],s=i&&i[t];return s?s.metrics.advance*e.scale+r:0}}function eu(t,e,n,i){const r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function nu(t,e,n){let i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function iu(t,e,n,i,r,s){let o=null,a=eu(e,n,r,s);for(const l of i){const t=eu(e-l.x,n,r,s)+l.badness;t<=a&&(o=l,a=t)}return{index:t,x:e,priorBreak:o,badness:a}}function ru(t){return t?ru(t.priorBreak).concat(t.index):[]}function su(t,e,n,i,r,s,o){if("point"!==s)return[];if(!t)return[];const a=[],l=function(t,e,n,i,r,s){let o=0;for(let a=0;a<t.length();a++){const n=t.getSection(a);o+=tu(t.getCharCode(a),n,i,r,e,s)}return o/Math.max(1,Math.ceil(o/n))}(t,e,n,i,r,o),c=t.text.indexOf("\u200b")>=0;let u=0;for(let d=0;d<t.length();d++){const n=t.getSection(d),s=t.getCharCode(d);if(Yc[s]||(u+=tu(s,n,i,r,e,o)),d<t.length()-1){const e=!((h=s)<11904||!(br(h)||xr(h)||Dr(h)||Ir(h)||Sr(h)||fr(h)||wr(h)||_r(h)||Tr(h)||Mr(h)||Er(h)||Fr(h)||yr(h)||gr(h)||mr(h)||Cr(h)||vr(h)||zr(h)||kr(h)||Ar(h)));(Jc[s]||e||n.imageName)&&a.push(iu(d+1,u,l,a,nu(s,t.getCharCode(d+1),e&&c),!1))}}var h;return ru(iu(t.length(),u,l,a,0,!0))}function ou(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function au(t,e,n,i,r){if(!i&&!r)return;const s=t[n],o=(t[n].x+s.metrics.advance*s.scale)*i;for(let a=e;a<=n;a++)t[a].x-=o,t[a].y+=r}function lu(t,e,n){const{horizontalAlign:i,verticalAlign:r}=ou(n),s=e[0]-t.displaySize[0]*i,o=e[1]-t.displaySize[1]*r;return{image:t,top:o,bottom:o+t.displaySize[1],left:s,right:s+t.displaySize[0]}}function cu(t,e,n,i,r,s){const o=t.image;let a;if(o.content){const t=o.content,e=o.pixelRatio||1;a=[t[0]/e,t[1]/e,o.displaySize[0]-t[2]/e,o.displaySize[1]-t[3]/e]}const l=e.left*s,c=e.right*s;let u,h,d,p;"width"===n||"both"===n?(p=r[0]+l-i[3],h=r[0]+c+i[1]):(p=r[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const f=e.top*s,m=e.bottom*s;return"height"===n||"both"===n?(u=r[1]+f-i[0],d=r[1]+m+i[2]):(u=r[1]+(f+m-o.displaySize[1])/2,d=u+o.displaySize[1]),{image:o,top:u,right:h,bottom:d,left:p,collisionPadding:a}}class uu extends r{constructor(t,e,n,i){super(t,e),this.angle=n,void 0!==i&&(this.segment=i)}clone(){return new uu(this.x,this.y,this.angle,this.segment)}}function hu(t,e,n,i,r){if(void 0===e.segment)return!0;let s=e,o=e.segment+1,a=0;for(;a>-n/2;){if(o--,o<0)return!1;a-=t[o].dist(s),s=t[o]}a+=t[o].dist(t[o+1]),o++;const l=[];let c=0;for(;a<n/2;){const e=t[o],n=t[o+1];if(!n)return!1;let s=t[o-1].angleTo(e)-e.angleTo(n);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:s}),c+=s;a-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;o++,a+=e.dist(n)}return!0}function du(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function pu(t,e,n){return t?.6*e*n:0}function fu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function mu(t,e,n,i,r,s){const o=pu(n,r,s),a=fu(n,i)*s;let l=0;const c=du(t)/2;for(let u=0;u<t.length-1;u++){const n=t[u],i=t[u+1],r=n.dist(i);if(l+r>c){const s=(c-l)/r,h=nn(n.x,i.x,s),d=nn(n.y,i.y,s),p=new uu(h,d,i.angleTo(n),u);return p._round(),!o||hu(t,p,a,o,e)?p:void 0}l+=r}}function gu(t,e,n,i,r,s,o,a,l){const c=pu(i,s,o),u=fu(i,r),h=u*o,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),_u(t,d?e/2*a%e:(u/2+2*s)*o*a%e,e,c,n,h,d,!1,l)}function _u(t,e,n,i,r,s,o,a,l){const c=s/2,u=du(t);let h=0,d=e-n,p=[];for(let f=0;f<t.length-1;f++){const e=t[f],o=t[f+1],a=e.dist(o),m=o.angleTo(e);for(;d+n<h+a;){d+=n;const g=(d-h)/a,_=nn(e.x,o.x,g),y=nn(e.y,o.y,g);if(_>=0&&_<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const e=new uu(_,y,m,f);e._round(),i&&!hu(t,e,s,i,r)||p.push(e)}}h+=a}return a||p.length||o||(p=_u(t,h/2,n,i,r,s,o,!0,l)),p}function yu(t,e,n,i,s){const o=[];for(let a=0;a<t.length;a++){const l=t[a];let c;for(let t=0;t<l.length-1;t++){let a=l[t],u=l[t+1];a.x<e&&u.x<e||(a.x<e?a=new r(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x<e&&(u=new r(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y<n&&u.y<n||(a.y<n?a=new r(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round():u.y<n&&(u=new r(a.x+(n-a.y)/(u.y-a.y)*(u.x-a.x),n)._round()),a.x>=i&&u.x>=i||(a.x>=i?a=new r(i,a.y+(i-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x>=i&&(u=new r(i,a.y+(i-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y>=s&&u.y>=s||(a.y>=s?a=new r(a.x+(s-a.y)/(u.y-a.y)*(u.x-a.x),s)._round():u.y>=s&&(u=new r(a.x+(s-a.y)/(u.y-a.y)*(u.x-a.x),s)._round()),c&&a.equals(c[c.length-1])||(c=[a],o.push(c)),c.push(u)))))}}return o}sr("Anchor",uu);var vu=wu,xu=wu,bu=1e20;function wu(t,e,n,i,r,s){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=s||"normal",this.radius=n||8;var o=this.size=this.fontSize+2*this.buffer,a=o+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Cu(t,e,n,i,r,s){for(var o=0;o<e;o++)Eu(t,o,e,n,i,r,s);for(var a=0;a<n;a++)Eu(t,a*e,1,e,i,r,s)}function Eu(t,e,n,i,r,s,o){var a,l,c,u;for(s[0]=0,o[0]=-bu,o[1]=bu,a=0;a<i;a++)r[a]=t[e+a*n];for(a=1,l=0,c=0;a<i;a++){do{c=(r[a]-r[u=s[l]]+a*a-u*u)/(a-u)/2}while(c<=o[l]&&--l>-1);s[++l]=a,o[l]=c,o[l+1]=bu}for(a=0,l=0;a<i;a++){for(;o[l+1]<a;)l++;t[e+a*n]=r[u=s[l]]+(a-u)*(a-u)}}wu.prototype._draw=function(t,e){var n,i,r,s,o,a,l,c,u,h=this.ctx.measureText(t),d=h.width,p=2*this.buffer;e&&this.useMetrics?(o=Math.floor(h.actualBoundingBoxAscent),c=this.buffer+Math.ceil(h.actualBoundingBoxAscent),a=this.buffer,l=this.buffer,n=(i=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+p,r=(s=Math.min(this.size-a,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+p,this.ctx.textBaseline="alphabetic"):(n=i=this.size,r=s=this.size,o=19*this.fontSize/24,a=l=0,c=this.middle,this.ctx.textBaseline="middle"),i&&s&&(this.ctx.clearRect(l,a,i,s),this.ctx.fillText(t,this.buffer,c),u=this.ctx.getImageData(l,a,i,s));var f=new Uint8ClampedArray(n*r);return function(t,e,n,i,r,s,o){s.fill(bu,0,e*n),o.fill(0,0,e*n);for(var a=(e-i)/2,l=0;l<r;l++)for(var c=0;c<i;c++){var u=(l+a)*e+c+a,h=t.data[4*(l*i+c)+3]/255;if(1===h)s[u]=0,o[u]=bu;else if(0===h)s[u]=bu,o[u]=0;else{var d=Math.max(0,.5-h),p=Math.max(0,h-.5);s[u]=d*d,o[u]=p*p}}}(u,n,r,i,s,this.gridOuter,this.gridInner),Cu(this.gridOuter,n,r,this.f,this.v,this.z),Cu(this.gridInner,n,r,this.f,this.v,this.z),function(t,e,n,i,r,s,o){for(var a=0;a<e*n;a++){var l=Math.sqrt(i[a])-Math.sqrt(r[a]);t[a]=Math.round(255-255*(l/s+o))}}(f,n,r,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:f,metrics:{width:i,height:s,sdfWidth:n,sdfHeight:r,top:o,left:0,advance:d}}},wu.prototype.draw=function(t){return this._draw(t,!1).data},wu.prototype.drawWithMetrics=function(t){return this._draw(t,!0)},vu.default=xu;const Su={none:0,ideographs:1,all:2};class Tu{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const n=[];for(const i in t)for(const e of t[i])n.push({stack:i,id:e});g(n,({stack:t,id:e},n)=>{let i=this.entries[t];i||(i=this.entries[t]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[e];if(void 0!==r)return void n(null,{stack:t,id:e,glyph:r});if(r=this._tinySDF(i,t,e),r)return i.glyphs[e]=r,void n(null,{stack:t,id:e,glyph:r});const s=Math.floor(e/256);if(256*s>65535)return void n(new Error("glyphs > 65535 not supported"));if(i.ranges[s])return void n(null,{stack:t,id:e,glyph:r});let o=i.requests[s];o||(o=i.requests[s]=[],Tu.loadGlyphRange(t,s,this.url,this.requestManager,(t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(i.glyphs[+t]=e[+t]);i.ranges[s]=!0}for(const n of o)n(t,e);delete i.requests[s]})),o.push((i,r)=>{i?n(i):r&&n(null,{stack:t,id:e,glyph:r[e]||null})})},(t,n)=>{if(t)e(t);else if(n){const t={};for(const{stack:e,id:i,glyph:r}of n)(t[e]||(t[e]={}))[i]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};e(null,t)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Su.none&&(this.localGlyphMode===Su.all?!!this.localFontFamily:!!this.localFontFamily&&(Mr(t)||Pr(t)||yr(t)||vr(t)))}_tinySDF(t,e,n){const i=this.localFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(n))return;let r=t.tinySDF;if(!r){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),r=t.tinySDF=new Tu.TinySDF(48,6,16,.25,i,n)}if(this.localGlyphs[r.fontWeight][n])return this.localGlyphs[r.fontWeight][n];const{data:s,metrics:o}=r.drawWithMetrics(String.fromCharCode(n)),{sdfWidth:a,sdfHeight:l,width:c,height:u,left:h,top:d,advance:p}=o;return this.localGlyphs[r.fontWeight][n]={id:n,bitmap:new za({width:a,height:l},s),metrics:{width:c/2,height:u/2,left:h/2,top:d/2-27,advance:p/2,localGlyph:!0}}}}function Mu(t,e,n,i){const s=[],o=t.image,a=o.pixelRatio,l=o.paddedRect.w-2,c=o.paddedRect.h-2,u=t.right-t.left,h=t.bottom-t.top,d=o.stretchX||[[0,l]],p=o.stretchY||[[0,c]],f=(t,e)=>t+e[1]-e[0],m=d.reduce(f,0),g=p.reduce(f,0),_=l-m,y=c-g;let v=0,x=m,b=0,w=g,C=0,E=_,S=0,T=y;if(o.content&&i){const t=o.content;v=Au(d,0,t[0]),b=Au(p,0,t[1]),x=Au(d,t[0],t[2]),w=Au(p,t[1],t[3]),C=t[0]-v,S=t[1]-b,E=t[2]-t[0]-x,T=t[3]-t[1]-w}const M=(i,s,l,c)=>{const d=Pu(i.stretch-v,x,u,t.left),p=Iu(i.fixed-C,E,i.stretch,m),f=Pu(s.stretch-b,w,h,t.top),_=Iu(s.fixed-S,T,s.stretch,g),y=Pu(l.stretch-v,x,u,t.left),M=Iu(l.fixed-C,E,l.stretch,m),A=Pu(c.stretch-b,w,h,t.top),k=Iu(c.fixed-S,T,c.stretch,g),P=new r(d,f),I=new r(y,f),O=new r(y,A),z=new r(d,A),D=new r(p/a,_/a),R=new r(M/a,k/a),L=e*Math.PI/180;if(L){const t=Math.sin(L),e=Math.cos(L),n=[e,-t,t,e];P._matMult(n),I._matMult(n),z._matMult(n),O._matMult(n)}const F=i.stretch+i.fixed,B=s.stretch+s.fixed;return{tl:P,tr:I,bl:z,br:O,tex:{x:o.paddedRect.x+1+F,y:o.paddedRect.y+1+B,w:l.stretch+l.fixed-F,h:c.stretch+c.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:R,minFontScaleX:E/a/u,minFontScaleY:T/a/h,isSDF:n}};if(i&&(o.stretchX||o.stretchY)){const t=ku(d,_,m),e=ku(p,y,g);for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)s.push(M(i,e[t],r,e[t+1]))}}else s.push(M({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return s}function Au(t,e,n){let i=0;for(const r of t)i+=Math.max(e,Math.min(n,r[1]))-Math.max(e,Math.min(n,r[0]));return i}function ku(t,e,n){const i=[{fixed:-1,stretch:0}];for(const[r,s]of t){const t=i[i.length-1];i.push({fixed:r-t.stretch,stretch:t.stretch}),i.push({fixed:r-t.stretch,stretch:t.stretch+(s-r)})}return i.push({fixed:e+1,stretch:n}),i}function Pu(t,e,n,i){return t/e*n+i}function Iu(t,e,n,i){return t-e*n/i}Tu.loadGlyphRange=function(t,e,n,i,r){const s=256*e,o=s+255,a=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${s}-${o}`),bt.Glyphs);St(a,(t,e)=>{if(t)r(t);else if(e){const t={};for(const n of function(t){return new bc(t).readFields(Uc,[])}(e))t[n.id]=n;r(null,t)}})},Tu.TinySDF=vu;class Ou{constructor(t=[],e=zu){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,s=e[r];if(n(i,s)>=0)break;e[t]=s,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),s=e[i];const o=i+1;if(o<this.length&&n(e[o],s)<0&&(i=o,s=e[o]),n(s,r)>=0)break;e[t]=s,t=i}e[t]=r}}function zu(t,e){return t<e?-1:t>e?1:0}function Du(t,e=1,n=!1){let i=1/0,s=1/0,o=-1/0,a=-1/0;const l=t[0];for(let r=0;r<l.length;r++){const t=l[r];(!r||t.x<i)&&(i=t.x),(!r||t.y<s)&&(s=t.y),(!r||t.x>o)&&(o=t.x),(!r||t.y>a)&&(a=t.y)}const c=Math.min(o-i,a-s);let u=c/2;const h=new Ou([],Ru);if(0===c)return new r(i,s);for(let r=i;r<o;r+=c)for(let e=s;e<a;e+=c)h.push(new Lu(r+u,e+u,u,t));let d=function(t){let e=0,n=0,i=0;const r=t[0];for(let s=0,o=r.length,a=o-1;s<o;a=s++){const t=r[s],o=r[a],l=t.x*o.y-o.x*t.y;n+=(t.x+o.x)*l,i+=(t.y+o.y)*l,e+=3*l}return new Lu(n/e,i/e,0,t)}(t),p=h.length;for(;h.length;){const i=h.pop();(i.d>d.d||!d.d)&&(d=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,p)),i.max-d.d<=e||(u=i.h/2,h.push(new Lu(i.p.x-u,i.p.y-u,u,t)),h.push(new Lu(i.p.x+u,i.p.y-u,u,t)),h.push(new Lu(i.p.x-u,i.p.y+u,u,t)),h.push(new Lu(i.p.x+u,i.p.y+u,u,t)),p+=4)}return n&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function Ru(t,e){return e.max-t.max}function Lu(t,e,n,i){this.p=new r(t,e),this.h=n,this.d=function(t,e){let n=!1,i=1/0;for(let r=0;r<e.length;r++){const s=e[r];for(let e=0,r=s.length,o=r-1;e<r;o=e++){const r=s[e],a=s[o];r.y>t.y!=a.y>t.y&&t.x<(a.x-r.x)*(t.y-r.y)/(a.y-r.y)+r.x&&(n=!n),i=Math.min(i,Xo(t,r,a))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}const Fu=Number.POSITIVE_INFINITY;function Bu(t,e){return e[1]!==Fu?function(t,e,n){let i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){let n=0,i=0;e<0&&(e=0);const r=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function Nu(t,e,n,i,r,s,o,a){t.createArrays(),t.tilePixelRatio=Ro/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const l=t.layers[0].layout,c=t.layers[0]._unevaluatedLayout._values,u={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;u.compositeTextSizes=[c["text-size"].possiblyEvaluate(new rs(e),o),c["text-size"].possiblyEvaluate(new rs(n),o)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;u.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new rs(e),o),c["icon-size"].possiblyEvaluate(new rs(n),o)]}u.layoutTextSize=c["text-size"].possiblyEvaluate(new rs(a+1),o),u.layoutIconSize=c["icon-size"].possiblyEvaluate(new rs(a+1),o),u.textMaxSize=c["text-size"].possiblyEvaluate(new rs(18),o);const h=l.get("text-line-height")*hc,d="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),p=l.get("text-keep-upright"),f=l.get("text-size");for(const m of t.features){const s=l.get("text-font").evaluate(m,{},o).join(","),a=f.evaluate(m,{},o),c=u.layoutTextSize.evaluate(m,{},o),g=(u.layoutIconSize.evaluate(m,{},o),{horizontal:{},vertical:void 0}),_=m.text;let y,v=[0,0];if(_){const i=_.toString(),u=l.get("text-letter-spacing").evaluate(m,{},o)*hc,f=Nr(i)?u:0,y=l.get("text-anchor").evaluate(m,{},o),x=l.get("text-variable-anchor");if(!x){const t=l.get("text-radial-offset").evaluate(m,{},o);v=t?Bu(y,[t*hc,Fu]):l.get("text-offset").evaluate(m,{},o).map(t=>t*hc)}let b=d?"center":l.get("text-justify").evaluate(m,{},o);const w=l.get("symbol-placement"),C="point"===w?l.get("text-max-width").evaluate(m,{},o)*hc:0,E=()=>{t.allowVerticalPlacement&&Br(i)&&(g.vertical=Qc(_,e,n,r,s,C,h,y,"left",f,v,Hc.vertical,!0,w,c,a))};if(!d&&x){const t="auto"===b?x.map(t=>Vu(t)):[b];let i=!1;for(let o=0;o<t.length;o++){const l=t[o];if(!g.horizontal[l])if(i)g.horizontal[l]=g.horizontal[0];else{const t=Qc(_,e,n,r,s,C,h,"center",l,f,v,Hc.horizontal,!1,w,c,a);t&&(g.horizontal[l]=t,i=1===t.positionedLines.length)}}E()}else{"auto"===b&&(b=Vu(y));const t=Qc(_,e,n,r,s,C,h,y,b,f,v,Hc.horizontal,!1,w,c,a);t&&(g.horizontal[b]=t),E(),Br(i)&&d&&p&&(g.vertical=Qc(_,e,n,r,s,C,h,y,b,f,v,Hc.vertical,!1,w,c,a))}}let x=!1;if(m.icon&&m.icon.name){const e=i[m.icon.name];e&&(y=lu(r[m.icon.name],l.get("icon-offset").evaluate(m,{},o),l.get("icon-anchor").evaluate(m,{},o)),x=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const b=$u(g.horizontal)||g.vertical;t.iconsInText=!!b&&b.iconsInText,(b||y)&&Uu(t,m,g,y,i,u,c,0,v,x,o)}s&&t.generateCollisionDebugBuffers(a,t.collisionBoxArray)}function Vu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uu(t,e,n,i,r,s,o,a,l,c,h){let d=s.textMaxSize.evaluate(e,{},h);void 0===d&&(d=o);const p=t.layers[0].layout,f=p.get("icon-offset").evaluate(e,{},h),m=$u(n.horizontal),g=o/24,_=t.tilePixelRatio*g,y=t.tilePixelRatio*d/24,v=t.tilePixelRatio*p.get("symbol-spacing"),x=p.get("text-padding")*t.tilePixelRatio,b=p.get("icon-padding")*t.tilePixelRatio,w=u(p.get("text-max-angle")),C="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),E="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),S=p.get("symbol-placement"),T=v/2,M=p.get("icon-text-fit");let A;i&&"none"!==M&&(t.allowVerticalPlacement&&n.vertical&&(A=cu(i,n.vertical,M,p.get("icon-text-fit-padding"),f,g)),m&&(i=cu(i,m,M,p.get("icon-text-fit-padding"),f,g)));const P=(a,u)=>{u.x<0||u.x>=Ro||u.y<0||u.y>=Ro||function(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,v,x,b,w,C,E){const S=t.addToLineVertexArray(e,n);let T,M,A,P,I,O,z,D=0,R=0,L=0,F=0,B=-1,N=-1;const V={};let U=ao(""),j=0,q=0;if(void 0===a._unevaluatedLayout.getValue("text-radial-offset")?[j,q]=a.layout.get("text-offset").evaluate(x,{},C).map(t=>t*hc):(j=a.layout.get("text-radial-offset").evaluate(x,{},C)*hc,q=Fu),t.allowVerticalPlacement&&i.vertical){const t=i.vertical;if(f)O=Zu(t),o&&(z=Zu(o));else{const n=a.layout.get("text-rotate").evaluate(x,{},C)+90;A=Gu(l,e,c,u,h,t,0,p,n),o&&(P=Gu(l,e,c,u,h,o,0,_,n))}}if(r){const n=a.layout.get("icon-rotate").evaluate(x,{},C),i="none"!==a.layout.get("icon-text-fit"),s=Mu(r,n,w,i),d=o?Mu(o,n,w,i):void 0;M=Gu(l,e,c,u,h,r,0,_,n),D=4*s.length;const p=t.iconSizeData;let f=null;"source"===p.kind?(f=[dc*a.layout.get("icon-size").evaluate(x,{},C)],f[0]>ju&&k(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===p.kind&&(f=[dc*b.compositeIconSizes[0].evaluate(x,{},C),dc*b.compositeIconSizes[1].evaluate(x,{},C)],(f[0]>ju||f[1]>ju)&&k(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,s,f,v,y,x,!1,e,S.lineStartIndex,S.lineLength,-1,C),B=t.icon.placedSymbolArray.length-1,d&&(R=4*d.length,t.addSymbols(t.icon,d,f,v,y,x,Hc.vertical,e,S.lineStartIndex,S.lineLength,-1,C),N=t.icon.placedSymbolArray.length-1)}for(const k in i.horizontal){const n=i.horizontal[k];T||(U=ao(n.text),f?I=Zu(n):T=Gu(l,e,c,u,h,n,0,p,a.layout.get("text-rotate").evaluate(x,{},C)));const r=1===n.positionedLines.length;if(L+=qu(t,e,n,s,a,f,x,m,S,i.vertical?Hc.horizontal:Hc.horizontalOnly,r?Object.keys(i.horizontal):[k],V,B,b,C),r)break}i.vertical&&(F+=qu(t,e,i.vertical,s,a,f,x,m,S,Hc.vertical,["vertical"],V,N,b,C));let $=-1;const G=(t,e)=>t?Math.max(t,e):e;$=G(I,$),$=G(O,$),$=G(z,$);const Z=$>-1?1:0;Z&&($*=E/hc),t.glyphOffsetArray.length>=eh.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,V.right>=0?V.right:-1,V.center>=0?V.center:-1,V.left>=0?V.left:-1,V.vertical||-1,B,N,U,void 0!==T?T:t.collisionBoxArray.length,void 0!==T?T+1:t.collisionBoxArray.length,void 0!==A?A:t.collisionBoxArray.length,void 0!==A?A+1:t.collisionBoxArray.length,void 0!==M?M:t.collisionBoxArray.length,void 0!==M?M+1:t.collisionBoxArray.length,P||t.collisionBoxArray.length,P?P+1:t.collisionBoxArray.length,c,L,F,D,R,Z,0,d,j,q,$)}(t,u,a,n,i,r,A,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_,x,C,l,0,b,E,f,e,s,c,h,o)};if("line"===S)for(const u of yu(e.geometry,0,0,Ro,Ro)){const e=gu(u,v,w,n.vertical||m,i,24,y,t.overscaling,Ro);for(const n of e){const e=m;e&&Hu(t,e.text,T,n)||P(u,n)}}else if("line-center"===S){for(const u of e.geometry)if(u.length>1){const t=mu(u,w,n.vertical||m,i,24,y);t&&P(u,t)}}else if("Polygon"===e.type)for(const u of yl(e.geometry,0)){const t=Du(u,16);P(u[0],new uu(t.x,t.y,0))}else if("LineString"===e.type)for(const u of e.geometry)P(u,new uu(u[0].x,u[0].y,0));else if("Point"===e.type)for(const u of e.geometry)for(const t of u)P([t],new uu(t.x,t.y,0))}const ju=32640;function qu(t,e,n,i,s,o,a,l,c,u,h,d,p,f,m){const g=function(t,e,n,i,s,o,a,l){const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(const h of e.positionedLines)for(const t of h.positionedGlyphs){if(!t.rect)continue;const i=t.rect||{};let o=4,d=!0,p=1,f=0;const m=(s||l)&&t.vertical,g=t.metrics.advance*t.scale/2;if(l&&e.verticalizable){const e=(t.scale-1)*hc,n=(hc-t.metrics.width*t.scale)/2;f=h.lineOffset/2-(t.imageName?-n:e)}if(t.imageName){const e=a[t.imageName];d=e.sdf,p=e.pixelRatio,o=1/p}const _=s?[t.x+g,t.y]:[0,0];let y=s?[0,0]:[t.x+g+n[0],t.y+n[1]-f],v=[0,0];m&&(v=y,y=[0,0]);const x=(t.metrics.left-o)*t.scale-g+y[0],b=(-t.metrics.top-o)*t.scale+y[1],w=x+i.w*t.scale/(p*(t.localGlyph?2:1)),C=b+i.h*t.scale/(p*(t.localGlyph?2:1)),E=new r(x,b),S=new r(w,b),T=new r(x,C),M=new r(w,C);if(m){const e=new r(-g,g-Wc),n=-Math.PI/2,i=12-g,s=new r(22-i,-(t.imageName?i:0)),o=new r(...v);E._rotateAround(n,e)._add(s)._add(o),S._rotateAround(n,e)._add(s)._add(o),T._rotateAround(n,e)._add(s)._add(o),M._rotateAround(n,e)._add(s)._add(o)}if(c){const t=Math.sin(c),e=Math.cos(c),n=[e,-t,t,e];E._matMult(n),S._matMult(n),T._matMult(n),M._matMult(n)}const A=new r(0,0),k=new r(0,0);u.push({tl:E,tr:S,bl:T,br:M,tex:i,writingMode:e.writingMode,glyphOffset:_,sectionIndex:t.sectionIndex,isSDF:d,pixelOffsetTL:A,pixelOffsetBR:k,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,s,o,a,i,t.allowVerticalPlacement),_=t.textSizeData;let y=null;"source"===_.kind?(y=[dc*s.layout.get("text-size").evaluate(a,{},m)],y[0]>ju&&k(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===_.kind&&(y=[dc*f.compositeTextSizes[0].evaluate(a,{},m),dc*f.compositeTextSizes[1].evaluate(a,{},m)],(y[0]>ju||y[1]>ju)&&k(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,g,y,l,o,a,u,e,c.lineStartIndex,c.lineLength,p,m);for(const r of h)d[r]=t.text.placedSymbolArray.length-1;return 4*g.length}function $u(t){for(const e in t)return t[e];return null}function Gu(t,e,n,i,s,o,a,l,c){let h=o.top,d=o.bottom,p=o.left,f=o.right;const m=o.collisionPadding;if(m&&(p-=m[0],h-=m[1],f+=m[2],d+=m[3]),c){const t=new r(p,h),e=new r(f,h),n=new r(p,d),i=new r(f,d),s=u(c);t._rotate(s),e._rotate(s),n._rotate(s),i._rotate(s),p=Math.min(t.x,e.x,n.x,i.x),f=Math.max(t.x,e.x,n.x,i.x),h=Math.min(t.y,e.y,n.y,i.y),d=Math.max(t.y,e.y,n.y,i.y)}return t.emplaceBack(e.x,e.y,p,h,f,d,l,n,i,s),t.length-1}function Zu(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Hu(t,e,n,i){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<n)return!0}else r[e]=[];return r[e].push(i),!1}const Wu=Ll.VectorTileFeature.types,Xu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ku(t,e,n,i,r,s,o,a,l,c,u,h,d){const p=a?Math.min(ju,Math.round(a[0])):0,f=a?Math.min(ju,Math.round(a[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),s,o,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function Qu(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function Yu(t){for(const e of t.sections)if(Gr(e.text))return!0;return!1}class Ju{constructor(t){this.layoutVertexArray=new Ps,this.indexArray=new Fs,this.programConfigurations=t,this.segments=new Do,this.dynamicLayoutVertexArray=new Is,this.opacityVertexArray=new Os,this.placedSymbolArray=new Xs}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,oc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Xu,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}sr("SymbolBuffers",Ju);class th{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Do,this.collisionVertexArray=new Ls,this.collisionVertexArrayExt=new Is}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ac.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,lc.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}sr("CollisionBuffers",th);class eh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=la([]),this.placementViewportMatrix=la([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pc(this.zoom,e["text-size"]),this.iconSizeData=pc(this.zoom,e["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map(t=>Hc[t])),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.sourceID=t.sourceID}createArrays(){this.text=new Ju(new Mo(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Ju(new Mo(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Ys,this.lineVertexArray=new Js,this.symbolInstances=new Qs}calculateGlyphDependencies(t,e,n,i,r){for(let s=0;s<t.length;s++)if(e[t.charCodeAt(s)]=!0,(n||i)&&r){const n=yc[t.charAt(s)];n&&(e[n.charCodeAt(0)]=!0)}}populate(t,e,n){const i=this.layers[0],r=i.layout,s=r.get("text-font"),o=r.get("text-field"),a=r.get("icon-image"),l=("constant"!==o.value.kind||o.value.value instanceof pe&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),c="constant"!==a.value.kind||!!a.value.value||Object.keys(a.parameters).length>0,u=r.get("symbol-sort-key");if(this.features=[],!l&&!c)return;const h=e.iconDependencies,d=e.glyphDependencies,p=e.availableImages,f=new rs(this.zoom);for(const{feature:m,id:g,index:_,sourceLayerIndex:y}of t){const t=i._featureFilter.needGeometry,e=No(m,t);if(!i._featureFilter.filter(f,e,n))continue;let o,a;if(t||(e.geometry=Bo(m)),l){const t=i.getValueAndResolveTokens("text-field",e,n,p),r=pe.factory(t);Yu(r)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===es()||this.hasRTLText&&is.isParsed())&&(o=_c(r,i,e))}if(c){const t=i.getValueAndResolveTokens("icon-image",e,n,p);a=t instanceof fe?t:fe.fromString(t)}if(!o&&!a)continue;const v=this.sortFeaturesByKey?u.evaluate(e,{},n):void 0;if(this.features.push({id:g,text:o,icon:a,index:_,sourceLayerIndex:y,geometry:e.geometry,properties:m.properties,type:Wu[m.type],sortKey:v}),a&&(h[a.name]=!0),o){const t=s.evaluate(e,{},n).join(","),i="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Hc.vertical)>=0;for(const e of o.sections)if(e.image)h[e.image.name]=!0;else{const n=Br(o.toString()),r=e.fontStack||t,s=d[r]=d[r]||{};this.calculateGlyphDependencies(e.text,s,i,this.allowVerticalPlacement,n)}}}"line"===r.get("symbol-placement")&&(this.features=function(t){const e={},n={},i=[];let r=0;function s(e){i.push(t[e]),r++}function o(t,e,r){const s=n[t];return delete n[t],n[e]=s,i[s].geometry[0].pop(),i[s].geometry[0]=i[s].geometry[0].concat(r[0]),s}function a(t,n,r){const s=e[n];return delete e[n],e[t]=s,i[s].geometry[0].shift(),i[s].geometry[0]=r[0].concat(i[s].geometry[0]),s}function l(t,e,n){const i=n?e[0][e[0].length-1]:e[0][0];return`${t}:${i.x}:${i.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){s(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in n&&f in e&&n[p]!==e[f]){const t=a(p,f,h),r=o(p,f,i[t].geometry);delete e[p],delete n[f],n[l(d,i[r].geometry,!0)]=r,i[t].geometry=null}else p in n?o(p,f,h):f in e?a(p,f,h):(s(c),e[p]=r-1,n[f]=r-1)}return i.filter(t=>t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((t,e)=>t.sortKey-e.sortKey)}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]);const r={};for(let s=t.segment+1;s<e.length;s++)r[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:n},s<e.length-1&&(n+=e[s+1].dist(e[s]));for(let s=t.segment||0;s>=0;s--)r[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,i,r,s,o,a,l,c,u,h){const d=t.indexArray,p=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,p,d,this.canOverlap?s.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,_=this.allowVerticalPlacement&&o===Hc.vertical?Math.PI/2:0,y=s.text&&s.text.sections;for(let v=0;v<e.length;v++){const{tl:i,tr:r,bl:o,br:l,tex:c,pixelOffsetTL:u,pixelOffsetBR:m,minFontScaleX:g,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:C}=e[v],E=f.vertexLength,S=b[1];Ku(p,a.x,a.y,i.x,S+i.y,c.x,c.y,n,w,u.x,u.y,g,x),Ku(p,a.x,a.y,r.x,S+r.y,c.x+c.w,c.y,n,w,m.x,u.y,g,x),Ku(p,a.x,a.y,o.x,S+o.y,c.x,c.y+c.h,n,w,u.x,m.y,g,x),Ku(p,a.x,a.y,l.x,S+l.y,c.x+c.w,c.y+c.h,n,w,m.x,m.y,g,x),Qu(t.dynamicLayoutVertexArray,a,_),d.emplaceBack(E,E+1,E+2),d.emplaceBack(E+1,E+2,E+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),v!==e.length-1&&C===e[v+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,s,s.index,{},h,y&&y[C])}t.placedSymbolArray.emplaceBack(a.x,a.y,m,this.glyphOffsetArray.length-m,g,l,c,a.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],o,0,!1,0,u)}_commitLayoutVertex(t,e,n,i,r){t.emplaceBack(e.x,e.y,n,i,Math.round(r.x),Math.round(r.y))}_addCollisionDebugVertices(t,e,n,i,s){const o=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),a=o.vertexLength,l=s.anchorX,c=s.anchorY;for(let r=0;r<4;r++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),n.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,i,l,c,new r(t.x1,t.y2)),o.vertexLength+=4;const u=n.indexArray;u.emplaceBack(a,a+1),u.emplaceBack(a+1,a+2),u.emplaceBack(a+2,a+3),u.emplaceBack(a+3,a),o.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,i,r,s){for(let o=i;o<r;o++){const i=n.get(o),r=this.getSymbolInstanceTextSize(t,s,e,o);this._addCollisionDebugVertices(i,r,this.textCollisionBox,i.anchorPoint,s)}}_addIconDebugCollisionBoxes(t,e,n,i,r,s){for(let o=i;o<r;o++){const i=n.get(o),r=this.getSymbolInstanceIconSize(t,e,o);this._addCollisionDebugVertices(i,r,this.iconCollisionBox,i.anchorPoint,s)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new th(Ds,cc.members,qs),this.iconCollisionBox=new th(Ds,cc.members,qs);const n=mc(this.iconSizeData,t),i=mc(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(i,t,e,s.textBoxStartIndex,s.textBoxEndIndex,s),this._addTextDebugCollisionBoxes(i,t,e,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._addIconDebugCollisionBoxes(n,t,e,s.iconBoxStartIndex,s.iconBoxEndIndex,s),this._addIconDebugCollisionBoxes(n,t,e,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s)}}getSymbolInstanceTextSize(t,e,n,i){const r=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:i),s=fc(this.textSizeData,t,r)/hc;return this.tilePixelRatio*s}getSymbolInstanceIconSize(t,e,n){const i=this.icon.placedSymbolArray.get(n),r=fc(this.iconSizeData,t,i);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(t,e,n){t.emplaceBack(e,-n,-n),t.emplaceBack(e,n,-n),t.emplaceBack(e,n,n),t.emplaceBack(e,-n,n)}_updateTextDebugCollisionBoxes(t,e,n,i,r,s){for(let o=i;o<r;o++){const i=n.get(o),r=this.getSymbolInstanceTextSize(t,s,e,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,i.padding)}}_updateIconDebugCollisionBoxes(t,e,n,i,r){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceIconSize(t,e,s);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,i.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=mc(this.iconSizeData,t),i=mc(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(i,t,e,s.textBoxStartIndex,s.textBoxEndIndex,s),this._updateTextDebugCollisionBoxes(i,t,e,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._updateIconDebugCollisionBoxes(n,t,e,s.iconBoxStartIndex,s.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(n,t,e,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,i,r,s,o,a,l){const c={};for(let u=e;u<n;u++){const e=t.get(u);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let u=i;u<r;u++){const e=t.get(u);c.verticalTextBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalTextFeatureIndex=e.featureIndex;break}for(let u=s;u<o;u++){const e=t.get(u);c.iconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.iconFeatureIndex=e.featureIndex;break}for(let u=a;u<l;u++){const e=t.get(u);c.verticalIconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalIconFeatureIndex=e.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<i;r+=4)t.indexArray.emplaceBack(r,r+1,r+2),t.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),i=[],r=[],s=[];for(let o=0;o<this.symbolInstances.length;++o){s.push(o);const t=this.symbolInstances.get(o);i.push(0|Math.round(e*t.anchorX+n*t.anchorY)),r.push(t.featureIndex)}return s.sort((t,e)=>i[t]-i[e]||r[e]-r[t]),s}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}sr("SymbolBucket",eh,{omit:["layers","collisionBoxArray","features","compareText"]}),eh.MAX_GLYPHS=65535,eh.addDynamicAttributes=Qu;const nh=new ys({"symbol-placement":new ps(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new ps(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ps(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fs(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ps(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ps(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ps(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ps(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ps(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new fs(Bt.layout_symbol["icon-size"]),"icon-text-fit":new ps(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ps(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new fs(Bt.layout_symbol["icon-image"]),"icon-rotate":new fs(Bt.layout_symbol["icon-rotate"]),"icon-padding":new ps(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new ps(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new fs(Bt.layout_symbol["icon-offset"]),"icon-anchor":new fs(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ps(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ps(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ps(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new fs(Bt.layout_symbol["text-field"]),"text-font":new fs(Bt.layout_symbol["text-font"]),"text-size":new fs(Bt.layout_symbol["text-size"]),"text-max-width":new fs(Bt.layout_symbol["text-max-width"]),"text-line-height":new ps(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new fs(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new fs(Bt.layout_symbol["text-justify"]),"text-radial-offset":new fs(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ps(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new fs(Bt.layout_symbol["text-anchor"]),"text-max-angle":new ps(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new ps(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new fs(Bt.layout_symbol["text-rotate"]),"text-padding":new ps(Bt.layout_symbol["text-padding"]),"text-keep-upright":new ps(Bt.layout_symbol["text-keep-upright"]),"text-transform":new fs(Bt.layout_symbol["text-transform"]),"text-offset":new fs(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new ps(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ps(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new ps(Bt.layout_symbol["text-optional"])});var ih={paint:new ys({"icon-opacity":new fs(Bt.paint_symbol["icon-opacity"]),"icon-color":new fs(Bt.paint_symbol["icon-color"]),"icon-halo-color":new fs(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new fs(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fs(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new ps(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ps(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new fs(Bt.paint_symbol["text-opacity"]),"text-color":new fs(Bt.paint_symbol["text-color"],{runtimeType:Kt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new fs(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new fs(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new fs(Bt.paint_symbol["text-halo-blur"]),"text-translate":new ps(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new ps(Bt.paint_symbol["text-translate-anchor"])}),layout:nh};class rh{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sr("FormatSectionOverride",rh,{omit:["defaultValue"]});class sh extends Io{constructor(t){super(t,ih)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const n of t)e.indexOf(n)<0&&e.push(n);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,i){const r=this.layout.get(t).evaluate(e,{},n,i),s=this._unevaluatedLayout._values[t];return s.isDataDriven()||ci(s.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(e,n)=>n in t?String(t[n]):"")}(e.properties,r)}createBucket(t){return new eh(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of ih.paint.overridableProperties){if(!sh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new rh(e),i=new li(n,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new hi("source",i):new di("composite",i,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new hs(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&sh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),i=ih.paint.properties[e];let r=!1;const s=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof pe)s(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{r||(e instanceof ve&&_e(e.value)===te?s(e.value.sections):e instanceof Ce?s(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return r}getProgramConfiguration(t){return new To(this,t)}}var oh={paint:new ys({"background-color":new ps(Bt.paint_background["background-color"]),"background-pattern":new gs(Bt.paint_background["background-pattern"]),"background-opacity":new ps(Bt.paint_background["background-opacity"])})},ah={paint:new ys({"raster-opacity":new ps(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ps(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ps(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ps(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new ps(Bt.paint_raster["raster-saturation"]),"raster-contrast":new ps(Bt.paint_raster["raster-contrast"]),"raster-resampling":new ps(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new ps(Bt.paint_raster["raster-fade-duration"])})};class lh extends Io{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var ch={paint:new ys({"sky-type":new ps(Bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ps(Bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ps(Bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ps(Bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ps(Bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new _s(Bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ps(Bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ps(Bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ps(Bt.paint_sky["sky-opacity"])})};function uh(t,e,n){const i=pa(0,0,1),r=Ca(wa());return function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l-s*a,t[1]=r*l+o*a,t[2]=s*l+i*a,t[3]=o*l-r*a}(r,r,n?-u(t)+Math.PI:u(t)),Ea(r,r,-u(e)),_a(i,i,r),ga(i,i)}const hh={circle:class extends Io{constructor(t){super(t,sa)}createBucket(t){return new Uo(t)}queryRadius(t){const e=t;return ta("circle-radius",this,e)+ta("circle-stroke-width",this,e)+ea(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,i,r,s,o,a){const l="map"===this.paint.get("circle-pitch-alignment");if(l&&t.queryGeometry.isAboveHorizon)return!1;const c=ia(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),h=l?u*t.pixelToTileUnitsFactor:u;for(const d of i)for(const e of d){const n=e.add(c),i=a&&s.elevation?s.elevation.exaggeration()*a.getElevationAt(n.x,n.y,!0):0,r=l?n:Sa(n,i,o),u=l?t.tilespaceRays.map(t=>Aa(t,i)):t.queryGeometry.screenGeometry;let d=h;const p=ba([],[e.x,e.y,i,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?d*=p[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(d*=s.cameraToCenterDistance/p[3]),qo(u,r,d))return!0}return!1}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new To(this,t)}},heatmap:class extends Io{createBucket(t){return new ka(t)}constructor(t){super(t,Ra),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=La({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new To(this,t)}},hillshade:class extends Io{constructor(t){super(t,Fa)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new To(this,t)}},fill:class extends Io{constructor(t){super(t,El)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new To(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new wl(t)}queryRadius(){return ea(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,i,r,s){return!t.queryGeometry.isAboveHorizon&&$o(na(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends Io{constructor(t){super(t,ql)}createBucket(t){return new Ul(t)}queryRadius(){return ea(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new To(this,t)}queryIntersectsFeature(t,e,n,i,s,o,a,l,c){const u=ia(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(e,n),d=this.paint.get("fill-extrusion-base").evaluate(e,n),p=[0,0],f=l&&o.elevation,m=o.elevation?o.elevation.exaggeration():1;if(f){const e=t.tile.getBucket(this).centroidVertexArray,n=c+1;if(n<e.length){const t=e.get(n);p[0]=t.a_centroid_pos0,p[1]=t.a_centroid_pos1}}if(0===p[0]&&1===p[1])return!1;const g=function(t,e,n,i,s,o,a,l,c){return o?function(t,e,n,i,r,s,o,a,l){const c=[],u=[],h=[0,0,0,1];for(const d of t){const t=[],p=[];for(const c of d){const u=c.x+i.x,d=c.y+i.y,f=Hl(u,d,e,n,s,o,a,l);h[0]=u,h[1]=d,h[2]=f.base,h[3]=1,ba(h,h,r),h[3]=Math.max(h[3],1e-5);const m=Zl([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);h[0]=u,h[1]=d,h[2]=f.top,h[3]=1,ba(h,h,r),h[3]=Math.max(h[3],1e-5);const g=Zl([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);t.push(m),p.push(g)}c.push(t),u.push(p)}return[c,u]}(t,e,n,i,s,o,a,l,c):function(t,e,n,i,s){const o=[],a=[],l=s[8]*e,c=s[9]*e,u=s[10]*e,h=s[11]*e,d=s[8]*n,p=s[9]*n,f=s[10]*n,m=s[11]*n;for(const g of t){const t=[],e=[];for(const n of g){const o=n.x+i.x,a=n.y+i.y,g=s[0]*o+s[4]*a+s[12],_=s[1]*o+s[5]*a+s[13],y=s[2]*o+s[6]*a+s[14],v=s[3]*o+s[7]*a+s[15],x=g+l,b=_+c,w=y+u,C=Math.max(v+h,1e-5),E=g+d,S=_+p,T=y+f,M=Math.max(v+m,1e-5),A=new r(x/C,b/C);A.z=w/C,t.push(A);const k=new r(E/M,S/M);k.z=T/M,e.push(k)}o.push(t),a.push(e)}return[o,a]}(t,e,n,i,s)}(i,d,h,u,a,f?l:null,p,m,o.center.lat),_=t.queryGeometry;return function(t,e,n){let i=1/0;$o(n,e)&&(i=Gl(n,e[0]));for(let r=0;r<e.length;r++){const s=e[r],o=t[r];for(let t=0;t<s.length-1;t++){const e=s[t],r=[e,s[t+1],o[t+1],o[t],e];jo(n,r)&&(i=Math.min(i,Gl(n,r)))}}return i!==1/0&&i}(g[0],g[1],_.isPointQuery()?_.screenBounds:_.screenGeometry)}},line:class extends Io{constructor(t){super(t,nc),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof en,this.gradientVersion=(this.gradientVersion+1)%a)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=ic.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new tc(t)}getProgramIds(){const t=this.paint.get("line-dasharray"),e=this.paint.get("line-pattern").constantOr(1),n=this.paint.get("line-gradient");return[e?"linePattern":t?"lineSDF":n?"lineGradient":"line"]}getProgramConfiguration(t){return new To(this,t)}queryRadius(t){const e=t,n=rc(ta("line-width",this,e),ta("line-gap-width",this,e)),i=ta("line-offset",this,e);return n/2+Math.abs(i)+ea(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,i,s,o){if(t.queryGeometry.isAboveHorizon)return!1;const a=na(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),l=t.pixelToTileUnitsFactor/2*rc(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),c=this.paint.get("line-offset").evaluate(e,n);return c&&(i=function(t,e){const n=[],i=new r(0,0);for(let r=0;r<t.length;r++){const s=t[r],o=[];for(let t=0;t<s.length;t++){const n=s[t-1],r=s[t],a=s[t+1],l=0===t?i:r.sub(n)._unit()._perp(),c=t===s.length-1?i:a.sub(r)._unit()._perp(),u=l._add(c)._unit();u._mult(1/(u.x*c.x+u.y*c.y)),o.push(u._mult(e)._add(r))}n.push(o)}return n}(i,c*t.pixelToTileUnitsFactor)),function(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];if(t.length>=3)for(let e=0;e<r.length;e++)if(Qo(t,r[e]))return!0;if(Go(t,r,n))return!0}return!1}(a,i,l)}isTileClipped(){return!0}},symbol:sh,background:class extends Io{constructor(t){super(t,oh)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Io{constructor(t){super(t,ah)}getProgramIds(){return["raster"]}},sky:class extends Io{constructor(t){super(t,ch),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=La({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const n=this.paint.get("sky-type");if("atmosphere"===n){const n=this.paint.get("sky-atmosphere-sun"),i=!n,r=t.style.light,s=r.properties.get("position");return i&&"viewport"===r.properties.get("anchor")&&k("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?uh(s.azimuthal,90-s.polar,e):uh(n[0],90-n[1],e)}if("gradient"===n){const t=this.paint.get("sky-gradient-center");return uh(t[0],90-t[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:dh,HTMLCanvasElement:ph,HTMLVideoElement:fh,ImageData:mh,ImageBitmap:gh}=o;class _h{constructor(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,e,n){const{width:i,height:r}=t,s=!(this.size&&this.size[0]===i&&this.size[1]===r||n),{context:o}=this,{gl:a}=o;if(this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),s)this.size=[i,r],t instanceof dh||t instanceof ph||t instanceof fh||t instanceof mh||gh&&t instanceof gh?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,i,r,0,this.format,a.UNSIGNED_BYTE,t.data);else{const{x:e,y:s}=n||{x:0,y:0};t instanceof dh||t instanceof ph||t instanceof fh||t instanceof mh||gh&&t instanceof gh?a.texSubImage2D(a.TEXTURE_2D,0,e,s,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,s,i,r,a.RGBA,a.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e,n){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class yh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const vh=o.performance;function xh(t){const e=t?t.url.toString():void 0;return vh.getEntriesByName(e)}class bh{constructor(){this.tasks={},this.taskQueue=[],C(["process"],this),this.invoker=new yh(this.process),this.nextId=0}add(t,e){const n=this.nextId++,i=function({type:t,isSymbolTile:e,zoom:n}){return n=n||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-n:"maybePrepare"===t&&e?400-n:500:200-n:100-n}(e);if(0===i){O();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:t,metadata:e,priority:i,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){O();try{if(this.taskQueue=this.taskQueue.filter(t=>!!this.tasks[t]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let i=0;i<this.taskQueue.length;i++){const n=this.tasks[this.taskQueue[i]];n.priority<e&&(e=n.priority,t=i)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}class wh{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Eh?new Eh(t.lng,t.lat):Eh.convert(t),this}setSouthWest(t){return this._sw=t instanceof Eh?new Eh(t.lng,t.lat):Eh.convert(t),this}extend(t){const e=this._sw,n=this._ne;let i,r;if(t instanceof Eh)i=t,r=t;else{if(!(t instanceof wh))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(wh.convert(t)):this.extend(Eh.convert(t)):this;if(i=t._sw,r=t._ne,!i||!r)return this}return e||n?(e.lng=Math.min(i.lng,e.lng),e.lat=Math.min(i.lat,e.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new Eh(i.lng,i.lat),this._ne=new Eh(r.lng,r.lat)),this}getCenter(){return new Eh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Eh(this.getWest(),this.getNorth())}getSouthEast(){return new Eh(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=Eh.convert(t);let i=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}static convert(t){return!t||t instanceof wh?t:new wh(t)}}const Ch=6371008.8;class Eh{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Eh(m(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return Ch*Math.acos(Math.min(r,1))}toBounds(t=0){const e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new wh(new Eh(this.lng-n,this.lat-e),new Eh(this.lng+n,this.lat+e))}static convert(t){if(t instanceof Eh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Eh(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Eh(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sh=2*Math.PI*Ch;function Th(t){return Sh*Math.cos(t*Math.PI/180)}function Mh(t){return(180+t)/360}function Ah(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function kh(t,e){return t/Th(e)}function Ph(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Ih(t,e){return t*Th(Ph(e))}class Oh{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=Eh.convert(t);return new Oh(Mh(n.lng),Ah(n.lat),kh(e,n.lat))}toLngLat(){return new Eh(360*this.x-180,Ph(this.y))}toAltitude(){return Ih(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Sh*(t=Ph(this.y),1/Math.cos(t*Math.PI/180));var t}}function zh(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}class Dh{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Fh(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=(r=this.y,s=this.z,o=zh(256*(i=this.x),256*(r=Math.pow(2,s)-r-1),s),a=zh(256*(i+1),256*(r+1),s),o[0]+","+o[1]+","+a[0]+","+a[1]);var i,r,s,o,a;const l=function(t,e,n){let i,r="";for(let s=t;s>0;s--)i=1<<s-1,r+=(e&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",n)}getTilePoint(t){const e=Math.pow(2,this.z);return new r((t.x*e-this.x)*Ro,(t.y*e-this.y)*Ro)}getTileVec3(t){const e=Math.pow(2,this.z);return pa((t.x*e-this.x)*Ro,(t.y*e-this.y)*Ro,Ih(t.z,t.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rh{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Fh(t,e.z,e.z,e.x,e.y)}}class Lh{constructor(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Dh(n,+i,+r),this.key=0===e&&t===n?this.canonical.key:Fh(e,t,n,i,r)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new Lh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Lh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return Fh(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return Fh(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Lh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Lh(e,this.wrap,e,n,i),new Lh(e,this.wrap,e,n+1,i),new Lh(e,this.wrap,e,n,i+1),new Lh(e,this.wrap,e,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Lh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Lh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Oh(t.x-this.wrap,t.y))}getTileVec3(t){return this.canonical.getTileVec3(new Oh(t.x-this.wrap,t.y,t.z))}}function Fh(t,e,n,i,r){const s=1<<Math.min(n,22);let o=s*(r%s)+i%s;return t&&n<22&&(o+=s*s*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*o+n)+(e-n)}sr("CanonicalTileID",Dh),sr("OverscaledTileID",Lh,{omit:["posMatrix"]});class Bh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Nh{constructor(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}var Vh=Cs([{name:"a_pos",type:"Int16",components:2}]);class Uh{constructor(t,e,n){this.tileID=t,this.uid=x(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<V.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const i of t){const t=i.layerIds.map(t=>e.getLayer(t)).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(e=>t.filter(t=>t.id===e)[0]));for(const e of t)n[e.id]=i}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof eh){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof eh&&e.hasRTLText){this.hasRTLText=!0,is.isLoading()||is.isLoaded()||"deferred"!==es()||ns();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(n))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Hs}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const n in this.buckets){const e=this.buckets[n];e.uploadPending()&&e.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _h(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _h(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,i,r,s,o,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:o,transform:s,params:r},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),r=e?e.sourceLayer:"",s=i._geojsonTileLayer||i[r];if(!s)return;const o=Ei(e&&e.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let h=0;h<s.length;h++){const e=s.feature(h);if(o.needGeometry){const t=No(e,!0);if(!o.filter(new rs(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new rs(this.tileID.overscaledZ),e))continue;const i=n.getId(e,r),d=new Nh(e,a,l,c,i);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=z(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const i=this.expirationTime-e;i?this.expirationTime=t+Math.max(i,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!e.style.hasLayer(i))continue;const r=this.buckets[i],s=r.layers[0].sourceLayer||"_geojsonTileLayer",o=n[s],a=t[s];if(!o||!a||0===Object.keys(a).length)continue;r.update(a,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<V.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=V.now()+t}setDependencies(t,e){const n={};for(const i of e)n[i]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}}class jh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},y(this.stateChanges[t][i],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])n[e]||(this.deletedStates[t][i][e]=null)}else for(const r in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][r]&&delete this.deletedStates[t][i][r]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),i=y({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete i[t]}return i}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const t={};for(const e in this.stateChanges[i])this.state[i][e]||(this.state[i][e]={}),y(this.state[i][e],this.stateChanges[i][e]),t[e]=this.state[i][e];n[i]=t}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const t={};if(null===this.deletedStates[i])for(const e in this.state[i])t[e]={},this.state[i][e]={};else for(const e in this.deletedStates[i]){if(null===this.deletedStates[i][e])this.state[i][e]={};else for(const t of Object.keys(this.deletedStates[i][e]))delete this.state[i][e][t];t[e]=this.state[i][e]}n[i]=n[i]||{},y(n[i],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const i in t)t[i].setFeatureState(n,e)}}class qh{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function $h(t,e,n,i){let r=0,s=Number.MAX_VALUE;for(let o=0;o<3;o++)if(Math.abs(i[o])<1e-15){if(n[o]<t[o]||n[o]>e[o])return null}else{const a=1/i[o];let l=(t[o]-n[o])*a,c=(e[o]-n[o])*a;if(l>c){const t=l;l=c,c=t}if(l>r&&(r=l),c<s&&(s=c),r>s)return null}return r}function Gh(t,e,n,i,r,s,o,a,l,c,u){const h=i-t,d=r-e,p=s-n,f=o-t,m=a-e,g=l-n,_=u[1]*g-u[2]*m,y=u[2]*f-u[0]*g,v=u[0]*m-u[1]*f,x=h*_+d*y+p*v;if(Math.abs(x)<1e-15)return null;const b=1/x,w=c[0]-t,C=c[1]-e,E=c[2]-n,S=(w*_+C*y+E*v)*b;if(S<0||S>1)return null;const T=C*p-E*d,M=E*h-w*p,A=w*d-C*h,k=(u[0]*T+u[1]*M+u[2]*A)*b;return k<0||S+k>1?null:(f*T+m*M+g*A)*b}function Zh(t,e,n){return(t-e)/(n-e)}function Hh(t,e,n,i,r,s,o,a,l){const c=1<<n,u=s-i,h=o-r,d=(t+1)/c*u+i,p=(e+0)/c*h+r,f=(e+1)/c*h+r;a[0]=(t+0)/c*u+i,a[1]=p,l[0]=d,l[1]=f}class Wh{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let i=Math.ceil(Math.pow(2,e));const r=1/i,s=(t,e,n,i,r)=>{const s=i?1:0,o=(t+1)*n-s,a=e*n,l=(e+1)*n-s;r[0]=t*n,r[1]=a,r[2]=o,r[3]=l};let o=new qh(i);const a=[];for(let l=0;l<i*i;l++){s(l%i,Math.floor(l/i),r,!1,a);const e=Kh(a[0],a[1],t),n=Kh(a[2],a[1],t),c=Kh(a[2],a[3],t),u=Kh(a[0],a[3],t);o.minimums.push(Math.min(e,n,c,u)),o.maximums.push(Math.max(e,n,c,u)),o.leaves.push(1)}for(n.push(o),i/=2;i>=1;i/=2){const t=n[n.length-1];o=new qh(i);for(let e=0;e<i*i;e++){s(e%i,Math.floor(e/i),2,!0,a);const n=t.getElevation(a[0],a[1]),r=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),c=t.getElevation(a[0],a[3]),u=t.isLeaf(a[0],a[1]),h=t.isLeaf(a[2],a[1]),d=t.isLeaf(a[2],a[3]),p=t.isLeaf(a[0],a[3]),f=Math.min(n.min,r.min,l.min,c.min),m=Math.max(n.max,r.max,l.max,c.max),g=u&&h&&d&&p;o.maximums.push(m),o.minimums.push(f),o.leaves.push(m-f<=5&&g?1:0)}n.push(o)}return n}(this.dem),n=e.length-1,i=e[n];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,i,r,s,o=1){return $h([t,e,-100],[n,i,this.maximums[0]*o],r,s)}raycast(t,e,n,i,r,s,o=1){if(!this.nodeCount)return null;const a=this.raycastRoot(t,e,n,i,r,s,o);if(null==a)return null;const l=[],c=[],u=[],h=[],d=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:a,t:p,nodex:f,nodey:m,depth:g}=d.pop();if(this.leaves[a]){Hh(f,m,g,t,e,n,i,u,h);const a=1<<g,l=(f+0)/a,c=(f+1)/a,d=(m+0)/a,_=(m+1)/a,y=Kh(l,d,this.dem)*o,v=Kh(c,d,this.dem)*o,x=Kh(c,_,this.dem)*o,b=Kh(l,_,this.dem)*o,w=Gh(u[0],u[1],y,h[0],u[1],v,h[0],h[1],x,r,s),C=Gh(h[0],h[1],x,u[0],h[1],b,u[0],u[1],y,r,s),E=Math.min(null!==w?w:Number.MAX_VALUE,null!==C?C:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const t=ma([],r,s,p);if(Xh(y,v,b,x,Zh(t[0],u[0],h[0]),Zh(t[1],u[1],h[1]))>=t[2])return p}continue}let _=0;for(let d=0;d<this._siblingOffset.length;d++){Hh((f<<1)+this._siblingOffset[d][0],(m<<1)+this._siblingOffset[d][1],g+1,t,e,n,i,u,h),u[2]=-100,h[2]=this.maximums[this.childOffsets[a]+d]*o;const p=$h(u,h,r,s);if(null!=p){const t=p;l[d]=t;let e=!1;for(let n=0;n<_&&!e;n++)t>=l[c[n]]&&(c.splice(n,0,d),e=!0);e||(c[_]=d),_++}}for(let t=0;t<_;t++){const e=c[t];d.push({idx:this.childOffsets[a]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(m<<1)+this._siblingOffset[e][1],depth:g+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,i,r){if(1===t[i].isLeaf(e,n))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const s=i-1,o=t[s];let a,l=0;for(let c=0;c<this._siblingOffset.length;c++){const t=2*e+this._siblingOffset[c][0],i=2*n+this._siblingOffset[c][1],r=o.getElevation(t,i),s=o.isLeaf(t,i),u=this._addNode(r.min,r.max,s);s&&(l|=1<<c),a||(a=u)}for(let c=0;c<this._siblingOffset.length;c++)l&1<<c||this._construct(t,2*e+this._siblingOffset[c][0],2*n+this._siblingOffset[c][1],s,a+c)}}function Xh(t,e,n,i,r,s){return nn(nn(t,n,s),nn(e,i,s),r)}function Kh(t,e,n){const i=n.dim,r=f(t*i-.5,0,i-1),s=f(e*i-.5,0,i-1),o=Math.floor(r),a=Math.floor(s),l=Math.min(o+1,i-1),c=Math.min(a+1,i-1);return Xh(n.get(o,a),n.get(l,a),n.get(o,c),n.get(l,c),r-o,s-a)}const Qh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Yh{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n,i=!1,r=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return k(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const s=this.dim=e.height-2;if(this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox",this.borderReady=i,!i){for(let t=0;t<s;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(s,t)]=this.data[this._idx(s-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,s)]=this.data[this._idx(t,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Wh(this)}get(t,e,n=!1){const i=new Uint8Array(this.data.buffer);n&&(t=f(t,-1,this.dim),e=f(e,-1,this.dim));const r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[r],i[r+1],i[r+2])}static getUnpackVector(t){return Qh[t]}get unpackVector(){return Qh[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,n){return(256*t*256+256*e+n)/10-1e4}_unpackTerrarium(t,e,n){return 256*t+e+n/256-32768}static pack(t,e){const n=[0,0,0,0],i=Yh.getUnpackVector(e);let r=Math.floor((t+i[3])/i[2]);return n[2]=r%256,r=Math.floor(r/256),n[1]=r%256,r=Math.floor(r/256),n[0]=r,n}getPixels(){return new Da({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,r=e*this.dim+this.dim,s=n*this.dim,o=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:s=o-1;break;case 1:o=s+1}const a=-e*this.dim,l=-n*this.dim;for(let c=s;c<o;c++)for(let e=i;e<r;e++)this.data[this._idx(e,c)]=t.data[this._idx(e+a,c+l)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}sr("DEMData",Yh),sr("DemMinMaxQuadTree",Wh,{omit:["dem"]});class Jh{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:e,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout(()=>{this.remove(t,r)},n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const i of this.data[n])t(i.value)||e.push(i);for(const n of e)this.remove(n.value.tileID,n)}}class td{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}td.ReadOnly=!1,td.ReadWrite=!0,td.disabled=new td(519,td.ReadOnly,[0,1]);const ed=7680;class nd{constructor(t,e,n,i,r,s){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=s}}nd.disabled=new nd({func:519,mask:0},0,0,ed,ed,ed);class id{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}id.Replace=[1,0],id.disabled=new id(id.Replace,ue.transparent,[!1,!1,!1,!1]),id.unblended=new id(id.Replace,ue.transparent,[!0,!0,!0,!0]),id.alphaBlended=new id([1,771],ue.transparent,[!0,!0,!0,!0]);const rd=1029,sd=2305;class od{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}od.disabled=new od(!1,rd,sd),od.backCCW=new od(!0,rd,sd),od.backCW=new od(!0,rd,2304),od.frontCW=new od(!0,1028,2304),od.frontCCW=new od(!0,1028,sd);class ad extends Ft{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),e.on("error",()=>{this._sourceErrored=!0}),this._source=e,this._tiles={},this._cache=new Jh(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new jh}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return _(this._tiles).map(t=>t.tileID).sort(ld).map(t=>t.key)}getRenderableIds(t){const e=[];for(const n in this._tiles)this._isIdRenderable(+n,t)&&e.push(this._tiles[n]);return t?e.sort((t,e)=>{const n=t.tileID,i=e.tileID,s=new r(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),o=new r(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-i.overscaledZ||o.y-s.y||o.x-s.x}).map(t=>t.tileID.key):e.map(t=>t.tileID).sort(ld).map(t=>t.key)}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new Lt(i,{tile:t})):this.update(this.transform));t.timeAdded=V.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Rt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),s=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[s]&&(t.neighboringTiles[s].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,i){for(const r in this._tiles){let s=this._tiles[r];if(i[r]||!s.hasData()||s.tileID.overscaledZ<=e||s.tileID.overscaledZ>n)continue;let o=s.tileID;for(;s&&s.tileID.overscaledZ>e+1;){const t=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[t.key],s&&s.hasData()&&(o=t)}let a=o;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){i[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),i=this._getLoadedTile(e);if(i)return i}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,i=Math.ceil(t.height/e)+1,r=Math.floor(n*i*5),s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(s)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(+e,this._tiles[e])}}update(t,e,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let i;this.updateCacheSize(t,e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(t=>new Lh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)):(i=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,useElevationData:!!this.transform.elevation&&!this.usedForTerrain}),this._source.hasTile&&(i=i.filter(t=>this._source.hasTile(t)))):i=[];const r=this._updateRetainedTiles(i);if(cd(this._source.type)&&0!==i.length){const t={},e={},n=Object.keys(r);for(const i of n){const n=r[i],s=this._tiles[i];if(!s||s.fadeEndTime&&s.fadeEndTime<=V.now())continue;const o=this.findLoadedParent(n,Math.max(n.overscaledZ-ad.maxOverzooming,this._source.minzoom));o&&(this._addTile(o.tileID),t[o.tileID.key]=o.tileID),e[i]=n}const s=i[i.length-1].overscaledZ;for(const i in this._tiles){const t=this._tiles[i];if(r[i]||!t.hasData())continue;let n=t.tileID;for(;n.overscaledZ>s;){n=n.scaledTo(n.overscaledZ-1);const s=this._tiles[n.key];if(s&&s.hasData()&&e[n.key]){r[i]=t.tileID;break}}}for(const i in t)r[i]||(this._coveredTiles[i]=!0,r[i]=t[i])}for(const o in r)this._tiles[o].clearFadeHold();const s=function(t,e){const n=[];for(const i in t)i in e||n.push(i);return n}(this._tiles,r);for(const o of s){const t=this._tiles[o];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+o)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},i=t[t.length-1].overscaledZ,r=t[0].overscaledZ,s=Math.max(r-ad.maxOverzooming,this._source.minzoom),o=Math.max(r+ad.maxUnderzooming,this._source.minzoom),a={};for(const l of t){const t=this._addTile(l);e[l.key]=l,t.hasData()||i<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,i,o,e);for(const l of t){let t=this._tiles[l.key];if(t.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const t=l.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=l.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let i=t.wasRequested();for(let r=l.overscaledZ-1;r>=s;--r){const s=l.scaledTo(r);if(n[s.key])break;if(n[s.key]=!0,t=this.getTile(s),!t&&i&&(t=this._addTile(s)),t&&(e[s.key]=s,i=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);return n||(e=new Uh(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Rt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._cache.reset()}tilesIn(t,e,n){const i=[],r=this.transform;if(!r)return i;for(const s in this._tiles){const o=this._tiles[s];if(n&&o.clearQueryDebugViz(),o.holdingForFade())continue;const a=t.containsTile(o,r,e);a&&i.push(a)}return i}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map(t=>this._tiles[t].tileID);for(const n of e)n.posMatrix=this.transform.calculatePosMatrix(n.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(cd(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=V.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const i=this._tiles[t];i&&i.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(t,e))}}function ld(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function cd(t){return"raster"===t||"image"===t||"video"===t}ad.maxOverzooming=10,ad.maxUnderzooming=3;class ud{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const i=n||t.findDEMTileFor(e);if(!i||!i.dem)return;const r=i.dem,s=i.tileID,o=1<<e.canonical.z-s.canonical.z;return new ud(i,i.tileSize/Ro/o,[(e.canonical.x/o-s.canonical.x)*r.dim,(e.canonical.y/o-s.canonical.y)*r.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],i=Math.floor(t*this._scale+this._offset[0]),s=Math.floor(n);return new r(i,s)}getElevationAt(t,e,n,i){const r=t*this._scale+this._offset[0],s=e*this._scale+this._offset[1],o=Math.floor(r),a=Math.floor(s),l=this._dem;return i=!!i,n?nn(nn(l.get(o,a,i),l.get(o,a+1,i),s-a),nn(l.get(o+1,a,i),l.get(o+1,a+1,i),s-a),r-o):l.get(o,a,i)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*kh(1,t)*this._dem.stride}}class hd{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new tr(Ro,16,0),this.featureIndexArray=new eo,this.promoteId=e}insert(t,e,n,i,r,s=0){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r,s);const a=this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const i=t[e];n[0]=Math.min(n[0],i.x),n[1]=Math.min(n[1],i.y),n[2]=Math.max(n[2],i.x),n[3]=Math.max(n[3],i.y)}n[0]<Ro&&n[1]<Ro&&n[2]>=0&&n[3]>=0&&a.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ll.VectorTile(new bc(this.rawTileData)).layers,this.sourceLayerCoder=new Bh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,n,i){this.loadVTLayers();const r=t.params||{},s=Ei(r.filter),o=t.tileResult,a=t.transform,l=o.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,(t,e,n,i)=>Yo(o.bufferedTilespaceGeometry,t,e,n,i));c.sort(pd);let u=null;a.elevation&&c.length>0&&(u=ud.create(a.elevation,this.tileID));const h={};let d;for(let p=0;p<c.length;p++){const a=c[p];if(a===d)continue;d=a;const l=this.featureIndexArray.get(a);let f=null;this.loadMatchingFeature(h,l,s,r.layers,r.availableImages,e,n,i,(e,n,i,r=0)=>(f||(f=Bo(e)),n.queryIntersectsFeature(o,e,i,f,this.z,t.transform,t.pixelPosMatrix,u,r)))}return h}loadMatchingFeature(t,e,n,i,r,s,o,a,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:h,layoutVertexArrayOffset:d}=e,p=this.bucketLayerIDs[u];if(i&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(i,p))return;const f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(c);if(n.needGeometry){const t=No(m,!0);if(!n.filter(new rs(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new rs(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let _=0;_<p.length;_++){const e=p[_];if(i&&i.indexOf(e)<0)continue;const n=s[e];if(!n)continue;let u={};void 0!==g&&a&&(u=a.getState(n.sourceLayer||"_geojsonTileLayer",g));const h=y({},o[e]);h.paint=dd(h.paint,n.paint,m,u,r),h.layout=dd(h.layout,n.layout,m,u,r);const f=!l||l(m,n,u,d);if(!f)continue;const v=new Nh(m,this.z,this.x,this.y,g);v.layer=h;let x=t[e];void 0===x&&(x=t[e]=[]),x.push({featureIndex:c,feature:v,intersectionZ:f})}}lookupSymbolFeatures(t,e,n,i,r,s,o,a){const l={};this.loadVTLayers();const c=Ei(r);for(const u of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:i,featureIndex:u,layoutVertexArrayOffset:0},c,s,o,a,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;return this.promoteId&&(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof n&&(n=Number(n))),n}}function dd(t,e,n,i,r){return S(t,(t,s)=>{const o=e instanceof ds?e.get(s):null;return o&&o.evaluate?o.evaluate(n,i,r):o})}function pd(t,e){return e-t}sr("FeatureIndex",hd,{omit:["rawTileData","sourceLayerCoder"]});class fd{constructor(t){const e={},n=[];for(const o in t){const i=t[o],r=e[o]={};for(const t in i){const e=i[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const s=e.metrics.localGlyph?2:1,o={x:0,y:0,w:e.bitmap.width+2*s,h:e.bitmap.height+2*s};n.push(o),r[t]={rect:o,metrics:e.metrics}}}const{w:i,h:r}=$c(n),s=new za({width:i||1,height:r||1});for(const o in t){const n=t[o];for(const t in n){const i=n[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const r=e[o][t].rect,a=i.metrics.localGlyph?2:1;za.copy(i.bitmap,s,{x:0,y:0},{x:r.x+a,y:r.y+a},i.bitmap)}}this.image=s,this.positions=e}}sr("GlyphAtlas",fd);class md{constructor(t){this.tileID=new Lh(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile}parse(t,e,n,i,r){this.status="parsing",this.data=t,this.collisionBoxArray=new Hs;const s=new Bh(Object.keys(t.layers).sort()),o=new hd(this.tileID,this.promoteId);o.bucketLayerIDs=[];const a={},l={featureIndex:o,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},c=e.familiesBySource[this.source];for(const _ in c){const e=t.layers[_];if(!e)continue;let i=!1,r=!1;for(const t of c[_])"symbol"===t[0].type?i=!0:r=!0;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!r)continue;1===e.version&&k(`Vector tile source "${this.source}" layer "${_}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const u=s.encode(_),h=[];for(let t=0;t<e.length;t++){const n=e.feature(t),i=o.getId(n,_);h.push({feature:n,id:i,index:t,sourceLayerIndex:u})}for(const t of c[_]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(gd(t,this.zoom,n),(a[e.id]=e.createBucket({index:o.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:u,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(h,l,this.tileID.canonical),o.bucketLayerIDs.push(t.map(t=>t.id)))}}let u,h,d,p;const f={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},m=S(l.glyphDependencies,t=>Object.keys(t).map(Number));Object.keys(m).length?i.send("getGlyphs",{uid:this.uid,stacks:m},(t,e)=>{u||(u=t,h=e,v.call(this))},void 0,!1,f):h={};const g=Object.keys(l.iconDependencies);g.length?i.send("getImages",{icons:g,source:this.source,tileID:this.tileID,type:"icons"},(t,e)=>{u||(u=t,d=e,v.call(this))},void 0,!1,f):d={};const y=Object.keys(l.patternDependencies);function v(){if(u)return r(u);if(h&&d&&p){const t=new fd(h),e=new Zc(d,p);for(const i in a){const r=a[i];r instanceof eh?(gd(r.layers,this.zoom,n),Nu(r,h,t.positions,d,e.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):r.hasPattern&&(r instanceof tc||r instanceof wl||r instanceof Ul)&&(gd(r.layers,this.zoom,n),r.addFeatures(l,this.tileID.canonical,e.patternPositions))}this.status="done",r(null,{buckets:_(a).filter(t=>!t.isEmpty()),featureIndex:o,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:e,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null})}}y.length?i.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"patterns"},(t,e)=>{u||(u=t,p=e,v.call(this))},void 0,!1,f):p={},v.call(this)}}function gd(t,e,n){const i=new rs(e);for(const r of t)r.recalculate(i,n)}class _d{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,i){const r=this.entries[t]=this.entries[t]||{callbacks:[]};if(r.result){const[t,n]=r.result;return this.scheduler?this.scheduler.add(()=>{i(t,n)},e):i(t,n),()=>{}}return r.callbacks.push(i),r.cancel||(r.cancel=n((n,i)=>{r.result=[n,i];for(const t of r.callbacks)this.scheduler?this.scheduler.add(()=>{t(n,i)},e):t(n,i);setTimeout(()=>delete this.entries[t],3e3)})),()=>{r.result||(r.callbacks=r.callbacks.filter(t=>t!==i),r.callbacks.length||(r.cancel(),delete this.entries[t]))}}}function yd(t,e,n){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},e=>{const i=St(t.request,(t,i,r,s)=>{t?e(t):i&&e(null,{vectorTile:n?void 0:new Ll.VectorTile(new bc(i)),rawData:i,cacheControl:r,expires:s})});return()=>{i.cancel(),e()}},e)}t.ARRAY_TYPE=oa,t.AUTH_ERR_MSG=K,t.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},C(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=O()?t:o,this.scheduler=new bh}send(t,e,n,i,r=!1,s){const o=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=s,this.callbacks[o]=n);const a=B(this.globalScope)?void 0:[];return this.target.postMessage({id:o,type:t,hasCallback:!!n,targetMapId:i,mustQueue:r,sourceMapId:this.mapId,data:lr(e,a)},a),{cancel:()=>{n&&delete this.callbacks[o],this.target.postMessage({id:o,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||O()){const t=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),t&&t.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(cr(e.error)):n(null,cr(e.data)))}else{const n=B(this.globalScope)?void 0:[],i=e.hasCallback?(e,i)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?lr(e):null,data:lr(i,n)},n)}:t=>{},r=cr(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,r,i);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],r.source)[t[1]](r,i)}else i(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Dh,t.Color=ue,t.ColorMode=id,t.CullFaceMode=od,t.DEMData=Yh,t.DataConstantProperty=ps,t.DedupedRequest=_d,t.DepthMode=td,t.EXTENT=Ro,t.Elevation=class{getAtPoint(t,e=0){const n=this._source();if(!n)return e;if(t.y<0||t.y>1)return e;const i=n.getSource().maxzoom,r=1<<i,s=Math.floor(t.x),o=t.x-s,a=new Lh(i,s,i,Math.floor(o*r),Math.floor(t.y*r)),l=this.findDEMTileFor(a);if(!l||!l.dem)return e;const c=l.dem,u=1<<l.tileID.canonical.z,h=(o*u-l.tileID.canonical.x)*c.dim,d=(t.y*u-l.tileID.canonical.y)*c.dim,p=Math.floor(h),f=Math.floor(d);return this.exaggeration()*nn(nn(c.get(p,f),c.get(p,f+1),d-f),nn(c.get(p+1,f),c.get(p+1,f+1),d-f),h-p)}getAtTileOffset(t,e,n){const i=1<<t.canonical.z;return this.getAtPoint(new Oh(t.wrap+(t.canonical.x+e/Ro)/i,(t.canonical.y+n/Ro)/i))}getForTilePoints(t,e,n,i){const r=ud.create(this,t,i);return!!r&&(e.forEach(t=>{t[2]=this.exaggeration()*r.getElevationAt(t[0],t[1],n)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,i=e.tileID,r=1<<t.canonical.z-i.canonical.z;let s=t.canonical.x/r-i.canonical.x,o=t.canonical.y/r-i.canonical.y,a=0;for(let l=0;l<t.canonical.z-i.canonical.z&&!n.leaves[a];l++){s*=2,o*=2;const t=2*Math.floor(o)+Math.floor(s);a=n.childOffsets[a]+t,s%=1,o%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Lt,t.EvaluationParameters=rs,t.Event=Rt,t.Evented=Ft,t.GlyphManager=Tu,t.ImagePosition=Gc,t.LngLat=Eh,t.LngLatBounds=wh,t.LocalGlyphMode=Su,t.MAX_SAFE_INTEGER=a,t.MercatorCoordinate=Oh,t.ONE_EM=hc,t.OverscaledTileID=Lh,t.Properties=ys,t.RGBAImage=Da,t.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",X,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Q(t))return t;const n=tt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Q(t))return t;const n=tt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!Q(t))return t;const n=tt(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,i){const r=tt(t);return Q(t)?(r.path=`/styles/v1${r.path}/sprite${e}${n}`,this._makeAPIURL(r,this._customAccessToken||i)):(r.path+=`${e}${n}`,et(r))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Q(t))return t;const i=tt(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==i.authority&&512===n?"@2x":""}${q.supported?".webp":"$1"}`),"raster"===i.authority?i.path=`/${j.RASTER_URL_PREFIX}${i.path}`:(i.path=i.path.replace(/^.+\/v4\//,"/"),i.path=`/${j.TILE_URL_VERSION}${i.path}`);const r=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(i.params)||j.ACCESS_TOKEN;return j.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&i.params.push(`sku=${this._skuToken}`),this._makeAPIURL(i,r)}canonicalizeTileURL(t,e){const n=tt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let i="mapbox://";n.path.match(/^\/raster\/v1\//)?i+=`raster/${n.path.replace(`/${j.RASTER_URL_PREFIX}/`,"")}`:i+=`tiles/${n.path.replace(`/${j.TILE_URL_VERSION}/`,"")}`;let r=n.params;return e&&(r=r.filter(t=>!t.match(/^access_token=/))),r.length&&(i+=`?${r.join("&")}`),i}canonicalizeTileset(t,e){const n=!!e&&Q(e),i=[];for(const r of t.tiles||[])Y(r)?i.push(this.canonicalizeTileURL(r,n)):i.push(r);return i}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=tt(j.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==i.path&&(t.path=`${i.path}${t.path}`),!j.REQUIRE_ACCESS_TOKEN)return et(t);if(e=e||j.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(t=>-1===t.indexOf("access_token")),t.params.push(`access_token=${e||""}`),et(t)}},t.ResourceType=bt,t.SegmentVector=Do,t.SourceCache=ad,t.StencilMode=nd,t.StructArrayLayout1ui2=$s,t.StructArrayLayout2f1f2i16=Rs,t.StructArrayLayout2i4=Ss,t.StructArrayLayout2ui4=qs,t.StructArrayLayout3f12=Is,t.StructArrayLayout3ui6=Fs,t.StructArrayLayout4i8=Ts,t.Texture=_h,t.Tile=Uh,t.Transitionable=as,t.Uniform1f=mo,t.Uniform1i=class extends fo{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.Uniform2f=class extends fo{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.Uniform3f=class extends fo{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.Uniform4f=go,t.UniformColor=_o,t.UniformMatrix3f=class extends fo{constructor(t,e){super(t,e),this.current=vo}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},t.UniformMatrix4f=class extends fo{constructor(t,e){super(t,e),this.current=yo}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=Rh,t.ValidationError=Nt,t.VectorTileWorkerSource=class extends Ft{constructor(t,e,n,i,r){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||yd,this.loading={},this.loaded={},this.deduped=new _d(t.scheduler),this.isSpriteLoaded=i,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,i=t&&t.request,r=i&&i.collectResourceTiming,s=this.loading[n]=new md(t);s.abort=this.loadVectorData(t,(o,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||o||!a)return s.status="done",l||(this.loaded[n]=s),e(o);const c=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl),s.vectorTile=a.vectorTile||new Ll.VectorTile(new bc(c));const h=()=>{s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,(t,n)=>{if(t||!n)return e(t);const s={};if(r){const t=xh(i);t.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,y({rawTileData:c.slice(0)},n,u,s))})};this.isSpriteLoaded?h():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):h()}),this.loaded=this.loaded||{},this.loaded[n]=s})}reloadTile(t,e){const n=this.loaded,i=t.uid,r=this;if(n&&n[i]){const s=n[i];s.showCollisionBoxes=t.showCollisionBoxes,s.enableTerrain=!!t.enableTerrain;const o=(t,n)=>{const i=s.reloadCallback;i&&(delete s.reloadCallback,s.parse(s.vectorTile,r.layerIndex,this.availableImages,r.actor,i)),e(t,n)};"parsing"===s.status?s.reloadCallback=o:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}}abortTile(t,e){const n=t.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()}},t.WritingMode=Hc,t.ZoomHistory=ur,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=Qu,t.altitudeFromMercatorZ=Ih,t.asyncAll=g,t.bezier=d,t.bindAll=C,t.bufferConvexPolygon=function(t,e){const n=[];for(let i=0;i<t.length;i++){const r=m(i-1,-1,t.length-1),s=m(i+1,-1,t.length-1),o=t[i],a=t[s],l=t[r].sub(o).unit(),c=a.sub(o).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*e/Math.sin(u/2));n.push(o.add(h))}return n},t.cacheEntryPossiblyAdded=function(t){vt++,vt>mt&&(t.getActor().send("enforceCacheSizeLimit",ft),vt=0)},t.clamp=f,t.clearTileCache=function(t){const e=o.caches.delete(ht);t&&e.catch(t).then(()=>t())},t.clipLine=yu,t.clone=function(t){var e=new oa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.clone$1=function(t){var e=new oa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$2=M,t.collisionCircleLayout=uc,t.config=j,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=ha,t.create$1=function(){var t=new oa(16);return oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$2=aa,t.createExpression=ui,t.createFilter=Ei,t.createLayout=Cs,t.createStyleLayer=function(t){return"custom"===t.type?new lh(t):new hh[t.type](t)},t.cross=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=r*l-s*a,t[1]=s*o-i*l,t[2]=i*a-r*o,t},t.degToRad=u,t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=p,t.easeCubicInOut=h,t.emitValidationErrors=Ji,t.endsWith=E,t.enforceCacheSizeLimit=function(t){gt(),dt&&dt.then(e=>{e.keys().then(n=>{for(let i=0;i<n.length-t;i++)e.delete(n[i])})})},t.evaluateSizeForFeature=fc,t.evaluateSizeForZoom=mc,t.evaluateVariableOffset=Bu,t.evented=ts,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=V,t.exported$1=q,t.extend=y,t.filterObject=T,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,l=r+r,c=n*o,u=i*o,h=i*a,d=r*o,p=r*a,f=r*l,m=s*o,g=s*a,_=s*l;return t[0]=1-h-f,t[1]=u+_,t[2]=d-g,t[3]=0,t[4]=u-_,t[5]=1-c-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=ou,t.getAnchorJustification=Vu,t.getBounds=function(t){let e=1/0,n=1/0,i=-1/0,s=-1/0;for(const r of t)e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x),s=Math.max(s,r.y);return{min:new r(e,n),max:new r(i,s)}},t.getImage=Ot,t.getJSON=function(t,e){return Et(y(t,{type:"json"}),e)},t.getMapSessionAPI=ct,t.getPerformanceMeasurement=xh,t.getRTLTextPluginStatus=es,t.getReferrer=Ct,t.getVideo=function(t,e){const n=o.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let i=0;i<t.length;i++){const e=o.document.createElement("source");At(t[i])||(n.crossOrigin="Anonymous"),e.src=t[i],n.appendChild(e)}return{cancel:()=>{}}},t.identity=la,t.identity$1=Ca,t.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15],y=n*a-i*o,v=n*l-r*o,x=n*c-s*o,b=i*l-r*a,w=i*c-s*a,C=r*c-s*l,E=u*m-h*f,S=u*g-d*f,T=u*_-p*f,M=h*g-d*m,A=h*_-p*m,k=d*_-p*g,P=y*k-v*A+x*M+b*T-w*S+C*E;return P?(t[0]=(a*k-l*A+c*M)*(P=1/P),t[1]=(r*A-i*k-s*M)*P,t[2]=(m*C-g*w+_*b)*P,t[3]=(d*w-h*C-p*b)*P,t[4]=(l*T-o*k-c*S)*P,t[5]=(n*k-r*T+s*S)*P,t[6]=(g*x-f*C-_*v)*P,t[7]=(u*C-d*x+p*v)*P,t[8]=(o*A-a*T+c*E)*P,t[9]=(i*T-n*A-s*E)*P,t[10]=(f*w-m*x+_*y)*P,t[11]=(h*x-u*w-p*y)*P,t[12]=(a*S-o*M-l*E)*P,t[13]=(n*M-i*S+r*E)*P,t[14]=(m*v-f*b-g*y)*P,t[15]=(u*b-h*v+d*y)*P,t):null},t.isMapAuthenticated=function(t){return ut.has(t)},t.isMapboxURL=Q,t.latFromMercatorY=Ph,t.len=xa,t.length=da,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.loadVectorTile=yd,t.makeRequest=Et,t.mercatorXfromLng=Mh,t.mercatorYfromLat=Ah,t.mercatorZfromAltitude=kh,t.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.mul$1=ua,t.mul$2=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},t.multiply=ca,t.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.normalize=ga,t.normalize$1=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o,t},t.number=nn,t.offscreenCanvasSupported=xt,t.ortho=function(t,e,n,i,r,s,o){var a=1/(e-n),l=1/(i-r),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(o+s)*c,t[15]=1,t},t.pbf=bc,t.perspective=function(t,e,n,i,r){var s,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(s=1/(i-r)),t[14]=2*r*i*s):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){const n={};for(let i=0;i<e.length;i++){const r=e[i];r in t&&(n[r]=t[r])}return n},t.plugin=is,t.pointGeometry=r,t.polygonIntersectsBox=Yo,t.polygonIntersectsPolygon=jo,t.polygonizeBounds=function(t,e,n=0,i=!0){const s=new r(n,n),o=t.sub(s),a=e.add(s),l=[o,new r(a.x,o.y),a,new r(o.x,a.y)];return i&&l.push(o),l},t.posAttributes=Vh,t.postMapLoadEvent=at,t.postTurnstileEvent=st,t.potpack=$c,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=function(t){return t*c},t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:Kr,pluginURL:Qr}),ts.on("pluginStateChange",t),t},t.removeAuthState=function(t){ut.delete(t)},t.renderColorRamp=La,t.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+c*i,t[5]=o*r+u*i,t[6]=a*r+h*i,t[7]=l*r+d*i,t[8]=c*r-s*i,t[9]=u*r-o*i,t[10]=h*r-a*i,t[11]=d*r-l*i,t},t.rotateX$1=Ea,t.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-c*i,t[1]=o*r-u*i,t[2]=a*r-h*i,t[3]=l*r-d*i,t[8]=s*i+c*r,t[9]=o*i+u*r,t[10]=a*i+h*r,t[11]=l*i+d*r,t},t.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+c*i,t[1]=o*r+u*i,t[2]=a*r+h*i,t[3]=l*r+d*i,t[4]=c*r-s*i,t[5]=u*r-o*i,t[6]=h*r-a*i,t[7]=d*r-l*i,t},t.rotateZ$1=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t},t.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.scale$1=function(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scaleAndAdd=ma,t.setCacheLimits=function(t,e){ft=t,mt=e},t.setRTLTextPlugin=function(t,e,n=!1){if(Kr===Zr||Kr===Hr||Kr===Wr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Qr=V.resolveURL(t),Kr=Zr,Xr=e,Jr(),n||ns()},t.spec=Bt,t.storeAuthState=function(t,e){e?ut.add(t):ut.delete(t)},t.sub=va,t.subtract=fa,t.symbolSize=gc,t.transformMat3=function(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t},t.transformMat4=ba,t.transformQuat=_a,t.translate=function(t,e,n){var i,r,s,o,a,l,c,u,h,d,p,f,m=n[0],g=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*_+e[12],t[13]=e[1]*m+e[5]*g+e[9]*_+e[13],t[14]=e[2]*m+e[6]*g+e[10]*_+e[14],t[15]=e[3]*m+e[7]*g+e[11]*_+e[15]):(r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=i=e[0],t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=i*m+a*g+h*_+e[12],t[13]=r*m+l*g+d*_+e[13],t[14]=s*m+c*g+p*_+e[14],t[15]=o*m+u*g+f*_+e[15]),t},t.triggerPluginCompletionEvent=Yr,t.uniqueId=x,t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateLight=Ki,t.validateStyle=Xi,t.values=_,t.vectorTile=Ll,t.version=e,t.warnOnce=k,t.window=o,t.wrap=m}),i(0,function(t){function e(t){const n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const i of t)n+=`${e(i)},`;return`${n}]`}const i=Object.keys(t).sort();let r="{";for(let s=0;s<i.length;s++)r+=`${JSON.stringify(i[s])}:${e(t[i[s]])},`;return`${r}}`}function n(n){let i="";for(const r of t.refProperties)i+=`/${e(n[r])}`;return i}class i{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,i){for(const n of e){this._layerConfigs[n.id]=n;const e=this._layers[n.id]=t.createStyleLayer(n);e._featureFilter=t.createFilter(e.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(const t of i)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=function(t,e){const i={};for(let s=0;s<t.length;s++){const r=e&&e[t[s].id]||n(t[s]);e&&(e[t[s].id]=r);let o=i[r];o||(o=i[r]=[]),o.push(t[s])}const r=[];for(const n in i)r.push(i[n]);return r}(t.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map(t=>this._layers[t.id]),n=e[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const s=n.sourceLayer||"_geojsonTileLayer";let o=r[s];o||(o=r[s]=[]),o.push(e)}}}const{ImageBitmap:r}=t.window;class s{loadTile(e,n){const{uid:i,encoding:s,rawImageData:o,padding:a,buildQuadTree:l}=e,c=r&&o instanceof r?this.getImageData(o,a):o;n(null,new t.DEMData(i,c,s,a<1,l))}getImageData(e,n){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const i=this.offscreenCanvasContext.getImageData(-n,-n,e.width+2*n,e.height+2*n);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:i.width,height:i.height},i.data)}}var o=function t(e,n){var i,r=e&&e.type;if("FeatureCollection"===r)for(i=0;i<e.features.length;i++)t(e.features[i],n);else if("GeometryCollection"===r)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)a(e.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<e.coordinates.length;i++)a(e.coordinates[i],n);return e};function a(t,e){if(0!==t.length){l(t[0],e);for(var n=1;n<t.length;n++)l(t[n],!e)}}function l(t,e){for(var n=0,i=0,r=t.length,s=r-1;i<r;s=i++)n+=(t[i][0]-t[s][0])*(t[s][1]+t[i][1]);n>=0!=!!e&&t.reverse()}const c=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class u{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.pointGeometry(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const i=[];for(const e of n)i.push(new t.pointGeometry(e[0],e[1]));e.push(i)}return e}}toGeoJSON(t,e,n){return c.call(this,t,e,n)}}class h{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(t){return new u(this._features[t])}}var d=t.vectorTile.VectorTileFeature,p=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function m(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new m(this.features[t],this.options.extent)},m.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],s=0;s<i.length;s++)r.push(new t.pointGeometry(i[s][0],i[s][1]));this.geometry.push(r)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,s=0;s<t.length;s++)for(var o=t[s],a=0;a<o.length;a++){var l=o[a];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},m.prototype.toGeoJSON=d.prototype.toGeoJSON;var g=y,_=p;function y(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,v,t.layers[n])}(e,n),n.finish()}function v(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,x,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var s=i.values;for(n=0;n<s.length;n++)e.writeMessage(4,S,s[n])}function x(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,b,t),e.writeVarintField(3,n.type),e.writeMessage(4,E,n)}function b(t,e){var n=t.feature,i=t.keys,r=t.values,s=t.keycache,o=t.valuecache;for(var a in n.properties){var l=s[a];void 0===l&&(i.push(a),s[a]=l=i.length-1),e.writeVarint(l);var c=n.properties[a],u=typeof c;"string"!==u&&"boolean"!==u&&"number"!==u&&(c=JSON.stringify(c));var h=u+":"+c,d=o[h];void 0===d&&(r.push(c),o[h]=d=r.length-1),e.writeVarint(d)}}function w(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function E(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,s=0,o=n.length,a=0;a<o;a++){var l=n[a],c=1;1===i&&(c=l.length),e.writeVarint(w(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(w(2,u-1));var d=l[h].x-r,p=l[h].y-s;e.writeVarint(C(d)),e.writeVarint(C(p)),r+=d,s+=p}3===i&&e.writeVarint(w(7,1))}}function S(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function T(t,e,n,i,r,s){if(r-i<=n)return;const o=i+r>>1;M(t,e,o,i,r,s%2),T(t,e,n,i,o-1,s+1),T(t,e,n,o+1,r,s+1)}function M(t,e,n,i,r,s){for(;r>i;){if(r-i>600){const o=r-i+1,a=n-i+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(a-o/2<0?-1:1);M(t,e,n,Math.max(i,Math.floor(n-a*c/o+u)),Math.min(r,Math.floor(n+(o-a)*c/o+u)),s)}const o=e[2*n+s];let a=i,l=r;for(A(t,e,i,n),e[2*r+s]>o&&A(t,e,i,r);a<l;){for(A(t,e,a,l),a++,l--;e[2*a+s]<o;)a++;for(;e[2*l+s]>o;)l--}e[2*i+s]===o?A(t,e,i,l):(l++,A(t,e,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function A(t,e,n,i){k(t,n,i),k(e,2*n,2*i),k(e,2*n+1,2*i+1)}function k(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function P(t,e,n,i){const r=t-n,s=e-i;return r*r+s*s}g.fromVectorTileJs=y,g.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new p(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return y({layers:n})},g.GeoJSONWrapper=_;const I=t=>t[0],O=t=>t[1];class z{constructor(t,e=I,n=O,i=64,r=Float64Array){this.nodeSize=i,this.points=t;const s=t.length<65536?Uint16Array:Uint32Array,o=this.ids=new s(t.length),a=this.coords=new r(2*t.length);for(let l=0;l<t.length;l++)o[l]=l,a[2*l]=e(t[l]),a[2*l+1]=n(t[l]);T(o,a,i,0,o.length-1,0)}range(t,e,n,i){return function(t,e,n,i,r,s,o){const a=[0,t.length-1,0],l=[];let c,u;for(;a.length;){const h=a.pop(),d=a.pop(),p=a.pop();if(d-p<=o){for(let o=p;o<=d;o++)c=e[2*o],u=e[2*o+1],c>=n&&c<=r&&u>=i&&u<=s&&l.push(t[o]);continue}const f=Math.floor((p+d)/2);c=e[2*f],u=e[2*f+1],c>=n&&c<=r&&u>=i&&u<=s&&l.push(t[f]);const m=(h+1)%2;(0===h?n<=c:i<=u)&&(a.push(p),a.push(f-1),a.push(m)),(0===h?r>=c:s>=u)&&(a.push(f+1),a.push(d),a.push(m))}return l}(this.ids,this.coords,t,e,n,i,this.nodeSize)}within(t,e,n){return function(t,e,n,i,r,s){const o=[0,t.length-1,0],a=[],l=r*r;for(;o.length;){const c=o.pop(),u=o.pop(),h=o.pop();if(u-h<=s){for(let r=h;r<=u;r++)P(e[2*r],e[2*r+1],n,i)<=l&&a.push(t[r]);continue}const d=Math.floor((h+u)/2),p=e[2*d],f=e[2*d+1];P(p,f,n,i)<=l&&a.push(t[d]);const m=(c+1)%2;(0===c?n-r<=p:i-r<=f)&&(o.push(h),o.push(d-1),o.push(m)),(0===c?n+r>=p:i+r>=f)&&(o.push(d+1),o.push(u),o.push(m))}return a}(this.ids,this.coords,t,e,n,this.nodeSize)}}const D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},R=Math.fround||(L=new Float32Array(1),t=>(L[0]=+t,L[0]));var L;class F{constructor(t){this.options=G(Object.create(D),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:i,nodeSize:r}=this.options;e&&console.time("total time");const s=`prepare ${t.length} points`;e&&console.time(s),this.points=t;let o=[];for(let a=0;a<t.length;a++)t[a].geometry&&o.push(N(t[a],a));this.trees[i+1]=new z(o,Z,H,r,Float32Array),e&&console.timeEnd(s);for(let a=i;a>=n;a--){const t=+Date.now();o=this._cluster(o,a),this.trees[a]=new z(o,Z,H,r,Float32Array),e&&console.log("z%d: %d clusters in %dms",a,o.length,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,i,180,s],e),o=this.getClusters([-180,i,r,s],e);return t.concat(o)}const o=this.trees[this._limitZoom(e)],a=o.range(j(n),q(s),j(r),q(i)),l=[];for(const c of a){const t=o.points[c];l.push(t.numPoints?V(t):this.points[t.index])}return l}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const s=r.points[e];if(!s)throw new Error(i);const o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=r.within(s.x,s.y,o),l=[];for(const c of a){const e=r.points[c];e.parentId===t&&l.push(e.numPoints?V(e):this.points[e.index])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){const i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:s,radius:o}=this.options,a=o/s,l=(n-a)/r,c=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((e-a)/r,l,(e+1+a)/r,c),i.points,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-a/r,l,1,c),i.points,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,l,a/r,c),i.points,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,r){const s=this.getChildren(e);for(const o of s){const e=o.properties;if(e&&e.cluster?r+e.point_count<=i?r+=e.point_count:r=this._appendLeaves(t,e.cluster_id,n,i,r):r<i?r++:t.push(o),t.length===n)break}return r}_addTileFeatures(t,e,n,i,r,s){for(const o of t){const t=e[o],a=t.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(t.x*r-n)),Math.round(this.options.extent*(t.y*r-i))]],tags:a?U(t):this.points[t.index].properties};let c;a?c=t.id:this.options.generateId?c=t.index:this.points[t.index].id&&(c=this.points[t.index].id),void 0!==c&&(l.id=c),s.features.push(l)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:i,extent:r,reduce:s,minPoints:o}=this.options,a=i/(r*Math.pow(2,e));for(let l=0;l<t.length;l++){const i=t[l];if(i.zoom<=e)continue;i.zoom=e;const r=this.trees[e+1],c=r.within(i.x,i.y,a),u=i.numPoints||1;let h=u;for(const t of c){const n=r.points[t];n.zoom>e&&(h+=n.numPoints||1)}if(h>=o){let t=i.x*u,o=i.y*u,a=s&&u>1?this._map(i,!0):null;const d=(l<<5)+(e+1)+this.points.length;for(const n of c){const l=r.points[n];if(l.zoom<=e)continue;l.zoom=e;const c=l.numPoints||1;t+=l.x*c,o+=l.y*c,l.parentId=d,s&&(a||(a=this._map(i,!0)),s(a,this._map(l)))}i.parentId=d,n.push(B(t/h,o/h,d,h,a))}else if(n.push(i),h>1)for(const t of c){const i=r.points[t];i.zoom<=e||(i.zoom=e,n.push(i))}}return n}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?G({},t.properties):t.properties;const n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?G({},i):i}}function B(t,e,n,i,r){return{x:R(t),y:R(e),zoom:1/0,id:n,parentId:-1,numPoints:i,properties:r}}function N(t,e){const[n,i]=t.geometry.coordinates;return{x:R(j(n)),y:R(q(i)),zoom:1/0,index:e,parentId:-1}}function V(t){return{type:"Feature",id:t.id,properties:U(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),$(t.y)]}};var e}function U(t){const e=t.numPoints,n=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?Math.round(e/100)/10+"k":e;return G(G({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function j(t){return t/360+.5}function q(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function $(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function G(t,e){for(const n in e)t[n]=e[n];return t}function Z(t){return t.x}function H(t){return t.y}function W(t,e,n,i){for(var r,s=i,o=n-e>>1,a=n-e,l=t[e],c=t[e+1],u=t[n],h=t[n+1],d=e+3;d<n;d+=3){var p=X(t[d],t[d+1],l,c,u,h);if(p>s)r=d,s=p;else if(p===s){var f=Math.abs(d-o);f<a&&(r=d,a=f)}}s>i&&(r-e>3&&W(t,e,r,i),t[r+2]=s,n-r>3&&W(t,r,n,i))}function X(t,e,n,i,r,s){var o=r-n,a=s-i;if(0!==o||0!==a){var l=((t-n)*o+(e-i)*a)/(o*o+a*a);l>1?(n=r,i=s):l>0&&(n+=o*l,i+=a*l)}return(o=t-n)*o+(a=e-i)*a}function K(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Q(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)Q(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)Q(t,e[i][r])}(r),r}function Q(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function Y(t,e,n,i){if(e.geometry){var r=e.geometry.coordinates,s=e.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===s)J(r,a);else if("MultiPoint"===s)for(var c=0;c<r.length;c++)J(r[c],a);else if("LineString"===s)tt(r,a,o,!1);else if("MultiLineString"===s){if(n.lineMetrics){for(c=0;c<r.length;c++)tt(r[c],a=[],o,!1),t.push(K(l,"LineString",a,e.properties));return}et(r,a,o,!1)}else if("Polygon"===s)et(r,a,o,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(c=0;c<e.geometry.geometries.length;c++)Y(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];et(r[c],u,o,!0),a.push(u)}}t.push(K(l,s,a,e.properties))}}function J(t,e){e.push(nt(t[0])),e.push(it(t[1])),e.push(0)}function tt(t,e,n,i){for(var r,s,o=0,a=0;a<t.length;a++){var l=nt(t[a][0]),c=it(t[a][1]);e.push(l),e.push(c),e.push(0),a>0&&(o+=i?(r*c-l*s)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-s,2))),r=l,s=c}var u=e.length-3;e[2]=1,W(e,0,u,n),e[u+2]=1,e.size=Math.abs(o),e.start=0,e.end=e.size}function et(t,e,n,i){for(var r=0;r<t.length;r++){var s=[];tt(t[r],s,n,i),e.push(s)}}function nt(t){return t/360+.5}function it(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function rt(t,e,n,i,r,s,o,a){if(i/=e,s>=(n/=e)&&o<i)return t;if(o<n||s>=i)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(p>=n&&f<i)l.push(u);else if(!(f<n||p>=i)){var m=[];if("Point"===d||"MultiPoint"===d)st(h,m,n,i,r);else if("LineString"===d)ot(h,m,n,i,r,!1,a.lineMetrics);else if("MultiLineString"===d)lt(h,m,n,i,r,!1);else if("Polygon"===d)lt(h,m,n,i,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var _=[];lt(h[g],_,n,i,r,!0),_.length&&m.push(_)}if(m.length){if(a.lineMetrics&&"LineString"===d){for(g=0;g<m.length;g++)l.push(K(u.id,d,m[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(K(u.id,d,m,u.tags))}}}return l.length?l:null}function st(t,e,n,i,r){for(var s=0;s<t.length;s+=3){var o=t[s+r];o>=n&&o<=i&&(e.push(t[s]),e.push(t[s+1]),e.push(t[s+2]))}}function ot(t,e,n,i,r,s,o){for(var a,l,c=at(t),u=0===r?ut:ht,h=t.start,d=0;d<t.length-3;d+=3){var p=t[d],f=t[d+1],m=t[d+2],g=t[d+3],_=t[d+4],y=0===r?p:f,v=0===r?g:_,x=!1;o&&(a=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-_,2))),y<n?v>n&&(l=u(c,p,f,g,_,n),o&&(c.start=h+a*l)):y>i?v<i&&(l=u(c,p,f,g,_,i),o&&(c.start=h+a*l)):ct(c,p,f,m),v<n&&y>=n&&(l=u(c,p,f,g,_,n),x=!0),v>i&&y<=i&&(l=u(c,p,f,g,_,i),x=!0),!s&&x&&(o&&(c.end=h+a*l),e.push(c),c=at(t)),o&&(h+=a)}var b=t.length-3;p=t[b],f=t[b+1],m=t[b+2],(y=0===r?p:f)>=n&&y<=i&&ct(c,p,f,m),b=c.length-3,s&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&ct(c,c[0],c[1],c[2]),c.length&&e.push(c)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function lt(t,e,n,i,r,s){for(var o=0;o<t.length;o++)ot(t[o],e,n,i,r,s,!1)}function ct(t,e,n,i){t.push(e),t.push(n),t.push(i)}function ut(t,e,n,i,r,s){var o=(s-e)/(i-e);return t.push(s),t.push(n+(r-n)*o),t.push(1),o}function ht(t,e,n,i,r,s){var o=(s-n)/(r-n);return t.push(e+(i-e)*o),t.push(s),t.push(1),o}function dt(t,e){for(var n=[],i=0;i<t.length;i++){var r,s=t[i],o=s.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=pt(s.geometry,e);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var a=0;a<s.geometry.length;a++)r.push(pt(s.geometry[a],e))}else if("MultiPolygon"===o)for(r=[],a=0;a<s.geometry.length;a++){for(var l=[],c=0;c<s.geometry[a].length;c++)l.push(pt(s.geometry[a][c],e));r.push(l)}n.push(K(s.id,o,r,s.tags))}return n}function pt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function ft(t,e){if(t.transformed)return t;var n,i,r,s=1<<t.z,o=t.x,a=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(mt(c[i],c[i+1],e,s,o,a));else for(i=0;i<c.length;i++){var h=[];for(r=0;r<c[i].length;r+=2)h.push(mt(c[i][r],c[i][r+1],e,s,o,a));l.geometry.push(h)}}return t.transformed=!0,t}function mt(t,e,n,i,r,s){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-s))]}function gt(t,e,n,i,r){for(var s=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){o.numFeatures++,_t(o,t[a],s,r);var l=t[a].minX,c=t[a].minY,u=t[a].maxX,h=t[a].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),u>o.maxX&&(o.maxX=u),h>o.maxY&&(o.maxY=h)}return o}function _t(t,e,n,i){var r=e.geometry,s=e.type,o=[];if("Point"===s||"MultiPoint"===s)for(var a=0;a<r.length;a+=3)o.push(r[a]),o.push(r[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===s)yt(o,r,t,n,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(a=0;a<r.length;a++)yt(o,r[a],t,n,"Polygon"===s,0===a);else if("MultiPolygon"===s)for(var l=0;l<r.length;l++){var c=r[l];for(a=0;a<c.length;a++)yt(o,c[a],t,n,!0,0===a)}if(o.length){var u=e.tags||null;if("LineString"===s&&i.lineMetrics){for(var h in u={},e.tags)u[h]=e.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:u};null!==e.id&&(d.id=e.id),t.features.push(d)}}function yt(t,e,n,i,r,s){var o=i*i;if(i>0&&e.size<(r?o:i))n.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>o)&&(n.numSimplified++,a.push(e[l]),a.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,s=r-2;i<r;s=i,i+=2)n+=(t[i]-t[s])*(t[i+1]+t[s+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var o=t[i],a=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=o,t[r-1-i]=a}}(a,s),t.push(a)}}function vt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)Y(n,t.features[i],e,i);else Y(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=rt(t,1,-1-n,n,0,-1,2,e),s=rt(t,1,1-n,2+n,0,-1,2,e);return(r||s)&&(i=rt(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=dt(r,1).concat(i)),s&&(i=i.concat(dt(s,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(t,e,n){return 32*((1<<t)*n+e)+t}function bt(t,e){const n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);const r=new h(i.features);let s=g(r);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),e(null,{vectorTile:r,rawData:s.buffer})}vt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vt.prototype.splitTile=function(t,e,n,i,r,s,o){for(var a=[t,e,n,i],l=this.options,c=l.debug;a.length;){i=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();var u=1<<e,h=xt(e,n,i),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=gt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=t,r){if(e===l.maxZoom||e===r)continue;var f=1<<r-e;if(n!==Math.floor(s/f)||i!==Math.floor(o/f))continue}else if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==t.length){c>1&&console.time("clipping");var m,g,_,y,v,x,b=.5*l.buffer/l.extent,w=.5-b,C=.5+b,E=1+b;m=g=_=y=null,v=rt(t,u,n-b,n+C,0,d.minX,d.maxX,l),x=rt(t,u,n+w,n+E,0,d.minX,d.maxX,l),t=null,v&&(m=rt(v,u,i-b,i+C,1,d.minY,d.maxY,l),g=rt(v,u,i+w,i+E,1,d.minY,d.maxY,l),v=null),x&&(_=rt(x,u,i-b,i+C,1,d.minY,d.maxY,l),y=rt(x,u,i+w,i+E,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),a.push(m||[],e+1,2*n,2*i),a.push(g||[],e+1,2*n,2*i+1),a.push(_||[],e+1,2*n+1,2*i),a.push(y||[],e+1,2*n+1,2*i+1)}}},vt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,s=i.debug;if(t<0||t>24)return null;var o=1<<t,a=xt(t,e=(e%o+o)%o,n);if(this.tiles[a])return ft(this.tiles[a],r);s>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,c=t,u=e,h=n;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[xt(c,u,h)];return l&&l.source?(s>1&&console.log("found parent tile z%d-%d-%d",c,u,h),s>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,t,e,n),s>1&&console.timeEnd("drilling down"),this.tiles[a]?ft(this.tiles[a],r):null):null};class wt extends t.VectorTileWorkerSource{constructor(t,e,n,i,r){super(t,e,n,i,bt),r&&(this.loadGeoJSON=r)}loadData(e,n){const i=e&&e.request,r=i&&i.collectResourceTiming;this.loadGeoJSON(e,(s,a)=>{if(s||!a)return n(s);if("object"!=typeof a)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{o(a,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(t=>`${t.key}: ${t.message}`).join(", "));const i=a.features.filter(t=>n.value.evaluate({zoom:0},t));a={type:"FeatureCollection",features:i}}this._geoJSONIndex=e.cluster?new F(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const i={},r={},s={accumulated:null,zoom:0},o={properties:null},a=Object.keys(n);for(const l of a){const[e,s]=n[l],o=t.createExpression(s),a=t.createExpression("string"==typeof e?[e,["accumulated"],["get",l]]:e);i[l]=o.value,r[l]=a.value}return e.map=t=>{o.properties=t;const e={};for(const n of a)e[n]=i[n].evaluate(s,o);return e},e.reduce=(t,e)=>{o.properties=e;for(const n of a)s.accumulated=t[n],t[n]=r[n].evaluate(s,o)},e}(e)).load(a.features):function(t,e){return new vt(t,e)}(a,e.geojsonVtOptions)}catch(s){return n(s)}this.loaded={};const l={};if(r){const n=t.getPerformanceMeasurement(i);n&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}})}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class Ct{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,n){this.isSpriteLoaded=n;for(const i in this.workerSources[e]){const r=this.workerSources[e][i];for(const e in r)r[e]instanceof t.VectorTileWorkerSource&&(r[e].isSpriteLoaded=n,r[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,n){this.availableImages[t]=e;for(const i in this.workerSources[t]){const n=this.workerSources[t][i];for(const t in n)n[t].availableImages=e}n()}enableTerrain(t,e,n){this.terrain=e,n()}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(e,n,i){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).loadTile(r,i)}loadDEMTile(e,n,i){const r=this.enableTerrain?t.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(e,n.source).loadTile(r,i)}reloadTile(e,n,i){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).reloadTile(r,i)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,i){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();i(n?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),n)}}catch(t){i(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e}getWorkerSource(t,e,n){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:(e,n,i,r,s,o)=>{this.actor.send(e,n,i,t,s,o)},scheduler:this.actor.scheduler},this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded)),this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new s),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ct(self)),Ct}),i(0,function(t){var e=n;function n(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===i[e=t&&t.failIfMajorPerformanceCaveat]&&(i[e]=function(t){var e,i=function(t){var e=document.createElement("canvas"),i=Object.create(n.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,e.getContext("webgl",i)||e.getContext("experimental-webgl",i)}(t);if(!i)return!1;try{e=i.createShader(i.VERTEX_SHADER)}catch(t){return!1}return!(!e||i.isContextLost())&&(i.shaderSource(e,"void main() {}"),i.compileShader(e),!0===i.getShaderParameter(e,i.COMPILE_STATUS))}(e)),i[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var i={};function r(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!r(t[n],e[n]))return!1;return!0}return t===e}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const s={create:function(e,n,i){const r=t.window.document.createElement(e);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},o=t.window.document&&t.window.document.documentElement.style,a=o&&void 0!==o.userSelect?"userSelect":"WebkitUserSelect";let l;s.disableDrag=function(){o&&a&&(l=o[a],o[a]="none")},s.enableDrag=function(){o&&a&&(o[a]=l)},s.setTransform=function(t,e){t.style.transform=e};let c=!1;try{const e=Object.defineProperty({},"passive",{get(){c=!0}});t.window.addEventListener("test",e,e),t.window.removeEventListener("test",e,e)}catch(t){c=!1}s.addEventListener=function(t,e,n,i={}){t.addEventListener(e,n,"passive"in i&&c?i:i.capture)},s.removeEventListener=function(t,e,n,i={}){t.removeEventListener(e,n,"passive"in i&&c?i:i.capture)};const u=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",u,!0)};function h(e,n,i){const r=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.pointGeometry((i.clientX-n.left)*r,(i.clientY-n.top)*r)}s.suppressClick=function(){t.window.addEventListener("click",u,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",u,!0)},0)},s.mousePos=function(t,e){const n=t.getBoundingClientRect();return h(t,n,e)},s.touchPos=function(t,e){const n=t.getBoundingClientRect(),i=[];for(let r=0;r<e.length;r++)i.push(h(t,n,e[r]));return i},s.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},s.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};class d{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,n,i){const r=t.dot(n,this.dir);if(Math.abs(r)<1e-6)return!1;const s=t.dot(t.sub(t.create(),e,this.pos),n)/r,o=t.scaleAndAdd(t.create(),this.pos,this.dir,s);return t.copy(i,o),!0}}class p{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,n,i){const r=Math.pow(2,i),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const s=t.transformMat4([],i,e),o=1/s[3]/n*r;return t.mul(s,s,[o,o,1/s[3],o])}),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const n=t.sub([],s[e[0]],s[e[1]]),i=t.sub([],s[e[2]],s[e[1]]),r=t.normalize([],t.cross([],n,i)),o=-t.dot(r,s[e[1]]);return r.concat(o)});return new p(s,o)}}class f{constructor(e,n){this.min=e,this.max=n,this.center=t.scale([],t.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],i=t.clone(this.min),r=t.clone(this.max);for(let t=0;t<n.length;t++)i[t]=n[t]?this.min[t]:this.center[t],r[t]=n[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new f(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let r=0;r<e.planes.length;r++){const s=e.planes[r];let o=0;for(let e=0;e<n.length;e++)o+=t.dot$1(s,n[e])>=0;if(0===o)return 0;o!==n.length&&(i=!1)}if(i)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const s=e.points[r][t]-this.min[t];n=Math.min(n,s),i=Math.max(i,s)}if(i<0||n>this.max[t]-this.min[t])return 0}return 1}}function m(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class g extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let n=0;for(const i of t){if(i[0]<n||i[1]<i[0]||e<i[1])return!1;n=i[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const i of t)this.images[i]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const i={};for(const r of e){this.images[r]||this.fire(new t.Event("styleimagemissing",{id:r}));const e=this.images[r];e?i[r]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,i)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],i=this.getImage(e);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new t.ImagePosition(n,i);this.patterns[e]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:i}=t.potpack(e),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const s in this.patterns){const{bin:e}=this.patterns[s],n=e.x+1,i=e.y+1,o=this.images[s].data,a=o.width,l=o.height;t.RGBAImage.copy(o,r,{x:0,y:0},{x:n,y:i},{width:a,height:l}),t.RGBAImage.copy(o,r,{x:0,y:l-1},{x:n,y:i-1},{width:a,height:1}),t.RGBAImage.copy(o,r,{x:0,y:0},{x:n,y:i+l},{width:a,height:1}),t.RGBAImage.copy(o,r,{x:a-1,y:0},{x:n-1,y:i},{width:1,height:l}),t.RGBAImage.copy(o,r,{x:0,y:0},{x:n+a,y:i},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];m(t)&&this.updateImage(e,t)}}}const _=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return function([e,n,i]){const r=t.degToRad(n+90),s=t.degToRad(i);return{x:e*Math.cos(r)*Math.sin(s),y:e*Math.sin(r)*Math.sin(s),z:e*Math.cos(s),azimuthal:n,polar:i}}(e.expression.evaluate(n))}interpolate(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i),azimuthal:t.number(e.azimuthal,n.azimuthal,i),polar:t.number(e.polar,n.polar,i)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),y="-transition";class v extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(_),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(t.validateLight,e,n))for(const i in e){const n=e[i];t.endsWith(i,y)?this._transitionable.setTransition(i.slice(0,-y.length),n):this._transitionable.setValue(i,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const x=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)}),b="-transition";class w extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(x),this.set(e),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(e){for(const n in e){const i=e[n];t.endsWith(n,b)?this._transitionable.setTransition(n.slice(0,-b.length),i):this._transitionable.setValue(n,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}class C{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]}getDashRanges(t,e,n){const i=[];let r=t.length%2==1?-t[t.length-1]*n:0,s=t[0]*n,o=!0;i.push({left:r,right:s,isDash:o,zeroLength:0===t[0]});let a=t[0];for(let l=1;l<t.length;l++){o=!o;const e=t[l];r=a*n,a+=e,s=a*n,i.push({left:r,right:s,isDash:o,zeroLength:0===e})}return i}addRoundDash(t,e,n){const i=e/2;for(let r=-n;r<=n;r++){const e=this.width*(this.nextRow+n+r);let s=0,o=t[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=t[++s]);const l=Math.abs(a-o.left),c=Math.abs(a-o.right),u=Math.min(l,c);let h;const d=r/n*(i+1);if(o.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.data[e+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let o=t.length-1;o>=0;--o){const e=t[o],n=t[o+1];e.zeroLength?t.splice(o,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(o,1))}const e=t[0],n=t[t.length-1];e.isDash===n.isDash&&(e.left=n.left-this.width,n.right=e.right+this.width);const i=this.width*this.nextRow;let r=0,s=t[r];for(let o=0;o<this.width;o++){o/s.right>1&&(s=t[++r]);const e=Math.abs(o-s.left),n=Math.abs(o-s.right),a=Math.min(e,n);this.data[i+o]=Math.max(0,Math.min(255,(s.isDash?a:-a)+128))}}addDash(e,n){const i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.warnOnce("LineAtlas out of space"),null;0===e.length&&e.push(1);let s=0;for(let a=0;a<e.length;a++)e[a]<0&&(t.warnOnce("Negative value is found in line dasharray, replacing values with 0"),e[a]=0),s+=e[a];if(0!==s){const t=this.width/s,r=this.getDashRanges(e,this.width,t);n?this.addRoundDash(r,t,i):this.addRegularDash(r)}const o={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:s};return this.nextRow+=r,this.dirty=!0,o}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}class E{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const i=this.workerPool.acquire(this.id);for(let t=0;t<i.length;t++){const e=new E.Actor(i[t],n,this.id);e.name=`Worker ${t}`,this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,i){t.asyncAll(this.actors,(t,i)=>{t.send(e,n,i)},i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function S(e,n,i){return n*(t.EXTENT/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}E.Actor=t.Actor;class T{constructor(t,e,n,i){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(t=>i.pointCoordinate3D(t)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(e,n){let i,r;if(e instanceof t.pointGeometry||"number"==typeof e[0]){const s=t.pointGeometry.convert(e);i=[t.pointGeometry.convert(e)],r=n.isPointAboveHorizon(s)}else{const s=t.pointGeometry.convert(e[0]),o=t.pointGeometry.convert(e[1]);i=[s,o],r=t.polygonizeBounds(s,o).every(t=>n.isPointAboveHorizon(t))}return new T(i,n.getCameraPoint(),r,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.pointGeometry(1,1)):this.screenBounds[1],r=t.polygonizeBounds(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?r[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(r[3]=this.cameraPoint)),t.bufferConvexPolygon(r,e)}containsTile(e,n,i){const r=e.queryPadding+1,s=i?this._bufferedCameraMercator(r,n).map(t=>e.tileID.getTilePoint(t)):this._bufferedScreenMercator(r,n).map(t=>e.tileID.getTilePoint(t)),o=this.screenGeometryMercator.map(t=>e.tileID.getTileVec3(t)),a=o.map(e=>new t.pointGeometry(e[0],e[1])),l=n.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),c=e.tileID.getTileVec3(l),u=o.map(e=>{const n=t.sub(e,e,c);return t.normalize(n,n),new d(c,n)}),h=S(e,1,n.zoom);if(t.polygonIntersectsBox(s,0,0,t.EXTENT,t.EXTENT))return{queryGeometry:this,tilespaceGeometry:a,tilespaceRays:u,bufferedTilespaceGeometry:s,bufferedTilespaceBounds:(p=t.getBounds(s),p.min.x=t.clamp(p.min.x,0,t.EXTENT),p.min.y=t.clamp(p.min.y,0,t.EXTENT),p.max.x=t.clamp(p.max.x,0,t.EXTENT),p.max.y=t.clamp(p.max.y,0,t.EXTENT),p),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:h};var p}_bufferedScreenMercator(t,e){const n=M(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{const i=this.bufferedScreenGeometry(t).map(t=>e.pointCoordinate3D(t));return this._screenRaycastCache[n]=i,i}}_bufferedCameraMercator(t,e){const n=M(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{const i=this.bufferedCameraGeometry(t).map(t=>e.pointCoordinate3D(t));return this._cameraRaycastCache[n]=i,i}}}function M(t){return 100*t|0}function A(e,n,i){const r=function(r,s){if(r)return i(r);if(s){const r=t.pick(t.extend(s,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);s.vector_layers&&(r.vectorLayers=s.vector_layers,r.vectorLayerIds=r.vectorLayers.map(t=>t.id)),r.tiles=n.canonicalizeTileset(r,e.url),i(null,r)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.exported.frame(()=>r(null,e))}class k{constructor(e,n,i){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),i=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),s=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),o=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=i&&e.x<s&&e.y>=r&&e.y<o}}class P{constructor(t,e,n){this.context=t;const i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const I={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class O{constructor(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],s=e.attributes[r.name];void 0!==s&&t.vertexAttribPointer(s,r.components,t[I[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class z{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class D extends z{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class R extends z{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class L extends z{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class F extends z{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class B extends z{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class N extends z{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class V extends z{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class U extends z{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class j extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class q extends z{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class $ extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class G extends z{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Z extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class H extends z{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class W extends z{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class X extends z{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class K extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class Q extends z{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Y extends z{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class J extends z{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class tt extends z{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class et extends z{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class nt extends z{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class it extends z{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class rt extends z{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class st extends z{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ot extends z{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class at extends z{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class lt extends z{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ct extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ut extends z{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class ht extends z{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class dt extends ht{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class pt extends ht{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ft extends pt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class mt{constructor(t,e,n,i){this.context=t,this.width=e,this.height=n;const r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new dt(t,r),i&&(this.depthAttachment=new pt(t,r))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class gt{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new D(this),this.clearDepth=new R(this),this.clearStencil=new L(this),this.colorMask=new F(this),this.depthMask=new B(this),this.stencilMask=new N(this),this.stencilFunc=new V(this),this.stencilOp=new U(this),this.stencilTest=new j(this),this.depthRange=new q(this),this.depthTest=new $(this),this.depthFunc=new G(this),this.blend=new Z(this),this.blendFunc=new H(this),this.blendColor=new W(this),this.blendEquation=new X(this),this.cullFace=new K(this),this.cullFaceSide=new Q(this),this.frontFace=new Y(this),this.program=new J(this),this.activeTexture=new tt(this),this.viewport=new et(this),this.bindFramebuffer=new nt(this),this.bindRenderbuffer=new it(this),this.bindTexture=new rt(this),this.bindVertexBuffer=new st(this),this.bindElementBuffer=new ot(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new at(this),this.pixelStoreUnpack=new lt(this),this.pixelStoreUnpackPremultiplyAlpha=new ct(this),this.pixelStoreUnpackFlipY=new ut(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new P(this,t,e)}createVertexBuffer(t,e,n){return new O(this,t,e,n)}createRenderbuffer(t,e,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,n){return new mt(this,t,e,n)}clear({color:t,depth:e,stencil:n}){const i=this.gl;let r=0;t&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==n&&(r|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){r(e.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class _t extends t.Evented{constructor(e,n,i,r){super(),this.id=e,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,(e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new k(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const i=t.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(i,r)=>{if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData(r),delete r.cacheControl,delete r.expires;const i=this.map.painter.context,s=i.gl;e.texture=this.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new t.Texture(i,r,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),n(null)}})}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}var yt=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class vt extends t.Evented{constructor(t,e,n,i){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}load(e,n){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(i,r)=>{this._loaded=!0,i?this.fire(new t.ErrorEvent(i)):r&&(this.image=r,e&&(this.coordinates=e),n&&n(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(e){this.coordinates=e;const n=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){let n=1/0,i=1/0,r=-1/0,s=-1/0;for(const t of e)n=Math.min(n,t.x),i=Math.min(i,t.y),r=Math.max(r,t.x),s=Math.max(s,t.y);const o=Math.max(r-n,s-i),a=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((n+r)/2*l),Math.floor((i+s)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const i=n.map(t=>this.tileID.getTilePoint(t)._round());return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const xt={vector:class extends t.Evented{constructor(e,n,i,r){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,(e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new k(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t();const e=this.map.style._getSourceCaches(this.id);for(const n of e)n.clearTiles();this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(i,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",r,s.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",r,s.bind(this),void 0,!0);else{const n=t.loadVectorTile.call({deduped:this._deduped},r,(t,n)=>{t||!n?s.call(this,t):(r.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",r,s.bind(this),void 0,!0))},!0);e.request={cancel:n}}function s(i,r){return delete e.request,e.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:_t,"raster-dem":class extends _t{constructor(e,n,i,r){super(e,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,s){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(s){this.map._refreshExpiredTiles&&e.setExpiryData(s),delete s.cacheControl,delete s.expires;const n=t.window.ImageBitmap&&s instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported(),i=1-(s.width-t.prevPowerOfTwo(s.width))/2;i<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const o=n?s:t.exported.getImageData(s,i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding,padding:i};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",a,r.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(e){const n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,s=0===n.x?e.wrap-1:e.wrap,o=(n.x+1+i)%i,a=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,s,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,s,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,s,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,o,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,n,i,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const s=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*s,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*s,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*s,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},i),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(n),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,(e,n)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(e.resourceTiming=n.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,n){const i=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(i,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(t,r)=>(delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(r,this.map.painter,"reloadTile"===i),n(null))),void 0,"loadTile"===i)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends vt{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,(e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:vt,canvas:class extends vt{constructor(e,n,i,r){super(e,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(t=>!Array.isArray(t)||2!==t.length||t.some(t=>"number"!=typeof t))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,i=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,i.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}},bt=function(e,n,i,r){const s=new xt[n.type](e,n,i,r);if(s.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${s.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],s),s};function wt(e,n){const i=t.identity([]);return t.scale$1(i,i,[.5*e.width,.5*-e.height,1]),t.translate(i,i,[1,-1,0]),t.multiply(i,i,e.calculatePosMatrix(n.toUnwrapped()))}function Ct(t,e,n,i,r,s,o,a=!1){const l=t.tilesIn(i,o,a);l.sort(St);const c=[];for(const h of l)c.push({wrappedTileID:h.tile.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(e,n,t._state,h,r,s,wt(t.transform,h.tile.tileID),a)});const u=function(t){const e={},n={};for(const i of t){const t=i.queryResults,r=i.wrappedTileID,s=n[r]=n[r]||{};for(const n in t){const i=t[n],r=s[n]=s[n]||{},o=e[n]=e[n]||[];for(const t of i)r[t.featureIndex]||(r[t.featureIndex]=!0,o.push(t))}}return e}(c);for(const h in u)u[h].forEach(e=>{const n=e.feature,i=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i});return u}function Et(t,e){const n=t.getRenderableIds().map(e=>t.getTileByID(e)),i=[],r={};for(let s=0;s<n.length;s++){const t=n[s],o=t.tileID.canonical.key;r[o]||(r[o]=!0,t.querySourceFeatures(i,e))}return i}function St(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function Tt(){return null!=Fr.workerClass?new Fr.workerClass:new t.window.Worker(Fr.workerUrl)}const Mt="mapboxgl_preloaded_worker_pool";class At{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new Tt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Mt]}numActive(){return Object.keys(this.active).length}}let kt;function Pt(){return kt||(kt=new At),kt}function It(e,n){const i={};for(const t in e)"ref"!==t&&(i[t]=e[t]);return t.refProperties.forEach(t=>{t in n&&(i[t]=n[t])}),i}function Ot(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=It(t[n],e[t[n].ref]));return t}At.workerCount=2;const zt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain"};function Dt(t,e,n){n.push({command:zt.addSource,args:[t,e[t]]})}function Rt(t,e,n){e.push({command:zt.removeSource,args:[t]}),n[t]=!0}function Lt(t,e,n,i){Rt(t,n,i),Dt(t,e,n)}function Ft(t,e,n){let i;for(i in t[n])if(t[n].hasOwnProperty(i)&&"data"!==i&&!r(t[n][i],e[n][i]))return!1;for(i in e[n])if(e[n].hasOwnProperty(i)&&"data"!==i&&!r(t[n][i],e[n][i]))return!1;return!0}function Bt(t,e,n,i,s,o){let a;for(a in e=e||{},t=t||{})t.hasOwnProperty(a)&&(r(t[a],e[a])||n.push({command:o,args:[i,a,e[a],s]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(r(t[a],e[a])||n.push({command:o,args:[i,a,e[a],s]}))}function Nt(t){return t.id}function Vt(t,e){return t[e.id]=e,t}class Ut{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,i=this._distances[n];const r=e*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const s=n-1,o=this._distances[s],a=i-o,l=a>0?(r-o)/a:0;return this.points[s].mult(1-l).add(this.points[n].mult(l))}}class jt{constructor(t,e,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let s=0;s<this.xCellCount*this.yCellCount;s++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)}_insertBoxCell(t,e,n,i,r,s){this.boxCells[r].push(s)}_insertCircleCell(t,e,n,i,r,s){this.circleCells[r].push(s)}_query(t,e,n,i,r,s){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];const o=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(let t=0;t<this.boxKeys.length;t++)o.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],i=this.circles[3*t+2];o.push({key:this.circleKeys[t],x1:e-i,y1:n-i,x2:e+i,y2:n+i})}return s?o.filter(s):o}return this._forEachCell(t,e,n,i,this._queryCell,o,{hitTest:r,seenUids:{box:{},circle:{}}},s),r?o.length>0:o}_queryCircle(t,e,n,i,r){const s=t-n,o=t+n,a=e-n,l=e+n;if(o<0||s>this.width||l<0||a>this.height)return!i&&[];const c=[];return this._forEachCell(s,a,o,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),i?c.length>0:c}query(t,e,n,i,r){return this._query(t,e,n,i,!1,r)}hitTest(t,e,n,i,r){return this._query(t,e,n,i,!0,r)}hitTestCircle(t,e,n,i){return this._queryCircle(t,e,n,!0,i)}_queryCell(t,e,n,i,r,s,o,a){const l=o.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(t<=r[c+2]&&e<=r[c+3]&&n>=r[c+0]&&i>=r[c+1]&&(!a||a(this.boxKeys[u]))){if(o.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[u],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]})}}}const u=this.circleCells[r];if(null!==u){const r=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(r[u],r[u+1],r[u+2],t,e,n,i)&&(!a||a(this.circleKeys[c]))){if(o.hitTest)return s.push(!0),!0;{const t=r[u],e=r[u+1],n=r[u+2];s.push({key:this.circleKeys[c],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,i,r,s,o,a){const l=o.circle,c=o.seenUids,u=this.boxCells[r];if(null!==u){const t=this.bboxes;for(const e of u)if(!c.box[e]){c.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!a||a(this.boxKeys[e])))return s.push(!0),!0}}const h=this.circleCells[r];if(null!==h){const t=this.circles;for(const e of h)if(!c.circle[e]){c.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return s.push(!0),!0}}}_forEachCell(t,e,n,i,r,s,o,a){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,t,e,n,i,this.xCellCount*l+d,s,o,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,i,r,s){const o=i-t,a=r-e,l=n+s;return l*l>o*o+a*a}_circleAndRectCollide(t,e,n,i,r,s,o){const a=(s-i)/2,l=Math.abs(t-(i+a));if(l>a+n)return!1;const c=(o-r)/2,u=Math.abs(e-(r+c));if(u>c+n)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=n*n}}function qt(e,n,i,r,s){const o=t.create$1();return n?(t.scale$1(o,o,[1/s,1/s,1]),i||t.rotateZ(o,o,r.angle)):t.multiply(o,r.labelPlaneMatrix,e),o}function $t(e,n,i,r,s){if(n){const n=t.clone$1(e);return t.scale$1(n,n,[s,s,1]),i||t.rotateZ(n,n,-r.angle),n}return r.glCoordMatrix}function Gt(e,n,i=0){const r=[e.x,e.y,i,1];i?t.transformMat4(r,r,n):ne(r,r,n);const s=r[3];return{point:new t.pointGeometry(r[0]/s,r[1]/s),signedDistanceFromCamera:s}}function Zt(t,e){return Math.min(.5+t/e*.5,1.5)}function Ht(t,e){const n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function Wt(e,n,i,r,s,o,a,l,c){const u=r?e.textSizeData:e.iconSizeData,h=t.evaluateSizeForZoom(u,i.transform.zoom),d=[256/i.width*2+1,256/i.height*2+1],p=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();const f=e.lineVertexArray,m=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,g=i.transform.width/i.transform.height;let _=!1;for(let y=0;y<m.length;y++){const r=m.get(y);if(r.hidden||r.writingMode===t.WritingMode.vertical&&!_){ee(r.numGlyphs,p);continue}_=!1;const v=c?c({x:r.anchorX,y:r.anchorY}):0,x=[r.anchorX,r.anchorY,v,1];if(t.transformMat4(x,x,n),!Ht(x,d)){ee(r.numGlyphs,p);continue}const b=Zt(i.transform.cameraToCenterDistance,x[3]),w=t.evaluateSizeForFeature(u,h,r),C=a?w/b:w*b,E=new t.pointGeometry(r.anchorX,r.anchorY),S=Gt(E,s,v);if(S.signedDistanceFromCamera<=0){ee(r.numGlyphs,p);continue}const T=S.point;let M={};const A=a?null:c,k=Qt(r,C,!1,l,n,s,o,e.glyphOffsetArray,f,p,T,E,M,g,A);_=k.useVertical,A&&k.needsFlipping&&(M={}),(k.notEnoughRoom||_||k.needsFlipping&&Qt(r,C,!0,l,n,s,o,e.glyphOffsetArray,f,p,T,E,M,g,A).notEnoughRoom)&&ee(r.numGlyphs,p)}r?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function Xt(t,e,n,i,r,s,o,a,l,c,u,h,d){const p=a.glyphStartIndex+a.numGlyphs,f=a.lineStartIndex,m=a.lineStartIndex+a.lineLength,g=e.getoffsetX(a.glyphStartIndex),_=e.getoffsetX(p-1),y=Jt(t*g,n,i,r,s,o,a.segment,f,m,l,c,u,h,d,!0);if(!y)return null;const v=Jt(t*_,n,i,r,s,o,a.segment,f,m,l,c,u,h,d,!0);return v?{first:y,last:v}:null}function Kt(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function Qt(e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const g=n/24,_=e.lineOffsetX*g,y=e.lineOffsetY*g;let v;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,n=e.lineStartIndex,s=e.lineStartIndex+e.lineLength,u=Xt(g,l,_,y,i,h,d,e,c,o,p,m);if(!u)return{notEnoughRoom:!0};const x=Gt(u.first.point,a).point,b=Gt(u.last.point,a).point;if(r&&!i){const t=Kt(e.writingMode,x,b,f);if(t)return t}v=[u.first];for(let r=e.glyphStartIndex+1;r<t-1;r++)v.push(Jt(g*l.getoffsetX(r),_,y,i,h,d,e.segment,n,s,c,o,p,m));v.push(u.last)}else{if(r&&!i){const n=Gt(d,s).point,i=e.lineStartIndex+e.segment+1,r=new t.pointGeometry(c.getx(i),c.gety(i)),o=Gt(r,s),a=o.signedDistanceFromCamera>0?o.point:Yt(d,r,n,1,s),l=Kt(e.writingMode,n,a,f);if(l)return l}const n=Jt(g*l.getoffsetX(e.glyphStartIndex),_,y,i,h,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,o,p,m);if(!n)return{notEnoughRoom:!0};v=[n]}for(const x of v)t.addDynamicAttributes(u,x.point,x.angle);return{}}function Yt(t,e,n,i,r,s){const o=t.add(t.sub(e)._unit()),a=Gt(o,r,s?s(o):0).point,l=n.sub(a);return n.add(l._mult(i/l.mag()))}function Jt(e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const g=r?e-n:e+n;let _=g>0?1:-1,y=0;r&&(_*=-1,y=Math.PI),_<0&&(y+=Math.PI);let v=_>0?l+a:l+a+1,x=s,b=s,w=0,C=0;const E=Math.abs(g),S=[],T=[];let M=o;const A=()=>{const e=v-_;return 0===w?o:new t.pointGeometry(u.getx(e),u.gety(e))},k=()=>Yt(A(),M,b,E-w+1,h,p);for(;w+C<=E;){if(v+=_,v<l||v>=c)return null;if(b=x,S.push(x),f&&T.push(M||A()),x=d[v],void 0===x){M=new t.pointGeometry(u.getx(v),u.gety(v));const e=Gt(M,h,p?p(M):0);x=e.signedDistanceFromCamera>0?d[v]=e.point:k()}else M=null;w+=C,C=b.dist(x)}m&&p&&(M=M||new t.pointGeometry(u.getx(v),u.gety(v)),d[v]=x=void 0===d[v]?x:k(),C=b.dist(x));const P=(E-w)/C,I=x.sub(b),O=I.mult(P)._add(b);i&&O._add(I._unit()._perp()._mult(i*_));const z=y+Math.atan2(x.y-b.y,x.x-b.x);return S.push(O),f&&(M=M||new t.pointGeometry(u.getx(v),u.gety(v)),T.push(function(e,n,i){const r=1-i;return new t.pointGeometry(e.x*r+n.x*i,e.y*r+n.y*i)}(T.length>0?T[T.length-1]:M,M,P))),{point:O,angle:z,path:S,tilePath:T}}const te=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ee(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(te,3*t)}}function ne(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}const ie=100;class re{constructor(t,e=new jt(t.width+200,t.height+200,25),n=new jt(t.width+200,t.height+200,25)){this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ie,this.screenBottomBoundary=t.height+ie,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200}placeCollisionBox(t,e,n,i,r,s,o){const a=this.projectAndGetPerspectiveRatio(s,e.anchorPointX,e.anchorPointY,e.elevation),l=r*a.perspectiveRatio,c=(e.x1*t+n.x-e.padding)*l+a.point.x,u=(e.y1*t+n.y-e.padding)*l+a.point.y,h=(e.x2*t+n.x+e.padding)*l+a.point.x,d=(e.y2*t+n.y+e.padding)*l+a.point.y,p=a.perspectiveRatio<=.55||a.aboveHorizon;return!this.isInsideGrid(c,u,h,d)||!i&&this.grid.hitTest(c,u,h,d,o)||p?{box:[],offscreen:!1}:{box:[c,u,h,d],offscreen:this.isOffscreen(c,u,h,d)}}placeCollisionCircles(e,n,i,r,s,o,a,l,c,u,h,d,p,f){const m=[],g=this.transform.elevation,_=g?t=>g.getAtTileOffset(f,t.x,t.y):t=>0,y=new t.pointGeometry(n.anchorX,n.anchorY),v=_(y),x=this.projectAndGetPerspectiveRatio(o,y.x,y.y,v),{perspectiveRatio:b}=x,w=(u?s/b:s*b)/t.ONE_EM,C=Gt(y,a,v).point,E=x.signedDistanceFromCamera>0?Xt(w,r,n.lineOffsetX*w,n.lineOffsetY*w,!1,C,y,n,i,a,{},g&&!u?_:null,u&&!!g):null;let S=!1,T=!1,M=!0;if(E&&!x.aboveHorizon){const n=.5*d*b+p,i=new t.pointGeometry(-100,-100),r=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),s=new Ut,o=E.first,a=E.last;let u=[];for(let t=o.path.length-1;t>=1;t--)u.push(o.path[t]);for(let t=1;t<a.path.length;t++)u.push(a.path[t]);const f=2.5*n;if(l){const t=u.map(g?(t,e)=>{const n=_(e<o.path.length-1?o.tilePath[o.path.length-1-e]:a.tilePath[e-o.path.length+2]);return Gt(t,l,n)}:t=>Gt(t,l));u=t.some(t=>t.signedDistanceFromCamera<=0)?[]:t.map(t=>t.point)}let y=[];if(u.length>0){const e=u[0].clone(),n=u[0].clone();for(let t=1;t<u.length;t++)e.x=Math.min(e.x,u[t].x),e.y=Math.min(e.y,u[t].y),n.x=Math.max(n.x,u[t].x),n.y=Math.max(n.y,u[t].y);y=e.x>=i.x&&n.x<=r.x&&e.y>=i.y&&n.y<=r.y?[u]:n.x<i.x||e.x>r.x||n.y<i.y||e.y>r.y?[]:t.clipLine([u],i.x,i.y,r.x,r.y)}for(const t of y){s.reset(t,.25*n);let i=0;i=s.length<=.5*n?1:Math.ceil(s.paddedLength/f)+1;for(let t=0;t<i;t++){const r=t/Math.max(i-1,1),o=s.lerp(r),a=o.x+ie,l=o.y+ie;m.push(a,l,n,0);const u=a-n,d=l-n,p=a+n,f=l+n;if(M=M&&this.isOffscreen(u,d,p,f),T=T||this.isInsideGrid(u,d,p,f),!e&&this.grid.hitTestCircle(a,l,n,h)&&(S=!0,!c))return{circles:[],offscreen:!1,collisionDetected:S}}}}return{circles:!c&&S||!T?[]:m,offscreen:M,collisionDetected:S}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,r=1/0,s=-1/0,o=-1/0;for(const u of e){const e=new t.pointGeometry(u.x+ie,u.y+ie);i=Math.min(i,e.x),r=Math.min(r,e.y),s=Math.max(s,e.x),o=Math.max(o,e.y),n.push(e)}const a=this.grid.query(i,r,s,o).concat(this.ignoredGrid.query(i,r,s,o)),l={},c={};for(const u of a){const e=u.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const i=[new t.pointGeometry(u.x1,u.y1),new t.pointGeometry(u.x2,u.y1),new t.pointGeometry(u.x2,u.y2),new t.pointGeometry(u.x1,u.y2)];t.polygonIntersectsPolygon(n,i)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===c[e.bucketInstanceId]&&(c[e.bucketInstanceId]=[]),c[e.bucketInstanceId].push(e.featureIndex))}return c}insertCollisionBox(t,e,n,i,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,i,r){const s=e?this.ignoredGrid:this.grid,o={bucketInstanceId:n,featureIndex:i,collisionGroupID:r};for(let a=0;a<t.length;a+=4)s.insertCircle(o,t[a],t[a+1],t[a+2])}projectAndGetPerspectiveRatio(e,n,i,r){const s=[n,i,r||0,1];let o=!1;return r||this.transform.pitch>0?(t.transformMat4(s,s,e),o=s[2]>s[3]):ne(s,s,e),{point:new t.pointGeometry((s[0]/s[3]+1)/2*this.transform.width+ie,(-s[1]/s[3]+1)/2*this.transform.height+ie),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/s[3]*.5,1.5),signedDistanceFromCamera:s[3],aboveHorizon:o}}isOffscreen(t,e,n,i){return n<ie||t>=this.screenRightBoundary||i<ie||e>this.screenBottomBoundary}isInsideGrid(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}class se{constructor(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class oe{constructor(t,e,n,i,r){this.text=new se(t?t.text:null,e,n,r),this.icon=new se(t?t.icon:null,e,i,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ae{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class le{constructor(){this.invProjMatrix=t.create$1(),this.viewportMatrix=t.create$1(),this.circles=[]}}class ce{constructor(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class ue{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function he(e,n,i,r,s){const{horizontalAlign:o,verticalAlign:a}=t.getAnchorAlignment(e),l=-(o-.5)*n,c=-(a-.5)*i,u=t.evaluateVariableOffset(e,r);return new t.pointGeometry(l+u[0]*s,c+u[1]*s)}function de(e,n,i,r,s){const o=new t.pointGeometry(e,n);return i&&o._rotate(r?s:-s),o}class pe{constructor(t,e,n,i){this.transform=t.clone(),this.collisionIndex=new re(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ue(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,i,r){const s=i.getBucket(n),o=i.latestFeatureIndex;if(!s||!o||n.id!==s.layerIds[0])return;const a=i.collisionBoxArray,l=s.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),d="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),f=S(i,1,this.transform.zoom),m=qt(h,d,p,this.transform,f);let g=null;if(d){const e=$t(h,d,p,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[s.bucketInstanceId]=new ce(s.bucketInstanceId,o,s.sourceLayerIndex,s.index,i.tileID);const _={bucket:s,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:a,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(s.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(r)for(const t of s.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=t;e.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:_})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:_})}attemptAnchorPlacement(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,g,_){const y=[h.textOffset0,h.textOffset1],v=p.getSymbolInstanceTextSize(g,h,this.transform.zoom,d),x=he(t,n,i,y,r),b=this.collisionIndex.placeCollisionBox(v,e,de(x.x,x.y,s,o,this.transform.angle),u,a,l,c.predicate);if((!m||0!==this.collisionIndex.placeCollisionBox(p.getSymbolInstanceIconSize(_,this.transform.zoom,d),m,de(x.x,x.y,s,o,this.transform.angle),u,a,l,c.predicate).box.length)&&b.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(e=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:y,width:n,height:i,anchor:t,textBoxScale:r,prevAnchor:e},this.markUsedJustification(p,t,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[h.crossTileID]=f),{shift:x,placedGlyphBoxes:b}}}placeLayerBucketPart(e,n,i){const{bucket:r,layout:s,posMatrix:o,textLabelPlaneMatrix:a,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:u,collisionBoxArray:h,partiallyEvaluatedTextSize:d,partiallyEvaluatedIconSize:p,collisionGroup:f}=e.parameters,m=s.get("text-optional"),g=s.get("icon-optional"),_=s.get("text-allow-overlap"),y=s.get("icon-allow-overlap"),v="map"===s.get("text-rotation-alignment"),x="map"===s.get("text-pitch-alignment"),b="none"!==s.get("icon-text-fit"),w="viewport-y"===s.get("symbol-z-order"),C=_&&(y||!r.hasIconData()||g),E=y&&(_||!r.hasTextData()||m);!r.collisionArrays&&h&&r.deserializeCollisionBoxes(h),i&&r.updateCollisionDebugBuffers(this.transform.zoom,h);const S=(e,h,w)=>{if(n[e.crossTileID])return;if(u)return void(this.placements[e.crossTileID]=new ae(!1,!1,!1));let S=!1,T=!1,M=!0,A=null,k={box:null,offscreen:null},P={box:null,offscreen:null},I=null,O=null,z=null,D=0,R=0,L=0;w.textFeatureIndex?D=w.textFeatureIndex:e.useRuntimeCollisionCircles&&(D=e.featureIndex),w.verticalTextFeatureIndex&&(R=w.verticalTextFeatureIndex);const F=t=>{(this.transform.elevation||t.elevation)&&(t.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[r.bucketInstanceId].tileID,t.anchorPointX,t.anchorPointY):0)},B=w.textBox;if(B){F(B);const n=n=>{let i=t.WritingMode.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,i=t,this.markUsedOrientation(r,i,e))}return i},i=(n,i)=>{if(r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&w.verticalTextBox){for(const e of r.writingModes)if(e===t.WritingMode.vertical?(k=i(),P=k):k=n(),k&&k.box&&k.box.length)break}else k=n()};if(s.get("text-variable-anchor")){let a=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];a.indexOf(t.anchor)>0&&(a=a.filter(e=>e!==t.anchor),a.unshift(t.anchor))}const l=(t,n,i)=>{const s=e.textBoxScale,l=(t.x2-t.x1)*s+2*t.padding,u=(t.y2-t.y1)*s+2*t.padding,m=b&&!y?n:null;m&&F(m);let g={box:[],offscreen:!1};const w=_?2*a.length:a.length;for(let _=0;_<w;++_){const n=this.attemptAnchorPlacement(a[_%a.length],t,l,u,s,v,x,c,o,f,_>=a.length,e,h,r,i,m,d,p);if(n&&(g=n.placedGlyphBoxes,g&&g.box&&g.box.length)){S=!0,A=n.shift;break}}return g};i(()=>l(B,w.iconBox,t.WritingMode.horizontal),()=>{const n=w.verticalTextBox;return n&&F(n),r.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&e.numVerticalGlyphVertices>0&&n?l(n,w.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}}),k&&(S=k.box,M=k.offscreen);const u=n(k&&k.box);if(!S&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(r,t.anchor,e,u))}}else{const s=(n,i)=>{const s=r.getSymbolInstanceTextSize(d,e,this.transform.zoom,h),a=this.collisionIndex.placeCollisionBox(s,n,new t.pointGeometry(0,0),_,c,o,f.predicate);return a&&a.box&&a.box.length&&(this.markUsedOrientation(r,i,e),this.placedOrientations[e.crossTileID]=i),a};i(()=>s(B,t.WritingMode.horizontal),()=>{const n=w.verticalTextBox;return r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?(F(n),s(n,t.WritingMode.vertical)):{box:null,offscreen:null}}),n(k&&k.box&&k.box.length)}}if(I=k,S=I&&I.box&&I.box.length>0,M=I&&I.offscreen,e.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),c=t.evaluateSizeForFeature(r.textSizeData,d,n),u=s.get("text-padding");O=this.collisionIndex.placeCollisionCircles(_,n,r.lineVertexArray,r.glyphOffsetArray,c,o,a,l,i,x,f.predicate,e.collisionCircleDiameter,u,this.retainedQueryData[r.bucketInstanceId].tileID),S=_||O.circles.length>0&&!O.collisionDetected,M=M&&O.offscreen}if(w.iconFeatureIndex&&(L=w.iconFeatureIndex),w.iconBox){const e=e=>{F(e);const n=b&&A?de(A.x,A.y,v,x,this.transform.angle):new t.pointGeometry(0,0),i=r.getSymbolInstanceIconSize(p,this.transform.zoom,h);return this.collisionIndex.placeCollisionBox(i,e,n,y,c,o,f.predicate)};P&&P.box&&P.box.length&&w.verticalIconBox?(z=e(w.verticalIconBox),T=z.box.length>0):(z=e(w.iconBox),T=z.box.length>0),M=M&&z.offscreen}const N=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,V=g||0===e.numIconVertices;if(N||V?V?N||(T=T&&S):S=T&&S:T=S=T&&S,S&&I&&I.box&&this.collisionIndex.insertCollisionBox(I.box,s.get("text-ignore-placement"),r.bucketInstanceId,P&&P.box&&R?R:D,f.ID),T&&z&&this.collisionIndex.insertCollisionBox(z.box,s.get("icon-ignore-placement"),r.bucketInstanceId,L,f.ID),O&&(S&&this.collisionIndex.insertCollisionCircles(O.circles,s.get("text-ignore-placement"),r.bucketInstanceId,D,f.ID),i)){const t=r.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new le);for(let n=0;n<O.circles.length;n+=4)e.circles.push(O.circles[n+0]),e.circles.push(O.circles[n+1]),e.circles.push(O.circles[n+2]),e.circles.push(O.collisionDetected?1:0)}this.placements[e.crossTileID]=new ae(S||C,T||E,M||r.justReloaded),n[e.crossTileID]=!0};if(w){const t=r.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];S(r.symbolInstances.get(n),n,r.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)S(r.symbolInstances.get(t),t,r.collisionArrays[t]);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[r.bucketInstanceId];t.invert(e.invProjMatrix,o),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(e,n,i,r){let s;s=r===t.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];const o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=s>=0&&t!==s?0:i.crossTileID)}markUsedOrientation(e,n,i){const r=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,s=n===t.WritingMode.vertical?n:0,o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=s)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},s=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const a in this.placements){const t=this.placements[a],e=r[a];e?(this.opacities[a]=new oe(e,i,t.text,t.icon),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[a]=new oe(null,i,t.text,t.icon,t.skipFade),n=n||t.text||t.icon)}for(const a in r){const t=r[a];if(!this.opacities[a]){const e=new oe(t,i,!1,!1);e.isHidden()||(this.opacities[a]=e,n=n||t.text.placed||t.icon.placed)}}for(const a in s)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=s[a]);for(const a in o)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=o[a]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const i of e){const e=i.getBucket(t);e&&i.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,i.collisionBoxArray)}}updateBucketOpacities(e,n,i){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const r=e.layers[0].layout,s=new oe(null,0,!1,!1,!0),o=r.get("text-allow-overlap"),a=r.get("icon-allow-overlap"),l=r.get("text-variable-anchor"),c="map"===r.get("text-rotation-alignment"),u="map"===r.get("text-pitch-alignment"),h="none"!==r.get("icon-text-fit"),d=new oe(null,0,o&&(a||!e.hasIconData()||r.get("icon-optional")),a&&(o||!e.hasTextData()||r.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const p=(t,e,n)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n)};for(let f=0;f<e.symbolInstances.length;f++){const i=e.symbolInstances.get(f),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:o,crossTileID:a}=i;let m=this.opacities[a];n[a]?m=s:m||(m=d,this.opacities[a]=m),n[a]=!0;const g=i.numIconVertices>0,_=this.placedOrientations[i.crossTileID],y=_===t.WritingMode.vertical,v=_===t.WritingMode.horizontal||_===t.WritingMode.horizontalOnly;if(r>0||o>0){const t=we(m.text);p(e.text,r,y?Ce:t),p(e.text,o,v?Ce:t);const n=m.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=n||y?1:0)}),i.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=n||v?1:0);const s=this.variableOffsets[i.crossTileID];s&&this.markUsedJustification(e,s.anchor,i,_);const a=this.placedOrientations[i.crossTileID];a&&(this.markUsedJustification(e,"left",i,a),this.markUsedOrientation(e,a,i))}if(g){const t=we(m.icon),n=!(h&&i.verticalPlacedIconSymbolIndex&&y);i.placedIconSymbolIndex>=0&&(p(e.icon,i.numIconVertices,n?t:Ce),e.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=m.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(p(e.icon,i.numVerticalIconVertices,n?Ce:t),e.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[f];if(n){let i=new t.pointGeometry(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(l){const e=this.variableOffsets[a];e?(i=he(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),c&&i._rotate(u?this.transform.angle:-this.transform.angle)):t=!1}n.textBox&&fe(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||y,i.x,i.y),n.verticalTextBox&&fe(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||v,i.x,i.y)}const r=Boolean(!v&&n.verticalIconBox);n.iconBox&&fe(e.iconCollisionBox.collisionVertexArray,m.icon.placed,r,h?i.x:0,h?i.y:0),n.verticalIconBox&&fe(e.iconCollisionBox.collisionVertexArray,m.icon.placed,!r,h?i.x:0,h?i.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function fe(t,e,n,i,r){t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0)}const me=Math.pow(2,25),ge=Math.pow(2,24),_e=Math.pow(2,17),ye=Math.pow(2,16),ve=Math.pow(2,9),xe=Math.pow(2,8),be=Math.pow(2,1);function we(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*me+e*ge+n*_e+e*ye+n*ve+e*xe+n*be+e}const Ce=0;class Ee{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,i,r){const s=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(s,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((t,e)=>t.sortKey-e.sortKey));this._currentPartIndex<s.length;)if(e.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1}}class Se{constructor(t,e,n,i,r,s,o){this.placement=new pe(t,r,s,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,n,i){const r=t.exported.now(),s=()=>{const e=t.exported.now()-r;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=r)&&(!t.maxzoom||t.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Ee(t)),this._inProgressLayer.continuePlacement(i[t.source],this.placement,this._showCollisionBoxes,t,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Te=512/t.EXTENT/2;class Me{constructor(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(let i=0;i<e.length;i++){const n=e.get(i),r=n.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}getScaledCoordinates(e,n){const i=Te/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}}findMatches(t,e,n){const i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const s=t.get(r);if(s.crossTileID)continue;const o=this.indexedSymbolInstances[s.key];if(!o)continue;const a=this.getScaledCoordinates(s,e);for(const t of o)if(Math.abs(t.coord.x-a.x)<=i&&Math.abs(t.coord.y-a.y)<=i&&!n[t.crossTileID]){n[t.crossTileID]=!0,s.crossTileID=t.crossTileID;break}}}}class Ae{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ke{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],i={};for(const n in t){const r=t[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),i[r.tileID.key]=r}this.indexes[n]=i}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const i=this.usedCrossTileIDs[t.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>t.overscaledZ)for(const r in n){const s=n[r];s.tileID.isChildOf(t)&&s.findMatches(e.symbolInstances,t,i)}else{const s=n[t.scaledTo(Number(r)).key];s&&s.findMatches(e.symbolInstances,t,i)}}for(let r=0;r<e.symbolInstances.length;r++){const t=e.symbolInstances.get(r);t.crossTileID||(t.crossTileID=n.generate(),i[t.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Me(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n in e.indexedSymbolInstances)for(const i of e.indexedSymbolInstances[n])delete this.usedCrossTileIDs[t][i.crossTileID]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e}}class Pe{constructor(){this.layerIndexes={},this.crossTileIDs=new Ae,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new ke);let r=!1;const s={};i.handleWrapJump(n);for(const o of e){const e=o.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(o.tileID,e,this.crossTileIDs)&&(r=!0),s[e.bucketInstanceId]=!0)}return i.removeStaleBuckets(s)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach(t=>{e[t]=!0});for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}const Ie=(e,n)=>t.emitValidationErrors(e,n&&n.filter(t=>"source.canvas"!==t.identifier)),Oe=t.pick(zt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain"]),ze=t.pick(zt,["setCenter","setZoom","setBearing","setPitch"]),De=function(){const e={},n=t.spec.$version;for(const i in t.spec.$root){const r=t.spec.$root[i];if(r.required){let t=null;t="version"===i?n:"array"===r.type?[]:{},null!=t&&(e[i]=t)}}return e}(),Re={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Le extends t.Evented{constructor(e,n={}){super(),this.map=e,this.dispatcher=new E(Pt(),this),this.imageManager=new g,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,n.localFontFamily?t.LocalGlyphMode.all:n.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.lineAtlas=new C(256,512),this.crossTileSymbolIndex=new Pe,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const i=this;this._rtlTextPluginCallback=Le.registerForPluginStateChange(e=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every(t=>t))for(const t in i._sourceCaches){const e=i._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}})}),this.on("data",t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const n in this._layers){const t=this._layers[n];t.source===e.id&&this._validateLayer(t)}})}loadURL(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);const r=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(r,(e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,i)})}loadJSON(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(e,!1!==n.validate)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(De,!1)}_updateLayerCount(t,e){const n=e?1:-1;t.is3D()&&(this._num3DLayers+=n),"circle"===t.type&&(this._numCircleLayers+=n),"symbol"===t.type&&(this._numSymbolLayers+=n)}_load(e,n){if(n&&Ie(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e;for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const i=Ot(this.stylesheet.layers);this._order=i.map(t=>t.id),this._layers={},this._serializedLayers={};for(let r of i)r=t.createStyleLayer(r),r.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=r,this._serializedLayers[r.id]=r.serialize(),this._updateLayerCount(r,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new v(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(e){this._spriteRequest=function(e,n,i){let r,s,o;const a=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,a,".json"),t.ResourceType.SpriteJSON),(t,e)=>{l=null,o||(o=t,r=e,u())}),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,a,".png"),t.ResourceType.SpriteImage),(t,e)=>{c=null,o||(o=t,s=e,u())});function u(){if(o)i(o);else if(r&&s){const e=t.exported.getImageData(s),n={};for(const i in r){const{width:s,height:o,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=r[i],f=new t.RGBAImage({width:s,height:o});t.RGBAImage.copy(e,f,{x:a,y:l},{x:0,y:0},{width:s,height:o}),n[i]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}i(null,n)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,(e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const i=e.sourceLayer;i&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Re[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];"reload"===t?this._reloadSource(e):"clear"===t&&this._clearSource(e)}this._updateTilesForChangedImages();for(const i in this._updatedPaintProps)this._layers[i].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}const i={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];i[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this._getLayerSourceCache(n);t&&(t.used=!0)}const i=this.map.painter;if(i){const t=n.getProgramIds();if(!t)continue;const r=n.getProgramConfiguration(e.zoom);for(const e of t)i.useProgram(e,r)}}for(const r in i){const e=this._sourceCaches[r];i[r]!==e.used&&e.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:e.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),Ie(this,t.validateStyle(e)))return!1;(e=t.clone$2(e)).layers=Ot(e.layers);const n=function(t,e){if(!t)return[{command:zt.setStyle,args:[e]}];let n=[];try{if(!r(t.version,e.version))return[{command:zt.setStyle,args:[e]}];r(t.center,e.center)||n.push({command:zt.setCenter,args:[e.center]}),r(t.zoom,e.zoom)||n.push({command:zt.setZoom,args:[e.zoom]}),r(t.bearing,e.bearing)||n.push({command:zt.setBearing,args:[e.bearing]}),r(t.pitch,e.pitch)||n.push({command:zt.setPitch,args:[e.pitch]}),r(t.sprite,e.sprite)||n.push({command:zt.setSprite,args:[e.sprite]}),r(t.glyphs,e.glyphs)||n.push({command:zt.setGlyphs,args:[e.glyphs]}),r(t.transition,e.transition)||n.push({command:zt.setTransition,args:[e.transition]}),r(t.light,e.light)||n.push({command:zt.setLight,args:[e.light]});const i={},s=[];!function(t,e,n,i){let s;for(s in e=e||{},t=t||{})t.hasOwnProperty(s)&&(e.hasOwnProperty(s)||Rt(s,n,i));for(s in e)e.hasOwnProperty(s)&&(t.hasOwnProperty(s)?r(t[s],e[s])||("geojson"===t[s].type&&"geojson"===e[s].type&&Ft(t,e,s)?n.push({command:zt.setGeoJSONSourceData,args:[s,e[s].data]}):Lt(s,e,n,i)):Dt(s,e,n))}(t.sources,e.sources,s,i);const o=[];t.layers&&t.layers.forEach(t=>{i[t.source]?n.push({command:zt.removeLayer,args:[t.id]}):o.push(t)});let a=t.terrain;a&&i[a.source]&&(n.push({command:zt.setTerrain,args:[void 0]}),a=void 0),n=n.concat(s),r(a,e.terrain)||n.push({command:zt.setTerrain,args:[e.terrain]}),function(t,e,n){e=e||[];const i=(t=t||[]).map(Nt),s=e.map(Nt),o=t.reduce(Vt,{}),a=e.reduce(Vt,{}),l=i.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<i.length;u++)d=i[u],a.hasOwnProperty(d)?h++:(n.push({command:zt.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<s.length;u++)d=s[s.length-1-u],l[l.length-1-u]!==d&&(o.hasOwnProperty(d)?(n.push({command:zt.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],n.push({command:zt.addLayer,args:[a[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<s.length;u++)if(d=s[u],p=o[d],f=a[d],!c[d]&&!r(p,f))if(r(p.source,f.source)&&r(p["source-layer"],f["source-layer"])&&r(p.type,f.type)){for(g in Bt(p.layout,f.layout,n,d,null,zt.setLayoutProperty),Bt(p.paint,f.paint,n,d,null,zt.setPaintProperty),r(p.filter,f.filter)||n.push({command:zt.setFilter,args:[d,f.filter]}),r(p.minzoom,f.minzoom)&&r(p.maxzoom,f.maxzoom)||n.push({command:zt.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Bt(p[g],f[g],n,d,g.slice(6),zt.setPaintProperty):r(p[g],f[g])||n.push({command:zt.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Bt(p[g],f[g],n,d,g.slice(6),zt.setPaintProperty):r(p[g],f[g])||n.push({command:zt.setLayerProperty,args:[d,g,f[g]]}))}else n.push({command:zt.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],n.push({command:zt.addLayer,args:[f,m]})}(o,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:zt.setStyle,args:[e]}]}return n}(this.serialize(),e).filter(t=>!(t.command in ze));if(0===n.length)return!1;const i=n.filter(t=>!(t.command in Oe));if(i.length>0)throw new Error(`Unimplemented: ${i.map(t=>t.command).join(", ")}.`);return n.forEach(t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args)}),this.stylesheet=e,!0}addImage(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,i={}){if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,`sources.${e}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=bt(e,n,this.dispatcher,this);r.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:r.serialize(),sourceId:e}));const s=n=>{const i=(n?"symbol:":"other:")+e,s=this._sourceCaches[i]=new t.SourceCache(i,r,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[e]=s,s.style=this,s.onAdd(this.map)};s(!1),"vector"!==n.type&&"geojson"!==n.type||s(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(void 0===n)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this._getSourceCaches(e);for(const r of i)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}addLayer(e,n,i={}){this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${r}" already exists on this map`)));let s;if("custom"===e.type){if(Ie(this,t.validateCustomStyleLayer(e)))return;s=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$2(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,`layers.${r}`,e,{arrayIndex:-1},i))return;s=t.createStyleLayer(e),this._validateLayer(s),s.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}const o=n?this._order.indexOf(n):this._order.length;if(n&&-1===o)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`)));this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=s;const a=this._getLayerSourceCache(s);if(this._removedLayers[r]&&s.source&&a&&"custom"!==s.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",a.pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const i=this._order.indexOf(e);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`))):(this._order.splice(r,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));n.setEventedParent(null),this._updateLayerCount(n,!1);const i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,n,i){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,n,i={}){this._checkLoaded();const s=this.getLayer(e);if(s){if(!r(s.filter,n))return null==n?(s.filter=void 0,void this._updateLayer(s)):void(this._validate(t.validateStyle.filter,`layers.${s.id}.filter`,n,null,i)||(s.filter=t.clone$2(n),this._updateLayer(s)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){return t.clone$2(this.getLayer(e).filter)}setLayoutProperty(e,n,i,s={}){this._checkLoaded();const o=this.getLayer(e);o?r(o.getLayoutProperty(n),i)||(o.setLayoutProperty(n,i,s),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,n){const i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,n,i,s={}){this._checkLoaded();const o=this.getLayer(e);o?r(o.getPaintProperty(n),i)||(o.setPaintProperty(n,i,s)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const i=e.source,r=e.sourceLayer,s=this.getSource(i);if(void 0===s)return void this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const o=s.type;if("geojson"===o&&r)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===o&&!r)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(i);for(const t of a)t.setFeatureState(r,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const i=e.source,r=this.getSource(i);if(void 0===r)return void this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const s=r.type,o="vector"===s?e.sourceLayer:void 0;if("vector"===s&&!o)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(i);for(const t of a)t.removeFeatureState(o,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,i=e.sourceLayer,r=this.getSource(n);if(void 0!==r){if("vector"!==r.type||i)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e,layers:this._serializeLayers(this._order)},t=>void 0!==t)}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},i=[];for(let s=this._order.length-1;s>=0;s--){const r=this._order[s];if(e(r)){n[r]=s;for(const e of t){const t=e[r];if(t)for(const e of t)i.push(e)}}}i.sort((t,e)=>e.intersectionZ-t.intersectionZ);const r=[];for(let s=this._order.length-1;s>=0;s--){const o=this._order[s];if(e(o))for(let t=i.length-1;t>=0;t--){const e=i[t].feature;if(n[e.layer.id]<s)break;r.push(e),i.pop()}else for(const e of t){const t=e[o];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];r[n.source]=!0}}const s=[];n.availableImages=this._availableImages;const o=n&&n.layers?n.layers.some(t=>{const e=this.getLayer(t);return e&&e.is3D()}):this.has3DLayers(),a=T.createFromScreenPoints(e,i);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;n.layers&&!r[e]||s.push(Ct(this._sourceCaches[t],this._layers,this._serializedLayers,a,n,i,o,!!this.map._showQueryGeometry))}return this.placement&&s.push(function(t,e,n,i,r,s,o){const a={},l=s.queryRenderedSymbols(i),c=[];for(const u of Object.keys(l).map(Number))c.push(o[u]);c.sort(St);for(const u of c){const n=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],e,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in n){const e=a[t]=a[t]||[],i=n[t];i.sort((t,e)=>{const n=u.featureSortOrder;if(n){const i=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex});for(const t of i)e.push(t)}}for(const u in a)a[u].forEach(e=>{const i=e.feature,r=n(t[u]).getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r});return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);const i=this._getSourceCaches(e);let r=[];for(const t of i)r=r.concat(Et(t,n));return r}addSourceType(t,e,n){return Le.getSourceType(t)?n(new Error(`A source type called "${t}" already exists.`)):(Le.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const i=this.light.getLight();let s=!1;for(const t in e)if(!r(e[t],i[t])){s=!0;break}if(!s)return;const o={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(o)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(e){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),void this._force3DLayerUpdate();if("object"==typeof e.source){const n="terrain-dem-src";this.addSource(n,e.source),e=t.clone$2(e),e=t.extend(e,{source:n})}if(!this._validate(t.validateStyle.terrain,"terrain",e)){if(this.terrain){const n=this.terrain,i=n.get();for(const s in e)if(!r(e[s],i[s])){n.set(e),this.stylesheet.terrain=e;const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i);break}}else this._createTerrain(e);this._updateDrapeFirstLayers()}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(t=>this.isLayerDraped(this._layers[t])),e=this._order.filter(t=>!this.isLayerDraped(this._layers[t]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(e){const n=this.terrain=new w(e);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const i={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(i)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_validate(e,n,i,r,s={}){return(!s||!1!==s.validate)&&Ie(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const n of e)n.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const n of e)n.resume(),n.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,i,r,s=!1){let o=!1,a=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this._getLayerSourceCache(n);if(!t)continue;l[n.source]=t.getRenderableIds(!0).map(e=>t.getTileByID(e)).sort((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1))}const i=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng);o=o||i}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===i,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Se(e,this._order,s,n,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const i=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};i(this._otherSourceCaches[e.source]),i(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,i){return t.makeRequest(n,i)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Le.getSourceType=function(t){return xt[t]},Le.setSourceType=function(t,e){xt[t]=e},Le.registerForPluginStateChange=t.registerForPluginStateChange;var Fe="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Be={};Be=Ue("","\n#define ELEVATION_SCALE 7.3\n#ifdef TERRAIN\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}float prevElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*word/ELEVATION_SCALE;}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0);const Ne=Ue("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nconst float PI=3.141592653589793;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const float PI=3.141592653589793;const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.");var Ve={background:Ue("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ue("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ue("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Ue("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ue("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}"),heatmapTexture:Ue("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ue("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ue("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ue("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Ue("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:Ue("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:Ue("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:Ue("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Ue("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);gl_Position=mix(u_matrix*vec4(pos_nx.xy,h,1),AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(pos_nx.xy,t > 0.0 ? height : base,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Ue("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);gl_Position=mix(u_matrix*vec4(pos_nx.xy,h,1),AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(pos_nx.xy,z,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Ue("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ue("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ue("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Ue("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Ue("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Ue("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Ue("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ue("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:Ue("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Ue("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:Ue("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);}"),terrainDepth:Ue("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ue("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(vec3(p.xyx)*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;color.rgb+=rnd/255.0;return color;}float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Fe),skyboxGradient:Ue("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform lowp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(vec3(p.xyx)*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;color.rgb+=rnd/255.0;return color;}void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5))*u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Fe),skyboxCapture:Ue("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}")};function Ue(t,e,n){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),s=t.match(/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g);let a=o?o.concat(s):s;n||(a=Be.staticUniforms.concat(a));const l={};return{fragmentSource:t=t.replace(i,(t,e,n,i,r)=>(l[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = u_${r};\n#endif\n`)),vertexSource:e=e.replace(i,(t,e,n,i,r)=>{const s="float"===i?"vec2":"vec4",o=r.match(/color/)?"color":s;return l[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${s} a_${r};\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${s} a_${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`}),staticAttributes:r,staticUniforms:a}}class je{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,i,r,s,o,a){this.context=t;let l=this.boundPaintVertexBuffers.length!==i.length;for(let c=0;!l&&c<i.length;c++)this.boundPaintVertexBuffers[c]!==i[c]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!l&&this.boundIndexBuffer===r&&this.boundVertexOffset===s&&this.boundDynamicVertexBuffer===o&&this.boundDynamicVertexBuffer2===a?(t.bindVertexArrayOES.set(this.vao),o&&o.bind(),r&&r.dynamicDraw&&r.bind(),a&&a.bind()):this.freshBind(e,n,i,r,s,o,a)}freshBind(t,e,n,i,r,s,o){let a;const l=t.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),a=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=o;else{a=c.currentNumAttributes||0;for(let t=l;t<a;t++)u.disableVertexAttribArray(t)}e.enableAttributes(u,t);for(const h of n)h.enableAttributes(u,t);s&&s.enableAttributes(u,t),o&&o.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const h of n)h.bind(),h.setVertexAttribPointers(u,t,r);s&&(s.bind(),s.setVertexAttribPointers(u,t,r)),i&&i.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function qe(e,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new t.MercatorCoordinate(0,r/i).toLngLat().lat,new t.MercatorCoordinate(0,(r+1)/i).toLngLat().lat]}function $e(e,n,i,r,s,o,a){const l=e.context,c=l.gl,u=i.fbo;if(!u)return;e.prepareDrawTile(n);const h=e.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const d=((t,e,n,i)=>{const r=n.paint.get("hillshade-shadow-color"),s=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:i||t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:qe(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:s,u_accent:o}})(e,i,r,e.terrain?n.posMatrix:null);h.draw(l,c.TRIANGLES,s,o,a,t.CullFaceMode.disabled,d,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function Ge(e,n,i){if(!n.needsDEMTextureUpload)return;const r=e.context,s=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(i.stride);const o=i.getPixels();n.demTexture?n.demTexture.update(o,{premultiply:!1}):n.demTexture=new t.Texture(r,o,s.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Ze(e,n,i,r,s,o){const a=e.context,l=a.gl;if(!n.dem)return;const c=n.dem;if(a.activeTexture.set(l.TEXTURE1),Ge(e,n,c),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const u=c.dim;a.activeTexture.set(l.TEXTURE0);let h=n.fbo;if(!h){const e=new t.Texture(a,{width:u,height:u,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),h=n.fbo=a.createFramebuffer(u,u,!0),h.colorAttachment.set(e.texture)}a.bindFramebuffer.set(h.framebuffer),a.viewport.set([0,0,u,u]),e.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,s,o,t.CullFaceMode.disabled,((e,n)=>{const i=n.stride,r=t.create$1();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,c),i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}const He=(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image0:new t.Uniform1i(e,n.u_image0),u_skirt_height:new t.Uniform1f(e,n.u_skirt_height)}),We=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),Xe=new class{constructor(){this.operations={}}newMorphing(t,e,n,i,r){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:i,phase:0,duration:r,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},Ke={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Qe(e,n,i,r,s){const o=e.context,a=o.gl;let l,c;const u=e.options.showTerrainWireframe?2:0,h=(t,n)=>{if(c===t)return;const i=[Ke[t]];n&&i.push(Ke[u]),l=e.useProgram("terrainRaster",null,i),c=t},d=e.colorModeForRenderPass(),p=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);Xe.update(s);const f=e.transform,m=6*Math.pow(1.5,22-f.zoom)*n.exaggeration();(u?[!1,!0]:[!1]).forEach(e=>{c=-1;const u=e?a.LINES:a.TRIANGLES,[g,_]=e?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const c of r){const r=i.getTile(c),x=t.StencilMode.disabled,b=n.prevTerrainTileForTile[c.key],w=n.terrainTileForTile[c.key];v=w,null!=(y=b)&&null!=v&&y.hasData()&&v.hasData()&&null!=y.demTexture&&null!=v.demTexture&&y.tileID.key!==v.tileID.key&&Xe.newMorphing(c.key,b,w,s,250),o.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const C=Xe.getMorphValuesForProxy(c.key),E=C?1:0;let S;C&&(S={morphing:{srcDemTile:C.from,dstDemTile:C.to,phase:t.easeCubicInOut(C.phase)}});const T=We(c.posMatrix,Ye(c.canonical,f.renderWorldCopies)?m/10:m);h(E,e),n.setupElevationDraw(r,l,S),l.draw(o,u,p,x,d,t.CullFaceMode.backCCW,T,"terrain_raster",n.gridBuffer,g,_)}var y,v})}function Ye(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const Je=t=>({u_matrix:t});function tn(e,n,i,r,s){if(s>0){const o=t.exported.now(),a=(o-e.timeAdded)/s,l=n?(o-n.timeAdded)/s:-1,c=i.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-u)>Math.abs(e.tileID.overscaledZ-u),d=h&&e.refreshedUponExpiration?1:t.clamp(h?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class en extends t.SourceCache{constructor(t){const e=bt("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new E(Pt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,i){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,useElevationData:!0}).reduce((n,i)=>{if(n[i.key]="",!this._tiles[i.key]){const n=new t.Tile(i,this._source.tileSize*i.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[i.key]=n}return n},{});for(const t in this._tiles)t in r||(this.freeFBO(t),this._tiles[t].state="unloaded",delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class nn extends t.OverscaledTileID{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.posMatrix=n}}class rn extends t.Elevation{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,r,s]=function(e){const n=new t.StructArrayLayout4i8,i=new t.StructArrayLayout3ui6,r=131;n.reserve(17161),i.reserve(33800);const s=t.EXTENT/128,o=t.EXTENT+s/2,a=o+s;for(let c=-s;c<a;c+=s)for(let e=-s;e<a;e+=s){const i=e<0||e>o||c<0||c>o?24575:0,r=t.clamp(Math.round(e),0,t.EXTENT),s=t.clamp(Math.round(c),0,t.EXTENT);n.emplaceBack(r+i,s,r,s)}const l=(t,e)=>{const n=e*r+t;i.emplaceBack(n+1,n,n+r),i.emplaceBack(n+r,n+r+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach(t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)}),[n,i,32768]}(),o=e.context;this.gridBuffer=o.createVertexBuffer(i,yt.members),this.gridIndexBuffer=o.createIndexBuffer(r),this.gridSegments=t.SegmentVector.simpleSegment(0,0,i.length,r.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,i.length,s),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new en(n.map),this.orthoMatrix=t.create$1(),t.ortho(this.orthoMatrix,0,t.EXTENT,0,t.EXTENT,0,1);const a=o.gl;this._overlapStencilMode=new t.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(e,n,i){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const r=e.terrain.properties;this.sourceCache=e._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const s=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.sourceCache.getSource().tileSize/128,i=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(n,e*i,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,s(),this._initializing=!0),s(),n.updateElevation(!i),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPoint(t.MercatorCoordinate.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.painter.options;this.renderCached=(r.zooming||r.moving||r.rotating||!!this.forceRenderCached)&&!this._invalidateRenderCache,this._invalidateRenderCache=!1;const s=this.proxyCoords=n.getIds().map(t=>{const e=n.getTileByID(t).tileID;return e.posMatrix=i.calculatePosMatrix(e.toUnwrapped()),e});!function(e,n){const i=n.transform.pointCoordinate(n.transform.getCameraPoint()),r=new t.pointGeometry(i.x,i.y);e.sort((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const i=new t.pointGeometry(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),s=new t.pointGeometry(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),o=r.mult(1<<e.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(i)-o.distSqr(s)})}(s,this.painter),this._previousZoom=i.zoom;const o=this.proxyToSource||{};this.proxyToSource={},s.forEach(t=>{this.proxyToSource[t.key]={}}),this.terrainTileForTile={};const a=this._style._sourceCaches;for(const t in a){const n=a[t];if(!n.used)continue;if(n!==this.sourceCache&&(this._findCoveringTileCache[n.id]={}),this._setupProxiedCoordsForOrtho(n,e[t],o),n.usedForTerrain)continue;const i=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(i)}this.proxiedCoords[n.id]=s.map(t=>new nn(t,t.key,this.orthoMatrix)),this._assignTerrainTiles(s),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._setupRenderCache(o),this.renderingToTexture=!1,this._initFBOPool(),this._updateTimestamp=t.exported.now();const l={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in l||(this._visibleDemTiles.push(e),l[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach(t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)})}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const i=this.terrainTileForTile[n],r=i.dem;!r||i.demTexture&&!i.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),Ge(this.painter,i,r))}}_prepareDemTileUniforms(t,e,n,i){if(!e||null==e.demTexture)return!1;const r=t.tileID.canonical,s=Math.pow(2,e.tileID.canonical.z-r.z),o=i||"";return n[`u_dem_tl${o}`]=[r.x*s%1,r.y*s%1],n[`u_dem_scale${o}`]=s,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce((e,n)=>{if(!n.dem)return e;const i=n.dem.tree.minimums[0];return i>0&&t++,e+i},0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const i=this._getLoadedAreaMinimum(),r={width:1,height:1,data:new Uint8Array(t.DEMData.pack(i,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let s=this._emptyDEMTexture;return s?s.update(r,{premultiply:!1}):s=this._emptyDEMTexture=new t.Texture(e,r,n.RGBA,{premultiply:!1}),s}setupElevationDraw(e,n,i){const r=this.painter.context,s=r.gl,o=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;o.u_dem_size=this.sourceCache.getSource().tileSize,o.u_exaggeration=this.exaggeration();let l=null,c=null,u=1;if(i&&i.morphing&&this._useVertexMorphing){const t=i.morphing.srcDemTile,n=i.morphing.dstDemTile;u=i.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,o,"_prev")&&(c=t),this._prepareDemTileUniforms(e,n,o)&&(l=n))}if(c&&l?(r.activeTexture.set(s.TEXTURE2),l.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),r.activeTexture.set(s.TEXTURE4),c.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),o.u_dem_lerp=u):(l=this.terrainTileForTile[e.tileID.key],r.activeTexture.set(s.TEXTURE2),(this._prepareDemTileUniforms(e,l,o)?l.demTexture:this.emptyDEMTexture).bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST)),i&&i.useDepthForOcclusion&&(r.activeTexture.set(s.TEXTURE3),this._depthTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),o.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),i&&i.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;o.u_meter_to_dem=e}i&&i.labelPlaneMatrixInv&&(o.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(r,o)}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,i=this.painter.context,r=this.proxySourceCache,s=this.proxiedCoords[r.id],o=()=>{i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),this.renderingToTexture=!1},a=this._drapedRenderBatches.shift();let l=[];const c=n.style.order;let u=0;for(let h=0;h<s.length;h++){const d=s[h],p=r.getTileByID(d.proxyTileKey),f=r.proxyCachedFBO[d.key]?r.proxyCachedFBO[d.key][e]:void 0;let m,g;if(m=this.currentFBO=void 0!==f?r.renderCache[f]:this.pool[u++],p.texture=m.tex,void 0===f||m.dirty){i.bindFramebuffer.set(m.fb.framebuffer),this.renderedToTile=!1,m.dirty&&(i.clear({color:t.Color.transparent}),m.dirty=!1);for(let t=a.start;t<=a.end;++t){const e=n.style._layers[c[t]];if(e.isHidden(n.transform.zoom))continue;const r=n.style._getLayerSourceCache(e),s=r?this.proxyToSource[d.key][r.id]:[d];if(!s)continue;const o=s;i.viewport.set([0,0,m.fb.width,m.fb.height]),g!==(r?r.id:null)&&(this._setupStencil(s,e,r),g=r?r.id:null),n.renderLayer(n,r,e,o)}m.dirty=this.renderedToTile,this.renderedToTile&&l.push(p.tileID),5===u&&(u=0,l.length>0&&(o(),Qe(n,this,r,l,this._updateTimestamp),this.renderingToTexture=!0,l=[]))}else l.push(p.tileID)}return o(),l.length>0&&Qe(n,this,r,l,this._updateTimestamp),a.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let n,i=0,r=0,s=!1;for(let o=0;o<e;++o){const e=t._layers[t.order[o]];this._style.isLayerDraped(e)?(s&&++i,++r):s||(s=!0,n=e.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-i/r),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(t=>t.dem).forEach(e=>{t=Math.min(t,e.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const i=this._visibleDemTiles.filter(t=>t.dem).map(i=>{const r=i.tileID,s=Math.pow(2,r.overscaledZ),{x:o,y:a}=r.canonical,l=o/s,c=(o+1)/s,u=a/s,h=(a+1)/s;return{minx:l,miny:u,maxx:c,maxy:h,t:i.dem.tree.raycastRoot(l,u,c,h,t,e,n),tile:i}});i.sort((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE));for(const r of i){if(null==r.t)return null;const i=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,t,e,n);if(null!=i)return i}return null}_createFBO(){const e=this.painter.context,n=e.gl,i=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const r=new t.Texture(e,{width:i[0],height:i[1],data:null},n.RGBA);r.bind(n.LINEAR,n.CLAMP_TO_EDGE);const s=e.createFramebuffer(i[0],i[1],!1);return s.colorAttachment.set(r.texture),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:s,tex:r,dirty:!1,ref:1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){return!this.renderCached||this._style.order.some(t=>{const e=this._style._layers[t],n=!e.isHidden(this.painter.transform.zoom),i=e.getCrossfadeParameters();return"custom"!==e.type&&!n&&!!i&&1!==i.t})}_clearRasterFadeFromRenderCache(){let t=!1;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e]._source instanceof _t){t=!0;break}if(t)for(let e=0;e<this._style.order.length;++e){const t=this._style._layers[this._style.order[e]],n=t.isHidden(this.painter.transform.zoom),i=this._style._getLayerSourceCache(t);if("raster"!==t.type||n||!i)continue;const r=t.paint.get("raster-fade-duration");for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][i.id];if(t)for(const e of t){const t=tn(i.getTile(e),i.findLoadedParent(e,0),i,this.painter.transform,r);(1!==t.opacity||0!==t.mix)&&this._clearRenderCacheForTile(i.id,e)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const n=[];let i,r=0,s=this._style._layers[t[r]];for(;!this._style.isLayerDraped(s)&&s.isHidden(this.painter.transform.zoom)&&++r<e;)s=this._style._layers[t[r]];for(;r<e;++r){const e=this._style._layers[t[r]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===i&&(i=r):void 0!==i&&(n.push({start:i,end:r-1}),i=void 0))}void 0!==i&&n.push({start:i,end:r-1}),this._drapedRenderBatches=n}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()){if(e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const i=Object.values(t[n]);e.renderCachePool.push(...i)}}return}this._clearRasterFadeFromRenderCache();const n=this.proxyCoords,i=this._tilesDirty;for(let r=n.length-1;r>=0;r--){const s=n[r];if(e.getTileByID(s.key),void 0!==e.proxyCachedFBO[s.key]){const n=t[s.key],r=this.proxyToSource[s.key];let o=0;for(const t in r){const e=r[t],s=n[t];if(!s||s.length!==e.length||e.some((e,n)=>e!==s[n]||i[t]&&i[t].hasOwnProperty(e.key))){o=-1;break}++o}for(const t in e.proxyCachedFBO[s.key])e.renderCache[e.proxyCachedFBO[s.key][t]].dirty=o<0||o!==Object.values(n).length}else for(let t=0;t<this._drapedRenderBatches.length;++t){const n=this._drapedRenderBatches[t];let i=e.renderCachePool.pop();void 0===i&&e.renderCache.length<50&&(i=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==i&&(void 0===e.proxyCachedFBO[s.key]&&(e.proxyCachedFBO[s.key]={}),e.proxyCachedFBO[s.key][n.start]=i,e.renderCache[i].dirty=!0)}}this._tilesDirty={}}_setupStencil(t,e,n){if(!n||!this._sourceTilesOverlap[n.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const i=this.painter.context,r=i.gl;if(t.length<=1)return void(this._overlapStencilType=!1);const s=this.currentFBO,o=s.fb;let a;if(e.isTileClipped())a=t.length,this._overlapStencilMode.test={func:r.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);a=1,this._overlapStencilMode.test={func:r.GREATER,mask:255},this._overlapStencilType="Mask"}if(!o.depthAttachment){const t=i.createRenderbuffer(i.gl.DEPTH_STENCIL,o.width,o.height);o.depthAttachment=new ft(i,o.framebuffer),o.depthAttachment.set(t),i.clear({stencil:0})}s.ref+a>255&&(i.clear({stencil:0}),s.ref=0),s.ref+=a,this._overlapStencilMode.ref=s.ref,e.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,n){const i=this.painter,r=this.painter.context,s=r.gl;i._tileClippingMaskIDs={},r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const o=i.useProgram("clippingMask");for(const a of e){const e=i._tileClippingMaskIDs[a.key]=--n;o.draw(r,s.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:s.ALWAYS,mask:0},e,255,s.KEEP,s.KEEP,s.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Je(a.posMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const i=[e.x,e.y,1,1];t.transformMat4(i,i,n.pixelMatrixInverse),t.scale$2(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;const r=n._camera.position,s=t.mercatorZfromAltitude(1,n.center.lat),o=[r[0],r[1],r[2]/s,0],a=t.subtract([],i.slice(0,3),o);t.normalize(a,a);const l=this.raycast(o,a,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(o,o,a,l),o[3]=o[2],o[2]*=s,o):null}drawDepth(){const e=this.painter,n=e.context,i=this.proxySourceCache,r=Math.ceil(e.width),s=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===s||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const e=n.gl,i=n.createFramebuffer(r,s,!0);n.activeTexture.set(e.TEXTURE0);const o=new t.Texture(n,{width:r,height:s,data:null},e.RGBA);o.bind(e.NEAREST,e.CLAMP_TO_EDGE),i.colorAttachment.set(o.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,r,s);i.depthAttachment.set(a),this._depthFBO=i,this._depthTexture=o}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,r,s]),function(e,n,i,r){const s=e.context,o=s.gl;s.clear({depth:1});const a=e.useProgram("terrainDepth"),l=new t.DepthMode(o.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const c of r){const e=i.getTile(c),r=We(c.posMatrix,0);n.setupElevationDraw(e,a),a.draw(s,o.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,r,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,n){if(t.getSource()instanceof vt)return this._setupProxiedCoordsForImageSource(t,e,n);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const i=this.proxiedCoords[t.id]=[],r=this.proxyCoords;for(let o=0;o<r.length;o++){const e=r[o],s=this._findTileCoveringTileID(e,t);if(s){const r=this._createProxiedId(e,s,n[e.key]&&n[e.key][t.id]);i.push(r),this.proxyToSource[e.key][t.id]=[r]}}let s=!1;for(let o=0;o<e.length;o++){const r=t.getTile(e[o]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const e=this.proxyToSource[a.tileID.key][t.id],o=this._createProxiedId(a.tileID,r,n[a.tileID.key]&&n[a.tileID.key][t.id]);e?e.splice(e.length-1,0,o):this.proxyToSource[a.tileID.key][t.id]=[o],i.push(o),s=!0}}this._sourceTilesOverlap[t.id]=s}_setupProxiedCoordsForImageSource(e,n,i){if(!e.getSource().loaded())return;const r=this.proxiedCoords[e.id]=[],s=this.proxyCoords,o=e.getSource(),a=new t.pointGeometry(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),l=o.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((t,e)=>(t.min.x=Math.min(t.min.x,e.x-a.x),t.min.y=Math.min(t.min.y,e.y-a.y),t.max.x=Math.max(t.max.x,e.x-a.x),t.max.y=Math.max(t.max.y,e.y-a.y),t),{min:new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(e,n)=>{const i=e.wrap+e.canonical.x/(1<<e.canonical.z),r=e.canonical.y/(1<<e.canonical.z),s=t.EXTENT/(1<<e.canonical.z),o=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return i+s<o+l.min.x||i>o+l.max.x||r+s<a+l.min.y||r>a+l.max.y};for(let t=0;t<s.length;t++){const o=s[t];for(let t=0;t<n.length;t++){const s=e.getTile(n[t]);if(!s||!s.hasData())continue;if(c(o,s.tileID))continue;const a=this._createProxiedId(o,s,i[o.key]&&i[o.key][e.id]),l=this.proxyToSource[o.key][e.id];l?l.push(a):this.proxyToSource[o.key][e.id]=[a],r.push(a)}}}_createProxiedId(e,n,i){let r=this.orthoMatrix;if(i){const t=i.find(t=>t.key===n.tileID.key);if(t)return t}if(n.tileID.key!==e.key){const i=e.canonical.z-n.tileID.canonical.z;let s,o,a;r=t.create$1();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;i>0?(s=t.EXTENT>>i,o=s*((n.tileID.canonical.x<<i)-e.canonical.x+l),a=s*((n.tileID.canonical.y<<i)-e.canonical.y)):(s=t.EXTENT<<-i,o=t.EXTENT*(n.tileID.canonical.x-(e.canonical.x+l<<-i)),a=t.EXTENT*(n.tileID.canonical.y-(e.canonical.y<<-i))),t.ortho(r,0,s,0,s,0,1),t.translate(r,r,[o,a,0])}return new nn(n.tileID,e.key,r)}_findTileCoveringTileID(e,n){let i=n.getTile(e);if(i&&i.hasData())return i;const r=this._findCoveringTileCache[n.id],s=r[e.key];if(i=s?n.getTileByID(s):null,i&&i.hasData()||null===s)return i;let o=i?i.tileID:e,a=o.overscaledZ;const l=n.getSource().minzoom,c=[];if(!s){const r=n.getSource().maxzoom;if(e.canonical.z>=r){const i=e.canonical.z-r;n.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,n.transform.tileZoom),o=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>i,e.canonical.y>>i)):0!==i&&(a=r,o=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>i,e.canonical.y>>i))}o.key!==e.key&&(c.push(o.key),i=n.getTile(o))}const u=t=>{c.forEach(e=>{r[e]=t}),c.length=0};for(a-=1;a>=l&&(!i||!i.hasData());a--){i&&u(i.tileID.key);const t=o.calculateScaledKey(a);if(i=n.getTileByID(t),i&&i.hasData())break;const e=r[t];if(null===e)break;void 0===e?c.push(t):i=n.getTileByID(e)}return u(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(t){this.renderedToTile||(this.renderedToTile=!0)}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let n,i,r;const s=new t.StructArrayLayout2ui4,o=131;for(i=1;i<129;i++){for(n=1;n<129;n++)r=i*o+n,s.emplaceBack(r,r+1),s.emplaceBack(r,r+o),s.emplaceBack(r+1,r+o),128===i&&s.emplaceBack(r+o,r+o+1);s.emplaceBack(r+1,r+1+o)}return s}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function sn(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const i=t[n].split(" ");e.push(i.pop())}return e}class on{static cacheKey(t,e,n){let i=`${t}${n?n.cacheKey:""}`;for(const r of e)i+=`/${r}`;return i}constructor(e,n,i,r,s,o){const a=e.gl;this.program=a.createProgram();const l=sn(i.staticAttributes),c=r?r.getBinderAttributes():[],u=l.concat(c),h=i.staticUniforms?sn(i.staticUniforms):[],d=r?r.getBinderUniforms():[],p=h.concat(d),f=[];for(const t of p)f.indexOf(t)<0&&f.push(t);let m=r?r.defines():[];m=m.concat(o.map(t=>`#define ${t}`));const g=m.concat(Ne.fragmentSource,i.fragmentSource).join("\n"),_=m.concat(Ne.vertexSource,Be.vertexSource,i.vertexSource).join("\n"),y=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(y,g),a.compileShader(y),a.attachShader(this.program,y);const v=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(v,_),a.compileShader(v),a.attachShader(this.program,v),this.attributes={};const x={};this.numAttributes=u.length;for(let t=0;t<this.numAttributes;t++)u[t]&&(a.bindAttribLocation(this.program,t,u[t]),this.attributes[u[t]]=t);a.linkProgram(this.program),a.deleteShader(v),a.deleteShader(y);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!x[e]){const t=a.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=s(e,x),this.binderUniforms=r?r.getUniforms(e,x):[],-1!==o.indexOf("TERRAIN")&&(this.terrainUniforms=((e,n)=>({u_dem:new t.Uniform1i(e,n.u_dem),u_dem_prev:new t.Uniform1i(e,n.u_dem_prev),u_dem_unpack:new t.Uniform4f(e,n.u_dem_unpack),u_dem_tl:new t.Uniform2f(e,n.u_dem_tl),u_dem_scale:new t.Uniform1f(e,n.u_dem_scale),u_dem_tl_prev:new t.Uniform2f(e,n.u_dem_tl_prev),u_dem_scale_prev:new t.Uniform1f(e,n.u_dem_scale_prev),u_dem_size:new t.Uniform1f(e,n.u_dem_size),u_dem_lerp:new t.Uniform1f(e,n.u_dem_lerp),u_exaggeration:new t.Uniform1f(e,n.u_exaggeration),u_depth:new t.Uniform1i(e,n.u_depth),u_depth_size_inv:new t.Uniform2f(e,n.u_depth_size_inv),u_meter_to_dem:new t.Uniform1f(e,n.u_meter_to_dem),u_label_plane_matrix_inv:new t.UniformMatrix4f(e,n.u_label_plane_matrix_inv)}))(e,x))}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(e[t])}}draw(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const g=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(s);for(const y in this.fixedUniforms)this.fixedUniforms[y].set(o[y]);p&&p.setUniforms(t,this.binderUniforms,h,{zoom:d});const _={[g.LINES]:2,[g.TRIANGLES]:3,[g.LINE_STRIP]:1}[e];for(const y of u.get()){const n=y.vaos||(y.vaos={});(n[a]||(n[a]=new je)).bind(t,this,l,p?p.getPaintVertexBuffers():[],c,y.vertexOffset,f,m),g.drawElements(e,y.primitiveLength*_,g.UNSIGNED_SHORT,y.primitiveOffset*_*2)}}}function an(t,e,n){const i=1/S(n,1,e.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),s=n.tileSize*Math.pow(2,e.transform.tileZoom)/r,o=s*(n.tileID.canonical.x+n.tileID.wrap*r),a=s*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,a>>16],u_pixel_coord_lower:[65535&o,65535&a]}}const ln=(e,n,i,r)=>{const s=n.style.light,o=s.properties.get("position"),a=[o.x,o.y,o.z],l=t.create$2();"viewport"===s.properties.get("anchor")&&(t.fromRotation(l,-n.transform.angle),t.transformMat3(a,a,l));const c=s.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:s.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},cn=(e,n,i,r,s,o,a)=>t.extend(ln(e,n,i,r),an(o,n,a),{u_height_factor:-Math.pow(2,s.overscaledZ)/a.tileSize/8}),un=t=>({u_matrix:t}),hn=(e,n,i,r)=>t.extend(un(e),an(i,n,r)),dn=(t,e)=>({u_matrix:t,u_world:e}),pn=(e,n,i,r,s)=>t.extend(hn(e,n,i,r),{u_world:s}),fn=(e,n,i,r)=>{const s=e.transform;let o;if("map"===r.paint.get("circle-pitch-alignment")){const t=S(i,1,s.zoom);o=[t,t]}else o=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_matrix:e.translatePosMatrix(n.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:o}},mn=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},gn=(e,n,i)=>{const r=t.EXTENT/i.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_extrude_scale:[n.pixelsToGLUnits[0]/r,n.pixelsToGLUnits[1]/r]}},_n=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),yn=(t,e,n,i)=>({u_matrix:t,u_extrude_scale:S(e,1,n),u_intensity:i}),vn=(e,n,i,r)=>{const s=e.transform;return{u_matrix:En(e,n,i,r),u_ratio:1/S(n,1,s.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},xn=(e,n,i,r,s)=>t.extend(vn(e,n,i,r),{u_image:0,u_image_height:s}),bn=(e,n,i,r,s)=>{const o=e.transform,a=Cn(n,o);return{u_matrix:En(e,n,i,s),u_texsize:n.imageAtlasTexture.size,u_ratio:1/S(n,1,o.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},wn=(e,n,i,r,s,o)=>{const a=e.lineAtlas,l=Cn(n,e.transform),c="round"===i.layout.get("line-cap"),u=a.getDash(r.from,c),h=a.getDash(r.to,c),d=u.width*s.fromScale,p=h.width*s.toScale;return t.extend(vn(e,n,i,o),{u_patternscale_a:[l/d,-u.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:a.width/(256*Math.min(d,p)*t.exported.devicePixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:s.t})};function Cn(t,e){return 1/S(t,1,e.tileZoom)}function En(t,e,n,i){return t.translatePosMatrix(i||e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Sn=(t,e,n,i,r)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(o=r.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(s=r.paint.get("raster-contrast"),s>0?1/(1-s):1+s),u_spin_weights:Tn(r.paint.get("raster-hue-rotate"))};var s,o};function Tn(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Mn=(t,e,n,i,r,s,o,a,l,c)=>{const u=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:u.width/u.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:o,u_coord_matrix:a,u_is_text:+l,u_pitch_with_map:+i,u_texsize:c,u_texture:0}},An=(e,n,i,r,s,o,a,l,c,u,h)=>{const{cameraToCenterDistance:d,_pitch:p}=s.transform;return t.extend(Mn(e,n,i,r,s,o,a,l,c,u),{u_gamma_scale:r?d*Math.cos(s.terrain?0:p):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+h})},kn=(e,n,i,r,s,o,a,l,c,u)=>t.extend(An(e,n,i,r,s,o,a,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1}),Pn=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),In=(e,n,i,r,s,o)=>t.extend(function(t,e,n,i){const r=n.imageManager.getPattern(t.from.toString()),s=n.imageManager.getPattern(t.to.toString()),{width:o,height:a}=n.imageManager.getPixelSize(),l=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),h=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:s.tl,u_pattern_br_b:s.br,u_texsize:[o,a],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:s.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/S(i,1,n.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(r,o,i,s),{u_matrix:e,u_opacity:n}),On={fillExtrusion:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale)}),collisionCircle:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}),lineGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}),linePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),lineSDF:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}),raster:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),background:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}),terrainRaster:He,terrainDepth:He,skybox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_cubemap:new t.Uniform1i(e,n.u_cubemap),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_center_direction:new t.Uniform3f(e,n.u_center_direction),u_radius:new t.Uniform1f(e,n.u_radius),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxCapture:(e,n)=>({u_matrix_3f:new t.UniformMatrix3f(e,n.u_matrix_3f),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_sun_intensity:new t.Uniform1f(e,n.u_sun_intensity),u_color_tint_r:new t.Uniform4f(e,n.u_color_tint_r),u_color_tint_m:new t.Uniform4f(e,n.u_color_tint_m),u_luminance:new t.Uniform1f(e,n.u_luminance)})};let zn;function Dn(e,n,i,r,s,o,a){const l=e.context,c=l.gl,u=e.useProgram("collisionBox"),h=[];let d=0,p=0;for(let x=0;x<r.length;x++){const f=r[x],m=n.getTile(f),g=m.getBucket(i);if(!g)continue;let _=f.posMatrix;0===s[0]&&0===s[1]||(_=e.translatePosMatrix(f.posMatrix,m,s,o));const y=a?g.textCollisionBox:g.iconCollisionBox,v=g.collisionCircleArray;if(v.length>0){const n=t.create$1(),i=_;t.mul$1(n,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul$1(n,n,g.placementViewportMatrix),h.push({circleArray:v,circleOffset:p,transform:i,invTransform:n}),d+=v.length/4,p=d}y&&(e.terrain&&e.terrain.setupElevationDraw(m,u),u.draw(l,c.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,gn(_,e.transform,m),i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,e.transform.zoom,null,y.collisionVertexBuffer,y.collisionVertexBufferExt))}if(!a||!h.length)return;const f=e.useProgram("collisionCircle"),m=new t.StructArrayLayout2f1f2i16;m.resize(4*d),m._trim();let g=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,i=t.circleArray[n+0],r=t.circleArray[n+1],s=t.circleArray[n+2],o=t.circleArray[n+3];m.emplace(g++,i,r,s,o,0),m.emplace(g++,i,r,s,o,1),m.emplace(g++,i,r,s,o,2),m.emplace(g++,i,r,s,o,3)}(!zn||zn.length<2*d)&&(zn=function(e){const n=2*e,i=new t.StructArrayLayout3ui6;i.resize(n),i._trim();for(let t=0;t<n;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(d));const _=l.createIndexBuffer(zn,!0),y=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const x of h){const n={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(v=e.transform).cameraToCenterDistance,u_viewport_size:[v.width,v.height]};f.draw(l,c.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,n,i.id,y,_,t.SegmentVector.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,e.transform.zoom,null,null,null)}var v;y.destroy(),_.destroy()}const Rn=t.identity(new Float32Array(16));function Ln(e,n,i,r,s,o){const{horizontalAlign:a,verticalAlign:l}=t.getAnchorAlignment(e),c=-(a-.5)*n,u=-(l-.5)*i,h=t.evaluateVariableOffset(e,r);return new t.pointGeometry((c/s+h[0])*o,(u/s+h[1])*o)}function Fn(e,n,i,r,s,o,a,l,c,u,h,d){const p=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let _=0;_<p.length;_++){const m=p.get(_),y=e.allowVerticalPlacement&&!m.placedOrientation,v=m.hidden||!m.crossTileID||y?null:r[m.crossTileID];if(v){const r=new t.pointGeometry(m.anchorX,m.anchorY),p=d(r),_=Gt(r,i?l:a,p),y=Zt(o.cameraToCenterDistance,_.signedDistanceFromCamera);let x=s.evaluateSizeForFeature(e.textSizeData,u,m)*y/t.ONE_EM;i&&(x*=e.tilePixelRatio/c);const{width:b,height:w,anchor:C,textOffset:E,textBoxScale:S}=v,T=Ln(C,b,w,E,S,x),M=i?Gt(r.add(T),a,p).point:_.point.add(n?T.rotate(-o.angle):T),A=e.allowVerticalPlacement&&m.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<m.numGlyphs;e++)t.addDynamicAttributes(f,M,A);h&&m.associatedIconIndex>=0&&(g[m.associatedIconIndex]={shiftedAnchor:M,angle:A})}else ee(m.numGlyphs,f)}if(h){m.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const i=n.get(e);if(i.hidden)ee(i.numGlyphs,m);else{const n=g[e];if(n)for(let e=0;e<i.numGlyphs;e++)t.addDynamicAttributes(m,n.shiftedAnchor,n.angle);else ee(i.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function Bn(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Nn(e,n,i,r,s,o,a,l,c,u,h,d){const p=e.context,f=p.gl,m=e.transform,g="map"===l,_="map"===c,y=g&&"point"!==i.layout.get("symbol-placement"),v=g&&!_&&!y,x=void 0!==i.layout.get("symbol-sort-key").constantOr(1);let b=!1;const w=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),C=i.layout.get("text-variable-anchor"),E=[],T=e.terrain&&_?["PITCH_WITH_MAP_TERRAIN"]:null;for(const M of r){const r=n.getTile(M),l=r.getBucket(i);if(!l)continue;const c=s?l.text:l.icon;if(!c||!c.segments.get().length)continue;const h=c.programConfigurations.get(i.id),d=s||l.sdfIcons,p=s?l.textSizeData:l.iconSizeData,w=_||0!==m.pitch,A=e.useProgram(Bn(d,s,l),h,T),k=t.evaluateSizeForZoom(p,m.zoom);let P,I,O,z,D=[0,0],R=null;if(s){if(I=r.glyphAtlasTexture,O=f.LINEAR,P=r.glyphAtlasTexture.size,l.iconsInText){D=r.imageAtlasTexture.size,R=r.imageAtlasTexture;const t="composite"===p.kind||"camera"===p.kind;z=w||e.options.rotating||e.options.zooming||t?f.LINEAR:f.NEAREST}}else{const t=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;I=r.imageAtlasTexture,O=d||e.options.rotating||e.options.zooming||t||w?f.LINEAR:f.NEAREST,P=r.imageAtlasTexture.size}const L=S(r,1,e.transform.zoom),F=qt(M.posMatrix,_,g,e.transform,L),B=e.terrain&&_&&y?t.invert(new Float32Array(16),F):Rn,N=$t(M.posMatrix,_,g,e.transform,L),V=C&&l.hasTextData(),U="none"!==i.layout.get("icon-text-fit")&&V&&l.hasIconData();if(y){const t=m.elevation;Wt(l,M.posMatrix,e,s,F,N,_,u,t?e=>t.getAtTileOffset(M,e.x,e.y):null)}const j=e.translatePosMatrix(M.posMatrix,r,o,a),q=y||s&&C||U?Rn:F,$=e.translatePosMatrix(N,r,o,a,!0),G=d&&0!==i.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1);let Z;Z=d?l.iconsInText?kn(p.kind,k,v,_,e,j,q,$,P,D):An(p.kind,k,v,_,e,j,q,$,s,P,!0):Mn(p.kind,k,v,_,e,j,q,$,s,P);const H={program:A,buffers:c,uniformValues:Z,atlasTexture:I,atlasTextureIcon:R,atlasInterpolation:O,atlasInterpolationIcon:z,isSDF:d,hasHalo:G,tile:r,labelPlaneMatrixInv:B};if(x&&l.canOverlap){b=!0;const e=c.segments.get();for(const n of e)E.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:H})}else E.push({segments:c.segments,sortKey:0,state:H})}b&&E.sort((t,e)=>t.sortKey-e.sortKey);for(const t of E){const n=t.state;if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),p.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,Vn(n.buffers,t.segments,i,e,n.program,w,h,d,r)),r.u_is_halo=0}Vn(n.buffers,t.segments,i,e,n.program,w,h,d,n.uniformValues)}}function Vn(e,n,i,r,s,o,a,l,c){const u=r.context;s.draw(u,u.gl.TRIANGLES,o,a,l,t.CullFaceMode.disabled,c,i.id,e.layoutVertexBuffer,e.indexBuffer,n,i.paint,r.transform.zoom,e.programConfigurations.get(i.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Un(e,n,i,r,s,o,a){const l=e.context.gl,c=i.paint.get("fill-pattern"),u=c&&c.constantOr(1),h=i.getCrossfadeParameters();let d,p,f,m,g;a?(p=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=l.LINES):(p=u?"fillPattern":"fill",d=l.TRIANGLES);for(const _ of r){const r=n.getTile(_);if(u&&!r.patternsLoaded())continue;const y=r.getBucket(i);if(!y)continue;e.prepareDrawTile(_);const v=y.programConfigurations.get(i.id),x=e.useProgram(p,v);u&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(h));const b=c.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],n=t.patternPositions[b.from.toString()];e&&n&&v.setConstantPatternPositions(e,n)}const w=e.translatePosMatrix(_.posMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(a){m=y.indexBuffer2,g=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];f="fillOutlinePattern"===p&&u?pn(w,e,h,r,t):dn(w,t)}else m=y.indexBuffer,g=y.segments,f=u?hn(w,e,h,r):un(w);x.draw(e.context,d,s,e.stencilModeForClipping(_),o,t.CullFaceMode.disabled,f,i.id,y.layoutVertexBuffer,m,g,i.paint,e.transform.zoom,v)}}function jn(e,n,i,r,s,o,a){const l=e.context,c=l.gl,u=i.paint.get("fill-extrusion-pattern"),h=u.constantOr(1),d=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity");for(const f of r){const r=n.getTile(f),m=r.getBucket(i);if(!m)continue;const g=m.programConfigurations.get(i.id),_=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",g);if(e.terrain){const t=e.terrain;if(!m.enableTerrain)continue;if(t.setupElevationDraw(r,_,{useMeterToDem:!0}),qn(l,n,f,m,i,t),!m.centroidVertexBuffer){const t=_.attributes.a_centroid_pos;void 0!==t&&c.vertexAttrib2f(t,0,0)}}h&&(e.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),g.updatePaintBuffers(d));const y=u.constantOr(null);if(y&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[y.to.toString()],n=t.patternPositions[y.from.toString()];e&&n&&g.setConstantPatternPositions(e,n)}const v=e.translatePosMatrix(f.posMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),x=i.paint.get("fill-extrusion-vertical-gradient"),b=h?cn(v,e,x,p,f,d,r):ln(v,e,x,p);_.draw(l,l.gl.TRIANGLES,s,o,a,t.CullFaceMode.backCCW,b,i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,i.paint,e.transform.zoom,g,e.terrain?m.centroidVertexBuffer:null)}}function qn(e,n,i,r,s,o){const a=[e=>{let n=e.canonical.x-1,i=e.wrap;return n<0&&(n=(1<<e.canonical.z)-1,i--),new t.OverscaledTileID(e.overscaledZ,i,e.canonical.z,n,e.canonical.y)},e=>{let n=e.canonical.x+1,i=e.wrap;return n===1<<e.canonical.z&&(n=0,i++),new t.OverscaledTileID(e.overscaledZ,i,e.canonical.z,n,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=n.getSource().maxzoom,i=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(s)};let r,o,a;return(t.overscaledZ===t.canonical.z||t.overscaledZ>=e)&&(r=i(t.key)),t.overscaledZ>=e&&(o=i(t.calculateScaledKey(t.overscaledZ+1))),t.overscaledZ>e&&(a=i(t.calculateScaledKey(t.overscaledZ-1))),r||o||a},c=[0,0,0],u=(e,n)=>(c[0]=Math.min(e.min.y,n.min.y),c[1]=Math.max(e.max.y,n.max.y),c[2]=t.EXTENT-n.min.x>e.max.x?n.min.x-t.EXTENT:e.max.x,c),h=(e,n)=>(c[0]=Math.min(e.min.x,n.min.x),c[1]=Math.max(e.max.x,n.max.x),c[2]=t.EXTENT-n.min.y>e.max.y?n.min.y-t.EXTENT:e.max.y,c),d=[(t,e)=>u(t,e),(t,e)=>u(e,t),(t,e)=>h(t,e),(t,e)=>h(e,t)],p=new t.pointGeometry(0,0);let f,m,g;const _=(e,n,r,s,a)=>{const l=[[s?r:e,s?e:r,0],[s?r:n,s?n:r,0]],c=a<0?t.EXTENT+a:a,u=[s?c:(e+n)/2,s?(e+n)/2:c,0];return 0===r&&a<0||0!==r&&a>0?o.getForTilePoints(g,[u],!0,m):l.push(u),o.getForTilePoints(i,l,!0,f),Math.max(l[0][2],l[1][2],u[2])/o.exaggeration()};for(let y=0;y<4;y++){const e=r.borders[y];if(0===e.length&&(r.borderDone[y]=!0),r.borderDone[y])continue;const n=g=a[y](i),s=l(n);if(!s||!s.enableTerrain)continue;if(m=o.findDEMTileFor(n),!m||!m.dem)continue;if(!f){const t=o.findDEMTileFor(i);if(!t||!t.dem)return;f=t}const c=(y<2?1:5)-y,u=s.borders[c];let h=0;for(let i=0;i<e.length;i++){const n=r.featuresOnBorder[e[i]],o=n.borders[y];let a;for(;h<u.length&&(a=s.featuresOnBorder[u[h]],!(a.borders[c][1]>o[0]+3));)s.borderDone[c]||s.encodeCentroid(void 0,a,!1),h++;if(a&&h<u.length){const e=h;let i=0;for(;!(a.borders[c][0]>o[1]-3)&&(i++,++h!==u.length);)a=s.featuresOnBorder[u[h]];if(a=s.featuresOnBorder[u[e]],n.intersectsCount()>1||a.intersectsCount()>1||1!==i){1!==i&&(h=e),r.encodeCentroid(void 0,n,!1),s.borderDone[c]||s.encodeCentroid(void 0,a,!1);continue}const l=d[y](n,a),f=y%2?t.EXTENT-1:0;p.x=_(l[0],Math.min(t.EXTENT-1,l[1]),f,y<2,l[2]),p.y=0,r.encodeCentroid(p,n,!1),s.borderDone[c]||s.encodeCentroid(p,a,!1)}else r.encodeCentroid(void 0,n,!1)}r.borderDone[y]=r.needsCentroidUpdate=!0,s.borderDone[c]||(s.borderDone[c]=s.needsCentroidUpdate=!0)}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(e)}const $n=new t.Color(1,0,0,1),Gn=new t.Color(0,1,0,1),Zn=new t.Color(0,0,1,1),Hn=new t.Color(1,0,1,1),Wn=new t.Color(0,1,1,1);function Xn(t,e,n,i){Qn(t,0,e+n/2,t.transform.width,n,i)}function Kn(t,e,n,i){Qn(t,e-n/2,0,n,t.transform.height,i)}function Qn(e,n,i,r,s,o){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.exported.devicePixelRatio,i*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,s*t.exported.devicePixelRatio),a.clear({color:o}),l.disable(l.SCISSOR_TEST)}function Yn(e,n,i){const r=e.context,s=r.gl,o=i.posMatrix,a=e.useProgram("debug"),l=n.getTileByID(i.key);e.terrain&&e.terrain.setupElevationDraw(l,a);const c=t.DepthMode.disabled,u=t.StencilMode.disabled,h=e.colorModeForRenderPass(),d="$debug";r.activeTexture.set(s.TEXTURE0),e.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a.draw(r,s.LINE_STRIP,c,u,h,t.CullFaceMode.disabled,_n(o,t.Color.red),d,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);const p=l.latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),m=n.getTile(i).tileSize,g=512/Math.min(m,512)*(i.overscaledZ/e.transform.zoom)*.5;let _=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(_+=` => ${i.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,`${_} ${f}kb`),a.draw(r,s.TRIANGLES,c,u,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,_n(o,t.Color.transparent,g),d,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}const Jn=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ti}=Jn;function ei(t,e,n,i){t.emplaceBack(e,n,i)}class ni{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,ei(this.vertexArray,-1,-1,1),ei(this.vertexArray,1,-1,1),ei(this.vertexArray,-1,1,1),ei(this.vertexArray,1,1,1),ei(this.vertexArray,-1,-1,-1),ei(this.vertexArray,1,-1,-1),ei(this.vertexArray,-1,1,-1),ei(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,ti),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function ii(e,n,i,r,s,o){const a=e.gl,l=n.paint.get("sky-atmosphere-color"),c=n.paint.get("sky-atmosphere-halo-color"),u=n.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,n,i,r)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(t.fromMat4([],r),s,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+o,n.skyboxTexture,0),i.draw(e,a.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const ri={symbol:function(e,n,i,r,s){if("translucent"!==e.renderPass)return;const o=t.StencilMode.disabled,a=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,n,i,r,s,o,a){const l=n.transform,c="map"===s,u="map"===o;for(const h of e){const e=r.getTile(h),s=e.getBucket(i);if(!s||!s.text||!s.text.segments.get().length)continue;const o=t.evaluateSizeForZoom(s.textSizeData,l.zoom),d=S(e,1,n.transform.zoom),p=qt(h.posMatrix,u,c,n.transform,d),f="none"!==i.layout.get("icon-text-fit")&&s.hasIconData();if(o){const n=Math.pow(2,l.zoom-e.tileID.overscaledZ),i=l.elevation;Fn(s,c,u,a,t.symbolSize,l,p,h.posMatrix,n,o,f,i?t=>i.getAtTileOffset(h,t.x,t.y):t=>0)}}}(r,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),s),0!==i.paint.get("icon-opacity").constantOr(1)&&Nn(e,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),o,a),0!==i.paint.get("text-opacity").constantOr(1)&&Nn(e,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),o,a),n.map.showCollisionBoxes&&(Dn(e,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Dn(e,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,i,r){if("translucent"!==e.renderPass)return;const s=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),a=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0===s.constantOr(1)&&(0===o.constantOr(1)||0===a.constantOr(1)))return;const c=e.context,u=c.gl,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),d=t.StencilMode.disabled,p=e.colorModeForRenderPass(),f=[];for(let m=0;m<r.length;m++){const s=r[m],o=n.getTile(s),a=o.getBucket(i);if(!a)continue;const c=a.programConfigurations.get(i.id),u=mn(i),h={programConfiguration:c,program:e.useProgram("circle",c,u),layoutVertexBuffer:a.layoutVertexBuffer,indexBuffer:a.indexBuffer,uniformValues:fn(e,s,o,i),tile:o};if(l){const e=a.segments.get();for(const n of e)f.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:h})}else f.push({segments:a.segments,sortKey:0,state:h})}l&&f.sort((t,e)=>t.sortKey-e.sortKey);for(const m of f){const{programConfiguration:n,program:r,layoutVertexBuffer:s,indexBuffer:o,uniformValues:a,tile:l}=m.state,f=m.segments;e.terrain&&e.terrain.setupElevationDraw(l,r,{useDepthForOcclusion:!0}),r.draw(c,u.TRIANGLES,h,d,p,t.CullFaceMode.disabled,a,i.id,s,o,f,i.paint,e.transform.zoom,n)}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const s=e.context,o=s.gl,a=t.StencilMode.disabled,l=new t.ColorMode([o.ONE,o.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){const i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{const s=i.createTexture();i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,i){const r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(t,e,s,r)}}(s,e,i),s.clear({color:t.Color.transparent});for(let c=0;c<r.length;c++){const u=r[c];if(n.hasRenderableParent(u))continue;const h=n.getTile(u),d=h.getBucket(i);if(!d)continue;const p=d.programConfigurations.get(i.id),f=e.useProgram("heatmap",p),{zoom:m}=e.transform;e.terrain&&e.terrain.setupElevationDraw(h,f),f.draw(s,o.TRIANGLES,t.DepthMode.disabled,a,l,t.CullFaceMode.disabled,yn(u.posMatrix,h,m,i.paint.get("heatmap-intensity")),i.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,i.paint,e.transform.zoom,p)}s.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const i=e.context,r=i.gl,s=n.heatmapFbo;if(!s)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let o=n.colorRampTexture;o||(o=n.colorRampTexture=new t.Texture(i,n.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,r.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((e,n,i,r)=>{const s=t.create$1();t.ortho(s,0,e.width,e.height,0,0,1);const o=e.context.gl;return{u_matrix:s,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,i))},line:function(e,n,i,r){if("translucent"!==e.renderPass)return;const s=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0===s.constantOr(1)||0===o.constantOr(1))return;const a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),h=u.constantOr(1),d=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":d?"lineGradient":"line",m=e.context,g=m.gl;let _=!0;for(const y of r){const r=n.getTile(y);if(h&&!r.patternsLoaded())continue;const s=r.getBucket(i);if(!s)continue;e.prepareDrawTile(y);const o=s.programConfigurations.get(i.id),v=e.context.program.get(),x=e.useProgram(f,o),b=_||x.program!==v,w=u.constantOr(null);if(w&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[w.to.toString()],n=t.patternPositions[w.from.toString()];e&&n&&o.setConstantPatternPositions(e,n)}const C=e.terrain?y.posMatrix:null,E=h?bn(e,r,i,p,C):c?wn(e,r,i,c,p,C):d?xn(e,r,i,C,s.lineClipsArray.length):vn(e,r,i,C);if(h)m.activeTexture.set(g.TEXTURE0),r.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),o.updatePaintBuffers(p);else if(c&&(b||e.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m);else if(d){const r=s.gradients[i.id];let o=r.texture;if(i.gradientVersion!==r.version){let a=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=y.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-y.canonical.z):1;a=t.clamp(t.nextPowerOfTwo(s.maxLineLength/t.EXTENT*1024*r),256,m.maxTextureSize)}r.gradient=t.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:s.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new t.Texture(m,r.gradient,g.RGBA),r.version=i.gradientVersion,o=r.texture}m.activeTexture.set(g.TEXTURE0),o.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(m,g.TRIANGLES,a,e.stencilModeForClipping(y),l,t.CullFaceMode.disabled,E,i.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,i.paint,e.transform.zoom,o,s.layoutVertexBuffer2),_=!1}},fill:function(e,n,i,r){const s=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0===o.constantOr(1))return;const a=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===s.constantOr(t.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){const s=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);Un(e,n,i,r,s,a,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){const s=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);Un(e,n,i,r,s,a,!0)}},"fill-extrusion":function(e,n,i,r){const s=i.paint.get("fill-extrusion-opacity");if(0!==s&&"translucent"===e.renderPass){const o=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==s||i.paint.get("fill-extrusion-pattern").constantOr(1))jn(e,n,i,r,o,t.StencilMode.disabled,t.ColorMode.disabled),jn(e,n,i,r,o,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const s=e.colorModeForRenderPass();jn(e,n,i,r,o,t.StencilMode.disabled,s)}}},hillshade:function(e,n,i,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const s=e.context,o=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),a=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[c,u]="translucent"!==e.renderPass||l?[{},r]:e.stencilConfigForOverlap(r);for(const h of u){const r=n.getTile(h);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)Ze(e,r,i,o,t.StencilMode.disabled,a);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(h):c[h.overscaledZ];$e(e,h,r,i,o,t,a)}}s.viewport.set([0,0,e.width,e.height])},raster:function(e,n,i,r,s,o){if("translucent"!==e.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const a=e.context,l=a.gl,c=n.getSource(),u=e.useProgram("raster"),h=e.colorModeForRenderPass(),d=e.terrain&&e.terrain.renderingToTexture,[p,f]=c instanceof vt||d?[{},r]:e.stencilConfigForOverlap(r),m=f[f.length-1].overscaledZ,g=!e.options.moving;for(const _ of f){const r=d?t.DepthMode.disabled:e.depthModeForSublayer(_.overscaledZ-m,1===i.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),s=n.getTile(_);if(d&&(!s||!s.hasData()))continue;const f=d?_.posMatrix:e.transform.calculatePosMatrix(_.toUnwrapped(),g),y=e.terrain&&d?e.terrain.stencilModeForRTTOverlap(_):p[_.overscaledZ],v=o?0:i.paint.get("raster-fade-duration");s.registerFadeDuration(v);const x=n.findLoadedParent(_,0),b=tn(s,x,n,e.transform,v);let w,C;e.terrain&&e.terrain.prepareDrawTile(_);const E="nearest"===i.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),s.texture.bind(E,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(l.TEXTURE1),x?(x.texture.bind(E,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,x.tileID.overscaledZ-s.tileID.overscaledZ),C=[s.tileID.canonical.x*w%1,s.tileID.canonical.y*w%1]):s.texture.bind(E,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);const S=Sn(f,C||[0,0],w||1,b,i);c instanceof vt?u.draw(a,l.TRIANGLES,r,t.StencilMode.disabled,h,t.CullFaceMode.disabled,S,i.id,c.boundsBuffer,e.quadTriangleIndexBuffer,c.boundsSegments):u.draw(a,l.TRIANGLES,r,y,h,t.CullFaceMode.disabled,S,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,n,i,r){const s=i.paint.get("background-color"),o=i.paint.get("background-opacity");if(0===o)return;const a=e.context,l=a.gl,c=e.transform,u=c.tileSize,h=i.paint.get("background-pattern");if(e.isPatternMissing(h))return;const d=!h&&1===s.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==d)return;const p=t.StencilMode.disabled,f=e.depthModeForSublayer(0,"opaque"===d?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),m=e.colorModeForRenderPass(),g=e.useProgram(h?"backgroundPattern":"background"),_=r||c.coveringTiles({tileSize:u});h&&(a.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));const y=i.getCrossfadeParameters();for(const v of _){const n=r?v.posMatrix:e.transform.calculatePosMatrix(v.toUnwrapped());e.prepareDrawTile(v);const c=h?In(n,o,e,h,{tileID:v,tileSize:u},y):Pn(n,o,s);g.draw(a,l.TRIANGLES,f,p,m,t.CullFaceMode.disabled,c,i.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}},sky:function(e,n,i){const r=i.paint.get("sky-opacity");if(0===r)return;const s=e.context,o=i.paint.get("sky-type"),a=new t.DepthMode(s.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),l=e.frameCounter/1e3%1;"atmosphere"===o?"offscreen"===e.renderPass?i.needsSkyboxCapture(e)&&(function(e,n,i,r){const s=e.context,o=s.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=s.createFramebuffer(32,32,!1),n.skyboxGeometry=new ni(s),n.skyboxTexture=s.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,n.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(let t=0;t<6;++t)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}s.bindFramebuffer.set(a.framebuffer),s.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),c=e.useProgram("skyboxCapture"),u=new Float64Array(16);t.identity(u),t.rotateY(u,u,.5*-Math.PI),ii(s,n,c,u,l,0),t.identity(u),t.rotateY(u,u,.5*Math.PI),ii(s,n,c,u,l,1),t.identity(u),t.rotateX(u,u,.5*-Math.PI),ii(s,n,c,u,l,2),t.identity(u),t.rotateX(u,u,.5*Math.PI),ii(s,n,c,u,l,3),t.identity(u),ii(s,n,c,u,l,4),t.identity(u),t.rotateY(u,u,Math.PI),ii(s,n,c,u,l,5),s.viewport.set([0,0,e.width,e.height])}(e,i),i.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,i,r,s){const o=e.context,a=o.gl,l=e.transform,c=e.useProgram("skybox");o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const u=((t,e,n,i,r)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:i,u_temporal_offset:r}))(l.skyboxMatrix,n.getCenter(e,!1),0,r,s);c.draw(o,a.TRIANGLES,i,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,u,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,a,r,l):"gradient"===o&&"sky"===e.renderPass&&function(e,n,i,r,s){const o=e.context,a=o.gl,l=e.transform,c=e.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new ni(o)),o.activeTexture.set(a.TEXTURE0);let u=n.colorRampTexture;u||(u=n.colorRampTexture=new t.Texture(o,n.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((e,n,i,r,s)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.degToRad(i),u_opacity:r,u_temporal_offset:s}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),r,s);c.draw(o,a.TRIANGLES,i,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,a,r,l)},debug:function(t,e,n){for(let i=0;i<n.length;i++)Yn(t,e,n[i])},custom:function(e,n,i){const r=e.context,s=i.implementation;if("offscreen"===e.renderPass){const t=s.prerender;t&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),t.call(s,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(t.StencilMode.disabled);const n="3d"===s.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);r.setDepthMode(n),s.render(r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}};class si{constructor(e,n){this.context=new gt(e),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Pe,this.gpuTimers={},this.frameCounter=0}updateTerrain(t,e){const n=!!t&&!!t.terrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rn(this,t));const i=this._terrain;this.transform.elevation=n?i:null,i.update(t,this.transform,e)}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,n){if(this.width=e*t.exported.devicePixelRatio,this.height=n*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(i,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const r=new t.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(t.EXTENT,0,t.EXTENT,0),r.emplaceBack(0,t.EXTENT,0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(r,yt.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const s=new t.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(s,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout1ui2;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);const a=new t.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now())}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=t.create$1();t.ortho(i,0,this.width,this.height,0,0,1),t.scale$1(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,Je(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,i){if(!(n&&this.currentStencilSource!==n.id&&e.isTileClipped()&&i&&i.length))return;this.currentStencilSource=n.id;const r=this.context,s=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of i){const e=this._tileClippingMaskIDs[a.key]=this.nextStencilID++;o.draw(r,s.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:s.ALWAYS,mask:0},e,255,s.KEEP,s.KEEP,s.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Je(a.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.StencilMode({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,i=e.sort((t,e)=>e.overscaledZ-t.overscaledZ),r=i[i.length-1].overscaledZ,s=i[0].overscaledZ-r+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();const e={};for(let i=0;i<s;i++)e[i+r]=new t.StencilMode({func:n.GEQUAL,mask:255},i+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=s,[e,i]}return[{[r]:t.StencilMode.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,n,i){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(i||this.context.gl.LEQUAL,n,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const i=this.style.order,r=this.style._sourceCaches;for(const t in r){const e=r[t];e.used&&e.prepare(this.context)}const s={},o={},a={};for(const t in r){const e=r[t];s[t]=e.getVisibleCoordinates(),o[t]=s[t].slice().reverse(),a[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),t.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const t of i){const n=this.style._layers[t],i=e._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const r=i?o[i.id]:void 0;("custom"===n.type||n.isSky()||r&&r.length)&&this.renderLayer(this,i,n,r)}if(this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky())continue;const r=n?o[n.id]:void 0;this._renderTileClippingMasks(t,n,r),this.renderLayer(this,n,t,r)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?o[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;){const t=this.style._layers[i[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=n?("symbol"===t.type?a:o)[n.id]:void 0;this._renderTileClippingMasks(t,n,n?s[n.id]:void 0),this.renderLayer(this,n,t,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let n=null;t.values(this.style._layers).forEach(t=>{const i=e._getLayerSourceCache(t);i&&!t.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<i.getSource().maxzoom)&&(n=i)}),n&&this.options.showTileBoundaries&&ri.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;Xn(t,t.transform.height-(e.top||0),3,$n),Xn(t,e.bottom||0,3,Gn),Kn(t,e.left||0,3,Zn),Kn(t,t.transform.width-(e.right||0),3,Hn);const n=t.transform.centerPoint;!function(t,e,n,i){Qn(t,e-1,n-10,2,20,i),Qn(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,Wn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%t.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}}renderLayer(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||i&&i.length)&&(this.id=n.id,this.gpuTimingStart(n),ri[n.type](t,e,n,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const n in t){const i=t[n],r=this.context.extTimerQuery,s=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),e[n]=s}return e}translatePosMatrix(e,n,i,r,s){if(!i[0]&&!i[1])return e;const o=s?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){const t=Math.sin(o),e=Math.cos(o);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const a=[s?i[0]:S(n,i[0],this.transform.zoom),s?i[1]:S(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,a),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=[];return this.terrain&&!this.terrain.renderingToTexture&&e.push("TERRAIN"),t&&e.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&e.push("OVERDRAW_INSPECTOR"),e}useProgram(t,e,n){this.cache=this.cache||{};const i=n||[],r=this.currentGlobalDefines().concat(i),s=on.cacheKey(t,r,e);return this.cache[s]||(this.cache[s]=new on(this.context,t,Ve[t],e,On[t],r)),this.cache[s]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(t){this.terrain&&this.terrain.prepareDrawTile(t)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}}class oi{constructor(t=0,e=0,n=0,i=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i}interpolate(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,i)),this}getCenter(e,n){const i=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.pointGeometry(i,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new oi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ai(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function li(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]}function ci(e,n){const i=ai(e,3);t.fromQuat(e,n),li(e,3,i)}function ui(t,e){li(t,3,[e[0],e[1],e[2],1])}function hi(e,n){const i=t.identity$1([]);return t.rotateZ$1(i,i,-n),t.rotateX$1(i,i,-e),i}function di(e,n){const i=[e[0],e[1],0],r=[n[0],n[1],0];if(t.length(i)>=1e-15){const e=t.normalize([],i);t.scale(r,e,t.dot(r,e)),n[0]=r[0],n[1]=r[1]}const s=t.cross([],n,e);if(t.len(s)<1e-15)return null;const o=Math.atan2(-s[1],s[0]);return hi(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),o)}class pi{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){this._position=this._renderWorldCopies?function(e){if(!e)return;const n=Array.isArray(e)?new t.MercatorCoordinate(e[0],e[1],e[2]):e;return n.x=t.wrap(n.x,0,1),n}(e):e}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const i=this._elevation?this._elevation.getAtPoint(t.MercatorCoordinate.fromLngLat(e)):0,r=this.position,s=t.MercatorCoordinate.fromLngLat(e,i),o=[s.x-r.x,s.y-r.y,s.z-r.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=di(o,n)}setPitchBearing(e,n){this.orientation=hi(t.degToRad(e),t.degToRad(-n))}}class fi{constructor(e,n){this._transform=t.identity([]),this._orientation=t.identity$1([]),n&&(this._orientation=n,ci(this._transform,this._orientation)),e&&ui(this._transform,e)}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const t=ai(this._transform,3);return[t[0],t[1],t[2]]}set position(t){ui(this._transform,t)}get orientation(){return this._orientation}set orientation(t){this._orientation=t,ci(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=hi(t,e),ci(this._transform,this._orientation)}forward(){const t=ai(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=ai(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=ai(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(e,n){const i=new Float64Array(16);return t.invert(i,this.getWorldToCamera(e,n)),i}getWorldToCamera(e,n){const i=new Float64Array(16),r=new Float64Array(4),s=this.position;return t.conjugate(r,this._orientation),t.scale(s,s,-e),t.fromQuat(i,r),t.translate(i,i,s),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}getCameraToClipPerspective(e,n,i,r){const s=new Float64Array(16);return t.perspective(s,e,n,i,r),s}clone(){return new fi([...this.position],[...this.orientation])}}class mi{constructor(e,n,i,r,s){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===s||s,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new oi,this._posMatrixCache={},this._alignedPosMatrixCache={},this._camera=new fi,this._centerAltitude=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const t=new mi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._cameraZoom=this._cameraZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,t?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(t){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),t&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.wrap(e,-180,180)*Math.PI/180;var i;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(i=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i),function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=i*-a+s*l,t[3]=r*-a+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const e=this._elevation.getAtPoint(t.MercatorCoordinate.fromLngLat(this.center),-1);return-1===e?(this._cameraZoom=null,!1):(this._centerAltitude=e,!0)}_updateCameraOnTerrain(){const e=this.cameraToCenterDistance/this.worldSize,n=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(n+e)}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const e=this._cameraZoom,n=this._elevation.getAtPoint(t.MercatorCoordinate.fromLngLat(this.center)),i=t.mercatorZfromAltitude(n,this.center.lat),r=this._mercatorZfromZoom(e),s=this._mercatorZfromZoom(this._maxZoom),o=Math.max(r-i,s);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const r=t.length(t.sub([],this._camera.position,i));return t.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new pi;return n.position=new t.MercatorCoordinate(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this._renderWorldCopies,n}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const n=t.transformQuat([],[0,0,-1],e),i=t.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const r=di(n,i);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;e[2]=t.clamp(e[2],r/i,r/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){const i=this.pointCoordinate(new t.pointGeometry(0,0)),r=this.pointCoordinate(new t.pointGeometry(this.width,0)),s=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),o=this.pointCoordinate(new t.pointGeometry(0,this.height)),a=Math.floor(Math.min(i.x,r.x,s.x,o.x)),l=Math.floor(Math.max(i.x,r.x,s.x,o.x)),c=1;for(let u=a-c;u<=l+c;u++)0!==u&&n.push(new t.UnwrappedTileID(u,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const i=n,r=!!e.useElevationData;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const s=t.MercatorCoordinate.fromLngLat(this.center),o=1<<n,a=[o*s.x,o*s.y,0],l=p.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),c=this.pointCoordinate(this.getCameraPoint()),u=o*t.mercatorZfromAltitude(1,this.center.lat),h=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),d=[o*c.x,o*c.y,h],m=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),g=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?n:0,_=this.elevation?1e4*this.elevation.exaggeration():0,y=t=>({aabb:new f([t*o,0,-_],[(t+1)*o,o,_]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),v=[],x=[],b=n,w=e.reparseOverscaled?i:n,C=(t,e)=>{if(!this._elevation)return;const n=this._elevation.getMinMaxForTile(e);n&&(t.min[2]=n.min,t.max[2]=n.max,t.center[2]=(t.min[2]+t.max[2])/2)},E=t=>t*t,S=E((h-this._centerAltitude)*u),T=(t,e)=>{if(e*E(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)};if(this._renderWorldCopies)for(let t=1;t<=3;t++)v.push(y(-t)),v.push(y(t));for(v.push(y(0));v.length>0;){const i=v.pop(),s=i.x,o=i.y;let c=i.fullyVisible;if(!c){const t=i.aabb.intersects(l);if(0===t)continue;c=2===t}let h=!0;if(g<=i.zoom&&i.zoom<b){const t=i.aabb.distanceX(d),e=i.aabb.distanceY(d);let n=S;r&&(n=E(i.aabb.distanceZ(d)*u));const s=t*t+e*e+n;h=s<E((1<<b-i.zoom)*m*T(Math.max(n,S),s))}if(i.zoom!==b&&h)for(let e=0;e<4;e++){const n=(s<<1)+e%2,a=(o<<1)+(e>>1),l=i.aabb.quadrant(e);let u=null;r&&i.zoom>b-6&&(u=new t.OverscaledTileID(i.zoom+1===b?w:i.zoom+1,i.wrap,i.zoom+1,n,a),C(l,u)),v.push({aabb:l,zoom:i.zoom+1,x:n,y:a,wrap:i.wrap,fullyVisible:c,tileID:u})}else{const r=i.zoom===b?w:i.zoom;if(e.minzoom&&e.minzoom>r)continue;const l=a[0]-(.5+s+(i.wrap<<i.zoom))*(1<<n-i.zoom),c=a[1]-.5-o,u=i.tileID?i.tileID:new t.OverscaledTileID(r,i.wrap,i.zoom,s,o);x.push({tileID:u,distanceSq:l*l+c*c})}}return x.sort((t,e)=>t.distanceSq-e.distanceSq).map(t=>t.tileID)}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(e,n){const i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(e),o=new t.MercatorCoordinate(s.x-(i.x-r.x),s.y-(i.y-r.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(t){this.center=this.coordinateLocation(t),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t){return this._coordinatePoint(this.locationCoordinate(t),!1)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(t){return t.toLngLat()}pointRayIntersection(e,n){const i=null!=n?n:this._centerAltitude,r=[e.x,e.y,0,1],s=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(s,s,this.pixelMatrixInverse);const o=s[3];t.scale$2(r,r,1/r[3]),t.scale$2(s,s,1/o);const a=r[2],l=s[2];return{p0:r,p1:s,t:a===l?0:(i-a)/(l-a)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse),t.scale$2(n,n,1/n[3]),t.scale$2(i,i,1/i[3]),n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,i[2]=t.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,t.scale$2(n,n,1/this.worldSize),t.scale$2(i,i,1/this.worldSize),new d([n[0],n[1],n[2]],t.normalize([],t.sub([],i,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:i,t:r}=e,s=t.mercatorZfromAltitude(n[2],this._center.lat),o=t.mercatorZfromAltitude(i[2],this._center.lat);return new t.MercatorCoordinate(t.number(n[0],i[0],r)/this.worldSize,t.number(n[1],i[1],r)/this.worldSize,t.number(s,o,r))}pointCoordinate(e){const n=this.horizonLineFromTop(!1),i=new t.pointGeometry(e.x,Math.max(n,e.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(i))}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);const n=this.elevation;let i=this.elevation.pointCoordinate(e);if(i)return new t.MercatorCoordinate(i[0],i[1],i[2]);let r=0,s=this.horizonLineFromTop();if(e.y>s)return this.pointCoordinate(e);const o=.02*s,a=e.clone();for(let l=0;l<10&&s-r>o;l++){a.y=t.number(r,s,.66);const e=n.pointCoordinate(a);e?(s=a.y,i=e):r=a.y}return i?new t.MercatorCoordinate(i[0],i[1],i[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const e=this.horizonLineFromTop();return t.y<e}}_coordinatePoint(e,n){const i=n&&this.elevation?this.elevation.getAtPoint(e,this._centerAltitude):this._centerAltitude,r=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return t.transformMat4(r,r,this.pixelMatrix),r[3]>0?new t.pointGeometry(r[0]/r[3],r[1]/r[3]):new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}getBounds(){return this._terrainEnabled()?this._getBounds3D():(new t.LngLatBounds).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom))).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom)))}_getBounds3D(){const e=this.elevation,n=e.visibleDemTiles.reduce((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t},{min:Number.MAX_VALUE,max:0});n.min*=e.exaggeration(),n.max*=e.exaggeration();const i=this.horizonLineFromTop();return[new t.pointGeometry(0,i),new t.pointGeometry(this.width,i),new t.pointGeometry(this.width,this.height),new t.pointGeometry(0,this.height)].reduce((t,e)=>t.extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,n.min)))).extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,n.max)))),new t.LngLatBounds)}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-.97*e;return t?Math.max(0,n):n}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(e,n=!1){const i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];const s=e.canonical,o=this.worldSize/this.zoomScale(s.z),a=s.x+Math.pow(2,s.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[a*o,s.y*o,0]),t.scale$1(l,l,[o/t.EXTENT,o/t.EXTENT,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),r[i]=new Float32Array(l),r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=this._camera.position,i=this._camera.forward();if(n.z<=0||i[2]>=0)return;const r=t.mercatorZfromAltitude(1,this._center.lat);n[2]/=r,i[2]/=r,t.normalize(i,i);const s=e.raycast(n,i,e.exaggeration());if(s){const e=t.scaleAndAdd([],n,i,s),r=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),o=this._camera.position,a=r.z+t.length([r.x-o[0],r.y-o[1],r.z-o[2]]);this._cameraZoom=this._zoomFromMercatorZ(a),this._centerAltitude=r.toAltitude(),this._center=r.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=e.getAtPoint(this._camera.mercatorPosition),i=this._minimumHeightOverTerrain()*Math.cos(t.degToRad(this._maxPitch)),r=t.mercatorZfromAltitude(n,this._center.lat),s=this._camera.position[2]-r;if(s<i){const e=t.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),n=this._camera.mercatorPosition,r=[e.x-n.x,e.y-n.y,e.z-n.z],o=t.length(r);r[2]-=i-s;const a=t.length(r);if(0===a)return;t.scale(r,r,o/a),this._camera.position=[e.x-r[0],e.y-r[1],e.z-r[2]],this._camera.orientation=di(r,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,n,i,r,s=-90,o=90,a=-180,l=180;const c=this.size,u=this._unmodified;if(this.latRange){const n=this.latRange;s=t.mercatorYfromLat(n[1])*this.worldSize,o=t.mercatorYfromLat(n[0])*this.worldSize,e=o-s<c.y?c.y/(o-s):0}if(this.lngRange){const e=this.lngRange;a=t.mercatorXfromLng(e[0])*this.worldSize,l=t.mercatorXfromLng(e[1])*this.worldSize,n=l-a<c.x?c.x/(l-a):0}const h=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.pointGeometry(n?(l+a)/2:h.x,e?(o+s)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){const t=h.y,e=c.y/2;t-e<s&&(r=s+e),t+e>o&&(r=o-e)}if(this.lngRange){const t=h.x,e=c.x/2;t-e<a&&(i=a+e),t+e>l&&(i=l-e)}void 0===i&&void 0===r||(this.center=this.unproject(new t.pointGeometry(void 0!==i?i:h.x,void 0!==r?r:h.y))),this._constrainCameraAltitude(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){const e=(t,e)=>Math.log2(t/(this.tileSize*Math.abs(e[1]-e[0])));let n=0;if(this.latRange){const i=this.latRange;n=e(this.height,[t.mercatorYfromLat(i[0]),t.mercatorYfromLat(i[1])])}let i=0;if(this.lngRange){const n=this.lngRange;i=e(this.width,[t.mercatorXfromLng(n[0]),t.mercatorXfromLng(n[1])])}return Math.max(n,i)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const n=t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;this._updateCameraState();const i=Math.PI/2+this._pitch,r=this.fovAboveCenter,s=this.elevation?this.elevation.getMinElevationBelowMSL()*n:0,o=(this._camera.position[2]*this.worldSize-s)/Math.cos(this._pitch),a=Math.sin(r)*o/Math.sin(t.clamp(Math.PI-i-r,.01,Math.PI-.01)),l=this.point,c=l.x,u=l.y,h=Math.cos(Math.PI/2-this._pitch)*a+o,d=Math.min(1.01*h,o*(1/this._horizonShift)),p=this.height/50,f=this._camera.getWorldToCamera(this.worldSize,n),m=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,p,d);m[8]=2*-e.x/this.width,m[9]=2*e.y/this.height;let g=t.mul$1([],m,f);this.mercatorMatrix=t.scale$1([],g,[this.worldSize,this.worldSize,this.worldSize/n]),this.projMatrix=g,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const _=new Float32Array(16);t.identity(_),t.scale$1(_,_,[1,-1,1]),t.rotateX(_,_,this._pitch),t.rotateZ(_,_,this.angle);const y=t.perspective(new Float32Array(16),this._fov,this.width/this.height,p,d),v=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;y[8]=2*-e.x/this.width,y[9]=2*(e.y+v)/this.height,this.skyboxMatrix=t.multiply(_,y,_);const x=this.width%2/2,b=this.height%2/2,w=Math.cos(this.angle),C=Math.sin(this.angle),E=c-Math.round(c)+w*x+C*b,S=u-Math.round(u)+w*b+C*x,T=new Float64Array(g);if(t.translate(T,T,[E>.5?E-1:E,S>.5?S-1:S,0]),this.alignedProjMatrix=T,g=t.create$1(),t.scale$1(g,g,[this.width/2,-this.height/2,1]),t.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=t.create$1(),t.scale$1(g,g,[1,-1,1]),t.translate(g,g,[-1,-1,0]),t.scale$1(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),g=t.invert(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const e=this._camera.forward(),n=this.cameraToCenterDistance,i=this.point,r=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),s=this.cameraToCenterDistance/r;this._camera.position=[i.x/this.worldSize-e[0]*n/s,i.y/this.worldSize-e[1]*n/s,t.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-e[2]*n/s]}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=e[2];let r=1;i>0&&(r=Math.min((n-this._camera.position[2])/i,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,r),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:i,bearing:r}=this._camera.getPitchBearing(),s=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),o=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),a=Math.max((e[2]-s)/Math.cos(i),o),l=this._zoomFromMercatorZ(a);t.scaleAndAdd(e,e,n,a),this._pitch=t.clamp(i,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(r,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new t.MercatorCoordinate(e[0],e[1],e[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!!this._elevation}isHorizonVisibleForPoints(e,n){const i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),s=Math.min(e.y,n.y),o=Math.max(e.y,n.y),a=[new t.pointGeometry(i,s),new t.pointGeometry(r,o),new t.pointGeometry(i,o),new t.pointGeometry(r,s)],l=this._renderWorldCopies?-3:0,c=this._renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>c||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.isHorizonVisibleForPoints(new t.pointGeometry(0,0),new t.pointGeometry(this.width,this.height))}zoomDeltaToMovement(e,n){const i=t.length(t.sub([],this._camera.position,e)),r=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(r)}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}}class gi{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){let n=!1,i=null;const r=()=>{i=null,n&&(t(),i=setTimeout(r,300),n=!1)};return()=>(n=!0,i||r(),i)}(this._updateHashUnthrottled.bind(this))}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const n=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,r),o=Math.round(n.lng*s)/s,a=Math.round(n.lat*s)/s,l=this._map.getBearing(),c=this._map.getPitch();let u="";if(u+=e?`/${o}/${a}/${i}`:`${i}/${a}/${o}`,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),this._hashName){const e=this._hashName;let n=!1;const i=t.window.location.hash.slice(1).split("&").map(t=>{const i=t.split("=")[0];return i===e?(n=!0,`${i}=${u}`):t}).filter(t=>t);return n||i.push(`${e}=${u}`),`#${i.join("&")}`}return`#${u}`}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(t=>t.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(t=>isNaN(t))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}const _i={linearity:.3,easing:t.bezier(0,0,.3,1)},yi=t.extend({deceleration:2500,maxSpeed:1400},_i),vi=t.extend({deceleration:20,maxSpeed:1400},_i),xi=t.extend({deceleration:1e3,maxSpeed:360},_i),bi=t.extend({deceleration:1e3,maxSpeed:90},_i);class wi{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const s=Ei(n.pan.mag(),i,t.extend({},yi,e||{}));r.offset=n.pan.mult(s.amount/n.pan.mag()),r.center=this._map.transform.center,Ci(r,s)}if(n.zoom){const t=Ei(n.zoom,i,vi);r.zoom=this._map.transform.zoom+t.amount,Ci(r,t)}if(n.bearing){const e=Ei(n.bearing,i,xi);r.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),Ci(r,e)}if(n.pitch){const t=Ei(n.pitch,i,bi);r.pitch=this._map.transform.pitch+t.amount,Ci(r,t)}if(r.zoom||r.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.extend(r,{noMoveStart:!0})}}function Ci(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Ei(e,n,i){const{maxSpeed:r,linearity:s,deceleration:o}=i,a=t.clamp(e*s/(n/1e3),-r,r),l=Math.abs(a)/(o*s);return{easing:i.easing,duration:1e3*l,amount:a*(l/2)}}class Si extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i,r={}){const o=s.mousePos(n.getCanvasContainer(),i),a=n.unproject(o);super(e,t.extend({point:o,lngLat:a,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class Ti extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){const r="touchend"===e?i.changedTouches:i.touches,o=s.touchPos(n.getCanvasContainer(),r),a=o.map(t=>n.unproject(t)),l=o.reduce((t,e,n,i)=>t.add(e.div(i.length)),new t.pointGeometry(0,0));super(e,{points:o,point:l,lngLats:a,lngLat:n.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Mi extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Ai{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Mi(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Si(t.type,this._map,t))}mouseup(t){this._map.fire(new Si(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Si(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Si(t.type,this._map,t))}mouseover(t){this._map.fire(new Si(t.type,this._map,t))}mouseout(t){this._map.fire(new Si(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ti(t.type,this._map,t))}touchmove(t){this._map.fire(new Ti(t.type,this._map,t))}touchend(t){this._map.fire(new Ti(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ti(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ki{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Si(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Si("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Si(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pi{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(s.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=s.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(i.x,n.x),o=Math.max(i.x,n.x),a=Math.min(i.y,n.y),l=Math.max(i.y,n.y);s.setTransform(this._box,`translate(${r}px,${a}px)`),this._box.style.width=o-r+"px",this._box.style.height=l-a+"px"}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const i=this._startPos,r=n;if(this.reset(),s.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(i,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function Ii(t,e){const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class Oi{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){const n=new t.pointGeometry(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Ii(i,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const i=Ii(n,e);for(const r in this.touches){const t=this.touches[r],e=i[r];(!e||e.dist(t)>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class zi{constructor(t){this.singleTap=new Oi(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const i=this.singleTap.touchend(t,e,n);if(i){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class Di{constructor(){this._zoomIn=new zi({numTouches:1,numTaps:2}),this._zoomOut=new zi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const i=this._zoomIn.touchend(t,e,n),r=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ri={0:1,2:2};class Li{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=s.mouseButton(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){const n=Ri[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&s.mouseButton(t)===this._eventButton&&(this._moved&&s.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fi extends Li{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class Bi extends Li{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class Ni extends Li{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class Vi{constructor(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,i){i.length>0&&(this._active=!0);const r=Ii(i,n),s=new t.pointGeometry(0,0),o=new t.pointGeometry(0,0);let a=0;for(const t in r){const e=r[t],n=this._touches[t];n&&(s._add(e),o._add(e.sub(n)),a++,r[t]=e)}if(this._touches=r,a<this._minTouches||!o.mag())return;const l=o.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(a),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ui{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[i,r]=this._firstTwoTouches,s=ji(n,e,i),o=ji(n,e,r);if(!s||!o)return;const a=this._aroundCenter?null:s.add(o).div(2);return this._move([s,o],a,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,o=ji(n,e,i),a=ji(n,e,r);o&&a||(this._active&&s.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ji(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function qi(t,e){return Math.log(t/e)/Math.LN2}class $i extends Ui{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(qi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:qi(this._distance,n),pinchAround:e}}}function Gi(t,e){return 180*t.angleWith(e)/Math.PI}class Zi extends Ui{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Gi(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=Gi(t,this._startVector);return Math.abs(n)<e}}function Hi(t){return Math.abs(t.y)>Math.abs(t.x)}class Wi extends Ui{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(t){this._lastPoints=t,Hi(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){const i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,r=e.mag()>=2;if(!i&&!r)return;if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const s=t.y>0==e.y>0;return Hi(t)&&Hi(e)&&s}}const Xi={panStep:100,bearingStep:15,pitchStep:10};class Ki{constructor(){const t=Xi;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,i=0,r=0,s=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),s=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:o=>{const a=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:Qi,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:o.getBearing()+n*this._bearingStep,pitch:o.getPitch()+i*this._pitchStep,offset:[-r*this._panStep,-s*this._panStep],center:o.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Qi(t){return t*(2-t)}const Yi=4.000244140625;class Ji{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;let n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=t.exported.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%Yi==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=s.mousePos(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform,n=()=>e._terrainEnabled()?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>Yi?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);const r=n(),s=Math.pow(2,r),o="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n(),this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:n(),r=this._startZoom,s=this._easing;let o,a=!1;if("wheel"===this._type&&r&&s){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),n=s(e);o=t.number(r,i,n),e<1?this._frameId||(this._frameId=!0):a=!0}else o=i,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,i=(t.exported.now()-e.start)/e.duration,r=e.easing(i+.01)-e.easing(i),s=.27/Math.sqrt(r*r+1e-4)*.01,o=Math.sqrt(.0729-s*s);n=t.bezier(s,o,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}reset(){this._active=!1}}class tr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class er{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nr{constructor(){this._tap=new zi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ir{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class rr{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class sr{constructor(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const or=t=>t.zoom||t.drag||t.pitch||t.rotate;class ar extends t.Event{}class lr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const i=t.sub([],n,e);this.radius=t.length(i[2]<0?t.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$2(e,e,this.constants);const n=t.scale([],e,this.radius);if(n[2]>0){const e=t.scale([],[0,0,1],t.dot(n,[0,0,1])),i=t.scale([],t.normalize([],[n[0],n[1],0]),this.radius),r=t.add([],n,t.scale([],t.sub([],t.add([],i,e),n),2));n[0]=r[0],n[1]=r[1]}return n}}function cr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class ur{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wi(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new lr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[r,o,a]of this._listeners)s.addEventListener(r,o,r===t.window.document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[e,n,i]of this._listeners)s.removeEventListener(e,n,e===t.window.document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Ai(e,t));const i=e.boxZoom=new Pi(e,t);this._add("boxZoom",i);const r=new Di,s=new er;e.doubleClickZoom=new tr(s,r),this._add("tapZoom",r),this._add("clickZoom",s);const o=new nr;this._add("tapDragZoom",o);const a=e.touchPitch=new Wi;this._add("touchPitch",a);const l=new Bi(t),c=new Ni(t);e.dragRotate=new rr(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new Fi(t),h=new Vi(t);e.dragPan=new ir(n,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new Zi,p=new $i;e.touchZoomRotate=new sr(n,p,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ki(e));const f=e.scrollZoom=new Ji(e,this);this._add("scrollZoom",f,["mousePan"]);const m=e.keyboard=new Ki;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[g]&&e[g].enable(t[g])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(or(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===t.type,i=n?void 0:t,r={needsRenderFrame:!1},o={},a={},l=t.touches?this._getMapTouches(t.touches):void 0,c=l?s.touchPos(this._el,l):n?void 0:s.mousePos(this._el,t);for(const{handlerName:s,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let n;this._blockedByActive(a,p,s)?d.reset():d[e||t.type]&&(n=d[e||t.type](t,c,l),this.mergeHandlerResult(r,o,n,s,i),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||d.isActive())&&(a[s]=d)}const u={};for(const s in this._previousActiveHandlers)a[s]||(u[s]=i);this._previousActiveHandlers=a,(Object.keys(u).length||cr(r))&&(this._changes.push([r,o,u]),this._triggerRenderFrame()),(Object.keys(a).length||cr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(e,n,i,r,s){if(!i)return;t.extend(e,i);const o={handlerName:r,originalEvent:i.originalEvent||s};void 0!==i.zoomDelta&&(n.zoom=o),void 0!==i.panDelta&&(n.drag=o),void 0!==i.pitchDelta&&(n.pitch=o),void 0!==i.bearingDelta&&(n.rotate=o)}_applyChanges(){const e={},n={},i={};for(const[r,s,o]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.aroundCoord&&(e.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.extend(n,s),t.extend(i,o);this._updateMapTransform(e,n,i),this._changes=[]}_updateMapTransform(e,n,i){const r=this._map,s=r.transform,o=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!cr(e)){const t=s.zoom;s.cameraElevationReference="sea",s.recenterOnTerrain(),s.cameraElevationReference="ground",t!==s.zoom&&this._map._update(!0)}if(!cr(e))return this._fireEvents(n,i,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=e;void 0!==p&&(h=p),(t=>n.drag&&!this._eventsInProgress.drag)()&&h&&(this._dragOrigin=o(s.pointCoordinate3D(h)),this._trackingEllipsoid.setup(s._camera.position,this._dragOrigin)),s.cameraElevationReference="sea",r._stop(!0),h=h||r.transform.centerPoint,c&&(s.bearing+=c),u&&(s.pitch+=u),s._updateCameraState();const f=[0,0,0];if(a){const t=s.screenPointToMercatorRay(h),e=s.screenPointToMercatorRay(h.sub(a)),n=this._trackingEllipsoid.projectRay(t.dir),i=this._trackingEllipsoid.projectRay(e.dir);f[0]=i[0]-n[0],f[1]=i[1]-n[1]}const m=s.zoom,g=[0,0,0];if(l){const e=o(d||s.pointCoordinate3D(h)),n={dir:t.normalize([],t.sub([],e,s._camera.position))},i=s.screenPointToMercatorRay(s.centerPoint);if(n.dir[2]<0){const r=t.altitudeFromMercatorZ(e[2],e[1]),a=s.rayIntersectionCoordinate(s.pointRayIntersection(s.centerPoint,r)),c=s.zoomDeltaToMovement(o(a),l)*(i.dir[2]/n.dir[2]);t.scale(g,n.dir,c)}else if(s._terrainEnabled()){const i=s.zoomDeltaToMovement(e,l);t.scale(g,n.dir,i)}}const _=t.add(f,f,g);s._translateCameraConstrained(_),l&&Math.abs(s.zoom-m)>1e-4&&s.recenterOnTerrain(),s.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,i,!0)}_fireEvents(e,n,i){const r=or(this._eventsInProgress),s=or(e),o={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=n),this._eventsInProgress[t]=e[t]}!r&&s&&this._fireEvent("movestart",s.originalEvent);for(const t in o)this._fireEvent(t,o[t]);s&&this._fireEvent("move",s.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||i,a[`${t}end`]=l)}for(const t in a)this._fireEvent(t,a[t]);const c=or(this._eventsInProgress);if(i&&(r||s)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new ar("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class hr extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,i){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)}panTo(e,n,i){return this.easeTo(t.extend({center:e},n),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const i=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(n,e.padding),e}_cameraForBoxAndBearing(e,n,i,r){const s=this._extendCameraOptions(r),o=this.transform,a=o.padding,l=o.project(t.LngLat.convert(e)),c=o.project(t.LngLat.convert(n)),u=l.rotate(-t.degToRad(i)),h=c.rotate(-t.degToRad(i)),d=new t.pointGeometry(Math.max(u.x,h.x),Math.max(u.y,h.y)),p=new t.pointGeometry(Math.min(u.x,h.x),Math.min(u.y,h.y)),f=d.sub(p),m=(o.width-(a.left+a.right+s.padding.left+s.padding.right))/f.x,g=(o.height-(a.top+a.bottom+s.padding.top+s.padding.bottom))/f.y;if(g<0||m<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const _=Math.min(o.scaleZoom(o.scale*Math.min(m,g)),s.maxZoom),y="number"==typeof s.offset.x?new t.pointGeometry(s.offset.x,s.offset.y):t.pointGeometry.convert(s.offset),v=new t.pointGeometry((s.padding.left-s.padding.right)/2,(s.padding.top-s.padding.bottom)/2).rotate(i*Math.PI/180),x=y.add(v).mult(o.scale/o.zoomScale(_));return{center:o.unproject(l.add(c).div(2).sub(x)),zoom:_,bearing:i}}_cameraForBox(e,n,i,r,s){const o=this._extendCameraOptions(s);i=i||0,r=r||0,e=t.LngLat.convert(e),n=t.LngLat.convert(n);const a=this.transform.clone();a.padding=o.padding;const l=this.getFreeCameraOptions(),c=new t.LngLat(.5*(e.lng+n.lng),.5*(e.lat+n.lat)),u=.5*(i+r);if(a._camera.position[2]<t.mercatorZfromAltitude(u,c.lat))return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");l.lookAtPoint(c),a.setFreeCameraOptions(l);const h=t.MercatorCoordinate.fromLngLat(e),d=t.MercatorCoordinate.fromLngLat(n),m=a.pointRayIntersection(a.centerPoint,u),g=[(_=a.rayIntersectionCoordinate(m)).x,_.y,_.z];var _;const y=a.screenPointToMercatorRay(a.centerPoint);let v,x=0;do{const n=Math.floor(a.zoom),s=1<<n,o=Math.min(s*h.x,s*d.x),l=Math.min(s*h.y,s*d.y),c=Math.max(s*h.x,s*d.x),u=Math.max(s*h.y,s*d.y),m=new f([o,l,i],[c,u,r]),_=p.fromInvProjectionMatrix(a.invProjMatrix,a.worldSize,n);if(2!==m.intersects(_)){v&&(a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,-v),a._updateStateFromCamera());break}const x=t.sub([],a._camera.position,g);v=.5*t.length(x),a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,v);try{a._updateStateFromCamera()}catch(e){return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++x<10);return{center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch}}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}_raycastElevationBox(e,n){const i=this.transform.elevation;if(!i)return;const r=new t.pointGeometry(e.x,n.y),s=new t.pointGeometry(n.x,e.y),o=i.pointCoordinate(e);if(!o)return;const a=i.pointCoordinate(n);if(!a)return;const l=i.pointCoordinate(r);if(!l)return;const c=i.pointCoordinate(s);if(!c)return;const u=new t.MercatorCoordinate(o[0],o[1]).toLngLat(),h=new t.MercatorCoordinate(a[0],a[1]).toLngLat(),d=new t.MercatorCoordinate(l[0],l[1]).toLngLat(),p=new t.MercatorCoordinate(c[0],c[1]).toLngLat(),f=Math.min(u.lng,Math.min(h.lng,Math.min(d.lng,p.lng))),m=Math.min(u.lat,Math.min(h.lat,Math.min(d.lat,p.lat))),g=Math.max(u.lng,Math.max(h.lng,Math.max(d.lng,p.lng))),_=Math.max(u.lat,Math.max(h.lat,Math.max(d.lat,p.lat))),y=Math.min(o[3],Math.min(a[3],Math.min(l[3],c[3]))),v=Math.max(o[3],Math.max(a[3],Math.max(l[3],c[3])));return{minLngLat:new t.LngLat(f,m),maxLngLat:new t.LngLat(g,_),minAltitude:y,maxAltitude:v}}fitScreenCoordinates(e,n,i,r,s){let o,a,l,c;const u=t.pointGeometry.convert(e),h=t.pointGeometry.convert(n),d=this._raycastElevationBox(u,h);if(d)o=d.minLngLat,a=d.maxLngLat,l=d.minAltitude,c=d.maxAltitude;else{if(this.transform.isHorizonVisibleForPoints(u,h))return this;o=this.transform.pointLocation(u),a=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(n)),i,r):this._cameraForBox(o,a,l,c,r),r,s)}_fitInternal(e,n,i){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(e,n){this.stop();const i=this.transform;let r=!1,s=!1,o=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.LngLat.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(s=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(o=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),s&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),o&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){this.stop();const i=this.transform,r=i.zoom,s=i.pitch,o=i.bearing;i.setFreeCameraOptions(e);const a=r!==i.zoom,l=s!==i.pitch,c=o!==i.bearing;return this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),a&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),c&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),l&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const i=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:r,c="bearing"in e?this._normalizeBearing(e.bearing,s):s,u="pitch"in e?+e.pitch:o,h="padding"in e?e.padding:i.padding,d=t.pointGeometry.convert(e.offset);let p=i.centerPoint.add(d);const f=i.pointLocation(p),m=t.LngLat.convert(e.center||f);this._normalizeCenter(m);const g=i.project(f),_=i.project(m).sub(g),y=i.zoomScale(l-r);let v,x;e.around&&(v=t.LngLat.convert(e.around),x=i.locationPoint(v));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||s!==c,this._pitching=this._pitching||u!==o,this._padding=!i.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,b),this._ease(e=>{if(this._zooming&&(i.zoom=t.number(r,l,e)),this._rotating&&(i.bearing=t.number(s,c,e)),this._pitching&&(i.pitch=t.number(o,u,e)),this._padding&&(i.interpolatePadding(a,h,e),p=i.centerPoint.add(d)),v)i.setLocationAtPoint(v,x);else{const t=i.zoomScale(i.zoom-r),n=l>r?Math.min(2,y):Math.max(.5,y),s=Math.pow(n,1-e),o=i.unproject(g.add(_.mult(e*s)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?o.wrap():o,p)}this._fireMoveEvents(n)},t=>{i.recenterOnTerrain(),this._afterEase(n,t)},e),this}_prepareEase(e,n,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",n||i.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId,this.transform.cameraElevationReference="ground";const i=this._zooming,r=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),s&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(!e.essential&&t.exported.prefersReducedMotion){const i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const i=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):r,c="bearing"in e?this._normalizeBearing(e.bearing,s):s,u="pitch"in e?+e.pitch:o,h="padding"in e?e.padding:i.padding,d=i.zoomScale(l-r),p=t.pointGeometry.convert(e.offset);let f=i.centerPoint.add(p);const m=i.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);const _=i.project(m),y=i.project(g).sub(_);let v=e.curve;const x=Math.max(i.width,i.height),b=x/d,w=y.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,r,l),i.minZoom,i.maxZoom),s=x/i.zoomScale(n-r);v=Math.sqrt(s/w*2)}const C=v*v;function E(t){const e=(b*b-x*x+(t?-1:1)*C*C*w*w)/(2*(t?b:x)*C*w);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const M=E(0);let A=function(t){return T(M)/T(M+v*t)},k=function(t){return x*((T(M)*(S(e=M+v*t)/T(e))-S(M))/C)/w;var e},P=(E(1)-M)/v;if(Math.abs(w)<1e-6||!isFinite(P)){if(Math.abs(x-b)<1e-6)return this.easeTo(e,n);const t=b<x?-1:1;P=Math.abs(Math.log(b/x))/v,k=function(){return 0},A=function(e){return Math.exp(t*v*e)}}return e.duration="duration"in e?+e.duration:1e3*P/("screenSpeed"in e?+e.screenSpeed/v:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==c,this._pitching=u!==o,this._padding=!i.isPaddingEqual(h),this._prepareEase(n,!1),this._ease(e=>{const d=e*P,m=1/A(d);i.zoom=1===e?l:r+i.scaleZoom(m),this._rotating&&(i.bearing=t.number(s,c,e)),this._pitching&&(i.pitch=t.number(o,u,e)),this._padding&&(i.interpolatePadding(a,h,e),f=i.centerPoint.add(p));const v=1===e?g:i.unproject(_.add(y.mult(k(d))).mult(m));i.setLocationAtPoint(i.renderWorldCopies?v.wrap():v,f),i._updateCenterElevation(),this._fireMoveEvents(n)},()=>this._afterEase(n),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}}class dr{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=s.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){s.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString(`AttributionControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const i=n.reduce((t,e,i)=>(e.value&&(t+=`${e.key}=${e.value}${i<n.length-1?"&":""}`),t),"?");e.href=`${t.config.FEEDBACK_URL}/${i}${this._map._hash?this._map._hash.getHashString(!0):""}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(t=>"string"!=typeof t?"":t)):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const i in e){const n=e[i];if(n.used){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort((t,e)=>t.length-e.length),t=t.filter((e,n)=>{for(let i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0});const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class pr{constructor(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)}onAdd(t){this._map=t,this._container=s.create("div","mapboxgl-ctrl");const e=s.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){s.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class fr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const i of n)if(i.id===t)return void(i.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const mr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:gr,HTMLElement:_r,ImageBitmap:yr}=t.window,vr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function xr(t){t.parentNode&&t.parentNode.removeChild(t)}const br={showCompass:!0,showZoom:!0,visualizePitch:!1};class wr{constructor(e,n,i=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new Bi({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new Ni({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener(n,"mousedown",this.mousedown),s.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),s.addEventListener(n,"touchmove",this.touchmove),s.addEventListener(n,"touchend",this.touchend),s.addEventListener(n,"touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),s.disableDrag()}move(t,e){const n=this.map,i=this.mouseRotate.mousemoveWindow(t,e);if(i&&i.bearingDelta&&n.setBearing(n.getBearing()+i.bearingDelta),this.mousePitch){const i=this.mousePitch.mousemoveWindow(t,e);i&&i.pitchDelta&&n.setPitch(n.getPitch()+i.pitchDelta)}}off(){const t=this.element;s.removeEventListener(t,"mousedown",this.mousedown),s.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),s.removeEventListener(t,"touchmove",this.touchmove),s.removeEventListener(t,"touchend",this.touchend),s.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){s.enableDrag(),s.removeEventListener(t.window,"mousemove",this.mousemove),s.removeEventListener(t.window,"mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),s.mousePos(this.element,e)),s.addEventListener(t.window,"mousemove",this.mousemove),s.addEventListener(t.window,"mouseup",this.mouseup)}mousemove(t){this.move(t,s.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=s.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=s.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Cr(e,n,i){if(e=new t.LngLat(e.lng,e.lat),n){const r=new t.LngLat(e.lng-360,e.lat),s=new t.LngLat(e.lng+360,e.lat),o=360*Math.ceil(Math.abs(e.lng-i.center.lng)/360),a=i.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>i.width||n.y>i.height;i.locationPoint(r).distSqr(n)<a&&(l||Math.abs(r.lng-i.center.lng)<o)?e=r:i.locationPoint(s).distSqr(n)<a&&(l||Math.abs(s.lng-i.center.lng)<o)&&(e=s)}for(;Math.abs(e.lng-i.center.lng)>180;){const t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}const Er={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sr(t,e,n){const i=t.classList;for(const r in Er)i.remove(`mapboxgl-${n}-anchor-${r}`);i.add(`mapboxgl-${n}-anchor-${e}`)}class Tr extends t.Evented{constructor(e,n){if(super(),(e instanceof t.window.HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div"),this._element.setAttribute("aria-label","Map marker");const n=s.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${i}px`),n.setAttributeNS(null,"width",`${r}px`),n.setAttributeNS(null,"viewBox",`0 0 ${r} ${i}`);const o=s.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");const a=s.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");const l=s.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=s.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const u=s.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=s.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=s.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=s.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=s.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=s.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const _=s.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(_),a.appendChild(l),a.appendChild(u),a.appendChild(d),a.appendChild(f),a.appendChild(m),n.appendChild(a),n.setAttributeNS(null,"height",i*this._scale+"px"),n.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(n),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),Sr(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,i=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-n+i)],"bottom-right":[-i,-1*(e-n+i)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_updateOcclusion(){this._occlusionTimer||(this._occlusionTimer=setTimeout(this._onOcclusionTimer.bind(this),60))}_onOcclusionTimer(){const t=this._map.transform,e=this._pos?this._pos.sub(this._transformedOffset()):null;if(e&&e.x>=0&&e.x<t.width&&e.y>=0&&e.y<t.height){const t=this._map.unproject(e),n=this._map.getFreeCameraOptions();if(n.position){const e=n.position.toLngLat(),i=e.distanceTo(t),r=e.distanceTo(this._lngLat);this._element.classList.toggle("mapboxgl-marker-occluded",i<.9*r)}}this._occlusionTimer=null}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Cr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset()),this._map.transform.elevation&&this._updateOcclusion();let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),s.setTransform(this._element,`${Er[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${e}`)}_transformedOffset(){if(!this._defaultMarker)return this._offset;const t=this._map.transform,e=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&e._rotate(t.angle),"map"===this._pitchAlignment&&(e.y*=Math.cos(t._pitch)),e}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Mr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ar,kr=0,Pr=!1;const Ir={maxWidth:100,unit:"metric"};function Or(t,e,n){const i=n&&n.maxWidth||100,r=t._container.clientHeight/2,s=t.unproject([0,r]),o=t.unproject([i,r]),a=s.distanceTo(o);if(n&&"imperial"===n.unit){const n=3.2808*a;n>5280?zr(e,i,n/5280,t._getUIString("ScaleControl.Miles")):zr(e,i,n,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?zr(e,i,a/1852,t._getUIString("ScaleControl.NauticalMiles")):a>=1e3?zr(e,i,a/1e3,t._getUIString("ScaleControl.Kilometers")):zr(e,i,a,t._getUIString("ScaleControl.Meters"))}function zr(t,e,n,i){const r=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n);t.style.width=e*(r/n)+"px",t.innerHTML=`${r}&nbsp;${i}`}const Dr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Rr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Lr(e){if(e){if("number"==typeof e){const n=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(n,n),"top-right":new t.pointGeometry(-n,n),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(n,-n),"bottom-right":new t.pointGeometry(-n,-n),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const n=t.pointGeometry.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}return Lr(new t.pointGeometry(0,0))}const Fr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends hr{constructor(e){if(null!=(e=t.extend({},vr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new mi(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._renderTaskQueue=new fr,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},mr,e.locale),this._clickTolerance=e.clickTolerance,this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof _r))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ur(this,e),this._hash=e.hash&&new gi("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.attributionControl&&this.addControl(new dr({customAttribution:e.customAttribution})),this._logoControl=new pr,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.Event(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new t.Event(`${e.dataType}dataloading`,e))})}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}resize(e){const n=this._containerDimensions(),i=n[0],r=n[1];this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r);const s=!this._moving;return s&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),s&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.pointGeometry.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let i=!1;const r=r=>{const s=this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[];s.length?i||(i=!0,n.call(this,new Si(t,this,r.originalEvent,{features:s}))):i=!1};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:()=>{i=!1}}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const r=r=>{(this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?i=!0:i&&(i=!1,n.call(this,new Si(t,this,r.originalEvent)))},s=e=>{i&&(i=!1,n.call(this,new Si(t,this,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:s}}}{const i=t=>{const i=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,n.call(this,t),delete t.features)};return{layer:e,listener:n,delegates:{[t]:i}}}}on(t,e,n){if(void 0===n)return super.on(t,e);const i=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const r in i.delegates)this.on(r,i.delegates[r]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);const i=this._createDelegatedListener(t,e,n);for(const r in i.delegates)this.once(r,i.delegates[r]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(i=>{const r=this._delegatedListeners[t];for(let t=0;t<r.length;t++){const i=r[t];if(i.layer===e&&i.listener===n){for(const t in i.delegates)this.off(t,i.delegates[t]);return r.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,n){return this.style?(void 0!==n||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(n=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),t&&(this.style=new Le(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Le(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const i=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(i,t.ResourceType.Style);t.getJSON(r,(e,i)=>{e?this.fire(new t.ErrorEvent(e)):i&&this._updateDiff(i,n)})}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(i){t.warnOnce(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style._getSourceCaches(e);if(0!==n.length)return n.every(t=>t.loaded());this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)))}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n,{pixelRatio:i=1,sdf:r=!1,stretchX:s,stretchY:o,content:a}={}){if(this._lazyInitEmptyStyle(),n instanceof gr||yr&&n instanceof yr){const{width:l,height:c,data:u}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},u),pixelRatio:i,stretchX:s,stretchY:o,content:a,sdf:r,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:c,data:u}=n,h=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:c},new Uint8Array(u)),pixelRatio:i,stretchX:s,stretchY:o,content:a,sdf:r,version:0,userImage:h}),h.onAdd&&h.onAdd(this,e)}}}updateImage(e,n){const i=this.style.getImage(e);if(!i)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof gr||yr&&n instanceof yr?t.exported.getImageData(n):n,{width:s,height:o,data:a}=r;return void 0===s||void 0===o?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):s!==i.data.width||o!==i.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(a,!(n instanceof gr||yr&&n instanceof yr)),void this.style.updateImage(e,i))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,i={}){return this.style.setPaintProperty(t,e,n,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,i={}){return this.style.setLayoutProperty(t,e,n,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),this.style.setTerrain(t),this._update(!0)}getTerrain(){return this.style.getTerrain()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=s.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=s.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);const i=this._controlContainer=s.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(t=>{r[t]=s.create("div",`mapboxgl-ctrl-${t}`,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const i=t.exported.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=`${e}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?(t.storeAuthState(i,!0),this.painter=new si(i,this.transform),this.on("data",t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(i)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(e){let n,i=0;const r=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,n),i=t.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let s=!1;const o=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=t.exported.now();this.style.zoomHistory.update(e,n);const i=new t.EvaluationParameters(e,{now:n,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),r=i.crossFadingFactor();1===r&&r===this._crossFadingFactor||(s=!0,this._crossFadingFactor=r),this.style.update(i)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this._updateTerrain(),this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-i;r.endQueryEXT(r.TIME_ELAPSED_EXT,n),setTimeout(()=>{const i=r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:i}))},50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout(()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))},50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty;if(a||this._repaint)this.triggerRepaint();else if(this._triggerFrame(!1),!this.isMoving()&&this.loaded()&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}return!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,this._authenticate()),this}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof pr&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,i=n.createFramebuffer();function r(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(r(t),e.canvasCopies.map(r),e.timeStamps)}_canvasPixelComparison(t,e,n){let i=n[1]-n[0];const r=t.length/4;for(let s=0;s<e.length;s++){const o=e[s];let a=0;for(let e=0;e<o.length;e+=4)o[e]===t[e]&&o[e+1]===t[e+1]&&o[e+2]===t[e+2]&&o[e+3]===t[e+3]&&(a+=1);i+=(n[s+2]-n[s+1])*(1-a/r)}return i}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),xr(this._canvasContainer),xr(this._controlContainer),xr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame(t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)}))}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},br,e),this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),s.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),s.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=s.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new wr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){s.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=s.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){const n=this._map._getUIString(`NavigationControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},Mr,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(e){var n;return this._map=e,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==Ar?n(Ar):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(t=>{Ar="denied"!==t.state,n(Ar)}):(Ar=!!t.window.navigator.geolocation,n(Ar)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),s.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,kr=0,Pr=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,r=this._map.getBearing(),s=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),s,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([100,t]),i=e.distanceTo(n)/100,r=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Pr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=s.create("button","mapboxgl-ctrl-geolocate",this._container),s.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Tr(this._dotElement),this._circleElement=s.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Tr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":kr--,Pr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),kr++,kr>1?(e={maximumAge:6e5,timeout:0},Pr=!0):(e=this.options.positionOptions,Pr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dr,ScaleControl:class{constructor(e){this.options=t.extend({},Ir,e),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Or(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,Or(this._map,this._container,this.options)}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){s.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=s.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);s.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(Dr),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const n=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");let r;for(i.innerHTML=e;r=i.firstChild,r;)n.appendChild(r);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=s.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_update(t){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(t=>this._container.classList.add(t)),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cr(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let n=this.options.anchor;const i=Lr(this.options.offset);if(!n){const t=this._container.offsetWidth,r=this._container.offsetHeight;let s;s=e.y+i.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<t/2?s.push("left"):e.x>this._map.transform.width-t/2&&s.push("right"),n=0===s.length?"bottom":s.join("-")}const r=e.add(i[n]).round();s.setTransform(this._container,`${Er[n]} translate(${r.x}px,${r.y}px)`),Sr(this._container,n,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Rr);t&&t.focus()}_onClose(){this.remove()}},Marker:Tr,Style:Le,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:pi,Evented:t.Evented,config:t.config,prewarm:function(){Pt().acquire(Mt)},clearPrewarmedResources:function(){const t=kt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Mt),kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return At.workerCount},set workerCount(t){At.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Fr}),n}()},"5K5J":function(t,e,n){var i;i=function(){var t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function e(e){return e.match(t)||[]}function n(t){return{language:(t=e(t))[1]||"",extlang:t[2]||"",script:t[3]||"",region:t[4]||""}}function i(t,e,n){Object.defineProperty(t,e,{value:n,enumerable:!0})}function r(t,r,s){function o(n){return e(n)[t]||""}i(o,"pattern",r),i(n,s,o)}return r(1,/^[a-zA-Z]{2,3}$/,"language"),r(2,/^[a-zA-Z]{3}$/,"extlang"),r(3,/^[a-zA-Z]{4}$/,"script"),r(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),i(n,"split",function(t){return e(t).filter(function(t,e){return t&&e})}),n},t.exports?t.exports=i():this.subtag=i()},"73jG":function(t,e,n){"use strict";var i=n("jLWS");t.exports=function(t){var e,n=t.type||i.ERROR_HTTP;if(t.body)try{e=JSON.parse(t.body)}catch(s){e=t.body}else e=null;var r=t.message||null;r||("string"==typeof e?r=e:e&&"string"==typeof e.message?r=e.message:n===i.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=n,this.statusCode=t.statusCode||null,this.request=t.request,this.body=e}},"9/5/":function(t,e){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt,a="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,c=a||l||Function("return this")(),u=Object.prototype.toString,h=Math.max,d=Math.min,p=function(){return c.Date.now()};function f(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==u.call(t)}(t))return NaN;if(f(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=f(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var a=r.test(t);return a||s.test(t)?o(t.slice(2),a?2:8):i.test(t)?NaN:+t}t.exports=function(t,e,n){var i,r,s,o,a,l,c=0,u=!1,g=!1,_=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=i,s=r;return i=r=void 0,c=e,o=t.apply(s,n)}function v(t){return c=t,a=setTimeout(b,e),u?y(t):o}function x(t){var n=t-l;return void 0===l||n>=e||n<0||g&&t-c>=s}function b(){var t=p();if(x(t))return w(t);a=setTimeout(b,function(t){var n=e-(t-l);return g?d(n,s-(t-c)):n}(t))}function w(t){return a=void 0,_&&i?y(t):(i=r=void 0,o)}function C(){var t=p(),n=x(t);if(i=arguments,r=this,l=t,n){if(void 0===a)return v(l);if(g)return a=setTimeout(b,e),y(l)}return void 0===a&&(a=setTimeout(b,e)),o}return e=m(e)||0,f(n)&&(u=!!n.leading,s=(g="maxWait"in n)?h(m(n.maxWait)||0,e):s,_="trailing"in n?!!n.trailing:_),C.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=r=a=void 0},C.flush=function(){return void 0===a?o:w(p())},C}},AxvH:function(t,e,n){"use strict";t.exports=function(t){return t?t.split(/,\s*</).reduce(function(t,e){var n=function(t){var e=t.match(/<?([^>]*)>(.*)/);if(!e)return null;var n=e[1],i=e[2].split(";"),r=null,s=i.reduce(function(t,e){var n=function(t){var e=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return e?{key:e[1],value:e[2]}:null}(e);return n?"rel"===n.key?(r||(r=n.value),t):(t[n.key]=n.value,t):t},{});return r?{url:n,rel:r,params:s}:null}(e);return n?(n.rel.split(/\s+/).forEach(function(e){t[e]||(t[e]={url:n.url,params:n.params})}),t):t},{}):{}}},Bi8L:function(t,e,n){"use strict";var i=n("R/WN");t.exports=i,"undefined"!=typeof window&&(window.Suggestions=i)},Cu2R:function(t,e,n){"use strict";var i=n("ncV3"),r=n("KXza");t.exports=function(t){return function(e){var n;n=i.prototype.isPrototypeOf(e)?e:r(e);var s=Object.create(t);return s.client=n,s}}},KXza:function(t,e,n){"use strict";var i=n("oGbY"),r=n("ncV3");function s(t){r.call(this,t)}(s.prototype=Object.create(r.prototype)).constructor=s,s.prototype.sendRequest=i.browserSend,s.prototype.abortRequest=i.browserAbort,t.exports=function(t){return new s(t)}},KtRk:function(t,e,n){"use strict";var i=n("U6jy"),r=n("pit/");t.exports=i(r,{file:function(t){if("undefined"!=typeof window){if(t instanceof global.Blob||t instanceof global.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof t&&void 0===t.pipe)return"Filename or Readable stream"},date:function(t){var e="date";if("boolean"==typeof t)return e;try{var n=new Date(t);if(n.getTime&&isNaN(n.getTime()))return e}catch(i){return e}},coordinates:function(t){return r.tuple(r.number,r.number)(t)},assertShape:function(t,e){return r.assert(r.strictShape(t),e)}})},LFDd:function(t,e,n){"use strict";var i=n("U6jy"),r=n("KtRk"),s=n("baNz"),o=n("eFQn"),a=n("Cu2R"),l={},c=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];l.forwardGeocode=function(t){r.assertShape({query:r.required(r.string),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),proximity:r.coordinates,types:r.arrayOf(r.oneOf(c)),autocomplete:r.boolean,bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),routing:r.boolean})(t),t.mode=t.mode||"mapbox.places";var e=o(i({country:t.countries},s(t,["proximity","types","autocomplete","bbox","limit","language","routing"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(t,["mode","query"]),query:e})},l.reverseGeocode=function(t){r.assertShape({query:r.required(r.coordinates),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),types:r.arrayOf(r.oneOf(c)),bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),reverseMode:r.oneOf("distance","score"),routing:r.boolean})(t),t.mode=t.mode||"mapbox.places";var e=o(i({country:t.countries},s(t,["country","types","bbox","limit","language","reverseMode","routing"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(t,["mode","query"]),query:e})},t.exports=a(l)},"NkL+":function(t,e,n){"use strict";var i=Object.prototype.toString;t.exports=function(t){var e;return"[object Object]"===i.call(t)&&(null===(e=Object.getPrototypeOf(t))||e===Object.getPrototypeOf({}))}},"P8+q":function(t,e,n){var i;t.exports=i={},i.simpleFilter=function(t,e){return e.filter(function(e){return i.test(t,e)})},i.test=function(t,e){return null!==i.match(t,e)},i.match=function(t,e,n){var i,r=0,s=[],o=e.length,a=0,l=0,c=(n=n||{}).pre||"",u=n.post||"",h=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var d=0;d<o;d++)i=e[d],h[d]===t[r]?(i=c+i+u,r+=1,l+=1+l):l=0,a+=l,s[s.length]=i;return r===t.length?(a=h===t?1/0:a,{rendered:s.join(""),score:a}):null},i.filter=function(t,e,n){return e&&0!==e.length?"string"!=typeof t?e:(n=n||{},e.reduce(function(e,r,s,o){var a=r;n.extract&&(a=n.extract(r));var l=i.match(t,a,n);return null!=l&&(e[e.length]={string:l.rendered,score:l.score,index:s,original:r}),e},[]).sort(function(t,e){return e.score-t.score||t.index-e.index})):[]}},"R/WN":function(t,e,n){"use strict";var i=n("U6jy"),r=n("P8+q"),s=n("SX8C"),o=function(t,e,n){return this.options=i({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n=n||{}),this.el=t,this.data=e||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(t){this.handleKeyUp(t.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(t){this.handleKeyDown(t)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(t){this.handlePaste(t)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};o.prototype.handleKeyUp=function(t){40!==t&&38!==t&&27!==t&&13!==t&&9!==t&&this.handleInputChange(this.el.value)},o.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},o.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},o.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(t.target.value)},100)}},o.prototype.handleInputChange=function(t){this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates((function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}).bind(this))},o.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},o.prototype.update=function(t){this.data=t,this.handleKeyUp()},o.prototype.clear=function(){this.data=[],this.list.clear()},o.prototype.normalize=function(t){return t.toLowerCase()},o.prototype.match=function(t,e){return t.indexOf(e)>-1},o.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},o.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:(function(t){return this.getItemValue(t)}).bind(this)};t(this.options.filter?r.filter(this.query,this.data,e).map((function(t){return{original:t.original,string:this.render(t.original,t.string)}}).bind(this)):this.data.map((function(t){return{original:t,string:this.render(t)}}).bind(this)))},o.prototype.getItemValue=function(t){return t},o.prototype.render=function(t,e){if(e)return e;for(var n=this.getItemValue(t.original?t.original:t),i=this.normalize(n),r=i.lastIndexOf(this.query);r>-1;){var s=r+this.query.length;n=n.slice(0,r)+"<strong>"+n.slice(r,s)+"</strong>"+n.slice(s),r=i.slice(0,r).lastIndexOf(this.query)}return n},o.prototype.renderError=function(t){this.list.drawError(t)},t.exports=o},SX8C:function(t,e,n){"use strict";var i=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};i.prototype.show=function(){this.element.style.display="block"},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.add=function(t){this.items.push(t)},i.prototype.clear=function(){this.items=[],this.active=0},i.prototype.isEmpty=function(){return!this.items.length},i.prototype.isVisible=function(){return"block"===this.element.style.display},i.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()}else this.hide()},i.prototype.drawItem=function(t,e){var n=document.createElement("li"),i=document.createElement("a");e&&(n.className+=" active"),i.innerHTML=t.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),n.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,t)}).bind(this))},i.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()},i.prototype.move=function(t){this.active=t,this.draw()},i.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},i.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},i.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()},t.exports=i},"Smn/":function(t,e,n){"use strict";t.exports=function(t,e){return Object.keys(t).reduce(function(n,i){return n[i]=e(i,t[i]),n},{})}},SsYf:function(t,e){t.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},U6jy:function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var r in i)n.call(i,r)&&(t[r]=i[r])}return t};var n=Object.prototype.hasOwnProperty},WpKc:function(t,e,n){"use strict";var i=n("c90T");function r(t){this.origin=t.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=t.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=t,this.send=this.send.bind(this),this.countries=t.countries?t.countries.split(","):null,this.types=t.types?t.types.split(","):null,this.bbox=t.bbox?t.bbox:null,this.language=t.language?t.language.split(","):null,this.limit=t.limit?+t.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(t),this.eventQueue=new Array,this.flushInterval=t.flushInterval||1e3,this.maxQueueSize=t.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}r.prototype={select:function(t,e){var n=this.getSelectedIndex(t,e),i=this.getEventPayload("search.select",e);if(i.resultIndex=n,i.resultPlaceName=t.place_name,i.resultId=t.id,(n!==this.lastSentIndex||i.queryString!==this.lastSentInput)&&-1!=n&&(this.lastSentIndex=n,this.lastSentInput=i.queryString,i.queryString))return this.push(i)},start:function(t){var e=this.getEventPayload("search.start",t);if(e.queryString)return this.push(e)},keyevent:function(t,e){if(t.key&&!t.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(t.keyCode)){var n=this.getEventPayload("search.keystroke",e);if(n.lastAction=t.key,n.queryString)return this.push(n)}},send:function(t,e){if(!this.enableEventLogging)return e?e():void 0;var n=this.getRequestOptions(t);this.request(n,(function(t){return t?this.handleError(t,e):e?e():void 0}).bind(this))},getRequestOptions:function(t){return Array.isArray(t)||(t=[t]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}},getEventPayload:function(t,e){var n;n=e.options.proximity?[e.options.proximity.longitude,e.options.proximity.latitude]:null;var i=e._map?e._map.getZoom():void 0,r={event:t,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",proximity:n,limit:e.options.limit,mapZoom:i,keyboardLocale:this.locale};return r.queryString="search.select"===t?e.inputString:"search.select"!=t&&e._inputEl?e._inputEl.value:e.inputString,r},request:function(t,e){var n=new XMLHttpRequest;for(var i in n.onreadystatechange=function(){if(4==this.readyState)return e(204==this.status?null:this.statusText)},n.open(t.method,t.host+"/"+t.path,!0),t.headers)n.setRequestHeader(i,t.headers[i]);n.send(t.body)},handleError:function(t,e){if(e)return e(t)},generateSessionID:function(){return i()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(t,e){if(e._typeahead){var n=t.id;return e._typeahead.data.map(function(t){return t.id}).indexOf(n)}},shouldEnableLogging:function(t){return!(!1===t.enableEventLogging||t.origin&&-1==t.origin.indexOf("api.mapbox.com")||t.localGeocoder||t.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(t,e){this.eventQueue.push(t),(this.eventQueue.length>=this.maxQueueSize||e)&&this.flush()},remove:function(){this.flush()}},t.exports=r},YI60:function(t,e,n){"use strict";var i=n("aqBw"),r={};function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t){if(r[t])return r[t];var e=t.split("."),n=e[0],o=e[1];if(!o)throw new Error("Invalid token");var a=function(t){try{return JSON.parse(i.decode(t))}catch(e){throw new Error("Invalid token")}}(o),l={usage:n,user:a.u};return s(a,"a")&&(l.authorization=a.a),s(a,"exp")&&(l.expires=1e3*a.exp),s(a,"iat")&&(l.created=1e3*a.iat),s(a,"scopes")&&(l.scopes=a.scopes),s(a,"client")&&(l.client=a.client),s(a,"ll")&&(l.lastLogin=a.ll),s(a,"iu")&&(l.impersonator=a.iu),r[t]=l,l}},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},aqBw:function(t,e,n){(function(t){var i;!function(r){"object"==typeof global&&global;var s=function(t){this.message=t};(s.prototype=new Error).name="InvalidCharacterError";var o=function(t){throw new s(t)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=/[\t\n\f\r ]/g,c={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&o("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n,i,r,s=t.length%3,l="",c=-1,u=t.length-s;++c<u;)e=t.charCodeAt(c)<<16,n=t.charCodeAt(++c)<<8,i=t.charCodeAt(++c),l+=a.charAt((r=e+n+i)>>18&63)+a.charAt(r>>12&63)+a.charAt(r>>6&63)+a.charAt(63&r);return 2==s?(e=t.charCodeAt(c)<<8,n=t.charCodeAt(++c),l+=a.charAt((r=e+n)>>10)+a.charAt(r>>4&63)+a.charAt(r<<2&63)+"="):1==s&&(r=t.charCodeAt(c),l+=a.charAt(r>>2)+a.charAt(r<<4&63)+"=="),l},decode:function(t){var e=(t=String(t).replace(l,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&o("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,s="",c=-1;++c<e;)i=a.indexOf(t.charAt(c)),n=r%4?64*n+i:i,r++%4&&(s+=String.fromCharCode(255&n>>(-2*r&6)));return s},version:"0.1.0"};void 0===(i=(function(){return c}).call(e,n,e,t))||(t.exports=i)}()}).call(this,n("YuTi")(t))},baNz:function(t,e,n){"use strict";t.exports=function(t,e){var n=function(t,n){return-1!==e.indexOf(t)&&void 0!==n};return"function"==typeof e&&(n=e),Object.keys(t).filter(function(e){return n(e,t[e])}).reduce(function(e,n){return e[n]=t[n],e},{})}},c90T:function(t,e,n){for(var i=self.crypto||self.msCrypto,r="-_",s=36;s--;)r+=s.toString(36);for(s=36;s---10;)r+=s.toString(36).toUpperCase();t.exports=function(t){var e="",n=i.getRandomValues(new Uint8Array(t||21));for(s=t||21;s--;)e+=r[63&n[s]];return e}},cRm7:function(t,e,n){"use strict";var i=n("AxvH");function r(t,e){this.request=t,this.headers=e.headers,this.rawBody=e.body,this.statusCode=e.statusCode;try{this.body=JSON.parse(e.body||"{}")}catch(n){this.body=e.body}this.links=i(this.headers.link)}r.prototype.hasNextPage=function(){return!!this.links.next},r.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},t.exports=r},cryX:function(t,e,n){"use strict";t.exports=function(t){var e={};return t?(t.trim().split(/[\r|\n]+/).forEach(function(t){var n=function(t){var e=t.indexOf(":");return{name:t.substring(0,e).trim().toLowerCase(),value:t.substring(e+1).trim()}}(t);e[n.name]=n.value}),e):e}},d0rS:function(t,e,n){"use strict";function i(t){return Array.isArray(t)?t.map(encodeURIComponent).join(","):encodeURIComponent(String(t))}function r(t,e,n){if(!1===n||null===n)return t;var r=/\?/.test(t)?"&":"?",s=encodeURIComponent(e);return void 0!==n&&""!==n&&!0!==n&&(s+="="+i(n)),""+t+r+s}t.exports={appendQueryObject:function(t,e){if(!e)return t;var n=t;return Object.keys(e).forEach(function(t){var i=e[t];void 0!==i&&(Array.isArray(i)&&(i=i.filter(function(t){return null!=t}).join(",")),n=r(n,t,i))}),n},appendQueryParam:r,prependOrigin:function(t,e){if(!e)return t;if("http"===t.slice(0,4))return t;var n="/"===t[0]?"":"/";return""+e.replace(/\/$/,"")+n+t},interpolateRouteParams:function(t,e){return e?t.replace(/\/:([a-zA-Z0-9]+)/g,function(t,n){var r=e[n];if(void 0===r)throw new Error("Unspecified route parameter "+n);return"/"+i(r)}):t}}},eFQn:function(t,e,n){"use strict";var i=n("Smn/");t.exports=function(t){return i(t,function(t,e){return"boolean"==typeof e?JSON.stringify(e):e})}},iFvi:function(t,e,n){"use strict";var i=n("Bi8L"),r=n("9/5/"),s=n("U6jy"),o=n("+qE3").EventEmitter,a=n("SsYf"),l=n("0KjW"),c=n("LFDd"),u=n("WpKc"),h=n("/5w7"),d=n("5K5J");function p(t){this._eventEmitter=new o,this.options=s({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null}p.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(t){return t.place_name},render:function(t){var e=t.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+e[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"}},addTo:function(t){function e(t,e){if(!document.body.contains(e))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const n=t.onAdd();e.appendChild(n)}if(t._controlContainer)t.addControl(this);else if(t instanceof HTMLElement)e(this,t);else{if("string"!=typeof t)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const n=document.querySelectorAll(t);if(0===n.length)throw new Error("Element ",t,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,n[0])}}},onAdd:function(t){if(t&&"string"!=typeof t&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=c(l({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new u(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",r(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(t){this.eventManager.keyevent(t,this)}).bind(this));var s=document.createElement("div");s.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),s.appendChild(this._clearEl),s.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(s),this._typeahead=new i(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),e},createIcon:function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+t),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),"innerHTML"in n)n.innerHTML=e;else{var i=document.createElement("div");i.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",n.appendChild(i.firstChild.firstChild)}return n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(t){var e=(t.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this._geocode(e)},_onKeyDown:function(t){var e=27,n=9;if(t.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();var i=t.target&&t.target.shadowRoot?t.target.shadowRoot.activeElement:t.target;if(!i||!i.value)return this.fresh=!0,t.keyCode!==n&&this.clear(t),this._clearEl.style.display="none";t.metaKey||-1!==[n,e,37,39,13,38,40].indexOf(t.keyCode)||i.value.length>=this.options.minLength&&this._geocode(i.value)},_showButton:function(){this._typeahead.selected&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()},_onChange:function(){var t=this._typeahead.selected;if(t&&JSON.stringify(t)!==this.lastSelected){var e;if(this._clearEl.style.display="none",this.options.flyTo)if(t.properties&&a[t.properties.short_code])e=s({},this.options.flyTo),this._map&&this._map.fitBounds(a[t.properties.short_code].bbox,e);else if(t.bbox){var n=t.bbox;e=s({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],e)}else(e=s({},{zoom:this.options.zoom},this.options.flyTo)).center=t.center,this._map&&this._map.flyTo(e);this.options.marker&&this._mapboxgl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._eventEmitter.emit("result",{result:t}),this.eventManager.select(t,this)}},_geocode:function(t){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:t}),this.inputString=t;var e,n=this,i=null,r=["bbox","limit","proximity","countries","types","language","reverseMode","mode"].reduce(function(t,e){return n.options[e]&&(t[e]=["countries","types","language"].indexOf(e)>-1?n.options[e].split(/[\s,]+/):n.options[e],"proximity"===e&&n.options[e]&&"number"==typeof n.options[e].longitude&&"number"==typeof n.options[e].latitude&&(t[e]=[n.options[e].longitude,n.options[e].latitude])),t},{});if(this.options.localGeocoderOnly)e=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(t)){var o=t.split(/[\s(,)?]+/).map(function(t){return parseFloat(t,10)}).reverse();"proximity"in(r=s(r,{query:o,limit:1}))&&delete r.proximity,e=this.geocoderService.reverseGeocode(r).send()}else r=s(r,{query:t}),e=this.geocoderService.forwardGeocode(r).send();var a=[];this.options.localGeocoder&&((a=this.options.localGeocoder(t))||(a=[]));var l=[];return e.catch((function(t){i=t}).bind(this)).then((function(e){this._loadingEl.style.display="none";var n={};return e?"200"==e.statusCode&&((n=e.body).request=e.request,n.headers=e.headers):n={type:"FeatureCollection",features:[]},n.config=r,this.fresh&&(this.eventManager.start(this),this.fresh=!1),n.features=n.features?a.concat(n.features):a,this.options.externalGeocoder?(l=this.options.externalGeocoder(t,n.features)||[]).then(function(t){return n.features=n.features?t.concat(n.features):t,n},function(){return n}):n}).bind(this)).then((function(t){if(i)throw i;this.options.filter&&t.features.length&&(t.features=t.features.filter(this.options.filter)),t.features.length?(this._clearEl.style.display="block",this._eventEmitter.emit("results",t),this._typeahead.update(t.features)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",t))}).bind(this)).catch((function(t){this._loadingEl.style.display="none",a.length&&this.options.localGeocoder||l.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(a)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:a}),this._eventEmitter.emit("error",{error:t})}).bind(this)),e},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(t){this._clear(t),this._inputEl.focus()},_clearOnBlur:function(t){t.relatedTarget&&this._clear(t)},_onQueryResult:function(t){var e=t.body;if(e.features.length){var n=e.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(this._map)if(this._map.getZoom()>9){var t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat})}else this.setProximity(null)},_collapse:function(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(t){return this._geocode(t).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderMessage:function(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var t=this.options.language.split(",")[0],e=d.language(t),n=h.placeholder[e];if(n)return n}return"Search"},setInput:function(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this._geocode(t),this},setProximity:function(t){return this.options.proximity=t,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(t){return t&&"function"==typeof t&&(this._typeahead.render=t),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(t){var e=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=t||this.options.language||e,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(t){return this.options.zoom=t,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(t){return this.options.flyTo=t,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(t){return this.placeholder=t||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(t){return this.options.bbox=t,this},getCountries:function(){return this.options.countries},setCountries:function(t){return this.options.countries=t,this},getTypes:function(){return this.options.types},setTypes:function(t){return this.options.types=t,this},getMinLength:function(){return this.options.minLength},setMinLength:function(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.minLength=t),this},getLimit:function(){return this.options.limit},setLimit:function(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this},getFilter:function(){return this.options.filter},setFilter:function(t){return this.options.filter=t,this},setOrigin:function(t){return this.options.origin=t,this.geocoderService=c(l({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},_handleMarker:function(t){if(this._map){this._removeMarker();var e=s({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(e),t.center?this.mapMarker.setLngLat(t.center).addTo(this._map):t.geometry&&t.geometry.type&&"Point"===t.geometry.type&&t.geometry.coordinates&&this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this.eventManager.remove(),this}},t.exports=p},jLWS:function(t,e,n){"use strict";t.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},ncV3:function(t,e,n){"use strict";var i=n("YI60"),r=n("2+Hy"),s=n("jLWS");function o(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");i(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||s.API_ORIGIN}o.prototype.createRequest=function(t){return new r(this,t)},t.exports=o},oGbY:function(t,e,n){"use strict";var i=n("cRm7"),r=n("73jG"),s=n("jLWS"),o=n("cryX"),a={};function l(t){var e=t.total,n=t.loaded;return{total:e,transferred:n,percent:100*n/e}}function c(t,e){return new Promise(function(n,i){e.onprogress=function(e){t.emitter.emit(s.EVENT_PROGRESS_DOWNLOAD,l(e))};var o=t.file;o&&(e.upload.onprogress=function(e){t.emitter.emit(s.EVENT_PROGRESS_UPLOAD,l(e))}),e.onerror=function(t){i(t)},e.onabort=function(){var e=new r({request:t,type:s.ERROR_REQUEST_ABORTED});i(e)},e.onload=function(){if(delete a[t.id],e.status<200||e.status>=400){var s=new r({request:t,body:e.response,statusCode:e.status});i(s)}else n(e)};var c=t.body;"string"==typeof c?e.send(c):c?e.send(JSON.stringify(c)):o?e.send(o):e.send(),a[t.id]=e}).then(function(e){return function(t,e){return new i(t,{body:e.response,headers:o(e.getAllResponseHeaders()),statusCode:e.status})}(t,e)})}function u(t,e){var n=t.url(e),i=new window.XMLHttpRequest;return i.open(t.method,n),Object.keys(t.headers).forEach(function(e){i.setRequestHeader(e,t.headers[e])}),i}t.exports={browserAbort:function(t){var e=a[t.id];e&&(e.abort(),delete a[t.id])},sendRequestXhr:c,browserSend:function(t){return Promise.resolve().then(function(){var e=u(t,t.client.accessToken);return c(t,e)})},createRequestXhr:u}},"pit/":function(t,e,n){"use strict";var i=n("NkL+"),r=n("U6jy"),s="value",o="\n  ",a={};function l(t){var e=Array.isArray(t);return function(n){var i=c(a.plainArray,n);if(i)return i;if(e&&n.length!==t.length)return"an array with "+t.length+" items";for(var r=0;r<n.length;r++)if(i=c(e?t[r]:t,n[r]))return[r].concat(i)}}function c(t,e){if(null!=e||t.hasOwnProperty("__required")){var n=t(e);return n?Array.isArray(n)?n:[n]:void 0}}function u(t,e){var n=t.length,i=t[n-1],o=t.slice(0,n-1);return 0===o.length&&(o=[s]),e=r(e,{path:o}),"function"==typeof i?i(e):d(e,function(t){return"must be "+(/^an? /.test(e=t)?e:/^[aeiou]/i.test(e)?"an "+e:/^[a-z]/i.test(e)?"a "+e:e)+".";var e}(i))}function h(t){return t.length<2?t[0]:2===t.length?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function d(t,e){return(p(t.path)?"Item at position ":"")+t.path.join(".")+" "+e}function p(t){return"number"==typeof t[t.length-1]||"number"==typeof t[0]}a.assert=function(t,e){return e=e||{},function(n){var i=c(t,n);if(i){var r=u(i,e);throw e.apiName&&(r=e.apiName+": "+r),new Error(r)}}},a.shape=function(t){var e,n=(e=t,Object.keys(e||{}).map(function(t){return{key:t,value:e[t]}}));return function(t){var e,i=c(a.plainObject,t);if(i)return i;for(var r=[],l=0;l<n.length;l++)(i=c(n[l].value,t[e=n[l].key]))&&r.push([e].concat(i));return r.length<2?r[0]:function(t){r=r.map(function(e){return"- "+e[0]+": "+u(e,t).split("\n").join(o)});var e=t.path.join(".");return"The following properties"+(e===s?"":" of "+e)+" have invalid values:"+o+r.join(o)}}},a.strictShape=function(t){var e=a.shape(t);return function(n){var i=e(n);if(i)return i;var r=Object.keys(n).reduce(function(e,n){return void 0===t[n]&&e.push(n),e},[]);return 0!==r.length?function(){return"The following keys are invalid: "+r.join(", ")}:void 0}},a.arrayOf=function(t){return l(t)},a.tuple=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return l(t)},a.required=function(t){function e(e){return null==e?function(t){return d(t,p(t.path)?"cannot be undefined/null.":"is required.")}:t.apply(this,arguments)}return e.__required=!0,e},a.oneOfType=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(e){var n=t.map(function(t){return c(t,e)}).filter(Boolean);if(n.length===t.length)return n.every(function(t){return 1===t.length&&"string"==typeof t[0]})?h(n.map(function(t){return t[0]})):n.reduce(function(t,e){return e.length>t.length?e:t})}},a.equal=function(t){return function(e){if(e!==t)return JSON.stringify(t)}},a.oneOf=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),e=t.map(function(t){return a.equal(t)});return a.oneOfType.apply(this,e)},a.range=function(t){var e=t[0],n=t[1];return function(t){if(c(a.number,t)||t<e||t>n)return"number between "+e+" & "+n+" (inclusive)"}},a.any=function(){},a.boolean=function(t){if("boolean"!=typeof t)return"boolean"},a.number=function(t){if("number"!=typeof t)return"number"},a.plainArray=function(t){if(!Array.isArray(t))return"array"},a.plainObject=function(t){if(!i(t))return"object"},a.string=function(t){if("string"!=typeof t)return"string"},a.func=function(t){if("function"!=typeof t)return"function"},a.validate=c,a.processMessage=u,t.exports=a},piyq:function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function s(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||t,s),l=r?r+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function l(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=this._events[r?r+t:t];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,i=e.length,s=new Array(i);n<i;n++)s[n]=e[n].fn;return s},c.prototype.listenerCount=function(t){var e=this._events[r?r+t:t];return e?e.fn?1:e.length:0},c.prototype.emit=function(t,e,n,i,s,o){var a=r?r+t:t;if(!this._events[a])return!1;var l,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,i),!0;case 5:return u.fn.call(u.context,e,n,i,s),!0;case 6:return u.fn.call(u.context,e,n,i,s,o),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,n);break;case 4:u[c].fn.call(u[c].context,e,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},c.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return l(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||i&&!o.once||n&&o.context!==n||l(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==e||i&&!o[a].once||n&&o[a].context!==n)&&c.push(o[a]);c.length?this._events[s]=1===c.length?c[0]:c:l(this,s)}return this},c.prototype.removeAllListeners=function(t){var e;return t?this._events[e=r?r+t:t]&&l(this,e):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t.exports=c},zUnb:function(t,e,n){"use strict";function i(t){return"function"==typeof t}n.r(e);let r=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function o(t){setTimeout(()=>{throw t},0)}const a={closed:!0,next(t){},error(t){if(s.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete(){}},l=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function c(t){return null!==t&&"object"==typeof t}const u=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let h=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:s,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(i(s)){r&&(this._unsubscribe=void 0);try{s.call(this)}catch(a){e=a instanceof u?d(a.errors):[a]}}if(l(o)){let t=-1,n=o.length;for(;++t<n;){const n=o[t];if(c(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof u?e=e.concat(d(a.errors)):e.push(a)}}}if(e)throw new u(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=n;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function d(t){return t.reduce((t,e)=>t.concat(e instanceof u?e.errors:e),[])}const p=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class f extends h{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!t){this.destination=a;break}if("object"==typeof t){t instanceof f?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,n)}}[p](){return this}static create(t,e,n){const i=new f(t,e,n);return i.syncErrorThrowable=!1,i}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends f{constructor(t,e,n,r){let s;super(),this._parentSubscriber=t;let o=this;i(e)?s=e:e&&(s=e.next,n=e.error,r=e.complete,e!==a&&(o=Object.create(e),i(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=s;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;o(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw n;o(n)}}__tryOrSetError(t,e,n){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(i){return s.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=i,t.syncErrorThrown=!0,!0):(o(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const g=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function _(t){return t}let y=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:i}=this,r=function(t,e,n){if(t){if(t instanceof f)return t;if(t[p])return t[p]()}return t||e||n?new f(t,e,n):new f(a)}(t,e,n);if(r.add(i?i.call(r,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),s.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(t){try{return this._subscribe(t)}catch(e){s.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:i}=t;if(e||i)return!1;t=n&&n instanceof f?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=v(e))((e,n)=>{let i;i=this.subscribe(e=>{try{t(e)}catch(r){n(r),i&&i.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[g](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?_:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=v(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function v(t){if(t||(t=s.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const x=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class b extends h{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class w extends f{constructor(t){super(t),this.destination=t}}let C=(()=>{class t extends y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new w(this)}lift(t){const e=new E(this,this);return e.operator=t,e}next(t){if(this.closed)throw new x;if(!this.isStopped){const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].next(t)}}error(t){if(this.closed)throw new x;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].error(t);this.observers.length=0}complete(){if(this.closed)throw new x;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let i=0;i<e;i++)n[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new x;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new x;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new b(this,t))}asObservable(){const t=new y;return t.source=this,t}}return t.create=(t,e)=>new E(t,e),t})();class E extends C{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):h.EMPTY}}function S(t){return t&&"function"==typeof t.schedule}function T(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new M(t,e))}}class M{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new A(t,this.project,this.thisArg))}}class A extends f{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const k=t=>e=>{for(let n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()};function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const I=P(),O=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function z(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const D=t=>{if(t&&"function"==typeof t[g])return i=t,t=>{const e=i[g]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(O(t))return k(t);if(z(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,o),t);if(t&&"function"==typeof t[I])return e=t,t=>{const n=e[I]();for(;;){let e;try{e=n.next()}catch(i){return t.error(i),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,i};function R(t,e){return new y(n=>{const i=new h;let r=0;return i.add(e.schedule(function(){r!==t.length?(n.next(t[r++]),n.closed||i.add(this.schedule())):n.complete()})),i})}function L(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[g]}(t))return function(t,e){return new y(n=>{const i=new h;return i.add(e.schedule(()=>{const r=t[g]();i.add(r.subscribe({next(t){i.add(e.schedule(()=>n.next(t)))},error(t){i.add(e.schedule(()=>n.error(t)))},complete(){i.add(e.schedule(()=>n.complete()))}}))})),i})}(t,e);if(z(t))return function(t,e){return new y(n=>{const i=new h;return i.add(e.schedule(()=>t.then(t=>{i.add(e.schedule(()=>{n.next(t),i.add(e.schedule(()=>n.complete()))}))},t=>{i.add(e.schedule(()=>n.error(t)))}))),i})}(t,e);if(O(t))return R(t,e);if(function(t){return t&&"function"==typeof t[I]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new y(n=>{const i=new h;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=t[I](),i.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=r.next();t=n.value,e=n.done}catch(i){return void n.error(i)}e?n.complete():(n.next(t),this.schedule())}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof y?t:new y(D(t))}class F extends f{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class B extends f{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function N(t,e){if(!e.closed)return t instanceof y?t.subscribe(e):D(t)(e)}function V(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(V((n,i)=>L(t(n,i)).pipe(T((t,r)=>e(n,t,i,r))),n)):("number"==typeof e&&(n=e),e=>e.lift(new U(t,n)))}class U{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new j(t,this.project,this.concurrent))}}class j extends B{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e)}_innerSub(t){const e=new F(this),n=this.destination;n.add(e);const i=N(t,e);i!==e&&n.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function q(t=Number.POSITIVE_INFINITY){return V(_,t)}function $(t,e){return e?R(t,e):new y(k(t))}function G(){return function(t){return t.lift(new Z(t))}}class Z{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const i=new H(t,n),r=e.subscribe(i);return i.closed||(i.connection=n.connect()),r}}class H extends f{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,i=t._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}class W extends y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new h,t.add(this.source.subscribe(new K(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t}refCount(){return G()(this)}}const X=(()=>{const t=W.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class K extends w{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Q(){return new C}function Y(t){for(let e in t)if(t[e]===Y)return e;throw Error("Could not find renamed property on target object.")}function J(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function tt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(tt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function et(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const nt=Y({__forward_ref__:Y});function it(t){return t.__forward_ref__=it,t.toString=function(){return tt(this())},t}function rt(t){return st(t)?t():t}function st(t){return"function"==typeof t&&t.hasOwnProperty(nt)&&t.__forward_ref__===it}class ot extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function at(t){return"string"==typeof t?t:null==t?"":String(t)}function lt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():at(t)}function ct(t,e){const n=e?` in ${e}`:"";throw new ot("201",`No provider for ${lt(t)} found${n}`)}function ut(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ht(t){return{providers:t.providers||[],imports:t.imports||[]}}function dt(t){return pt(t,mt)||pt(t,_t)}function pt(t,e){return t.hasOwnProperty(e)?t[e]:null}function ft(t){return t&&(t.hasOwnProperty(gt)||t.hasOwnProperty(yt))?t[gt]:null}const mt=Y({"\u0275prov":Y}),gt=Y({"\u0275inj":Y}),_t=Y({ngInjectableDef:Y}),yt=Y({ngInjectorDef:Y});var vt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let xt;function bt(t){const e=xt;return xt=t,e}function wt(t,e,n){const i=dt(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&vt.Optional?null:void 0!==e?e:void ct(tt(t),"Injector")}function Ct(t){return{toString:t}.toString()}var Et=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),St=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const Tt="undefined"!=typeof globalThis&&globalThis,Mt="undefined"!=typeof window&&window,At="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,kt="undefined"!=typeof global&&global,Pt=Tt||kt||Mt||At,It={},Ot=[],zt=[],Dt=Y({"\u0275cmp":Y}),Rt=Y({"\u0275dir":Y}),Lt=Y({"\u0275pipe":Y}),Ft=Y({"\u0275mod":Y}),Bt=Y({"\u0275loc":Y}),Nt=Y({"\u0275fac":Y}),Vt=Y({__NG_ELEMENT_ID__:Y});let Ut=0;function jt(t){return Ct(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Et.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||zt,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||St.Emulated,id:"c",styles:t.styles||zt,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,r=t.features,s=t.pipes;return n.id+=Ut++,n.inputs=Ht(t.inputs,e),n.outputs=Ht(t.outputs),r&&r.forEach(t=>t(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(qt):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map($t):null,n})}function qt(t){return Xt(t)||function(t){return t[Rt]||null}(t)}function $t(t){return function(t){return t[Lt]||null}(t)}const Gt={};function Zt(t){const e={type:t.type,bootstrap:t.bootstrap||zt,declarations:t.declarations||zt,imports:t.imports||zt,exports:t.exports||zt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Ct(()=>{Gt[t.id]=t.type}),e}function Ht(t,e){if(null==t)return It;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,e&&(e[r]=s)}return n}const Wt=jt;function Xt(t){return t[Dt]||null}function Kt(t,e){const n=t[Ft]||null;if(!n&&!0===e)throw new Error(`Type ${tt(t)} does not have '\u0275mod' property.`);return n}const Qt=20,Yt=10;function Jt(t){return Array.isArray(t)&&"object"==typeof t[1]}function te(t){return Array.isArray(t)&&!0===t[1]}function ee(t){return 0!=(8&t.flags)}function ne(t){return 2==(2&t.flags)}function ie(t){return 1==(1&t.flags)}function re(t){return null!==t.template}function se(t,e){return t.hasOwnProperty(Nt)?t[Nt]:null}class oe{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function ae(){return le}function le(t){return t.type.prototype.ngOnChanges&&(t.setInput=ue),ce}function ce(){const t=he(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===It)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function ue(t,e,n,i){const r=he(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:It,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new oe(l&&l.currentValue,e,o===It),t[i]=e}function he(t){return t.__ngSimpleChanges__||null}let de;function pe(t){return!!t.listen}ae.ngInherit=!0;const fe={createRenderer:(t,e)=>void 0!==de?de:"undefined"!=typeof document?document:void 0};function me(t){for(;Array.isArray(t);)t=t[0];return t}function ge(t,e){return me(e[t])}function _e(t,e){return me(e[t.index])}function ye(t,e){return t.data[e]}function ve(t,e){const n=e[t];return Jt(n)?n:n[0]}function xe(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function be(t){return 4==(4&t[2])}function we(t){return 128==(128&t[2])}function Ce(t,e){return null==e?null:t[e]}function Ee(t){t[18]=0}function Se(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const Te={lFrame:Xe(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Me(){return Te.bindingsEnabled}function Ae(){return Te.lFrame.lView}function ke(){return Te.lFrame.tView}function Pe(t){Te.lFrame.contextLView=t}function Ie(){let t=Oe();for(;null!==t&&64===t.type;)t=t.parent;return t}function Oe(){return Te.lFrame.currentTNode}function ze(t,e){const n=Te.lFrame;n.currentTNode=t,n.isParent=e}function De(){return Te.lFrame.isParent}function Re(){Te.lFrame.isParent=!1}function Le(){return Te.isInCheckNoChangesMode}function Fe(t){Te.isInCheckNoChangesMode=t}function Be(){const t=Te.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Ne(){return Te.lFrame.bindingIndex++}function Ve(t){const e=Te.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Ue(t,e){const n=Te.lFrame;n.bindingIndex=n.bindingRootIndex=t,je(e)}function je(t){Te.lFrame.currentDirectiveIndex=t}function qe(){return Te.lFrame.currentQueryIndex}function $e(t){Te.lFrame.currentQueryIndex=t}function Ge(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Ze(t,e,n){if(n&vt.SkipSelf){let i=e,r=t;for(;i=i.parent,!(null!==i||n&vt.Host||(i=Ge(r),null===i)||(r=r[15],10&i.type)););if(null===i)return!1;e=i,t=r}const i=Te.lFrame=We();return i.currentTNode=e,i.lView=t,!0}function He(t){const e=We(),n=t[1];Te.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function We(){const t=Te.lFrame,e=null===t?null:t.child;return null===e?Xe(t):e}function Xe(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Ke(){const t=Te.lFrame;return Te.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Qe=Ke;function Ye(){const t=Ke();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Je(){return Te.lFrame.selectedIndex}function tn(t){Te.lFrame.selectedIndex=t}function en(){const t=Te.lFrame;return ye(t.tView,t.selectedIndex)}function nn(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;i&&(t.contentHooks||(t.contentHooks=[])).push(-n,i),r&&((t.contentHooks||(t.contentHooks=[])).push(n,r),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,r)),s&&(t.viewHooks||(t.viewHooks=[])).push(-n,s),o&&((t.viewHooks||(t.viewHooks=[])).push(n,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function rn(t,e,n){an(t,e,3,n)}function sn(t,e,n,i){(3&t[2])===n&&an(t,e,n,i)}function on(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function an(t,e,n,i){const r=null!=i?i:-1,s=e.length-1;let o=0;for(let a=void 0!==i?65535&t[18]:0;a<s;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=i&&o>=i)break}else e[a]<0&&(t[18]+=65536),(o<r||-1==r)&&(ln(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function ln(t,e,n,i){const r=n[i]<0,s=n[i+1],o=t[r?-n[i]:n[i]];r?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,s.call(o)):s.call(o)}const cn=-1;class un{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function hn(t,e,n){const i=pe(t);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];pn(o)?i&&t.setProperty(e,o,a):i?t.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function dn(t){return 3===t||4===t||6===t}function pn(t){return 64===t.charCodeAt(0)}function fn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||mn(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function mn(t,e,n,i,r){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const n=t[s++];if("number"==typeof n){if(n===e){o=-1;break}if(n>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function gn(t){return t!==cn}function _n(t){return 32767&t}function yn(t,e){let n=t>>16,i=e;for(;n>0;)i=i[15],n--;return i}let vn=!0;function xn(t){const e=vn;return vn=t,e}let bn=0;function wn(t,e){const n=En(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,Cn(i.data,t),Cn(e,null),Cn(i.blueprint,null));const r=Sn(t,e),s=t.injectorIndex;if(gn(r)){const t=_n(r),n=yn(r,e),i=n[1].data;for(let r=0;r<8;r++)e[s+r]=n[t+r]|i[t+r]}return e[s+8]=r,s}function Cn(t,e){t.push(0,0,0,0,0,0,0,0,e)}function En(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Sn(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const t=r[1],e=t.type;if(i=2===e?t.declTNode:1===e?r[6]:null,null===i)return cn;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return cn}function Tn(t,e,n){!function(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Vt)&&(i=n[Vt]),null==i&&(i=n[Vt]=bn++);const r=255&i;e.data[t+(r>>5)]|=1<<r}(t,e,n)}function Mn(t,e,n){if(n&vt.Optional)return t;ct(e,"NodeInjector")}function An(t,e,n,i){if(n&vt.Optional&&void 0===i&&(i=null),0==(n&(vt.Self|vt.Host))){const r=t[9],s=bt(void 0);try{return r?r.get(e,i,n&vt.Optional):wt(e,i,n&vt.Optional)}finally{bt(s)}}return Mn(i,e,n)}function kn(t,e,n,i=vt.Default,r){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Vt)?t[Vt]:void 0;return"number"==typeof e?e>=0?255&e:In:e}(n);if("function"==typeof s){if(!Ze(e,t,i))return i&vt.Host?Mn(r,n,i):An(e,n,i,r);try{const t=s();if(null!=t||i&vt.Optional)return t;ct(n)}finally{Qe()}}else if("number"==typeof s){let r=null,o=En(t,e),a=cn,l=i&vt.Host?e[16][6]:null;for((-1===o||i&vt.SkipSelf)&&(a=-1===o?Sn(t,e):e[o+8],a!==cn&&Ln(i,!1)?(r=e[1],o=_n(a),e=yn(a,e)):o=-1);-1!==o;){const t=e[1];if(Rn(s,o,t.data)){const t=On(o,e,n,r,i,l);if(t!==Pn)return t}a=e[o+8],a!==cn&&Ln(i,e[1].data[o+8]===l)&&Rn(s,o,e)?(r=t,o=_n(a),e=yn(a,e)):o=-1}}}return An(e,n,i,r)}const Pn={};function In(){return new Fn(Ie(),Ae())}function On(t,e,n,i,r,s){const o=e[1],a=o.data[t+8],l=zn(a,o,n,null==i?ne(a)&&vn:i!=o&&0!=(3&a.type),r&vt.Host&&s===a);return null!==l?Dn(e,o,l,a):Pn}function zn(t,e,n,i,r){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,c=s>>20,u=r?a+c:t.directiveEnd;for(let h=i?a:a+c;h<u;h++){const t=o[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(r){const t=o[l];if(t&&re(t)&&t.type===n)return l}return null}function Dn(t,e,n,i){let r=t[n];const s=e.data;if(r instanceof un){const o=r;o.resolving&&function(t,e){throw new ot("200",`Circular dependency in DI detected for ${t}`)}(lt(s[n]));const a=xn(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?bt(o.injectImpl):null;Ze(t,i,vt.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const i=le(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,i)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&bt(l),xn(a),o.resolving=!1,Qe()}}return r}function Rn(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Ln(t,e){return!(t&vt.Self||t&vt.Host&&e)}class Fn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return kn(this._tNode,this._lView,t,void 0,e)}}function Bn(t){return Ct(()=>{const e=t.prototype.constructor,n=e[Nt]||Nn(e),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const t=r[Nt]||Nn(r);if(t&&t!==n)return t;r=Object.getPrototypeOf(r)}return t=>new t})}function Nn(t){return st(t)?()=>{const e=Nn(rt(t));return e&&e()}:se(t)}function Vn(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let i=0;for(;i<t;){const r=n[i];if(dn(r))break;if(0===r)i+=2;else if("number"==typeof r)for(i++;i<t&&"string"==typeof n[i];)i++;else{if(r===e)return n[i+1];i+=2}}}return null}(Ie(),t)}const Un="__parameters__";function jn(t,e,n){return Ct(()=>{const i=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function r(...t){if(this instanceof r)return i.apply(this,t),this;const e=new r(...t);return n.annotation=e,n;function n(t,n,i){const r=t.hasOwnProperty(Un)?t[Un]:Object.defineProperty(t,Un,{value:[]})[Un];for(;r.length<=i;)r.push(null);return(r[i]=r[i]||[]).push(e),t}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class qn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=ut({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const $n=new qn("AnalyzeForEntryComponents"),Gn=Function;function Zn(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),Zn(i,e)):e!==t&&e.push(i)}return e}function Hn(t,e){t.forEach(t=>Array.isArray(t)?Hn(t,e):e(t))}function Wn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Xn(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Kn(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}function Qn(t,e,n){let i=Jn(t,e);return i>=0?t[1|i]=n:(i=~i,function(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function Yn(t,e){const n=Jn(t,e);if(n>=0)return t[1|n]}function Jn(t,e){return function(t,e,n){let i=0,r=t.length>>1;for(;r!==i;){const n=i+(r-i>>1),s=t[n<<1];if(e===s)return n<<1;s>e?r=n:i=n+1}return~(r<<1)}(t,e)}const ti={},ei=/\n/gm,ni="__source",ii=Y({provide:String,useValue:Y});let ri;function si(t){const e=ri;return ri=t,e}function oi(t,e=vt.Default){if(void 0===ri)throw new Error("inject() must be called from an injection context");return null===ri?wt(t,void 0,e):ri.get(t,e&vt.Optional?null:void 0,e)}function ai(t,e=vt.Default){return(xt||oi)(rt(t),e)}function li(t){const e=[];for(let n=0;n<t.length;n++){const i=rt(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let t,n=vt.Default;for(let e=0;e<i.length;e++){const r=i[e],s=r.__NG_DI_FLAG__;"number"==typeof s?-1===s?t=r.token:n|=s:t=r}e.push(ai(t,n))}else e.push(ai(i))}return e}function ci(t,e){return t.__NG_DI_FLAG__=e,t.prototype.__NG_DI_FLAG__=e,t}const ui=ci(jn("Inject",t=>({token:t})),-1),hi=ci(jn("Optional"),8),di=ci(jn("SkipSelf"),4);class pi{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function fi(t){return t instanceof pi?t.changingThisBreaksApplicationSecurity:t}const mi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,gi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var _i=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function yi(t){const e=function(){const t=Ae();return t&&t[12]}();return e?e.sanitize(_i.URL,t)||"":function(t,e){const n=function(t){return t instanceof pi&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}(t,"URL")?fi(t):(n=at(t),(n=String(n)).match(mi)||n.match(gi)?n:"unsafe:"+n);var n}function vi(t){return t.ngDebugContext}function xi(t){return t.ngOriginalError}function bi(t,...e){t.error(...e)}class wi{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),i=function(t){return t.ngErrorLogger||bi}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e),n&&i(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?vi(t)?vi(t):this._findContext(xi(t)):null}_findOriginalError(t){let e=xi(t);for(;e&&xi(e);)e=xi(e);return e}}function Ci(t,e){t.__ngContext__=e}const Ei=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Pt))();function Si(t){return t instanceof Function?t():t}var Ti=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function Mi(t,e){return(void 0)(t,e)}function Ai(t){const e=t[3];return te(e)?e[3]:e}function ki(t){return Ii(t[13])}function Pi(t){return Ii(t[4])}function Ii(t){for(;null!==t&&!te(t);)t=t[4];return t}function Oi(t,e,n,i,r){if(null!=i){let s,o=!1;te(i)?s=i:Jt(i)&&(o=!0,i=i[0]);const a=me(i);0===t&&null!==n?null==r?Vi(e,n,a):Ni(e,n,a,r||null,!0):1===t&&null!==n?Ni(e,n,a,r||null,!0):2===t?function(t,e,n){const i=ji(t,e);i&&function(t,e,n,i){pe(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,n,i,r){const s=n[7];s!==me(n)&&Oi(e,t,i,s,r);for(let o=Yt;o<n.length;o++){const r=n[o];Ki(r[1],r,t,e,i,s)}}(e,t,s,n,r)}}function zi(t,e,n){return pe(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Di(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Se(r,-1)),n.splice(i,1)}function Ri(t,e){if(t.length<=Yt)return;const n=Yt+e,i=t[n];if(i){const s=i[17];null!==s&&s!==t&&Di(s,i),e>0&&(t[n-1][4]=i[4]);const o=Xn(t,Yt+e);Ki(i[1],r=i,r[11],2,null,null),r[0]=null,r[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}var r;return i}function Li(t,e){if(!(256&e[2])){const n=e[11];pe(n)&&n.destroyNode&&Ki(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Fi(t[1],t);for(;e;){let n=null;if(Jt(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)Jt(e)&&Fi(e[1],e),e=e[3];null===e&&(e=t),Jt(e)&&Fi(e[1],e),n=e&&e[4]}e=n}}(e)}}function Fi(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const t=e[n[i]];if(!(t instanceof un)){const e=n[i+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const t=n[s+1],o="function"==typeof t?t(e):me(e[t]),a=i[r=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const t=i[r=n[s+1]];n[s].call(t)}if(null!==i){for(let t=r+1;t<i.length;t++)(0,i[t])();e[7]=null}}(t,e),1===e[1].type&&pe(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&te(e[3])){n!==e[3]&&Di(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function Bi(t,e,n){return function(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const e=t.data[i.directiveStart].encapsulation;if(e===St.None||e===St.Emulated)return null}return _e(i,n)}(t,e.parent,n)}function Ni(t,e,n,i,r){pe(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function Vi(t,e,n){pe(t)?t.appendChild(e,n):e.appendChild(n)}function Ui(t,e,n,i,r){null!==i?Ni(t,e,n,i,r):Vi(t,e,n)}function ji(t,e){return pe(t)?t.parentNode(e):e.parentNode}function qi(t,e,n){return $i(t,e,n)}let $i=function(t,e,n){return 40&t.type?_e(t,n):null};function Gi(t,e,n,i){const r=Bi(t,i,e),s=e[11],o=qi(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(n))for(let a=0;a<n.length;a++)Ui(s,r,n[a],o,!1);else Ui(s,r,n,o,!1)}function Zi(t,e){if(null!==e){const n=e.type;if(3&n)return _e(e,t);if(4&n)return Wi(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Zi(t,n);{const n=t[e.index];return te(n)?Wi(-1,n):me(n)}}if(32&n)return Mi(e,t)()||me(t[e.index]);{const n=Hi(t,e);return null!==n?Array.isArray(n)?n[0]:Zi(Ai(t[16]),n):Zi(t,e.next)}}return null}function Hi(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Wi(t,e){const n=Yt+t+1;if(n<e.length){const t=e[n],i=t[1].firstChild;if(null!==i)return Zi(t,i)}return e[7]}function Xi(t,e,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===e&&(a&&Ci(me(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)Xi(t,e,n.child,i,r,s,!1),Oi(e,t,r,a,s);else if(32&l){const o=Mi(n,i);let l;for(;l=o();)Oi(e,t,r,l,s);Oi(e,t,r,a,s)}else 16&l?Qi(t,e,i,n,r,s):Oi(e,t,r,a,s);n=o?n.projectionNext:n.next}}function Ki(t,e,n,i,r,s){Xi(n,i,t.firstChild,e,r,s,!1)}function Qi(t,e,n,i,r,s){const o=n[16],a=o[6].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Oi(e,t,r,a[l],s);else Xi(t,e,a,o[3],r,s,!0)}function Yi(t,e,n){pe(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Ji(t,e,n){pe(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function tr(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const n=e.length;if(r+n===i||t.charCodeAt(r+n)<=32)return r}n=r+1}}const er="ng-template";function nr(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==tr(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function ir(t){return 4===t.type&&t.value!==er}function rr(t,e,n){return e===(4!==t.type||n?t.value:er)}function sr(t,e,n){let i=4;const r=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(dn(t[e]))return e;return t.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!rr(t,l,n)||""===l&&1===e.length){if(or(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==t.attrs){if(!nr(t.attrs,c,n)){if(or(i))return!1;o=!0}continue}const u=ar(8&i?"class":l,r,ir(t),n);if(-1===u){if(or(i))return!1;o=!0;continue}if(""!==c){let t;t=u>s?"":r[u+1].toLowerCase();const e=8&i?t:null;if(e&&-1!==tr(e,c,0)||2&i&&c!==t){if(or(i))return!1;o=!0}}}}else{if(!o&&!or(i)&&!or(l))return!1;if(o&&or(l))continue;o=!1,i=l|1&i}}return or(i)||o}function or(t){return 0==(1&t)}function ar(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let n=!1;for(;r<e.length;){const i=e[r];if(i===t)return r;if(3===i||6===i)n=!0;else{if(1===i||2===i){let t=e[++r];for(;"string"==typeof t;)t=e[++r];continue}if(4===i)break;if(0===i){r+=4;continue}}r+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function lr(t,e,n=!1){for(let i=0;i<e.length;i++)if(sr(t,e[i],n))return!0;return!1}function cr(t,e){t:for(let n=0;n<e.length;n++){const i=e[n];if(t.length===i.length){for(let e=0;e<t.length;e++)if(t[e]!==i[e])continue t;return!0}}return!1}function ur(t,e){return t?":not("+e.trim()+")":e}function hr(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&i){const e=t[++n];r+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""===r||or(o)||(e+=ur(s,r),r=""),i=o,s=s||!or(i);n++}return""!==r&&(e+=ur(s,r)),e}const dr={};function pr(t){fr(ke(),Ae(),Je()+t,Le())}function fr(t,e,n,i){if(!i)if(3==(3&e[2])){const i=t.preOrderCheckHooks;null!==i&&rn(e,i,n)}else{const i=t.preOrderHooks;null!==i&&sn(e,i,0,n)}tn(n)}function mr(t,e){return t<<17|e<<2}function gr(t){return t>>17&32767}function _r(t){return 2|t}function yr(t){return(131068&t)>>2}function vr(t,e){return-131069&t|e<<2}function xr(t){return 1|t}function br(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const n=t.data[s];$e(r),n.contentQueries(2,e[s],s)}}}function wr(t,e,n,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,Ee(u),u[3]=u[15]=t,u[8]=n,u[10]=o||t&&t[10],u[11]=a||t&&t[11],u[12]=l||t&&t[12]||null,u[9]=c||t&&t[9]||null,u[6]=s,u[16]=2==e.type?t[16]:u,u}function Cr(t,e,n,i,r){let s=t.data[e];if(null===s)s=function(t,e,n,i,r){const s=Oe(),o=De(),a=t.data[e]=function(t,e,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(t,e,n,i,r),Te.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const t=function(){const t=Te.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===t?-1:t.injectorIndex}return ze(s,!0),s}function Er(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function Sr(t,e,n){He(e);try{const i=t.viewQuery;null!==i&&ts(1,i,n);const r=t.template;null!==r&&Ar(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&br(t,e),t.staticViewQueries&&ts(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)Xr(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),i}finally{e[2]&=-5,Ye()}}function Tr(t,e,n,i){const r=e[2];if(256==(256&r))return;He(e);const s=Le();try{Ee(e),Te.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Ar(t,e,n,2,i);const o=3==(3&r);if(!s)if(o){const n=t.preOrderCheckHooks;null!==n&&rn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&sn(e,n,0,null),on(e,0)}if(function(t){for(let e=ki(t);null!==e;e=Pi(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],i=n[3];0==(1024&n[2])&&Se(i,1),n[2]|=1024}}}(e),function(t){for(let e=ki(t);null!==e;e=Pi(e))for(let t=Yt;t<e.length;t++){const n=e[t],i=n[1];we(n)&&Tr(i,n,i.template,n[8])}}(e),null!==t.contentQueries&&br(t,e),!s)if(o){const n=t.contentCheckHooks;null!==n&&rn(e,n)}else{const n=t.contentHooks;null!==n&&sn(e,n,1),on(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const i=n[t];if(i<0)tn(~i);else{const r=i,s=n[++t],o=n[++t];Ue(s,r),o(2,e[r])}}}finally{tn(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Hr(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&ts(2,l,i),!s)if(o){const n=t.viewCheckHooks;null!==n&&rn(e,n)}else{const n=t.viewHooks;null!==n&&sn(e,n,2),on(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Se(e[3],-1))}finally{Ye()}}function Mr(t,e,n,i){const r=e[10],s=!Le(),o=be(e);try{s&&!o&&r.begin&&r.begin(),o&&Sr(t,e,i),Tr(t,e,n,i)}finally{s&&!o&&r.end&&r.end()}}function Ar(t,e,n,i,r){const s=Je();try{tn(-1),2&i&&e.length>Qt&&fr(t,e,Qt,Le()),n(i,r)}finally{tn(s)}}function kr(t,e,n){Me()&&(function(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||wn(n,e),Ci(i,e);const o=n.initialInputs;for(let a=r;a<s;a++){const i=t.data[a],s=re(i);s&&qr(e,n,i);const l=Dn(e,t,a,n);Ci(l,e),null!==o&&$r(0,a-r,l,i,0,o),s&&(ve(n.index,e)[8]=l)}}(t,e,n,_e(n,e)),128==(128&n.flags)&&function(t,e,n){const i=n.directiveStart,r=n.directiveEnd,s=n.index,o=Te.lFrame.currentDirectiveIndex;try{tn(s);for(let n=i;n<r;n++){const i=t.data[n],r=e[n];je(n),null===i.hostBindings&&0===i.hostVars&&null===i.hostAttrs||Br(i,r)}}finally{tn(-1),je(o)}}(t,e,n))}function Pr(t,e,n=_e){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(e,t):t[o];t[r++]=a}}}function Ir(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Or(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Or(t,e,n,i,r,s,o,a,l,c){const u=Qt+i,h=u+r,d=function(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:dr);return n}(u,h),p="function"==typeof c?c():c;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function zr(t,e,n,i){const r=ns(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&is(t).push(i,r.length-1))}function Dr(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function Rr(t,e,n,i,r,s,o,a){const l=_e(e,n);let c,u=e.inputs;var h;!a&&null!=u&&(c=u[i])?(ss(t,n,c,i,r),ne(e)&&function(t,e){const n=ve(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i="class"===(h=i)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,r=null!=o?o(r,e.value||"",i):r,pe(s)?s.setProperty(l,i,r):pn(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Lr(t,e,n,i){let r=!1;if(Me()){const s=function(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];lr(n,o.selectors,!1)&&(r||(r=[]),Tn(wn(n,e),t,o.type),re(o)?(Nr(t,n),r.unshift(o)):r.push(o))}return r}(t,e,n),o=null===i?null:{"":-1};if(null!==s){r=!0,Ur(n,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}let i=!1,a=!1,l=Er(t,e,s.length,null);for(let r=0;r<s.length;r++){const c=s[r];n.mergedAttrs=fn(n.mergedAttrs,c.hostAttrs),jr(t,n,e,l,c),Vr(l,c,o),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const u=c.type.prototype;!i&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),i=!0),a||!u.ngOnChanges&&!u.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(t,e){const n=e.directiveEnd,i=t.data,r=e.attrs,s=[];let o=null,a=null;for(let l=e.directiveStart;l<n;l++){const t=i[l],n=t.inputs,c=null===r||ir(e)?null:Gr(n,r);s.push(c),o=Dr(n,l,o),a=Dr(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,n)}o&&function(t,e,n){if(e){const i=t.localNames=[];for(let t=0;t<e.length;t+=2){const r=n[e[t+1]];if(null==r)throw new ot("301",`Export of name '${e[t+1]}' not found!`);i.push(e[t],r)}}}(n,i,o)}return n.mergedAttrs=fn(n.mergedAttrs,n.attrs),r}function Fr(t,e,n,i,r,s){const o=s.hostBindings;if(o){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const s=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(i,r,o)}}function Br(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Nr(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Vr(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;re(e)&&(n[""]=t)}}function Ur(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function jr(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=se(r.type)),o=new un(s,re(r),null);t.blueprint[i]=o,n[i]=o,Fr(t,e,0,i,Er(t,n,r.hostVars,dr),r)}function qr(t,e,n){const i=_e(e,t),r=Ir(n),s=t[10],o=Kr(t,wr(t,r,null,n.onPush?64:16,i,e,s,s.createRenderer(i,n),null,null));t[e.index]=o}function $r(t,e,n,i,r,s){const o=s[e];if(null!==o){const t=i.setInput;for(let e=0;e<o.length;){const r=o[e++],s=o[e++],a=o[e++];null!==t?i.setInput(n,a,r,s):n[s]=a}}}function Gr(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function Zr(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function Hr(t,e){const n=ve(e,t);if(we(n)){const t=n[1];80&n[2]?Tr(t,n,t.template,n[8]):n[5]>0&&Wr(n)}}function Wr(t){for(let n=ki(t);null!==n;n=Pi(n))for(let t=Yt;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Tr(t,e,t.template,e[8])}else e[5]>0&&Wr(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const i=ve(e[n],t);we(i)&&i[5]>0&&Wr(i)}}function Xr(t,e){const n=ve(e,t),i=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(i,n),Sr(i,n,n[8])}function Kr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Qr(t){for(;t;){t[2]|=64;const e=Ai(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function Yr(t,e,n){const i=e[10];i.begin&&i.begin();try{Tr(t,e,t.template,n)}catch(r){throw rs(e,r),r}finally{i.end&&i.end()}}function Jr(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=xe(n),r=i[1];Mr(r,i,r.template,n)}}(t[8])}function ts(t,e,n){$e(0),e(t,n)}const es=(()=>Promise.resolve(null))();function ns(t){return t[7]||(t[7]=[])}function is(t){return t.cleanup||(t.cleanup=[])}function rs(t,e){const n=t[9],i=n?n.get(wi,null):null;i&&i.handleError(e)}function ss(t,e,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function os(t,e,n){const i=ge(e,t);!function(t,e,n){pe(t)?t.setValue(e,n):e.textContent=n}(t[11],i,n)}function as(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?r=et(r,t):2==s&&(i=et(i,t+": "+e[++o]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const ls=new qn("INJECTOR",-1);class cs{get(t,e=ti){if(e===ti){const e=new Error(`NullInjectorError: No provider for ${tt(t)}!`);throw e.name="NullInjectorError",e}return e}}const us=new qn("Set Injector scope."),hs={},ds={},ps=[];let fs;function ms(){return void 0===fs&&(fs=new cs),fs}function gs(t,e=null,n=null,i){return new _s(t,n,e||ms(),i)}class _s{constructor(t,e,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];e&&Hn(e,n=>this.processProvider(n,t,e)),Hn([t],t=>this.processInjectorType(t,[],r)),this.records.set(ls,xs(void 0,this));const s=this.records.get(us);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof t?null:tt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=ti,n=vt.Default){this.assertNotDestroyed();const i=si(this);try{if(!(n&vt.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(r=t)||"object"==typeof r&&r instanceof qn)&&dt(t);e=n&&this.injectableDefInScope(n)?xs(ys(t),hs):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&vt.Self?ms():this.parent).get(t,e=n&vt.Optional&&e===ti?null:e)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(tt(t)),i)throw s;return function(t,e,n,i){const r=t.ngTempTokenPath;throw e[ni]&&r.unshift(e[ni]),t.message=function(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=tt(e);if(Array.isArray(e))r=e.map(tt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];t.push(n+":"+("string"==typeof i?JSON.stringify(i):tt(i)))}r=`{${t.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(ei,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t.ngTempTokenPath=null,t}(s,t,"R3InjectorError",this.source)}throw s}finally{si(i)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(tt(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=rt(t)))return!1;let i=ft(t);const r=null==i&&t.ngModule||void 0,s=void 0===r?t:r,o=-1!==n.indexOf(s);if(void 0!==r&&(i=ft(r)),null==i)return!1;if(null!=i.imports&&!o){let t;n.push(s);try{Hn(i.imports,i=>{this.processInjectorType(i,e,n)&&(void 0===t&&(t=[]),t.push(i))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:i}=t[e];Hn(i,t=>this.processProvider(t,n,i||ps))}}this.injectorDefTypes.add(s);const a=se(s)||(()=>new s);this.records.set(s,xs(a,hs));const l=i.providers;if(null!=l&&!o){const e=t;Hn(l,t=>this.processProvider(t,e,l))}return void 0!==r&&void 0!==t.providers}processProvider(t,e,n){let i=ws(t=rt(t))?t:rt(t&&t.provide);const r=function(t,e,n){return bs(t)?xs(void 0,t.useValue):xs(vs(t),hs)}(t);if(ws(t)||!0!==t.multi)this.records.get(i);else{let e=this.records.get(i);e||(e=xs(void 0,hs,!0),e.factory=()=>li(e.multi),this.records.set(i,e)),i=t,e.multi.push(t)}this.records.set(i,r)}hydrate(t,e){var n;return e.value===hs&&(e.value=ds,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function ys(t){const e=dt(t),n=null!==e?e.factory:se(t);if(null!==n)return n;if(t instanceof qn)throw new Error(`Token ${tt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=Kn(e,"?");throw new Error(`Can't resolve all parameters for ${tt(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[mt]||t[_t]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function vs(t,e,n){let i;if(ws(t)){const e=rt(t);return se(e)||ys(e)}if(bs(t))i=()=>rt(t.useValue);else if((r=t)&&r.useFactory)i=()=>t.useFactory(...li(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>ai(rt(t.useExisting));else{const e=rt(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return se(e)||ys(e);i=()=>new e(...li(t.deps))}var r;return i}function xs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function bs(t){return null!==t&&"object"==typeof t&&ii in t}function ws(t){return"function"==typeof t}const Cs=function(t,e,n){return function(t,e=null,n=null,i){const r=gs(t,e,n,i);return r._resolveInjectorDefTypes(),r}({name:n},e,t,n)};let Es=(()=>{class t{static create(t,e){return Array.isArray(t)?Cs(t,e,""):Cs(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=ti,t.NULL=new cs,t.\u0275prov=ut({token:t,providedIn:"any",factory:()=>ai(ls)}),t.__NG_ELEMENT_ID__=-1,t})();function Ss(t,e){nn(xe(t)[1],Ie())}function Ts(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const i=[t];for(;e;){let r;if(re(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(n){i.push(r);const e=t;e.inputs=Ms(t.inputs),e.declaredInputs=Ms(t.declaredInputs),e.outputs=Ms(t.outputs);const n=r.hostBindings;n&&Ps(t,n);const s=r.viewQuery,o=r.contentQueries;if(s&&As(t,s),o&&ks(t,o),J(t.inputs,r.inputs),J(t.declaredInputs,r.declaredInputs),J(t.outputs,r.outputs),re(r)&&r.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(r.data.animation)}}const e=r.features;if(e)for(let i=0;i<e.length;i++){const r=e[i];r&&r.ngInherit&&r(t),r===Ts&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=e+=r.hostVars,r.hostAttrs=fn(r.hostAttrs,n=fn(n,r.hostAttrs))}}(i)}function Ms(t){return t===It?{}:t===zt?[]:t}function As(t,e){const n=t.viewQuery;t.viewQuery=n?(t,i)=>{e(t,i),n(t,i)}:e}function ks(t,e){const n=t.contentQueries;t.contentQueries=n?(t,i,r)=>{e(t,i,r),n(t,i,r)}:e}function Ps(t,e){const n=t.hostBindings;t.hostBindings=n?(t,i)=>{e(t,i),n(t,i)}:e}let Is=null;function Os(){if(!Is){const t=Pt.Symbol;if(t&&t.iterator)Is=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Is=n)}}}return Is}function zs(t){return!!Ds(t)&&(Array.isArray(t)||!(t instanceof Map)&&Os()in t)}function Ds(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Rs(t,e,n){return t[e]=n}function Ls(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Fs(t,e,n,i){const r=Ae();return Ls(r,Ne(),e)&&(ke(),function(t,e,n,i,r,s){const o=_e(t,e);!function(t,e,n,i,r,s,o){if(null==s)pe(t)?t.removeAttribute(e,r,n):e.removeAttribute(r);else{const a=null==o?at(s):o(s,i||"",r);pe(t)?t.setAttribute(e,r,a,n):n?e.setAttributeNS(n,r,a):e.setAttribute(r,a)}}(e[11],o,s,t.value,n,i,r)}(en(),r,t,e,n,i)),Fs}function Bs(t,e,n,i,r,s,o,a){const l=Ae(),c=ke(),u=t+Qt,h=c.firstCreatePass?function(t,e,n,i,r,s,o,a,l){const c=e.consts,u=Cr(e,t,4,o||null,Ce(c,a));Lr(e,n,u,Ce(c,l)),nn(e,u);const h=u.tViews=Or(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,n,i,r,s,o):c.data[u];ze(h,!1);const d=l[11].createComment("");Gi(c,l,d,h),Ci(d,l),Kr(l,l[u]=Zr(d,l,d,h)),ie(h)&&kr(c,l,h),null!=o&&Pr(l,h,a)}function Ns(t,e=vt.Default){const n=Ae();return null===n?ai(t,e):kn(Ie(),n,rt(t),e)}function Vs(t,e,n){const i=Ae();return Ls(i,Ne(),e)&&Rr(ke(),en(),i,t,e,i[11],n,!1),Vs}function Us(t,e,n,i,r){const s=r?"class":"style";ss(t,n,e.inputs[s],s,i)}function js(t,e,n,i){const r=Ae(),s=ke(),o=Qt+t,a=r[11],l=r[o]=zi(a,e,Te.lFrame.currentNamespace),c=s.firstCreatePass?function(t,e,n,i,r,s,o){const a=e.consts,l=Cr(e,t,2,r,Ce(a,s));return Lr(e,n,l,Ce(a,o)),null!==l.attrs&&as(l,l.attrs,!1),null!==l.mergedAttrs&&as(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,0,e,n,i):s.data[o];ze(c,!0);const u=c.mergedAttrs;null!==u&&hn(a,l,u);const h=c.classes;null!==h&&Ji(a,l,h);const d=c.styles;null!==d&&Yi(a,l,d),64!=(64&c.flags)&&Gi(s,r,l,c),0===Te.lFrame.elementDepthCount&&Ci(l,r),Te.lFrame.elementDepthCount++,ie(c)&&(kr(s,r,c),function(t,e,n){if(ee(e)){const i=e.directiveEnd;for(let r=e.directiveStart;r<i;r++){const e=t.data[r];e.contentQueries&&e.contentQueries(1,n[r],r)}}}(s,c,r)),null!==i&&Pr(r,c)}function qs(){let t=Ie();De()?Re():(t=t.parent,ze(t,!1));const e=t;Te.lFrame.elementDepthCount--;const n=ke();n.firstCreatePass&&(nn(n,t),ee(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Us(n,e,Ae(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Us(n,e,Ae(),e.stylesWithoutHost,!1)}function $s(t,e,n,i){js(t,e,n,i),qs()}function Gs(){return Ae()}function Zs(t){return!!t&&"function"==typeof t.then}const Hs=function(t){return!!t&&"function"==typeof t.subscribe};function Ws(t,e,n=!1,i){const r=Ae(),s=ke(),o=Ie();return function(t,e,n,i,r,s,o=!1,a){const l=ie(i),c=t.firstCreatePass&&is(t),u=ns(e);let h=!0;if(3&i.type){const d=_e(i,e),p=a?a(d):It,f=p.target||d,m=u.length,g=a?t=>a(me(t[i.index])).target:i.index;if(pe(n)){let o=null;if(!a&&l&&(o=function(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const t=r[s];if(t===n&&r[s+1]===i){const t=e[7],n=r[s+2];return t.length>n?t[n]:null}"string"==typeof t&&(s+=2)}return null}(t,e,r,i.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,h=!1;else{s=Ks(i,e,s,!1);const t=n.listen(p.name||f,r,s);u.push(s,t),c&&c.push(r,g,m,m+1)}}else s=Ks(i,e,s,!0),f.addEventListener(r,s,o),u.push(s),c&&c.push(r,g,m,o)}else s=Ks(i,e,s,!1);const d=i.outputs;let p;if(h&&null!==d&&(p=d[r])){const t=p.length;if(t)for(let n=0;n<t;n+=2){const t=e[p[n]][p[n+1]].subscribe(s),o=u.length;u.push(s,t),c&&c.push(r,i.index,o,-(o+1))}}}(s,r,r[11],o,t,e,n,i),Ws}function Xs(t,e,n){try{return!1!==e(n)}catch(i){return rs(t,i),!1}}function Ks(t,e,n,i){return function r(s){if(s===Function)return n;const o=2&t.flags?ve(t.index,e):e;0==(32&e[2])&&Qr(o);let a=Xs(e,n,s),l=r.__ngNextListenerFn__;for(;l;)a=Xs(e,l,s)&&a,l=l.__ngNextListenerFn__;return i&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Qs(t=1){return function(t){return(Te.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Te.lFrame.contextLView))[8]}(t)}function Ys(t,e){let n=null;const i=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?lr(t,s,!0):cr(i,s))return r}else n=r}return n}function Js(t){const e=Ae()[16][6];if(!e.projection){const n=e.projection=Kn(t?t.length:1,null),i=n.slice();let r=e.child;for(;null!==r;){const e=t?Ys(r,t):0;null!==e&&(i[e]?i[e].projectionNext=r:n[e]=r,i[e]=r),r=r.next}}}function to(t,e=0,n){const i=Ae(),r=ke(),s=Cr(r,Qt+t,16,null,n||null);null===s.projection&&(s.projection=e),Re(),64!=(64&s.flags)&&function(t,e,n){Qi(e[11],0,e,n,Bi(t,n,e),qi(n.parent||e[6],n,e))}(r,i,s)}function eo(t,e,n,i,r){const s=t[n+1],o=null===e;let a=i?gr(s):yr(s),l=!1;for(;0!==a&&(!1===l||o);){const n=t[a+1];no(t[a],e)&&(l=!0,t[a+1]=i?xr(n):_r(n)),a=i?gr(n):yr(n)}l&&(t[n+1]=i?_r(s):xr(s))}function no(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Jn(t,e)>=0}const io={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ro(t){return t.substring(io.key,io.keyEnd)}function so(t,e){const n=io.textEnd;return n===e?-1:(e=io.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,io.key=e,n),oo(t,e,n))}function oo(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function ao(t,e){return function(t,e,n,i){const r=Ae(),s=ke(),o=Ve(2);s.firstUpdatePass&&ho(s,t,o,true),e!==dr&&Ls(r,o,e)&&mo(s,s.data[Je()],r,r[11],t,r[o+1]=function(t,e){return null==t||"object"==typeof t&&(t=tt(fi(t))),t}(e),true,o)}(t,e),ao}function lo(t){!function(t,e,n,i){const r=ke(),s=Ve(2);r.firstUpdatePass&&ho(r,null,s,i);const o=Ae();if(n!==dr&&Ls(o,s,n)){const a=r.data[Je()];if(yo(a,i)&&!uo(r,s)){let t=a.classesWithoutHost;null!==t&&(n=et(t,n||"")),Us(r,a,o,n,i)}else!function(t,e,n,i,r,s,o,a){r===dr&&(r=Ot);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const o=l<r.length?r[l+1]:void 0,d=c<s.length?s[c+1]:void 0;let p,f=null;u===h?(l+=2,c+=2,o!==d&&(f=h,p=d)):null===h||null!==u&&u<h?(l+=2,f=u):(c+=2,f=h,p=d),null!==f&&mo(t,e,n,i,f,p,true,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(t,e,n){if(null==n||""===n)return Ot;const i=[],r=fi(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(t,e,n),0,s)}}(Qn,co,t,!0)}function co(t,e){for(let n=function(t){return function(t){io.key=0,io.keyEnd=0,io.value=0,io.valueEnd=0,io.textEnd=t.length}(t),so(t,oo(t,0,io.textEnd))}(e);n>=0;n=so(e,n))Qn(t,ro(e),!0)}function uo(t,e){return e>=t.expandoStartIndex}function ho(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[Je()],o=uo(t,n);yo(s,i)&&null===e&&!o&&(e=!1),e=function(t,e,n,i){const r=function(t){const e=Te.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=fo(n=po(null,t,e,n,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==r)if(n=po(r,t,e,n,i),null===s){let n=function(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==yr(i))return t[gr(i)]}(t,e,i);void 0!==n&&Array.isArray(n)&&(n=po(null,t,e,n[1],i),n=fo(n,e.attrs,i),function(t,e,n,i){t[gr(n?e.classBindings:e.styleBindings)]=i}(t,e,i,n))}else s=function(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=fo(i,t[s].hostAttrs,n);return fo(i,e.attrs,n)}(t,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),n}(r,s,e,i),function(t,e,n,i,r,s){let o=s?e.classBindings:e.styleBindings,a=gr(o),l=yr(o);t[i]=n;let c,u=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||Jn(t,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const e=gr(t[a+1]);t[i+1]=mr(e,a),0!==e&&(t[e+1]=vr(t[e+1],i)),t[a+1]=131071&t[a+1]|i<<17}else t[i+1]=mr(a,0),0!==a&&(t[a+1]=vr(t[a+1],i)),a=i;else t[i+1]=mr(l,0),0===a?a=i:t[l+1]=vr(t[l+1],i),l=i;u&&(t[i+1]=_r(t[i+1])),eo(t,c,i,!0),eo(t,c,i,!1),function(t,e,n,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&Jn(s,e)>=0&&(n[i+1]=xr(n[i+1]))}(e,c,t,i,s),o=mr(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,n,o,i)}}function po(t,e,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],i=fo(i,s.hostAttrs,r),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),i}function fo(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Qn(t,o,!!n||e[++s]))}return void 0===t?null:t}function mo(t,e,n,i,r,s,o,a){if(!(3&e.type))return;const l=t.data,c=l[a+1];_o(1==(1&c)?go(l,e,n,r,yr(c),o):void 0)||(_o(s)||2==(2&c)&&(s=go(l,null,n,r,a,o)),function(t,e,n,i,r){const s=pe(t);if(e)r?s?t.addClass(n,i):n.classList.add(i):s?t.removeClass(n,i):n.classList.remove(i);else{let e=-1===i.indexOf("-")?void 0:Ti.DashCase;if(null==r)s?t.removeStyle(n,i,e):n.style.removeProperty(i);else{const o="string"==typeof r&&r.endsWith("!important");o&&(r=r.slice(0,-10),e|=Ti.Important),s?t.setStyle(n,i,r,e):n.style.setProperty(i,r,o?"important":"")}}}(i,o,ge(Je(),n),r,s))}function go(t,e,n,i,r,s){const o=null===e;let a;for(;r>0;){const e=t[r],s=Array.isArray(e),l=s?e[1]:e,c=null===l;let u=n[r+1];u===dr&&(u=c?Ot:void 0);let h=c?Yn(u,i):l===i?u:void 0;if(s&&!_o(h)&&(h=Yn(e,i)),_o(h)&&(a=h,o))return a;const d=t[r+1];r=o?gr(d):yr(d)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=Yn(t,i))}return a}function _o(t){return void 0!==t}function yo(t,e){return 0!=(t.flags&(e?16:32))}function vo(t,e=""){const n=Ae(),i=ke(),r=t+Qt,s=i.firstCreatePass?Cr(i,r,1,e,null):i.data[r],o=n[r]=function(t,e){return pe(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Gi(i,n,o,s),ze(s,!1)}function xo(t,e,n){const i=Ae(),r=function(t,e,n,i){return Ls(t,Ne(),n)?e+at(n)+i:dr}(i,t,e,n);return r!==dr&&os(i,Je(),r),xo}function bo(t,e,n,i,r){const s=Ae(),o=function(t,e,n,i,r,s){const o=function(t,e,n,i){const r=Ls(t,e,n);return Ls(t,e+1,i)||r}(t,Te.lFrame.bindingIndex,n,r);return Ve(2),o?e+at(n)+i+at(r)+s:dr}(s,t,e,n,i,r);return o!==dr&&os(s,Je(),o),bo}function wo(t,e,n){const i=Ae();return Ls(i,Ne(),e)&&Rr(ke(),en(),i,t,e,i[11],n,!0),wo}const Co=void 0;var Eo=["en",[["a","p"],["AM","PM"],Co],[["AM","PM"],Co,Co],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Co,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Co,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Co,"{1} 'at' {0}",Co],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let So={};function To(t){return t in So||(So[t]=Pt.ng&&Pt.ng.common&&Pt.ng.common.locales&&Pt.ng.common.locales[t]),So[t]}var Mo=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const Ao="en-US";let ko=Ao;function Po(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t} [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(ko=t.toLowerCase().replace(/_/g,"-"))}function Io(t,e,n,i,r){if(t=rt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Io(t[s],e,n,i,r);else{const s=ke(),o=Ae();let a=ws(t)?t:rt(t.provide),l=vs(t);const c=Ie(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(ws(t)||!t.multi){const i=new un(l,r,Ns),p=Do(a,e,r?u:u+d,h);-1===p?(Tn(wn(c,o),s,a),Oo(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(i),o.push(i)):(n[p]=i,o[p]=i)}else{const p=Do(a,e,u+d,h),f=Do(a,e,u,u+d),m=p>=0&&n[p],g=f>=0&&n[f];if(r&&!g||!r&&!m){Tn(wn(c,o),s,a);const u=function(t,e,n,i,r){const s=new un(t,n,Ns);return s.multi=[],s.index=e,s.componentProviders=0,zo(s,r,i&&!n),s}(r?Lo:Ro,n.length,r,i,l);!r&&g&&(n[f].providerFactory=u),Oo(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(u),o.push(u)}else Oo(s,t,p>-1?p:f,zo(n[r?f:p],l,!r&&i));!r&&i&&g&&n[f].componentProviders++}}}function Oo(t,e,n,i){const r=ws(e);if(r||e.useClass){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const t=o.indexOf(n);-1===t?o.push(n,[i,s]):o[t+1].push(i,s)}else o.push(n,s)}}}function zo(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Do(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function Ro(t,e,n,i){return Fo(this.multi,[])}function Lo(t,e,n,i){const r=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Dn(n,n[1],this.providerFactory.index,i);s=e.slice(0,t),Fo(r,s);for(let n=t;n<e.length;n++)s.push(e[n])}else s=[],Fo(r,s);return s}function Fo(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Bo(t,e=[]){return n=>{n.providersResolver=(n,i)=>function(t,e,n){const i=ke();if(i.firstCreatePass){const r=re(t);Io(n,i.data,i.blueprint,r,!0),Io(e,i.data,i.blueprint,r,!1)}}(n,i?i(t):t,e)}}class No{}class Vo{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${tt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let Uo=(()=>{class t{}return t.NULL=new Vo,t})();function jo(...t){}function qo(t,e){return new Go(_e(t,e))}const $o=function(){return qo(Ie(),Ae())};let Go=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=$o,t})();function Zo(t){return t instanceof Go?t.nativeElement:t}class Ho{}let Wo=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Xo(),t})();const Xo=function(){const t=Ae(),e=ve(Ie().index,t);return function(t){return t[11]}(Jt(e)?e:t)};let Ko=(()=>{class t{}return t.\u0275prov=ut({token:t,providedIn:"root",factory:()=>null}),t})();class Qo{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Yo=new Qo("11.2.6");class Jo{constructor(){}supports(t){return zs(t)}create(t){return new ea(t)}}const ta=(t,e)=>e;class ea{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ta}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,i=0,r=null;for(;e||n;){const s=!n||e&&e.currentIndex<sa(n,i,r)?e:n,o=sa(s,i,r),a=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)i++;else{r||(r=[]);const t=o-i,e=a-i;if(t!=e){for(let n=0;n<t;n++){const i=n<r.length?r[n]:r[n]=0,s=i+n;e<=s&&s<t&&(r[n]=i+1)}r[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!zs(t))throw new Error(`Error trying to diff '${tt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,i,r=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],i=this._trackByFn(e,n),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,n,i,e)),Object.is(r.item,n)||this._addIdentityChange(r,n)):(r=this._mismatch(r,n,i,e),s=!0),r=r._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Os()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(t,t=>{i=this._trackByFn(e,t),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,t,i,e)),Object.is(r.item,t)||this._addIdentityChange(r,t)):(r=this._mismatch(r,t,i,e),s=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,i){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,i)):t=this._addAfter(new na(e,n),r,i),t}_verifyReinsertion(t,e,n,i){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?t=this._reinsertAfter(r,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,r=t._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new ra),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ra),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class na{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ia{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class ra{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new ia,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function sa(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class oa{constructor(){}supports(t){return t instanceof Map||Ds(t)}create(){return new aa}}class aa{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ds(t)))throw new Error(`Error trying to diff '${tt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}const n=new la(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class la{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ca(){return new ua([new Jo])}let ua=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||ca()),deps:[[t,new di,new hi]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=ut({token:t,providedIn:"root",factory:ca}),t})();function ha(){return new da([new oa])}let da=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||ha()),deps:[[t,new di,new hi]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=ut({token:t,providedIn:"root",factory:ha}),t})();function pa(t,e,n,i,r=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&i.push(me(s)),te(s))for(let t=Yt;t<s.length;t++){const e=s[t],n=e[1].firstChild;null!==n&&pa(e[1],e,n,i)}const o=n.type;if(8&o)pa(t,e,n.child,i);else if(32&o){const t=Mi(n,e);let r;for(;r=t();)i.push(r)}else if(16&o){const t=Hi(e,n);if(Array.isArray(t))i.push(...t);else{const n=Ai(e[16]);pa(n[1],n,t,i,!0)}}n=r?n.projectionNext:n.next}return i}class fa{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return pa(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(te(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Ri(t,n),Xn(e,n))}this._attachedToViewContainer=!1}Li(this._lView[1],this._lView)}onDestroy(t){zr(this._lView[1],this._lView,null,t)}markForCheck(){Qr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Yr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Fe(!0);try{Yr(t,e,n)}finally{Fe(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Ki(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class ma extends fa{constructor(t){super(t),this._view=t}detectChanges(){Jr(this._view)}checkNoChanges(){!function(t){Fe(!0);try{Jr(t)}finally{Fe(!1)}}(this._view)}get context(){return null}}const ga=function(t=!1){return function(t,e,n){if(!n&&ne(t)){const n=ve(t.index,e);return new fa(n,n)}return 47&t.type?new fa(e[16],e):null}(Ie(),Ae(),t)};let _a=(()=>{class t{}return t.__NG_ELEMENT_ID__=ga,t.__ChangeDetectorRef__=!0,t})();const ya=[new oa],va=new ua([new Jo]),xa=new da(ya),ba=function(){return Sa(Ie(),Ae())};let wa=(()=>{class t{}return t.__NG_ELEMENT_ID__=ba,t})();const Ca=wa,Ea=class extends Ca{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=wr(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(e)),Sr(e,n,t),new fa(n)}};function Sa(t,e){return 4&t.type?new Ea(e,t,qo(t,e)):null}class Ta{}class Ma{}const Aa=function(){return Da(Ie(),Ae())};let ka=(()=>{class t{}return t.__NG_ELEMENT_ID__=Aa,t})();const Pa=ka,Ia=class extends Pa{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return qo(this._hostTNode,this._hostLView)}get injector(){return new Fn(this._hostTNode,this._hostLView)}get parentInjector(){const t=Sn(this._hostTNode,this._hostLView);if(gn(t)){const e=yn(t,this._hostLView),n=_n(t);return new Fn(e[1].data[n+8],e)}return new Fn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Oa(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-Yt}createEmbeddedView(t,e,n){const i=t.createEmbeddedView(e||{});return this.insert(i,n),i}createComponent(t,e,n,i,r){const s=n||this.parentInjector;if(!r&&null==t.ngModule&&s){const t=s.get(Ta,null);t&&(r=t)}const o=t.create(s,i,void 0,r);return this.insert(o.hostView,e),o}insert(t,e){const n=t._lView,i=n[1];if(te(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],i=new Ia(e,e[6],e[3]);i.detach(i.indexOf(t))}}const r=this._adjustIndex(e),s=this._lContainer;!function(t,e,n,i){const r=Yt+i,s=n.length;i>0&&(n[r-1][4]=e),i<s-Yt?(e[4]=n[r],Wn(n,Yt+i,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(i,n,s,r);const o=Wi(r,s),a=n[11],l=ji(a,s[7]);return null!==l&&function(t,e,n,i,r,s){i[0]=r,i[6]=e,Ki(t,i,n,1,r,s)}(i,s[6],a,n,l,o),t.attachToViewContainerRef(),Wn(za(s),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Oa(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Ri(this._lContainer,e);n&&(Xn(za(this._lContainer),e),Li(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Ri(this._lContainer,e);return n&&null!=Xn(za(this._lContainer),e)?new fa(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Oa(t){return t[8]}function za(t){return t[8]||(t[8]=[])}function Da(t,e){let n;const i=e[t.index];if(te(i))n=i;else{let r;if(8&t.type)r=me(i);else{const n=e[11];r=n.createComment("");const i=_e(t,e);Ni(n,ji(n,i),r,function(t,e){return pe(t)?t.nextSibling(e):e.nextSibling}(n,i),!1)}e[t.index]=n=Zr(i,e,r,t),Kr(e,n)}return new Ia(n,t,e)}const Ra={};class La extends Uo{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Xt(t);return new Na(e,this.ngModule)}}function Fa(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Ba=new qn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ei});class Na extends No{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(hr).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Fa(this.componentDef.inputs)}get outputs(){return Fa(this.componentDef.outputs)}create(t,e,n,i){const r=(i=i||this.ngModule)?function(t,e){return{get:(n,i,r)=>{const s=t.get(n,Ra,r);return s!==Ra||i===Ra?s:e.get(n,i,r)}}}(t,i.injector):t,s=r.get(Ho,fe),o=r.get(Ko,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(pe(t))return t.selectRootElement(e,n===St.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(a,n,this.componentDef.encapsulation):zi(s.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h={components:[],scheduler:Ei,clean:es,playerHandler:null,flags:0},d=Or(0,null,null,1,0,null,null,null,null,null),p=wr(null,d,h,u,null,null,s,a,o,r);let f,m;He(p);try{const t=function(t,e,n,i,r,s){const o=n[1];n[20]=t;const a=Cr(o,20,2,"#host",null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(as(a,l,!0),null!==t&&(hn(r,t,l),null!==a.classes&&Ji(r,t,a.classes),null!==a.styles&&Yi(r,t,a.styles)));const c=i.createRenderer(t,e),u=wr(n,Ir(e),null,e.onPush?64:16,n[20],a,i,c,null,null);return o.firstCreatePass&&(Tn(wn(a,n),o,e.type),Nr(o,a),Ur(a,n.length,1)),Kr(n,u),n[20]=u}(c,this.componentDef,p,s,a);if(c)if(n)hn(a,c,["ng-version",Yo.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!or(r))break;r=s}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&hn(a,c,t),e&&e.length>0&&Ji(a,c,e.join(" "))}if(m=ye(d,Qt),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const i=e[n];t.push(null!=i?Array.from(i):null)}}f=function(t,e,n,i,r){const s=n[1],o=function(t,e,n){const i=Ie();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),jr(t,i,e,Er(t,e,1,null),n));const r=Dn(e,t,i.directiveStart,i);Ci(r,e);const s=_e(i,e);return s&&Ci(s,e),r}(s,n,e);if(i.components.push(o),t[8]=o,r&&r.forEach(t=>t(o,e)),e.contentQueries){const t=Ie();e.contentQueries(1,o,t.directiveStart)}const a=Ie();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(tn(a.index),Fr(n[1],a,0,a.directiveStart,a.directiveEnd,e),Br(e,o)),o}(t,this.componentDef,p,h,[Ss]),Sr(d,p,null)}finally{Ye()}return new Va(this.componentType,f,qo(m,p),p,m)}}class Va extends class{}{constructor(t,e,n,i,r){super(),this.location=n,this._rootLView=i,this._tNode=r,this.instance=e,this.hostView=this.changeDetectorRef=new ma(i),this.componentType=t}get injector(){return new Fn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Ua=new Map;class ja extends Ta{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new La(this);const n=Kt(t),i=t[Bt]||null;i&&Po(i),this._bootstrapComponents=Si(n.bootstrap),this._r3Injector=gs(t,e,[{provide:Ta,useValue:this},{provide:Uo,useValue:this.componentFactoryResolver}],tt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Es.THROW_IF_NOT_FOUND,n=vt.Default){return t===Es||t===Ta||t===ls?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class qa extends Ma{constructor(t){super(),this.moduleType=t,null!==Kt(t)&&function(t){const e=new Set;!function t(n){const i=Kt(n,!0),r=i.id;null!==r&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${tt(e)} vs ${tt(e.name)}`)}(r,Ua.get(r),n),Ua.set(r,n));const s=Si(i.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new ja(this.moduleType,t)}}function $a(t,e,n){const i=Be()+t,r=Ae();return r[i]===dr?Rs(r,i,n?e.call(n):e()):function(t,e){return t[e]}(r,i)}function Ga(t,e,n,i){return function(t,e,n,i,r,s){const o=e+n;return Ls(t,o,r)?Rs(t,o+1,s?i.call(s,r):i(r)):function(t,e){const n=t[e];return n===dr?void 0:n}(t,o+1)}(Ae(),Be(),t,e,n,i)}const Za=class extends C{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let i,r=t=>null,s=()=>null;t&&"object"==typeof t?(i=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(r=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(s=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(i=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(r=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(s=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const o=super.subscribe(i,r,s);return t instanceof h&&t.add(o),o}};function Ha(){return this._results[Os()]()}class Wa{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Os(),n=Wa.prototype;n[e]||(n[e]=Ha)}get changes(){return this._changes||(this._changes=new Za)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const i=Zn(t);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(n._results,i,e))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Xa{constructor(t){this.queryList=t,this.matches=null}clone(){return new Xa(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ka{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);i.push(this.queries[n.indexInDeclarationView].clone())}return new Ka(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==cl(t,e).matches&&this.queries[e].setDirty()}}class Qa{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class Ya{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const i=null!==e?e.length:0,r=this.getByIndex(n).embeddedTView(t,i);r&&(r.indexInDeclarationView=n,null!==e?e.push(r):e=[r])}return null!==e?new Ya(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Ja{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Ja(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];this.matchTNodeWithReadOption(t,e,tl(e,r)),this.matchTNodeWithReadOption(t,e,zn(e,t,r,!1,!1))}else n===wa?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,zn(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Go||i===ka||i===wa&&4&e.type)this.addMatch(e.index,-2);else{const n=zn(e,t,i,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function tl(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function el(t,e,n,i){return-1===n?function(t,e){return 11&t.type?qo(t,e):4&t.type?Sa(t,e):null}(e,t):-2===n?function(t,e,n){return n===Go?qo(e,t):n===wa?Sa(e,t):n===ka?Da(e,t):void 0}(t,e,i):Dn(t,t[1],n,e)}function nl(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const i=t.data,s=n.matches,o=[];for(let t=0;t<s.length;t+=2){const r=s[t];o.push(r<0?null:el(e,i[r],s[t+1],n.metadata.read))}r.matches=o}return r.matches}function il(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const o=nl(t,e,r,n);for(let t=0;t<s.length;t+=2){const n=s[t];if(n>0)i.push(o[t/2]);else{const r=s[t+1],o=e[-n];for(let t=Yt;t<o.length;t++){const e=o[t];e[17]===e[3]&&il(e[1],e,r,i)}if(null!==o[9]){const t=o[9];for(let e=0;e<t.length;e++){const n=t[e];il(n[1],n,r,i)}}}}}return i}function rl(t){const e=Ae(),n=ke(),i=qe();$e(i+1);const r=cl(n,i);if(t.dirty&&be(e)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?il(n,e,i,[]):nl(n,e,r,i);t.reset(s,Zo),t.notifyOnChanges()}return!0}return!1}function sl(t,e,n,i){const r=ke();if(r.firstCreatePass){const s=Ie();ll(r,new Qa(e,n,i),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(r,t),2==(2&n)&&(r.staticContentQueries=!0)}al(r,Ae(),n)}function ol(){return t=Ae(),e=qe(),t[19].queries[e].queryList;var t,e}function al(t,e,n){const i=new Wa(4==(4&n));zr(t,e,i,i.destroy),null===e[19]&&(e[19]=new Ka),e[19].queries.push(new Xa(i))}function ll(t,e,n){null===t.queries&&(t.queries=new Ya),t.queries.track(new Ja(e,n))}function cl(t,e){return t.queries.getByIndex(e)}const ul=new qn("Application Initializer");let hl=(()=>{class t{constructor(t){this.appInits=t,this.resolve=jo,this.reject=jo,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Zs(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(ai(ul,8))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const dl=new qn("AppId"),pl={provide:dl,useFactory:function(){return`${fl()}${fl()}${fl()}`},deps:[]};function fl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ml=new qn("Platform Initializer"),gl=new qn("Platform ID"),_l=new qn("appBootstrapListener");let yl=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const vl=new qn("LocaleId"),xl=new qn("DefaultCurrencyCode");class bl{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const wl=function(t){return new qa(t)},Cl=wl,El=function(t){return Promise.resolve(wl(t))},Sl=function(t){const e=wl(t),n=Si(Kt(t).declarations).reduce((t,e)=>{const n=Xt(e);return n&&t.push(new Na(n)),t},[]);return new bl(e,n)},Tl=Sl,Ml=function(t){return Promise.resolve(Sl(t))};let Al=(()=>{class t{constructor(){this.compileModuleSync=Cl,this.compileModuleAsync=El,this.compileModuleAndAllComponentsSync=Tl,this.compileModuleAndAllComponentsAsync=Ml}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const kl=(()=>Promise.resolve(0))();function Pl(t){"undefined"==typeof Zone?kl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Il{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Za(!1),this.onMicrotaskEmpty=new Za(!1),this.onStable=new Za(!1),this.onError=new Za(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&e,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=Pt.requestAnimationFrame,e=Pt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Pt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Dl(t),zl(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Dl(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return Rl(t),n.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),Ll(t)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return Rl(t),n.invoke(r,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),Ll(t)}},onHasTask:(e,n,i,r)=>{e.hasTask(i,r),n===i&&("microTask"==r.change?(t._hasPendingMicrotasks=r.microTask,Dl(t),zl(t)):"macroTask"==r.change&&(t.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,n,i,r)=>(e.handleError(i,r),t.runOutsideAngular(()=>t.onError.emit(r)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Il.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Il.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,i){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+i,t,Ol,jo,jo);try{return r.runTask(s,e,n)}finally{r.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Ol={};function zl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Dl(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Rl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Ll(t){t._nesting--,zl(t)}class Fl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Za,this.onMicrotaskEmpty=new Za,this.onStable=new Za,this.onError=new Za}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,i){return t.apply(e,n)}}let Bl=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Il.assertNotInAngularZone(),Pl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Pl(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let i=-1;e&&e>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==i),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(ai(Il))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Nl=(()=>{class t{constructor(){this._applications=new Map,jl.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return jl.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class Vl{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Ul,jl=new Vl,ql=!0,$l=!1;const Gl=new qn("AllowMultipleToken");class Zl{constructor(t,e){this.name=t,this.token=e}}function Hl(t,e,n=[]){const i=`Platform: ${e}`,r=new qn(i);return(e=[])=>{let s=Wl();if(!s||s.injector.get(Gl,!1))if(t)t(n.concat(e).concat({provide:r,useValue:!0}));else{const t=n.concat(e).concat({provide:r,useValue:!0},{provide:us,useValue:"platform"});!function(t){if(Ul&&!Ul.destroyed&&!Ul.injector.get(Gl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ul=t.get(Xl);const e=t.get(ml,null);e&&e.forEach(t=>t())}(Es.create({providers:t,name:i}))}return function(t){const e=Wl();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function Wl(){return Ul&&!Ul.destroyed?Ul:null}let Xl=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Fl:("zone.js"===t?void 0:t)||new Il({enableLongStackTrace:($l=!0,ql),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(e?e.ngZone:void 0,{ngZoneEventCoalescing:e&&e.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:e&&e.ngZoneRunCoalescing||!1}),i=[{provide:Il,useValue:n}];return n.run(()=>{const e=Es.create({providers:i,parent:this.injector,name:t.moduleType.name}),r=t.create(e),s=r.injector.get(wi,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{s.handleError(t)}});r.onDestroy(()=>{Yl(this._modules,r),t.unsubscribe()})}),function(t,e,n){try{const i=n();return Zs(i)?i.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(s,n,()=>{const t=r.injector.get(hl);return t.runInitializers(),t.donePromise.then(()=>(Po(r.injector.get(vl,Ao)||Ao),this._moduleDoBootstrap(r),r))})})}bootstrapModule(t,e=[]){const n=Kl({},e);return function(t,e,n){const i=new qa(n);return Promise.resolve(i)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(Ql);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${tt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(ai(Es))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();function Kl(t,e){return Array.isArray(e)?e.reduce(Kl,t):Object.assign(Object.assign({},t),e)}let Ql=(()=>{class t{constructor(t,e,n,i,r){this._zone=t,this._injector=e,this._exceptionHandler=n,this._componentFactoryResolver=i,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new y(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),o=new y(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Il.assertNotInAngularZone(),Pl(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Il.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return S(i)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof i&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof y?t[0]:q(e)($(t,n))}(s,o.pipe(t=>{return G()((e=Q,function(t){let n;n="function"==typeof e?e:function(){return e};const i=Object.create(t,X);return i.source=t,i.subjectFactory=n,i})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof No?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const i=n.isBoundToModule?void 0:this._injector.get(Ta),r=n.create(Es.NULL,[],e||n.selector,i),s=r.location.nativeElement,o=r.injector.get(Bl,null),a=o&&r.injector.get(Nl);return o&&a&&a.registerApplication(s,o),r.onDestroy(()=>{this.detachView(r.hostView),Yl(this.components,r),a&&a.unregisterApplication(s)}),this._loadComponent(r),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Yl(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(_l,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(ai(Il),ai(Es),ai(wi),ai(Uo),ai(hl))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();function Yl(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Jl{}class tc{}const ec={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let nc=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||ec}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,i]=t.split("#");return void 0===i&&(i="default"),n("zn8P")(e).then(t=>t[i]).then(t=>ic(t,e,i)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,i]=t.split("#"),r="NgFactory";return void 0===i&&(i="default",r=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[i+r]).then(t=>ic(t,e,i))}}return t.\u0275fac=function(e){return new(e||t)(ai(Al),ai(tc,8))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();function ic(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const rc=Hl(null,"core",[{provide:gl,useValue:"unknown"},{provide:Xl,deps:[Es]},{provide:Nl,deps:[]},{provide:yl,deps:[]}]),sc=[{provide:Ql,useClass:Ql,deps:[Il,Es,wi,Uo,hl]},{provide:Ba,deps:[Il],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:hl,useClass:hl,deps:[[new hi,ul]]},{provide:Al,useClass:Al,deps:[]},pl,{provide:ua,useFactory:function(){return va},deps:[]},{provide:da,useFactory:function(){return xa},deps:[]},{provide:vl,useFactory:function(t){return Po(t=t||"undefined"!=typeof $localize&&$localize.locale||Ao),t},deps:[[new ui(vl),new hi,new di]]},{provide:xl,useValue:"USD"}];let oc=(()=>{class t{constructor(t){}}return t.\u0275fac=function(e){return new(e||t)(ai(Ql))},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:sc}),t})(),ac=null;function lc(){return ac}const cc=new qn("DocumentToken");let uc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({factory:hc,token:t,providedIn:"platform"}),t})();function hc(){return ai(pc)}const dc=new qn("Location Initialized");let pc=(()=>{class t extends uc{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=lc().getLocation(),this._history=lc().getHistory()}getBaseHrefFromDOM(){return lc().getBaseHref(this._doc)}onPopState(t){lc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){lc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){fc()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){fc()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(ai(cc))},t.\u0275prov=ut({factory:mc,token:t,providedIn:"platform"}),t})();function fc(){return!!window.history.pushState}function mc(){return new pc(ai(cc))}function gc(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function _c(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function yc(t){return t&&"?"!==t[0]?"?"+t:t}let vc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({factory:xc,token:t,providedIn:"root"}),t})();function xc(t){const e=ai(cc).location;return new wc(ai(uc),e&&e.origin||"")}const bc=new qn("appBaseHref");let wc=(()=>{class t extends vc{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return gc(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+yc(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,i){const r=this.prepareExternalUrl(n+yc(i));this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){const r=this.prepareExternalUrl(n+yc(i));this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(ai(uc),ai(bc,8))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Cc=(()=>{class t extends vc{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=gc(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,i){let r=this.prepareExternalUrl(n+yc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){let r=this.prepareExternalUrl(n+yc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(ai(uc),ai(bc,8))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Ec=(()=>{class t{constructor(t,e){this._subject=new Za,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=_c(Tc(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+yc(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Tc(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+yc(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+yc(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(ai(vc),ai(uc))},t.normalizeQueryParams=yc,t.joinWithSlash=gc,t.stripTrailingSlash=_c,t.\u0275prov=ut({factory:Sc,token:t,providedIn:"root"}),t})();function Sc(){return new Ec(ai(vc),ai(uc))}function Tc(t){return t.replace(/\/index.html$/,"")}var Mc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});class Ac{}let kc=(()=>{class t extends Ac{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=To(e);if(n)return n;const i=e.split("-")[0];if(n=To(i),n)return n;if("en"===i)return Eo;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Mo.PluralCase]}(e||this.locale)(t)){case Mc.Zero:return"zero";case Mc.One:return"one";case Mc.Two:return"two";case Mc.Few:return"few";case Mc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(ai(vl))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();function Pc(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[i,r]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(i.trim()===e)return decodeURIComponent(r)}return null}let Ic=(()=>{class t{constructor(t,e,n,i){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(zs(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${tt(t.item)}`);this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(Ns(ua),Ns(da),Ns(Go),Ns(Wo))},t.\u0275dir=Wt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Oc{constructor(t,e,n,i){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let zc=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,i)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Oc(null,this._ngForOf,-1,-1),null===i?void 0:i),r=new Dc(t,n);e.push(r)}else if(null==i)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const r=this._viewContainer.get(n);this._viewContainer.move(r,i);const s=new Dc(t,r);e.push(s)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,i=this._viewContainer.length;n<i;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=i,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ns(ka),Ns(wa),Ns(ua))},t.\u0275dir=Wt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Dc{constructor(t,e){this.record=t,this.view=e}}let Rc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new Lc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Fc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Fc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ns(ka),Ns(wa))},t.\u0275dir=Wt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Lc{constructor(){this.$implicit=null,this.ngIf=null}}function Fc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${tt(e)}'.`)}let Bc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:[{provide:Ac,useClass:kc}]}),t})(),Nc=(()=>{class t{}return t.\u0275prov=ut({token:t,providedIn:"root",factory:()=>new Vc(ai(cc),window)}),t})();class Vc{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){var e;if(!this.supportsScrolling())return;const n=null!==(e=this.document.getElementById(t))&&void 0!==e?e:this.document.getElementsByName(t)[0];void 0!==n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],i-r[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Uc(this.window.history)||Uc(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function Uc(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class jc extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new jc,ac||(ac=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=$c||($c=document.querySelector("base"),$c)?$c.getAttribute("href"):null;return null==e?null:(n=e,qc||(qc=document.createElement("a")),qc.setAttribute("href",n),"/"===qc.pathname.charAt(0)?qc.pathname:"/"+qc.pathname);var n}resetBaseElement(){$c=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return Pc(document.cookie,t)}}let qc,$c=null;const Gc=new qn("TRANSITION_ID"),Zc=[{provide:ul,useFactory:function(t,e,n){return()=>{n.get(hl).donePromise.then(()=>{const n=lc();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Gc,cc,Es],multi:!0}];class Hc{static init(){var t;t=new Hc,jl=t}addToWindow(t){Pt.getAngularTestability=(e,n=!0)=>{const i=t.findTestabilityInTree(e,n);if(null==i)throw new Error("Could not find testability for element.");return i},Pt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Pt.getAllAngularRootElements=()=>t.getAllRootElements(),Pt.frameworkStabilizers||(Pt.frameworkStabilizers=[]),Pt.frameworkStabilizers.push(t=>{const e=Pt.getAllAngularTestabilities();let n=e.length,i=!1;const r=function(e){i=i||e,n--,0==n&&t(i)};e.forEach(function(t){t.whenStable(r)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:n?lc().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const Wc=new qn("EventManagerPlugins");let Xc=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let i=0;i<n.length;i++){const e=n[i];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(ai(Wc),ai(Il))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class Kc{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const i=lc().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,n)}}let Qc=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Yc=(()=>{class t extends Qc{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>lc().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(ai(cc))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const Jc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},tu=/%COMP%/g;function eu(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?eu(t,r,n):(r=r.replace(tu,t),n.push(r))}return n}function nu(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let iu=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new ru(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case St.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new su(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case St.ShadowDom:return new ou(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=eu(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(ai(Xc),ai(Yc),ai(dl))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class ru{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Jc[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;const r=Jc[i];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const i=Jc[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,i){i&(Ti.DashCase|Ti.Important)?t.style.setProperty(e,n,i&Ti.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Ti.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,nu(n)):this.eventManager.addEventListener(t,e,nu(n))}}class su extends ru{constructor(t,e,n,i){super(t),this.component=n;const r=eu(i+"-"+n.id,n.styles,[]);e.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(tu,i+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(tu,i+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class ou extends ru{constructor(t,e,n,i){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=eu(i.id,i.styles,[]);for(let s=0;s<r.length;s++){const t=document.createElement("style");t.textContent=r[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let au=(()=>{class t extends Kc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(ai(cc))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const lu=["alt","control","meta","shift"],cu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},uu={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},hu={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let du=(()=>{class t extends Kc{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,i){const r=t.parseEventName(n),s=t.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>lc().onAndCancel(e,r.domEventName,s))}static parseEventName(e){const n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const r=t._normalizeKey(n.pop());let s="";if(lu.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),s+=t+".")}),s+=r,0!=n.length||0===r.length)return null;const o={};return o.domEventName=i,o.fullKey=s,o}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&uu.hasOwnProperty(e)&&(e=uu[e]))}return cu[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),lu.forEach(i=>{i!=n&&(0,hu[i])(t)&&(e+=i+".")}),e+=n,e}static eventCallback(e,n,i){return r=>{t.getEventFullKey(r)===e&&i.runGuarded(()=>n(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(ai(cc))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const pu=Hl(rc,"browser",[{provide:gl,useValue:"browser"},{provide:ml,useValue:function(){jc.makeCurrent(),Hc.init()},multi:!0},{provide:cc,useFactory:function(){return function(t){de=t}(document),document},deps:[]}]),fu=[[],{provide:us,useValue:"root"},{provide:wi,useFactory:function(){return new wi},deps:[]},{provide:Wc,useClass:au,multi:!0,deps:[cc,Il,gl]},{provide:Wc,useClass:du,multi:!0,deps:[cc]},[],{provide:iu,useClass:iu,deps:[Xc,Yc,dl]},{provide:Ho,useExisting:iu},{provide:Qc,useExisting:Yc},{provide:Yc,useClass:Yc,deps:[cc]},{provide:Bl,useClass:Bl,deps:[Il]},{provide:Xc,useClass:Xc,deps:[Wc,Il]},[]];let mu=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:dl,useValue:e.appId},{provide:Gc,useExisting:dl},Zc]}}}return t.\u0275fac=function(e){return new(e||t)(ai(t,12))},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:fu,imports:[Bc,oc]}),t})();function gu(t,e){return new y(n=>{const i=t.length;if(0===i)return void n.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=L(t[a]);let c=!1;n.add(l.subscribe({next:t=>{c||(c=!0,o++),r[a]=t},error:t=>n.error(t),complete:()=>{s++,s!==i&&c||(o===i&&n.next(e?e.reduce((t,e,n)=>(t[e]=r[n],t),{}):r),n.complete())}}))}})}"undefined"!=typeof window&&window;class _u{}const yu=new qn("NgValueAccessor"),vu={provide:yu,useExisting:it(()=>xu),multi:!0};let xu=(()=>{class t extends _u{constructor(t,e){super(),this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wo),Ns(Go))},t.\u0275dir=Wt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&Ws("change",function(t){return e.onChange(t.target.checked)})("blur",function(){return e.onTouched()})},features:[Bo([vu]),Ts]}),t})();const bu={provide:yu,useExisting:it(()=>Cu),multi:!0},wu=new qn("CompositionEventMode");let Cu=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=lc()?lc().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wo),Ns(Go),Ns(wu,8))},t.\u0275dir=Wt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&Ws("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[Bo([bu])]}),t})();function Eu(t){return null==t||0===t.length}function Su(t){return null!=t&&"number"==typeof t.length}const Tu=new qn("NgValidators"),Mu=new qn("NgAsyncValidators"),Au=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ku{static min(t){return function(t){return e=>{if(Eu(e.value)||Eu(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}(t)}static max(t){return function(t){return e=>{if(Eu(e.value)||Eu(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}(t)}static required(t){return function(t){return Eu(t.value)?{required:!0}:null}(t)}static requiredTrue(t){return function(t){return!0===t.value?null:{required:!0}}(t)}static email(t){return function(t){return Eu(t.value)||Au.test(t.value)?null:{email:!0}}(t)}static minLength(t){return function(t){return e=>Eu(e.value)||!Su(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}(t)}static maxLength(t){return function(t){return e=>Su(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}(t)}static pattern(t){return function(t){if(!t)return Pu;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Eu(t.value))return null;const i=t.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}(t)}static nullValidator(t){return null}static compose(t){return Lu(t)}static composeAsync(t){return Bu(t)}}function Pu(t){return null}function Iu(t){return null!=t}function Ou(t){const e=Zs(t)?L(t):t;return Hs(e),e}function zu(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Du(t,e){return e.map(e=>e(t))}function Ru(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function Lu(t){if(!t)return null;const e=t.filter(Iu);return 0==e.length?null:function(t){return zu(Du(t,e))}}function Fu(t){return null!=t?Lu(Ru(t)):null}function Bu(t){if(!t)return null;const e=t.filter(Iu);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if(l(e))return gu(e,null);if(c(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return gu(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return gu(t=1===t.length&&l(t[0])?t[0]:t,null).pipe(T(t=>e(...t)))}return gu(t,null)}(Du(t,e).map(Ou)).pipe(T(zu))}}function Nu(t){return null!=t?Bu(Ru(t)):null}function Vu(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Uu(t){return t._rawValidators}function ju(t){return t._rawAsyncValidators}let qu=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Fu(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Nu(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Wt({type:t}),t})(),$u=(()=>{class t extends qu{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Gu(e||t)},t.\u0275dir=Wt({type:t,features:[Ts]}),t})();const Gu=Bn($u);class Zu extends qu{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Hu{constructor(t){this._cd=t}is(t){var e,n;return!!(null===(n=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===n?void 0:n[t])}}let Wu=(()=>{class t extends Hu{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Ns(Zu,2))},t.\u0275dir=Wt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&ao("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[Ts]}),t})(),Xu=(()=>{class t extends Hu{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Ns($u,10))},t.\u0275dir=Wt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&ao("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[Ts]}),t})();function Ku(t,e){return[...e.path,t]}function Qu(t,e){th(t,e,!0),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&nh(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&nh(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function Yu(t,e,n=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),eh(t,e,!0),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Ju(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function th(t,e,n){const i=Uu(t);null!==e.validator?t.setValidators(Vu(i,e.validator)):"function"==typeof i&&t.setValidators([i]);const r=ju(t);if(null!==e.asyncValidator?t.setAsyncValidators(Vu(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]),n){const n=()=>t.updateValueAndValidity();Ju(e._rawValidators,n),Ju(e._rawAsyncValidators,n)}}function eh(t,e,n){let i=!1;if(null!==t){if(null!==e.validator){const n=Uu(t);if(Array.isArray(n)&&n.length>0){const r=n.filter(t=>t!==e.validator);r.length!==n.length&&(i=!0,t.setValidators(r))}}if(null!==e.asyncValidator){const n=ju(t);if(Array.isArray(n)&&n.length>0){const r=n.filter(t=>t!==e.asyncValidator);r.length!==n.length&&(i=!0,t.setAsyncValidators(r))}}}if(n){const t=()=>{};Ju(e._rawValidators,t),Ju(e._rawAsyncValidators,t)}return i}function nh(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function ih(t,e){th(t,e,!1)}function rh(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}function sh(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function oh(t,e){if(!e)return null;let n,i,r;return Array.isArray(e),e.forEach(t=>{t.constructor===Cu?n=t:Object.getPrototypeOf(t.constructor)===_u?i=t:r=t}),r||i||n||null}function ah(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const lh="VALID",ch="INVALID",uh="PENDING",hh="DISABLED";function dh(t){return(gh(t)?t.validators:t)||null}function ph(t){return Array.isArray(t)?Fu(t):t||null}function fh(t,e){return(gh(e)?e.asyncValidators:t)||null}function mh(t){return Array.isArray(t)?Nu(t):t||null}function gh(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class _h{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=ph(this._rawValidators),this._composedAsyncValidatorFn=mh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===lh}get invalid(){return this.status===ch}get pending(){return this.status==uh}get disabled(){return this.status===hh}get enabled(){return this.status!==hh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=ph(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=mh(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=uh,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=hh,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=lh,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==lh&&this.status!==uh||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hh:lh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=uh,this._hasOwnPendingAsyncValidator=!0;const e=Ou(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let i=t;return e.forEach(t=>{i=i instanceof vh?i.controls.hasOwnProperty(t)?i.controls[t]:null:i instanceof xh&&i.at(t)||null}),i}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Za,this.statusChanges=new Za}_calculateStatus(){return this._allControlsDisabled()?hh:this.errors?ch:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(uh)?uh:this._anyControlsHaveStatus(ch)?ch:lh}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){gh(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class yh extends _h{constructor(t=null,e,n){super(dh(e),fh(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){ah(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){ah(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class vh extends _h{constructor(t,e,n){super(dh(e),fh(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof yh?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,i)=>{n=e(n,t,i)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class xh extends _h{constructor(t,e,n){super(dh(e),fh(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof yh?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const bh={provide:$u,useExisting:it(()=>Ch)},wh=(()=>Promise.resolve(null))();let Ch=(()=>{class t extends $u{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Za,this.form=new vh({},Fu(t),Nu(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){wh.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Qu(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){wh.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),ah(this._directives,t)})}addFormGroup(t){wh.then(()=>{const e=this._findContainer(t.path),n=new vh({});ih(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){wh.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){wh.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,sh(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(Ns(Tu,10),Ns(Mu,10))},t.\u0275dir=Wt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&Ws("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Bo([bh]),Ts]}),t})();const Eh={provide:Zu,useExisting:it(()=>Th)},Sh=(()=>Promise.resolve(null))();let Th=(()=>{class t extends Zu{constructor(t,e,n,i){super(),this.control=new yh,this._registered=!1,this.update=new Za,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=oh(0,i)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),rh(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Ku(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Qu(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Sh.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;Sh.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(Ns($u,9),Ns(Tu,10),Ns(Mu,10),Ns(yu,10))},t.\u0275dir=Wt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Bo([Eh]),Ts,ae]}),t})(),Mh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Wt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const Ah={provide:yu,useExisting:it(()=>Ih),multi:!0};let kh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})(),Ph=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({factory:function(){return new t},token:t,providedIn:kh}),t})(),Ih=(()=>{class t extends _u{constructor(t,e,n,i){super(),this._renderer=t,this._elementRef=e,this._registry=n,this._injector=i,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Zu),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wo),Ns(Go),Ns(Ph),Ns(Es))},t.\u0275dir=Wt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&Ws("change",function(){return e.onChange()})("blur",function(){return e.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Bo([Ah]),Ts]}),t})();const Oh=new qn("NgModelWithFormControlWarning"),zh={provide:$u,useExisting:it(()=>Dh)};let Dh=(()=>{class t extends $u{constructor(t,e){super(),this.validators=t,this.asyncValidators=e,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Za,this._setValidators(t),this._setAsyncValidators(e)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(eh(this.form,this,!1),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return Qu(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){Yu(t.control||null,t,!1),ah(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,sh(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=t.control,n=this.form.get(t.path);e!==n&&(Yu(e||null,t),n instanceof yh&&(Qu(n,t),t.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const e=this.form.get(t.path);ih(e,t),e.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const e=this.form.get(t.path);e&&function(t,e){return eh(t,e,!1)}(e,t)&&e.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){th(this.form,this,!1),this._oldForm&&eh(this._oldForm,this,!1)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(Ns(Tu,10),Ns(Mu,10))},t.\u0275dir=Wt({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&Ws("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Bo([zh]),Ts,ae]}),t})();const Rh={provide:Zu,useExisting:it(()=>Lh)};let Lh=(()=>{class t extends Zu{constructor(t,e,n,i,r){super(),this._ngModelWarningConfig=r,this._added=!1,this.update=new Za,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=oh(0,i)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),rh(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Ku(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(Ns($u,13),Ns(Tu,10),Ns(Mu,10),Ns(yu,10),Ns(Oh,8))},t.\u0275dir=Wt({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Bo([Rh]),Ts,ae]}),t._ngModelWarningSentOnce=!1,t})();const Fh={provide:yu,useExisting:it(()=>Nh),multi:!0};function Bh(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Nh=(()=>{class t extends _u{constructor(t,e){super(),this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=Bh(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wo),Ns(Go))},t.\u0275dir=Wt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&Ws("change",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bo([Fh]),Ts]}),t})(),Vh=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(Bh(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ns(Go),Ns(Wo),Ns(Nh,9))},t.\u0275dir=Wt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const Uh={provide:yu,useExisting:it(()=>qh),multi:!0};function jh(t,e){return null==t?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let qh=(()=>{class t extends _u{constructor(t,e){super(),this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const i=t.item(e),r=this._getOptionValue(i.value);n.push(r)}}else{const t=e.options;for(let e=0;e<t.length;e++){const i=t.item(e);if(i.selected){const t=this._getOptionValue(i.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wo),Ns(Go))},t.\u0275dir=Wt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&Ws("change",function(t){return e.onChange(t.target)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bo([Uh]),Ts]}),t})(),$h=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(jh(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(jh(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ns(Go),Ns(Wo),Ns(qh,9))},t.\u0275dir=Wt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})(),Gh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[kh]]}),t})(),Zh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[Gh]}),t})(),Hh=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Oh,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[Gh]}),t})(),Wh=(()=>{class t{group(t,e=null){const n=this._reduceControls(t);let i,r=null,s=null;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,s=null!=e.asyncValidators?e.asyncValidators:null,i=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,s=null!=e.asyncValidator?e.asyncValidator:null)),new vh(n,{asyncValidators:s,updateOn:i,validators:r})}control(t,e,n){return new yh(t,e,n)}array(t,e,n){const i=t.map(t=>this._createControl(t));return new xh(i,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof yh||t instanceof vh||t instanceof xh?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({factory:function(){return new t},token:t,providedIn:Hh}),t})(),Xh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),Kh=(()=>{class t{constructor(){this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(e=>e.id!==t)}open(t){this.modals.find(e=>e.id===t).open()}close(t){this.modals.find(e=>e.id===t).close()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Qh(...t){let e=t[t.length-1];return S(e)?(t.pop(),R(t,e)):$(t)}class Yh extends C{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new x;return this._value}next(t){super.next(this._value=t)}}class Jh extends f{notifyNext(t,e,n,i,r){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class td extends f{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function ed(t,e,n,i,r=new td(t,n,i)){if(!r.closed)return e instanceof y?e.subscribe(r):D(e)(r)}const nd={};class id{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new rd(t,this.resultSelector))}}class rd extends Jh{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(nd),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add(ed(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const i=this.values,r=this.toRespond?i[n]===nd?--this.toRespond:this.toRespond:0;i[n]=e,0===r&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const sd=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function od(...t){return q(1)(Qh(...t))}const ad=new y(t=>t.complete());function ld(t){return t?function(t){return new y(e=>t.schedule(()=>e.complete()))}(t):ad}function cd(t){return new y(e=>{let n;try{n=t()}catch(i){return void e.error(i)}return(n?L(n):ld()).subscribe(e)})}function ud(t,e){return"function"==typeof e?n=>n.pipe(ud((n,i)=>L(t(n,i)).pipe(T((t,r)=>e(n,t,i,r))))):e=>e.lift(new hd(t))}class hd{constructor(t){this.project=t}call(t,e){return e.subscribe(new dd(t,this.project))}}class dd extends B{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new F(this),i=this.destination;i.add(n),this.innerSubscription=N(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const pd=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function fd(t){return e=>0===t?ld():e.lift(new md(t))}class md{constructor(t){if(this.total=t,this.total<0)throw new pd}call(t,e){return e.subscribe(new gd(t,this.total))}}class gd extends f{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function _d(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new yd(t,e,n))}}class yd{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new vd(t,this.accumulator,this.seed,this.hasSeed))}}class vd extends f{constructor(t,e,n,i){super(t),this.accumulator=e,this._seed=n,this.hasSeed=i,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(i){this.destination.error(i)}this.seed=n,this.destination.next(n)}}function xd(t,e){return function(n){return n.lift(new bd(t,e))}}class bd{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new wd(t,this.predicate,this.thisArg))}}class wd extends f{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function Cd(t){return function(e){const n=new Ed(t),i=e.lift(n);return n.caught=i}}class Ed{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Sd(t,this.selector,this.caught))}}class Sd extends B{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const i=new F(this);this.add(i);const r=N(n,i);r!==i&&this.add(r)}}}function Td(t,e){return V(t,e,1)}function Md(t){return function(e){return 0===t?ld():e.lift(new Ad(t))}}class Ad{constructor(t){if(this.total=t,this.total<0)throw new pd}call(t,e){return e.subscribe(new kd(t,this.total))}}class kd extends f{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,i=this.ring;for(let r=0;r<n;r++){const r=e++%n;t.next(i[r])}}t.complete()}}function Pd(t=zd){return e=>e.lift(new Id(t))}class Id{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Od(t,this.errorFactory))}}class Od extends f{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function zd(){return new sd}function Dd(t=null){return e=>e.lift(new Rd(t))}class Rd{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Ld(t,this.defaultValue))}}class Ld extends f{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Fd(t,e){const n=arguments.length>=2;return i=>i.pipe(t?xd((e,n)=>t(e,n,i)):_,fd(1),n?Dd(e):Pd(()=>new sd))}function Bd(){}function Nd(t,e,n){return function(i){return i.lift(new Vd(t,e,n))}}class Vd{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new Ud(t,this.nextOrObserver,this.error,this.complete))}}class Ud extends f{constructor(t,e,n,r){super(t),this._tapNext=Bd,this._tapError=Bd,this._tapComplete=Bd,this._tapError=n||Bd,this._tapComplete=r||Bd,i(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Bd,this._tapError=e.error||Bd,this._tapComplete=e.complete||Bd)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class jd{constructor(t){this.callback=t}call(t,e){return e.subscribe(new qd(t,this.callback))}}class qd extends f{constructor(t,e){super(t),this.add(new h(e))}}class $d{constructor(t,e){this.id=t,this.url=e}}class Gd extends $d{constructor(t,e,n="imperative",i=null){super(t,e),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Zd extends $d{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Hd extends $d{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Wd extends $d{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Xd extends $d{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kd extends $d{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qd extends $d{constructor(t,e,n,i,r){super(t,e),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Yd extends $d{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jd extends $d{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tp{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ep{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class np{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ip{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rp{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sp{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class op{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ap="primary";class lp{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function cp(t){return new lp(t)}function up(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function hp(t,e,n){const i=n.path.split("/");if(i.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let s=0;s<i.length;s++){const e=i[s],n=t[s];if(e.startsWith(":"))r[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function dp(t,e){const n=t?Object.keys(t):void 0,i=e?Object.keys(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!pp(t[r],e[r]))return!1;return!0}function pp(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((t,e)=>i[e]===t)}return t===e}function fp(t){return Array.prototype.concat.apply([],t)}function mp(t){return t.length>0?t[t.length-1]:null}function gp(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function _p(t){return Hs(t)?t:Zs(t)?L(Promise.resolve(t)):Qh(t)}function yp(t,e,n){return n?function(t,e){return dp(t,e)}(t.queryParams,e.queryParams)&&vp(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>pp(t[n],e[n]))}(t.queryParams,e.queryParams)&&xp(t.root,e.root)}function vp(t,e){if(!Sp(t.segments,e.segments))return!1;if(t.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children){if(!t.children[n])return!1;if(!vp(t.children[n],e.children[n]))return!1}return!0}function xp(t,e){return bp(t,e,e.segments)}function bp(t,e,n){if(t.segments.length>n.length)return!!Sp(t.segments.slice(0,n.length),n)&&!e.hasChildren();if(t.segments.length===n.length){if(!Sp(t.segments,n))return!1;for(const n in e.children){if(!t.children[n])return!1;if(!xp(t.children[n],e.children[n]))return!1}return!0}{const i=n.slice(0,t.segments.length),r=n.slice(t.segments.length);return!!Sp(t.segments,i)&&!!t.children.primary&&bp(t.children.primary,e,r)}}class wp{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cp(this.queryParams)),this._queryParamMap}toString(){return Ap.serialize(this)}}class Cp{constructor(t,e){this.segments=t,this.children=e,this.parent=null,gp(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kp(this)}}class Ep{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=cp(this.parameters)),this._parameterMap}toString(){return Lp(this)}}function Sp(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}class Tp{}class Mp{parse(t){const e=new Up(t);return new wp(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`/${Pp(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Op(e)}=${Op(t)}`).join("&"):`${Op(e)}=${Op(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Ap=new Mp;function kp(t){return t.segments.map(t=>Lp(t)).join("/")}function Pp(t,e){if(!t.hasChildren())return kp(t);if(e){const e=t.children.primary?Pp(t.children.primary,!1):"",n=[];return gp(t.children,(t,e)=>{e!==ap&&n.push(`${e}:${Pp(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function(t,e){let n=[];return gp(t.children,(t,i)=>{i===ap&&(n=n.concat(e(t,i)))}),gp(t.children,(t,i)=>{i!==ap&&(n=n.concat(e(t,i)))}),n}(t,(e,n)=>n===ap?[Pp(t.children.primary,!1)]:[`${n}:${Pp(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${kp(t)}/${e[0]}`:`${kp(t)}/(${e.join("//")})`}}function Ip(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Op(t){return Ip(t).replace(/%3B/gi,";")}function zp(t){return Ip(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Dp(t){return decodeURIComponent(t)}function Rp(t){return Dp(t.replace(/\+/g,"%20"))}function Lp(t){return`${zp(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${zp(t)}=${zp(e[t])}`).join("")}`;var e}const Fp=/^[^\/()?;=#]+/;function Bp(t){const e=t.match(Fp);return e?e[0]:""}const Np=/^[^=?&#]+/,Vp=/^[^?&#]+/;class Up{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cp([],{}):new Cp([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Cp(t,e)),n}parseSegment(){const t=Bp(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Ep(Dp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Bp(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Bp(this.remaining);t&&(n=t,this.capture(n))}t[Dp(e)]=Dp(n)}parseQueryParam(t){const e=function(t){const e=t.match(Np);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Vp);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const i=Rp(e),r=Rp(n);if(t.hasOwnProperty(i)){let e=t[i];Array.isArray(e)||(e=[e],t[i]=e),e.push(r)}else t[i]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Bp(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let r;n.indexOf(":")>-1?(r=n.substr(0,n.indexOf(":")),this.capture(r),this.capture(":")):t&&(r=ap);const s=this.parseChildren();e[r]=1===Object.keys(s).length?s.primary:new Cp([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class jp{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=qp(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=qp(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=$p(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return $p(t,this._root).map(t=>t.value)}}function qp(t,e){if(t===e.value)return e;for(const n of e.children){const e=qp(t,n);if(e)return e}return null}function $p(t,e){if(t===e.value)return[e];for(const n of e.children){const i=$p(t,n);if(i.length)return i.unshift(e),i}return[]}class Gp{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Zp(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Hp extends jp{constructor(t,e){super(t),this.snapshot=e,Jp(this,t)}toString(){return this.snapshot.toString()}}function Wp(t,e){const n=function(t,e){const n=new Qp([],{},{},"",{},ap,e,null,t.root,-1,{});return new Yp("",new Gp(n,[]))}(t,e),i=new Yh([new Ep("",{})]),r=new Yh({}),s=new Yh({}),o=new Yh({}),a=new Yh(""),l=new Xp(i,r,o,a,s,ap,e,n.root);return l.snapshot=n.root,new Hp(new Gp(l,[]),n)}class Xp{constructor(t,e,n,i,r,s,o,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(T(t=>cp(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(T(t=>cp(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Kp(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const t=n[i],e=n[i-1];if(t.routeConfig&&""===t.routeConfig.path)i--;else{if(e.component)break;i--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class Qp{constructor(t,e,n,i,r,s,o,a,l,c,u){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=cp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Yp extends jp{constructor(t,e){super(e),this.url=t,Jp(this,e)}toString(){return tf(this._root)}}function Jp(t,e){e.value._routerState=t,e.children.forEach(e=>Jp(t,e))}function tf(t){const e=t.children.length>0?` { ${t.children.map(tf).join(", ")} } `:"";return`${t.value}${e}`}function ef(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,dp(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),dp(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!dp(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),dp(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function nf(t,e){var n,i;return dp(t.params,e.params)&&Sp(n=t.url,i=e.url)&&n.every((t,e)=>dp(t.parameters,i[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||nf(t.parent,e.parent))}function rf(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function(t,e,n){return e.children.map(e=>{for(const i of n.children)if(t.shouldReuseRoute(e.value,i.value.snapshot))return rf(t,e,i);return rf(t,e)})}(t,e,n);return new Gp(i,r)}{const n=t.retrieve(e.value);if(n){const t=n.route;return sf(e,t),t}{const n=new Xp(new Yh((i=e.value).url),new Yh(i.params),new Yh(i.queryParams),new Yh(i.fragment),new Yh(i.data),i.outlet,i.component,i),r=e.children.map(e=>rf(t,e));return new Gp(n,r)}}var i}function sf(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)sf(t.children[n],e.children[n])}function of(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function af(t){return"object"==typeof t&&null!=t&&t.outlets}function lf(t,e,n,i,r){let s={};return i&&gp(i,(t,e)=>{s[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new wp(n.root===t?e:cf(n.root,t,e),s,r)}function cf(t,e,n){const i={};return gp(t.children,(t,r)=>{i[r]=t===e?n:cf(t,e,n)}),new Cp(t.segments,i)}class uf{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&of(n[0]))throw new Error("Root segment cannot have matrix parameters");const i=n.find(af);if(i&&i!==mp(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class hf{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function df(t,e,n){if(t||(t=new Cp([],{})),0===t.segments.length&&t.hasChildren())return pf(t,e,n);const i=function(t,e,n){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;const e=t.segments[r],o=n[i];if(af(o))break;const a=`${o}`,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!_f(a,l,e))return s;i+=2}else{if(!_f(a,{},e))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const e=new Cp(t.segments.slice(0,i.pathIndex),{});return e.children.primary=new Cp(t.segments.slice(i.pathIndex),t.children),pf(e,0,r)}return i.match&&0===r.length?new Cp(t.segments,{}):i.match&&!t.hasChildren()?ff(t,e,n):i.match?pf(t,0,r):ff(t,e,n)}function pf(t,e,n){if(0===n.length)return new Cp(t.segments,{});{const i=function(t){return af(t[0])?t[0].outlets:{[ap]:t}}(n),r={};return gp(i,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(r[i]=df(t.children[i],e,n))}),gp(t.children,(t,e)=>{void 0===i[e]&&(r[e]=t)}),new Cp(t.segments,r)}}function ff(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const s=n[r];if(af(s)){const t=mf(s.outlets);return new Cp(i,t)}if(0===r&&of(n[0])){i.push(new Ep(t.segments[e].path,gf(n[0]))),r++;continue}const o=af(s)?s.outlets.primary:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&of(a)?(i.push(new Ep(o,gf(a))),r+=2):(i.push(new Ep(o,{})),r++)}return new Cp(i,{})}function mf(t){const e={};return gp(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=ff(new Cp([],{}),0,t))}),e}function gf(t){const e={};return gp(t,(t,n)=>e[n]=`${t}`),e}function _f(t,e,n){return t==n.path&&dp(e,n.parameters)}class yf{constructor(t,e,n,i){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=i}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),ef(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const i=Zp(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,i[e],n),delete i[e]}),gp(i,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(i===r)if(i.component){const r=n.getContext(i.outlet);r&&this.deactivateChildRoutes(t,e,r.children)}else this.deactivateChildRoutes(t,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:i})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,r=Zp(t);for(const s of Object.keys(r))this.deactivateRouteAndItsChildren(r[s],i);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}activateChildRoutes(t,e,n){const i=Zp(e);t.children.forEach(t=>{this.activateRoutes(t,i[t.value.outlet],n),this.forwardEvent(new sp(t.value.snapshot))}),t.children.length&&this.forwardEvent(new ip(t.value.snapshot))}activateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(ef(i),i===r)if(i.component){const r=n.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,r.children)}else this.activateChildRoutes(t,e,n);else if(i.component){const e=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const t=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),vf(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),r=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=i,e.resolver=r,e.outlet&&e.outlet.activateWith(i,r),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function vf(t){ef(t.value),t.children.forEach(vf)}class xf{constructor(t,e){this.routes=t,this.module=e}}function bf(t){return"function"==typeof t}function wf(t){return t instanceof wp}const Cf=Symbol("INITIAL_VALUE");function Ef(){return ud(t=>function(...t){let e,n;return S(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),$(t,n).lift(new id(e))}(t.map(t=>t.pipe(fd(1),function(...t){const e=t[t.length-1];return S(e)?(t.pop(),n=>od(t,n,e)):e=>od(t,e)}(Cf)))).pipe(_d((t,e)=>{let n=!1;return e.reduce((t,i,r)=>{if(t!==Cf)return t;if(i===Cf&&(n=!0),!n){if(!1===i)return i;if(r===e.length-1||wf(i))return i}return t},t)},Cf),xd(t=>t!==Cf),T(t=>wf(t)?t:!0===t),fd(1)))}let Sf=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&$s(0,"router-outlet")},directives:function(){return[xm]},encapsulation:2}),t})();function Tf(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];Mf(i,Af(e,i))}}function Mf(t,e){t.children&&Tf(t.children,e)}function Af(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function kf(t){const e=t.children&&t.children.map(kf),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ap&&(n.component=Sf),n}function Pf(t){return t.outlet||ap}function If(t,e){const n=t.filter(t=>Pf(t)===e);return n.push(...t.filter(t=>Pf(t)!==e)),n}const Of={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function zf(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},Of):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(e.matcher||hp)(n,t,e);if(!r)return Object.assign({},Of);const s={};gp(r.posParams,(t,e)=>{s[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o,positionalParamSegments:null!==(i=r.posParams)&&void 0!==i?i:{}}}function Df(t,e,n,i,r="corrected"){if(n.length>0&&function(t,e,n){return n.some(n=>Rf(t,e,n)&&Pf(n)!==ap)}(t,n,i)){const r=new Cp(e,function(t,e,n,i){const r={};r.primary=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&Pf(s)!==ap){const n=new Cp([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,r[Pf(s)]=n}return r}(t,e,i,new Cp(n,t.children)));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Rf(t,e,n))}(t,n,i)){const s=new Cp(t.segments,function(t,e,n,i,r,s){const o={};for(const a of i)if(Rf(t,n,a)&&!r[Pf(a)]){const n=new Cp([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[Pf(a)]=n}return Object.assign(Object.assign({},r),o)}(t,e,n,i,t.children,r));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const s=new Cp(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function Rf(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function Lf(t,e,n,i){return!!(Pf(t)===i||i!==ap&&Rf(e,n,t))&&("**"===t.path||zf(e,t,n).matched)}function Ff(t,e,n){return 0===e.length&&!t.children[n]}class Bf{constructor(t){this.segmentGroup=t||null}}class Nf{constructor(t){this.urlTree=t}}function Vf(t){return new y(e=>e.error(new Bf(t)))}function Uf(t){return new y(e=>e.error(new Nf(t)))}function jf(t){return new y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class qf{constructor(t,e,n,i,r){this.configLoader=e,this.urlSerializer=n,this.urlTree=i,this.config=r,this.allowRedirects=!0,this.ngModule=t.get(Ta)}apply(){const t=Df(this.urlTree.root,[],[],this.config).segmentGroup,e=new Cp(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,ap).pipe(T(t=>this.createUrlTree($f(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Cd(t=>{if(t instanceof Nf)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Bf)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,ap).pipe(T(e=>this.createUrlTree($f(e),t.queryParams,t.fragment))).pipe(Cd(t=>{if(t instanceof Bf)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const i=t.segments.length>0?new Cp([],{[ap]:t}):t;return new wp(i,e,n)}expandSegmentGroup(t,e,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(T(t=>new Cp([],t))):this.expandSegment(t,n,e,n.segments,i,!0)}expandChildren(t,e,n){const i=[];for(const r of Object.keys(n.children))"primary"===r?i.unshift(r):i.push(r);return L(i).pipe(Td(i=>{const r=n.children[i],s=If(e,i);return this.expandSegmentGroup(t,s,r,i).pipe(T(t=>({segment:t,outlet:i})))}),_d((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const n=arguments.length>=2;return i=>i.pipe(t?xd((e,n)=>t(e,n,i)):_,Md(1),n?Dd(e):Pd(()=>new sd))}())}expandSegment(t,e,n,i,r,s){return L(n).pipe(Td(o=>this.expandSegmentAgainstRoute(t,e,n,o,i,r,s).pipe(Cd(t=>{if(t instanceof Bf)return Qh(null);throw t}))),Fd(t=>!!t),Cd((t,n)=>{if(t instanceof sd||"EmptyError"===t.name){if(Ff(e,i,r))return Qh(new Cp([],{}));throw new Bf(e)}throw t}))}expandSegmentAgainstRoute(t,e,n,i,r,s,o){return Lf(i,e,r,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,e,i,r,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s):Vf(e):Vf(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,i){const r=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Uf(r):this.lineralizeSegments(n,r).pipe(V(n=>{const r=new Cp(n,{});return this.expandSegment(t,r,e,n,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=zf(e,i,r);if(!o)return Vf(e);const u=this.applyRedirectCommands(a,i.redirectTo,c);return i.redirectTo.startsWith("/")?Uf(u):this.lineralizeSegments(i,u).pipe(V(i=>this.expandSegment(t,e,n,i.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,e,n,i,r){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Qh(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe(T(t=>(n._loadedConfig=t,new Cp(i,{})))):Qh(new Cp(i,{}));const{matched:s,consumedSegments:o,lastChild:a}=zf(e,n,i);if(!s)return Vf(e);const l=i.slice(a);return this.getChildConfig(t,n,i).pipe(V(t=>{const i=t.module,s=t.routes,{segmentGroup:a,slicedSegments:c}=Df(e,o,l,s),u=new Cp(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(i,s,u).pipe(T(t=>new Cp(o,t)));if(0===s.length&&0===c.length)return Qh(new Cp(o,{}));const h=Pf(n)===r;return this.expandSegment(i,u,s,c,h?ap:r,!0).pipe(T(t=>new Cp(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Qh(new xf(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Qh(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(V(n=>n?this.configLoader.load(t.injector,e).pipe(T(t=>(e._loadedConfig=t,t))):function(t){return new y(e=>e.error(up(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Qh(new xf([],t))}runCanLoadGuards(t,e,n){const i=e.canLoad;return i&&0!==i.length?Qh(i.map(i=>{const r=t.get(i);let s;if(function(t){return t&&bf(t.canLoad)}(r))s=r.canLoad(e,n);else{if(!bf(r))throw new Error("Invalid CanLoad guard");s=r(e,n)}return _p(s)})).pipe(Ef(),Nd(t=>{if(!wf(t))return;const e=up(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),T(t=>!0===t)):Qh(!0)}lineralizeSegments(t,e){let n=[],i=e.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Qh(n);if(i.numberOfChildren>1||!i.children.primary)return jf(t.redirectTo);i=i.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,i){const r=this.createSegmentGroup(t,e.root,n,i);return new wp(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return gp(t,(t,i)=>{if("string"==typeof t&&t.startsWith(":")){const r=t.substring(1);n[i]=e[r]}else n[i]=t}),n}createSegmentGroup(t,e,n,i){const r=this.createSegments(t,e.segments,n,i);let s={};return gp(e.children,(e,r)=>{s[r]=this.createSegmentGroup(t,e,n,i)}),new Cp(r,s)}createSegments(t,e,n,i){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,i):this.findOrReturn(e,n))}findPosParam(t,e,n){const i=n[e.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return i}findOrReturn(t,e){let n=0;for(const i of e){if(i.path===t.path)return e.splice(n),i;n++}return t}}function $f(t){const e={};for(const n of Object.keys(t.children)){const i=$f(t.children[n]);(i.segments.length>0||i.hasChildren())&&(e[n]=i)}return function(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new Cp(t.segments.concat(e.segments),e.children)}return t}(new Cp(t.segments,e))}class Gf{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Zf{constructor(t,e){this.component=t,this.route=e}}function Hf(t,e,n){const i=t._root;return Xf(i,e?e._root:null,n,[i.value])}function Wf(t,e,n){const i=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function Xf(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Zp(e);return t.children.forEach(t=>{!function(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Sp(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Sp(t.url,e.url)||!dp(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nf(t,e)||!dp(t.queryParams,e.queryParams);case"paramsChange":default:return!nf(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Gf(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Xf(t,e,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Zf(a.outlet.component,o))}else o&&Kf(e,a,r),r.canActivateChecks.push(new Gf(i)),Xf(t,null,s.component?a?a.children:null:n,i,r)}(t,s[t.value.outlet],n,i.concat([t.value]),r),delete s[t.value.outlet]}),gp(s,(t,e)=>Kf(t,n.getContext(e),r)),r}function Kf(t,e,n){const i=Zp(t),r=t.value;gp(i,(t,i)=>{Kf(t,r.component?e?e.children.getContext(i):null:e,n)}),n.canDeactivateChecks.push(new Zf(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class Qf{}function Yf(t){return new y(e=>e.error(t))}class Jf{constructor(t,e,n,i,r,s){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=i,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){const t=Df(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,ap);if(null===e)return null;const n=new Qp([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ap,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Gp(n,e),r=new Yp(this.url,i);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(t){const e=t.value,n=Kp(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const r of Object.keys(e.children)){const i=e.children[r],s=If(t,r),o=this.processSegmentGroup(s,i,r);if(null===o)return null;n.push(...o)}const i=function(t){const e=[];for(const n of t){if(!tm(n)){e.push(n);continue}const t=e.find(t=>n.value.routeConfig===t.value.routeConfig);void 0!==t?t.children.push(...n.children):e.push(n)}return e}(n);return i.sort((t,e)=>t.value.outlet===ap?-1:e.value.outlet===ap?1:t.value.outlet.localeCompare(e.value.outlet)),i}processSegment(t,e,n,i){for(const r of t){const t=this.processSegmentAgainstRoute(r,e,n,i);if(null!==t)return t}return Ff(e,n,i)?[]:null}processSegmentAgainstRoute(t,e,n,i){if(t.redirectTo||!Lf(t,e,n,i))return null;let r,s=[],o=[];if("**"===t.path){const i=n.length>0?mp(n).parameters:{};r=new Qp(n,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,im(t),Pf(t),t.component,t,em(e),nm(e)+n.length,rm(t))}else{const i=zf(e,t,n);if(!i.matched)return null;s=i.consumedSegments,o=n.slice(i.lastChild),r=new Qp(s,i.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,im(t),Pf(t),t.component,t,em(e),nm(e)+s.length,rm(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=Df(e,s,o,a.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return null===t?null:[new Gp(r,t)]}if(0===a.length&&0===c.length)return[new Gp(r,[])];const u=Pf(t)===i,h=this.processSegment(a,l,c,u?ap:i);return null===h?null:[new Gp(r,h)]}}function tm(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function em(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function nm(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function im(t){return t.data||{}}function rm(t){return t.resolve||{}}function sm(t){return ud(e=>{const n=t(e);return n?L(n).pipe(T(()=>e)):Qh(e)})}class om extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const am=new qn("ROUTES");class lm{constructor(t,e,n,i){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=i}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const n=this.loadModuleFactory(e.loadChildren).pipe(T(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const i=n.create(t);return new xf(fp(i.injector.get(am,void 0,vt.Self|vt.Optional)).map(kf),i)}),Cd(t=>{throw e._loader$=void 0,t}));return e._loader$=new W(n,()=>new C).pipe(G()),e._loader$}loadModuleFactory(t){return"string"==typeof t?L(this.loader.load(t)):_p(t()).pipe(V(t=>t instanceof Ma?Qh(t):L(this.compiler.compileModuleAsync(t))))}}class cm{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new um,this.attachRef=null}}class um{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new cm,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class hm{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function dm(t){throw t}function pm(t,e,n){return e.parse("/")}function fm(t,e){return Qh(null)}let mm=(()=>{class t{constructor(t,e,n,i,r,s,o,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=i,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new C,this.errorHandler=dm,this.malformedUriErrorHandler=pm,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:fm,afterPreactivation:fm},this.urlHandlingStrategy=new hm,this.routeReuseStrategy=new om,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=r.get(Ta),this.console=r.get(yl);const l=r.get(Il);this.isNgZoneEnabled=l instanceof Il&&Il.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new wp(new Cp([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new lm(s,o,t=>this.triggerEvent(new tp(t)),t=>this.triggerEvent(new ep(t))),this.routerState=Wp(this.currentUrlTree,this.rootComponentType),this.transitions=new Yh({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(xd(t=>0!==t.id),T(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),ud(t=>{let n=!1,i=!1;return Qh(t).pipe(Nd(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),ud(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Qh(t).pipe(ud(t=>{const n=this.transitions.getValue();return e.next(new Gd(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?ad:Promise.resolve(t)}),(i=this.ngModule.injector,r=this.configLoader,s=this.urlSerializer,o=this.config,ud(t=>function(t,e,n,i,r){return new qf(t,e,n,i,r).apply()}(i,r,s,t.extractedUrl,o).pipe(T(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e}))))),Nd(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,i,r){return V(s=>function(t,e,n,i,r="emptyOnly",s="legacy"){try{const o=new Jf(t,e,n,i,r,s).recognize();return null===o?Yf(new Qf):Qh(o)}catch(o){return Yf(o)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(T(t=>Object.assign(Object.assign({},s),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),Nd(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects);const n=new Xd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var i,r,s,o;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:i,source:r,restoredState:s,extras:o}=t,a=new Gd(n,this.serializeUrl(i),r,s);e.next(a);const l=Wp(i,this.rootComponentType).snapshot;return Qh(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:i,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),ad}),sm(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),Nd(t=>{const e=new Kd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),T(t=>Object.assign(Object.assign({},t),{guards:Hf(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return V(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Qh(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,i){return L(t).pipe(V(t=>function(t,e,n,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Qh(s.map(s=>{const o=Wf(s,e,r);let a;if(function(t){return t&&bf(t.canDeactivate)}(o))a=_p(o.canDeactivate(t,e,n,i));else{if(!bf(o))throw new Error("Invalid CanDeactivate guard");a=_p(o(t,e,n,i))}return a.pipe(Fd())})).pipe(Ef()):Qh(!0)}(t.component,t.route,n,e,i)),Fd(t=>!0!==t,!0))}(o,i,r,t).pipe(V(n=>n&&"boolean"==typeof n?function(t,e,n,i){return L(e).pipe(Td(e=>od(function(t,e){return null!==t&&e&&e(new np(t)),Qh(!0)}(e.route.parent,i),function(t,e){return null!==t&&e&&e(new rp(t)),Qh(!0)}(e.route,i),function(t,e,n){const i=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>cd(()=>Qh(e.guards.map(r=>{const s=Wf(r,e.node,n);let o;if(function(t){return t&&bf(t.canActivateChild)}(s))o=_p(s.canActivateChild(i,t));else{if(!bf(s))throw new Error("Invalid CanActivateChild guard");o=_p(s(i,t))}return o.pipe(Fd())})).pipe(Ef())));return Qh(r).pipe(Ef())}(t,e.path,n),function(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;return i&&0!==i.length?Qh(i.map(i=>cd(()=>{const r=Wf(i,e,n);let s;if(function(t){return t&&bf(t.canActivate)}(r))s=_p(r.canActivate(e,t));else{if(!bf(r))throw new Error("Invalid CanActivate guard");s=_p(r(e,t))}return s.pipe(Fd())}))).pipe(Ef()):Qh(!0)}(t,e.route,n))),Fd(t=>!0!==t,!0))}(i,s,t,e):Qh(n)),T(t=>Object.assign(Object.assign({},n),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),Nd(t=>{if(wf(t.guardsResult)){const e=up(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new Qd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),xd(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Hd(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),sm(t=>{if(t.guards.canActivateChecks.length)return Qh(t).pipe(Nd(t=>{const e=new Yd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),ud(t=>{let n=!1;return Qh(t).pipe((i=this.paramsInheritanceStrategy,r=this.ngModule.injector,V(t=>{const{targetSnapshot:e,guards:{canActivateChecks:n}}=t;if(!n.length)return Qh(t);let s=0;return L(n).pipe(Td(t=>function(t,e,n,i){return function(t,e,n,i){const r=Object.keys(t);if(0===r.length)return Qh({});const s={};return L(r).pipe(V(r=>function(t,e,n,i){const r=Wf(t,e,i);return _p(r.resolve?r.resolve(e,n):r(e,n))}(t[r],e,n,i).pipe(Nd(t=>{s[r]=t}))),Md(1),V(()=>Object.keys(s).length===r.length?Qh(s):ad))}(t._resolve,t,e,i).pipe(T(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Kp(t,n).resolve),null)))}(t.route,e,i,r)),Nd(()=>s++),Md(1),V(e=>s===n.length?Qh(t):ad))})),Nd({next:()=>n=!0,complete:()=>{if(!n){const n=new Hd(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(n),t.resolve(!1)}}}));var i,r}),Nd(t=>{const e=new Jd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),sm(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),T(t=>{const e=function(t,e,n){const i=rf(t,e._root,n?n._root:void 0);return new Hp(i,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),Nd(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(s=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),T(t=>(new yf(o,t.targetRouterState,t.currentRouterState,a).activate(s),t))),Nd({next(){n=!0},complete(){n=!0}}),(r=()=>{if(!n&&!i){this.resetUrlToCurrentUrlTree();const n=new Hd(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new jd(r))),Cd(n=>{if(i=!0,(r=n)&&r.ngNavigationCancelingError){const i=wf(n.url);i||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const r=new Hd(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(r),i?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const i=new Wd(t.id,this.serializeUrl(t.extractedUrl),n);e.next(i);try{t.resolve(this.errorHandler(n))}catch(s){t.reject(s)}}var r;return ad}));var r,s,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:i}=e,r={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,0!==Object.keys(t).length&&(r.state=t)}this.scheduleNavigation(i,t,n,r)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&n&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Tf(t),this.config=t.map(kf),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,e={}){const{relativeTo:n,queryParams:i,fragment:r,queryParamsHandling:s,preserveFragment:o}=e,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:r;let c=null;switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),i);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=i||null}return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,i,r){if(0===n.length)return lf(e.root,e.root,e,i,r);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new uf(!0,0,t);let e=0,n=!1;const i=t.reduce((t,i,r)=>{if("object"==typeof i&&null!=i){if(i.outlets){const e={};return gp(i.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(i.segmentPath)return[...t,i.segmentPath]}return"string"!=typeof i?[...t,i]:0===r?(i.split("/").forEach((i,r)=>{0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?e++:""!=i&&t.push(i))}),t):[...t,i]},[]);return new uf(n,e,i)}(n);if(s.toRoot())return lf(e.root,new Cp([],{}),e,i,r);const o=function(t,e,n){if(t.isAbsolute)return new hf(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new hf(t,t===e.root,0)}const i=of(t.commands[0])?0:1;return function(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new hf(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?pf(o.segmentGroup,o.index,s.commands):df(o.segmentGroup,o.index,s.commands);return lf(o.segmentGroup,a,e,i,r)}(a,this.currentUrlTree,t,c,l)}navigateByUrl(t,e={skipLocationChange:!1}){const n=wf(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(wf(t))return yp(this.currentUrlTree,t,e);const n=this.parseUrl(t);return yp(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return null!=i&&(e[n]=i),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Zd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,i,r){if(this.disposed)return Promise.resolve(!1);const s=this.getTransition(),o="imperative"!==e&&"imperative"===(null==s?void 0:s.source),a=(this.lastSuccessfulId===s.id||this.currentNavigation?s.rawUrl:s.urlAfterRedirects).toString()===t.toString();if(o&&a)return Promise.resolve(!0);let l,c,u;r?(l=r.resolve,c=r.reject,u=r.promise):u=new Promise((t,e)=>{l=t,c=e});const h=++this.navigationId;return this.setTransition({id:h,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:i,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,i){const r=this.urlSerializer.serialize(t);i=i||{},this.location.isCurrentPathEqualTo(r)||e?this.location.replaceState(r,"",Object.assign(Object.assign({},i),{navigationId:n})):this.location.go(r,"",Object.assign(Object.assign({},i),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(ai(Gn),ai(Tp),ai(um),ai(Ec),ai(Es),ai(Jl),ai(Al),ai(void 0))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),gm=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.route=e,this.commands=[],this.onChanges=new C,null==n&&i.setAttribute(r.nativeElement,"tabindex","0")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}onClick(){const t={skipLocationChange:ym(this.skipLocationChange),replaceUrl:ym(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ym(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(Ns(mm),Ns(Xp),Vn("tabindex"),Ns(Wo),Ns(Go))},t.\u0275dir=Wt({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,e){1&t&&Ws("click",function(){return e.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ae]}),t})(),_m=(()=>{class t{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.onChanges=new C,this.subscription=t.events.subscribe(t=>{t instanceof Zd&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,i,r){if(0!==t||e||n||i||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const s={skipLocationChange:ym(this.skipLocationChange),replaceUrl:ym(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,s),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ym(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(Ns(mm),Ns(Xp),Ns(vc))},t.\u0275dir=Wt({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&Ws("click",function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)}),2&t&&(wo("href",e.href,yi),Fs("target",e.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ae]}),t})();function ym(t){return""===t||!!t}let vm=(()=>{class t{constructor(t,e,n,i,r,s){this.router=t,this.element=e,this.renderer=n,this.cdr=i,this.link=r,this.linkWithHref=s,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=t.events.subscribe(t=>{t instanceof Zd&&this.update()})}ngAfterContentInit(){Qh(this.links.changes,this.linksWithHrefs.changes,Qh(null)).pipe(q()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var t;null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe();const e=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(t=>!!t).map(t=>t.onChanges);this.linkInputChangesSubscription=L(e).pipe(q()).subscribe(t=>{this.isActive!==this.isLinkActive(this.router)(t)&&this.update()})}set routerLinkActive(t){const e=Array.isArray(t)?t:t.split(" ");this.classes=e.filter(t=>!!t)}ngOnChanges(t){this.update()}ngOnDestroy(){var t;this.routerEventsSubscription.unsubscribe(),null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe()}update(){this.links&&this.linksWithHrefs&&this.router.navigated&&Promise.resolve().then(()=>{const t=this.hasActiveLinks();this.isActive!==t&&(this.isActive=t,this.cdr.markForCheck(),this.classes.forEach(e=>{t?this.renderer.addClass(this.element.nativeElement,e):this.renderer.removeClass(this.element.nativeElement,e)}))})}isLinkActive(t){return e=>t.isActive(e.urlTree,this.routerLinkActiveOptions.exact)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.linkWithHref&&t(this.linkWithHref)||this.links.some(t)||this.linksWithHrefs.some(t)}}return t.\u0275fac=function(e){return new(e||t)(Ns(mm),Ns(Go),Ns(Wo),Ns(_a),Ns(gm,8),Ns(_m,8))},t.\u0275dir=Wt({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(t,e,n){if(1&t&&(sl(n,gm,1),sl(n,_m,1)),2&t){let t;rl(t=ol())&&(e.links=t),rl(t=ol())&&(e.linksWithHrefs=t)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[ae]}),t})(),xm=(()=>{class t{constructor(t,e,n,i,r){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=r,this.activated=null,this._activatedRoute=null,this.activateEvents=new Za,this.deactivateEvents=new Za,this.name=i||ap,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),i=this.parentContexts.getOrCreateContext(this.name).children,r=new bm(t,i,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Ns(um),Ns(ka),Ns(Uo),Vn("name"),Ns(_a))},t.\u0275dir=Wt({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class bm{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Xp?this.route:t===um?this.childContexts:this.parent.get(t,e)}}class wm{}class Cm{preload(t,e){return Qh(null)}}let Em=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.injector=i,this.preloadingStrategy=r,this.loader=new lm(e,n,e=>t.triggerEvent(new tp(e)),e=>t.triggerEvent(new ep(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(xd(t=>t instanceof Zd),Td(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ta);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const i of e)if(i.loadChildren&&!i.canLoad&&i._loadedConfig){const t=i._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else i.loadChildren&&!i.canLoad?n.push(this.preloadConfig(t,i)):i.children&&n.push(this.processRoutes(t,i.children));return L(n).pipe(q(),T(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>(e._loadedConfig?Qh(e._loadedConfig):this.loader.load(t.injector,e)).pipe(V(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(ai(mm),ai(Jl),ai(Al),ai(Es),ai(wm))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Sm=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Gd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Zd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof op&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new op(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ai(mm),ai(Nc),ai(void 0))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const Tm=new qn("ROUTER_CONFIGURATION"),Mm=new qn("ROUTER_FORROOT_GUARD"),Am=[Ec,{provide:Tp,useClass:Mp},{provide:mm,useFactory:function(t,e,n,i,r,s,o,a={},l,c){const u=new mm(null,t,e,n,i,r,s,fp(o));if(l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(a,u),a.enableTracing){const t=lc();u.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return u},deps:[Tp,um,Ec,Es,Jl,Al,am,Tm,[class{},new hi],[class{},new hi]]},um,{provide:Xp,useFactory:function(t){return t.routerState.root},deps:[mm]},{provide:Jl,useClass:nc},Em,Cm,class{preload(t,e){return e().pipe(Cd(()=>Qh(null)))}},{provide:Tm,useValue:{enableTracing:!1}}];function km(){return new Zl("Router",mm)}let Pm=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Am,Dm(e),{provide:Mm,useFactory:zm,deps:[[mm,new hi,new di]]},{provide:Tm,useValue:n||{}},{provide:vc,useFactory:Om,deps:[uc,[new ui(bc),new hi],Tm]},{provide:Sm,useFactory:Im,deps:[mm,Nc,Tm]},{provide:wm,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Cm},{provide:Zl,multi:!0,useFactory:km},[Rm,{provide:ul,multi:!0,useFactory:Lm,deps:[Rm]},{provide:Bm,useFactory:Fm,deps:[Rm]},{provide:_l,multi:!0,useExisting:Bm}]]}}static forChild(e){return{ngModule:t,providers:[Dm(e)]}}}return t.\u0275fac=function(e){return new(e||t)(ai(Mm,8),ai(mm,8))},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})();function Im(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Sm(t,e,n)}function Om(t,e,n={}){return n.useHash?new Cc(t,e):new wc(t,e)}function zm(t){return"guarded"}function Dm(t){return[{provide:$n,multi:!0,useValue:t},{provide:am,multi:!0,useValue:t}]}let Rm=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new C}appInitializer(){return this.injector.get(dc,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(mm),i=this.injector.get(Tm);return"disabled"===i.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?Qh(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(Tm),n=this.injector.get(Em),i=this.injector.get(Sm),r=this.injector.get(mm),s=this.injector.get(Ql);t===s.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||r.initialNavigation(),n.setUpPreloading(),i.init(),r.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(ai(Es))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();function Lm(t){return t.appInitializer.bind(t)}function Fm(t){return t.bootstrapListener.bind(t)}const Bm=new qn("Router Initializer");function Nm(t,e,n,i){return new(n||(n=Promise))(function(r,s){function o(t){try{l(i.next(t))}catch(e){s(e)}}function a(t){try{l(i.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}l((i=i.apply(t,e||[])).next())})}let Vm=(()=>{class t{constructor(){}getvalue(){return this.x}setvalue(t){this.x=t}getcin(){return this.numcin}setcin(t){this.numcin=t}getemail(){return this.email}setemail(t){this.email=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Um=(()=>{class t{constructor(){}ngOnInit(){}myFunction(){var t=document.getElementById("myTopnav");"topnav"===t.className?t.className+=" responsive":t.className="topnav"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["app-navbar"]],decls:10,vars:0,consts:[["rel","stylesheet","href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"],["id","myTopnav",1,"topnav"],["routerLinkActive","active","href","accueil","routerLink","/accueil"],["href","information","routerLinkActive","active","routerLink","/information"],["href","contact","routerLinkActive","active","routerLink","/contact"],[1,"icon",3,"click"],[1,"fa","fa-bars"]],template:function(t,e){1&t&&($s(0,"link",0),js(1,"div",1),js(2,"a",2),vo(3,"Accueil"),qs(),js(4,"a",3),vo(5,"Information"),qs(),js(6,"a",4),vo(7,"Contact"),qs(),js(8,"a",5),Ws("click",function(){return e.myFunction()}),$s(9,"i",6),qs(),qs())},directives:[_m,vm],styles:[".topnav[_ngcontent-%COMP%]{overflow:hidden;background-color:#050505}.topnav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;display:block;color:#f2f2f2;text-align:center;margin:0 120px;padding:15px 25px;text-decoration:none;font-size:17px}.topnav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ddd;color:#000}.topnav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#f5f107;font-weight:bolder;color:#0a0808}.topnav[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:none}@media screen and (max-width:767px){.topnav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:not(:first-child){display:none}.topnav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:left;margin:0}.topnav[_ngcontent-%COMP%]   a.icon[_ngcontent-%COMP%]{float:right;display:block}}@media screen and (max-width:767px){.topnav.responsive[_ngcontent-%COMP%]{position:relative}.topnav.responsive[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.topnav.responsive[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:none;display:block;text-align:left}}"]}),t})(),jm=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["app-leftside"]],decls:7,vars:0,consts:[[1,"split","left"],[1,"centered"],[2,"font-weight","bolder","color","white","font-size","350%"],["src","assets/img/LOGOo (1).png",2,"width","100%"],["src","assets/img/1.png",1,"image"]],template:function(t,e){1&t&&(js(0,"body"),js(1,"div",0),js(2,"div",1),js(3,"p",2),vo(4,"` Dream Job `"),qs(),$s(5,"img",3),qs(),$s(6,"img",4),qs(),qs())},styles:[".split[_ngcontent-%COMP%]{height:100%;width:35%;position:fixed;z-index:1;top:0;overflow-x:hidden;padding-top:20px}.left[_ngcontent-%COMP%]{left:0;background-color:#111}.image[_ngcontent-%COMP%]{top:36.5%;right:20%}.centered[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]{position:absolute}.centered[_ngcontent-%COMP%]{top:30%;left:50%;transform:translate(-50%,-50%);text-align:center}@media (max-width:767px){.split[_ngcontent-%COMP%]{width:0}}"]}),t})();function qm(t,e){1&t&&(js(0,"div"),vo(1,"Email is required"),qs())}function $m(t,e){if(1&t&&(js(0,"div",20),Bs(1,qm,2,0,"div",13),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.em.errors.required)}}function Gm(t,e){1&t&&(js(0,"div"),vo(1,"Password is required"),qs())}function Zm(t,e){if(1&t&&(js(0,"div",20),Bs(1,Gm,2,0,"div",13),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.pass.errors.required)}}function Hm(t,e){1&t&&(js(0,"div"),js(1,"h4"),vo(2,"!! Merci de choisir votre statut !!"),qs(),qs())}function Wm(t,e){1&t&&(js(0,"div"),js(1,"h4"),vo(2,"Aucun Compte n'est enregistr\xe9 avec cette EMAIL !! Inscrivez Vous !"),qs(),qs())}const Xm=function(t){return{"is-invalid":t}},Km=function(){return{standalone:!0}};let Qm=(()=>{class t{constructor(t,e,n){this.fb=t,this.d=e,this.route=n,this.choix="",this.submitted=!1,this.ok=!0}ngOnInit(){this.form=this.fb.group({em:["",ku.required],pass:["",ku.required]})}get f(){return this.form.controls}updatecontent(){""===this.choix?this.isnull=!0:(this.d.setvalue(this.choix),this.isnull=!1,this.route.navigateByUrl("/inscription1"))}onSubmit(){return Nm(this,void 0,void 0,function*(){if(this.submitted=!0,this.d.setvalue(this.choix),this.form.valid){""===this.choix&&(this.isnull=!0);var t=document.getElementById("email").value,e=document.getElementById("pwd").value,n=`{"email":"${t}","statut":"${this.choix}"}`;const i=yield fetch("http://127.0.0.1:8000/login",{method:"POST",body:n,headers:{"Content-Type":"application/json"}});i.ok&&i.json().then(n=>{console.log(n),String(n.data)===e?(this.route.navigateByUrl("/consultation-chef"),this.ok=!0,this.d.setemail(t)):null===n.data&&(this.ok=!1)})}})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wh),Ns(Vm),Ns(mm))},t.\u0275cmp=jt({type:t,selectors:[["app-accueil"]],decls:36,vars:17,consts:[[1,"split","right"],["id","card"],["id","card-content"],["src","assets/img/images.png","alt","top img",1,"card-img-top"],["id","card-title"],[2,"font-weight","bolder"],[1,"underline-title"],["method","POST",1,"form",3,"formGroup","ngSubmit"],["for","user-email",2,"padding-top","11px"],["id","user-email","type","email","id","email","name","email","autocomplete","on","formControlName","em",1,"form-content",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","user-password",2,"padding-top","20px"],["id","user-password","type","password","id","pwd","name","password","formControlName","pass",1,"form-content",3,"ngClass"],[4,"ngIf"],["for","chef"],["type","radio","id","chef","name","statut","value","Chef",3,"ngModel","ngModelOptions","ngModelChange"],["for","chom"],["type","radio","id","chom","name","statut","value","Chomeur",3,"ngModel","ngModelOptions","ngModelChange"],["id","submit-btn","type","button",1,"b1",3,"click"],["id","signup","type","button",3,"click"],[1,"invalid-feedback"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"div",0),js(3,"div",1),js(4,"div",2),$s(5,"img",3),js(6,"div",4),js(7,"h2",5),vo(8,"LOGIN"),qs(),$s(9,"div",6),qs(),js(10,"form",7),Ws("ngSubmit",function(){return e.onSubmit()}),js(11,"label",8),vo(12," \xa0Email "),qs(),$s(13,"input",9),Bs(14,$m,2,1,"div",10),js(15,"label",11),vo(16,"\xa0Mot de passe "),qs(),$s(17,"input",12),Bs(18,Zm,2,1,"div",10),$s(19,"br"),Bs(20,Hm,3,0,"div",13),$s(21,"br"),js(22,"label",14),vo(23,"Chef "),js(24,"input",15),Ws("ngModelChange",function(t){return e.choix=t}),qs(),qs(),js(25,"label",16),vo(26,"Chomeur "),js(27,"input",17),Ws("ngModelChange",function(t){return e.choix=t}),qs(),qs(),Bs(28,Wm,3,0,"div",13),$s(29,"br"),js(30,"button",18),Ws("click",function(){return e.onSubmit()}),vo(31,"Se Connecter"),qs(),js(32,"button",19),Ws("click",function(){return e.updatecontent()}),vo(33,"Cr\xe9er Compte"),qs(),qs(),$s(34,"br"),$s(35,"br"),qs(),qs(),qs()),2&t&&(pr(10),Vs("formGroup",e.form),pr(3),Vs("ngClass",Ga(11,Xm,e.submitted&&e.f.em.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.em.errors),pr(3),Vs("ngClass",Ga(13,Xm,e.submitted&&e.f.pass.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.pass.errors),pr(2),Vs("ngIf",e.isnull),pr(4),Vs("ngModel",e.choix)("ngModelOptions",$a(15,Km)),pr(3),Vs("ngModel",e.choix)("ngModelOptions",$a(16,Km)),pr(1),Vs("ngIf",!e.ok))},directives:[Um,jm,Mh,Xu,Dh,Cu,Wu,Lh,Ic,Rc,Ih,Th],styles:[".split[_ngcontent-%COMP%]{height:100%;width:35%;position:fixed;z-index:1;top:1;overflow-x:hidden;padding-top:5px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:hsla(0,0%,100%,.993)}.b1[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:10px 0;margin:6px;cursor:pointer;width:440px;border:double}.centered[_ngcontent-%COMP%]{position:absolute;top:45%;left:50%;transform:translate(-50%,-50%)}.centrer[_ngcontent-%COMP%]{text-align:center}.centre[_ngcontent-%COMP%]{position:absolute;top:0;left:50%}a[_ngcontent-%COMP%]{text-decoration:none}label[_ngcontent-%COMP%]{font-family:Raleway,sans-serif;font-size:11pt}#card[_ngcontent-%COMP%]{background:#c5c1c1;border-radius:8px;box-shadow:2px 5px 8px rgba(0,0,0,.65);height:800px;margin:6rem auto 8.1rem;width:400px}.card-img-top[_ngcontent-%COMP%]{width:80%;margin-left:10%}#card-content[_ngcontent-%COMP%]{padding:10px 44px}#card-title[_ngcontent-%COMP%]{font-family:Raleway Thin,sans-serif;letter-spacing:4px;padding-bottom:23px;padding-top:13px;text-align:center}#signup[_ngcontent-%COMP%]{color:rgba(10,9,9,.9803921568627451);text-align:center;margin:0 auto}#signup[_ngcontent-%COMP%], #submit-btn[_ngcontent-%COMP%]{cursor:pointer;border:none;font-family:Raleway,sans-serif;font-size:11pt;font-weight:700;border-radius:21px;width:153px;height:42.3px;box-shadow:0 1px 8px #151615}#submit-btn[_ngcontent-%COMP%]{background:-webkit-linear-gradient(right,#0d0e0b,#000);color:#fff;transition:.25s;margin:30px auto 10px}#submit-btn[_ngcontent-%COMP%]:hover{box-shadow:0 1px 18px #050505}.form[_ngcontent-%COMP%]{align-items:left;display:flex;flex-direction:column}.invalid-feedback[_ngcontent-%COMP%]{font-size:medium}.form-content[_ngcontent-%COMP%]{background:#fbfbfb;border-radius:1rem;outline:none;font-size:150%;padding-top:14px}.underline-title[_ngcontent-%COMP%]{background:-webkit-linear-gradient(right,#191b18,#070c08);height:2px;margin:-.8rem auto 0;width:89px}h1[_ngcontent-%COMP%]{color:#0c0e0c;margin-top:20px;font-family:sans-serif;font-weight:bolder;padding:2%}h4[_ngcontent-%COMP%]{color:#8b0000;text-align:center}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}.b1[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.form-content[_ngcontent-%COMP%]{width:100%;height:15%}.card[_ngcontent-%COMP%]{margin:10px auto auto;padding:1rem auto auto;height:-webkit-min-content;height:min-content;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}}"]}),t})();var Ym=n("iFvi"),Jm=n.n(Ym);class tg{}class eg{}class ng{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),i=n.toLowerCase(),r=t.slice(e+1).trim();this.maybeSetNormalizedName(n,i),this.headers.has(i)?this.headers.get(i).push(r):this.headers.set(i,[r])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const i=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof ng?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new ng;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof ng?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...n),this.headers.set(e,i);break;case"d":const r=t.value;if(r){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===r.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class ig{encodeKey(t){return rg(t)}encodeValue(t){return rg(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function rg(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class sg{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new ig,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(t=>{const i=t.indexOf("="),[r,s]=-1==i?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,i)),e.decodeValue(t.slice(i+1))],o=n.get(r)||[];o.push(s),n.set(r,o)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const i=t[n];Array.isArray(i)?i.forEach(t=>{e.push({param:n,value:t,op:"a"})}):e.push({param:n,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new sg({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function og(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function ag(t){return"undefined"!=typeof Blob&&t instanceof Blob}function lg(t){return"undefined"!=typeof FormData&&t instanceof FormData}class cg{constructor(t,e,n,i){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,r=i):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.params&&(this.params=r.params)),this.headers||(this.headers=new ng),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new sg,this.urlWithParams=e}serializeBody(){return null===this.body?null:og(this.body)||ag(this.body)||lg(this.body)||"string"==typeof this.body?this.body:this.body instanceof sg?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||lg(this.body)?null:ag(this.body)?this.body.type||null:og(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof sg?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,i=t.responseType||this.responseType,r=void 0!==t.body?t.body:this.body,s=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,o=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),a)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),l)),new cg(e,n,r,{params:l,headers:a,reportProgress:o,responseType:i,withCredentials:s})}}var ug=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class hg{constructor(t,e=200,n="OK"){this.headers=t.headers||new ng,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class dg extends hg{constructor(t={}){super(t),this.type=ug.ResponseHeader}clone(t={}){return new dg({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class pg extends hg{constructor(t={}){super(t),this.type=ug.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new pg({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class fg extends hg{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function mg(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let gg=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let i;if(t instanceof cg)i=t;else{let r,s;r=n.headers instanceof ng?n.headers:new ng(n.headers),n.params&&(s=n.params instanceof sg?n.params:new sg({fromObject:n.params})),i=new cg(t,e,void 0!==n.body?n.body:null,{headers:r,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const r=Qh(i).pipe(Td(t=>this.handler.handle(t)));if(t instanceof cg||"events"===n.observe)return r;const s=r.pipe(xd(t=>t instanceof pg));switch(n.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return s.pipe(T(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return s.pipe(T(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return s.pipe(T(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return s.pipe(T(t=>t.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new sg).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,mg(n,e))}post(t,e,n={}){return this.request("POST",t,mg(n,e))}put(t,e,n={}){return this.request("PUT",t,mg(n,e))}}return t.\u0275fac=function(e){return new(e||t)(ai(tg))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class _g{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const yg=new qn("HTTP_INTERCEPTORS");let vg=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const xg=/^\)\]\}',?\n/;class bg{}let wg=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Cg=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new y(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const i=t.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const e=1223===n.status?204:n.status,i=n.statusText||"OK",s=new ng(n.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return r=new dg({headers:s,status:e,statusText:i,url:o}),r},o=()=>{let{headers:i,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===n.response?n.responseText:n.response),0===r&&(r=l?200:0);let c=r>=200&&r<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(xg,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=t,c&&(c=!1,l={error:u,text:l})}}c?(e.next(new pg({body:l,headers:i,status:r,statusText:o,url:a||void 0})),e.complete()):e.error(new fg({error:l,headers:i,status:r,statusText:o,url:a||void 0}))},a=t=>{const{url:i}=s(),r=new fg({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:i||void 0});e.error(r)};let l=!1;const c=i=>{l||(e.next(s()),l=!0);let r={type:ug.DownloadProgress,loaded:i.loaded};i.lengthComputable&&(r.total=i.total),"text"===t.responseType&&n.responseText&&(r.partialText=n.responseText),e.next(r)},u=t=>{let n={type:ug.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),t.reportProgress&&(n.addEventListener("progress",c),null!==i&&n.upload&&n.upload.addEventListener("progress",u)),n.send(i),e.next({type:ug.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),t.reportProgress&&(n.removeEventListener("progress",c),null!==i&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(ai(bg))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const Eg=new qn("XSRF_COOKIE_NAME"),Sg=new qn("XSRF_HEADER_NAME");class Tg{}let Mg=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Pc(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(ai(cc),ai(gl),ai(Eg))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Ag=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const i=this.tokenService.getToken();return null===i||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,i)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(ai(Tg),ai(Sg))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),kg=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(yg,[]);this.chain=t.reduceRight((t,e)=>new _g(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(ai(eg),ai(Es))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Pg=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Ag,useClass:vg}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:Eg,useValue:e.cookieName}:[],e.headerName?{provide:Sg,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:[Ag,{provide:yg,useExisting:Ag,multi:!0},{provide:Tg,useClass:Mg},{provide:Eg,useValue:"XSRF-TOKEN"},{provide:Sg,useValue:"X-XSRF-TOKEN"}]}),t})(),Ig=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:[gg,{provide:tg,useClass:kg},Cg,{provide:eg,useExisting:Cg},wg,{provide:bg,useExisting:wg}],imports:[[Pg.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();function Og(t,e,n,r){return i(n)&&(r=n,n=void 0),r?Og(t,e,n).pipe(T(t=>l(t)?r(...t):r(t))):new y(i=>{zg(t,e,function(t){i.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},i,n)})}function zg(t,e,n,i,r){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const i=t;t.addEventListener(e,n,r),s=()=>i.removeEventListener(e,n,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const i=t;t.on(e,n),s=()=>i.off(e,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const i=t;t.addListener(e,n),s=()=>i.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let s=0,o=t.length;s<o;s++)zg(t[s],e,n,i,r)}i.add(s)}class Dg extends h{constructor(t,e){super()}schedule(t,e=0){return this}}class Rg extends Dg{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n,i=!1;try{this.work(t)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let Lg=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class Fg extends Lg{constructor(t,e=Lg.now){super(t,()=>Fg.delegate&&Fg.delegate!==this?Fg.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return Fg.delegate&&Fg.delegate!==this?Fg.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const Bg=new Fg(Rg);function Ng(t){return!l(t)&&t-parseFloat(t)+1>=0}function Vg(t){const{index:e,period:n,subscriber:i}=t;if(i.next(e),!i.closed){if(-1===n)return i.complete();t.index=e+1,this.schedule(t,n)}}class Ug{call(t,e){return e.subscribe(new jg(t))}}class jg extends Jh{constructor(t){super(t),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(t){this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(let n=0;n<e&&!this.hasFirst;n++){const e=ed(this,t[n],void 0,n);this.subscriptions&&this.subscriptions.push(e),this.add(e)}this.observables=null}}notifyNext(t,e,n){if(!this.hasFirst){this.hasFirst=!0;for(let t=0;t<this.subscriptions.length;t++)if(t!==n){let e=this.subscriptions[t];e.unsubscribe(),this.remove(e)}this.subscriptions=null}this.destination.next(e)}}function qg(...t){const e=t[t.length-1];return"function"==typeof e&&t.pop(),$(t,void 0).lift(new $g(e))}class $g{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new Gg(t,this.resultSelector))}}class Gg extends f{constructor(t,e,n=Object.create(null)){super(t),this.resultSelector=e,this.iterators=[],this.active=0,this.resultSelector="function"==typeof e?e:void 0}_next(t){const e=this.iterators;l(t)?e.push(new Hg(t)):e.push("function"==typeof t[I]?new Zg(t[I]()):new Wg(this.destination,this,t))}_complete(){const t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(let n=0;n<e;n++){let e=t[n];e.stillUnsubscribed?this.destination.add(e.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const t=this.iterators,e=t.length,n=this.destination;for(let s=0;s<e;s++){let e=t[s];if("function"==typeof e.hasValue&&!e.hasValue())return}let i=!1;const r=[];for(let s=0;s<e;s++){let e=t[s],o=e.next();if(e.hasCompleted()&&(i=!0),o.done)return void n.complete();r.push(o.value)}this.resultSelector?this._tryresultSelector(r):n.next(r),i&&n.complete()}_tryresultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}class Zg{constructor(t){this.iterator=t,this.nextResult=t.next()}hasValue(){return!0}next(){const t=this.nextResult;return this.nextResult=this.iterator.next(),t}hasCompleted(){const t=this.nextResult;return Boolean(t&&t.done)}}class Hg{constructor(t){this.array=t,this.index=0,this.length=0,this.length=t.length}[I](){return this}next(t){const e=this.index++;return e<this.length?{value:this.array[e],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class Wg extends B{constructor(t,e,n){super(t),this.parent=e,this.observable=n,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[I](){return this}next(){const t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(t){this.buffer.push(t),this.parent.checkIterators()}subscribe(){return N(this.observable,new F(this))}}function Xg(t){return e=>e.lift(new Kg(t))}class Kg{constructor(t){this.notifier=t}call(t,e){const n=new Qg(t),i=N(this.notifier,new F(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n}}class Qg extends B{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function Yg(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new Jg(t,n))}}class Jg{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new t_(t,this.observables,this.project))}}class t_ extends Jh{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const i=e.length;this.values=new Array(i);for(let r=0;r<i;r++)this.toRespond.push(r);for(let r=0;r<i;r++)this.add(ed(this,e[r],void 0,r))}notifyNext(t,e,n){this.values[n]=e;const i=this.toRespond;if(i.length>0){const t=i.indexOf(n);-1!==t&&i.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const e_=["*"],n_=["dialog"];function i_(t){return null!=t}function r_(t){return(t||document.body).offsetHeight}"undefined"==typeof Element||Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){let e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null});const s_={animation:!0,transitionTimerDelayMs:5};let o_=(()=>{class t{constructor(){this.animation=s_.animation}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({factory:function(){return new t},token:t,providedIn:"root"}),t})();const a_=()=>{},{transitionTimerDelayMs:l_}=s_,c_=new Map,u_=(t,e,n,i)=>{let r=i.context||{};const s=c_.get(e);if(s)switch(i.runningTransition){case"continue":return ad;case"stop":t.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),c_.delete(e)}const o=n(e,i.animation,r)||a_;if(!i.animation||"none"===window.getComputedStyle(e).transitionProperty)return t.run(()=>o()),Qh(void 0).pipe(function(t){return e=>new y(n=>e.subscribe(e=>t.run(()=>n.next(e)),e=>t.run(()=>n.error(e)),()=>t.run(()=>n.complete())))}(t));const a=new C,c=new C,u=a.pipe(function(...t){return e=>od(e,Qh(...t))}(!0));c_.set(e,{transition$:a,complete:()=>{c.next(),c.complete()},context:r});const h=function(t){const{transitionDelay:e,transitionDuration:n}=window.getComputedStyle(t);return 1e3*(parseFloat(e)+parseFloat(n))}(e);return t.runOutsideAngular(()=>{const n=Og(e,"transitionend").pipe(Xg(u),xd(({target:t})=>t===e));(function(...t){if(1===t.length){if(!l(t[0]))return t[0];t=t[0]}return $(t,void 0).lift(new Ug)})(function(t=0,e,n){let i=-1;return Ng(e)?i=Number(e)<1?1:Number(e):S(e)&&(n=e),S(n)||(n=Bg),new y(e=>{const r=Ng(t)?t:+t-n.now();return n.schedule(Vg,r,{index:0,period:i,subscriber:e})})}(h+l_).pipe(Xg(u)),n,c).pipe(Xg(u)).subscribe(()=>{c_.delete(e),t.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let h_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),d_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),p_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})(),f_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),m_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})();var g_=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",t}({});"undefined"!=typeof navigator&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const __=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function y_(t){const e=Array.from(t.querySelectorAll(__)).filter(t=>-1!==t.tabIndex);return[e[0],e[e.length-1]]}new class{getAllStyles(t){return window.getComputedStyle(t)}getStyle(t,e){return this.getAllStyles(t)[e]}isStaticPositioned(t){return"static"===(this.getStyle(t,"position")||"static")}offsetParent(t){let e=t.offsetParent||document.documentElement;for(;e&&e!==document.documentElement&&this.isStaticPositioned(e);)e=e.offsetParent;return e||document.documentElement}position(t,e=!0){let n,i={width:0,height:0,top:0,bottom:0,left:0,right:0};if("fixed"===this.getStyle(t,"position"))n=t.getBoundingClientRect(),n={top:n.top,bottom:n.bottom,left:n.left,right:n.right,height:n.height,width:n.width};else{const e=this.offsetParent(t);n=this.offset(t,!1),e!==document.documentElement&&(i=this.offset(e,!1)),i.top+=e.clientTop,i.left+=e.clientLeft}return n.top-=i.top,n.bottom-=i.top,n.left-=i.left,n.right-=i.left,e&&(n.top=Math.round(n.top),n.bottom=Math.round(n.bottom),n.left=Math.round(n.left),n.right=Math.round(n.right)),n}offset(t,e=!0){const n=t.getBoundingClientRect(),i=window.pageYOffset-document.documentElement.clientTop,r=window.pageXOffset-document.documentElement.clientLeft;let s={height:n.height||t.offsetHeight,width:n.width||t.offsetWidth,top:n.top+i,bottom:n.bottom+i,left:n.left+r,right:n.right+r};return e&&(s.height=Math.round(s.height),s.width=Math.round(s.width),s.top=Math.round(s.top),s.bottom=Math.round(s.bottom),s.left=Math.round(s.left),s.right=Math.round(s.right)),s}positionElements(t,e,n,i){const[r="top",s="center"]=n.split("-"),o=i?this.offset(t,!1):this.position(t,!1),a=this.getAllStyles(e),l=parseFloat(a.marginTop),c=parseFloat(a.marginBottom),u=parseFloat(a.marginLeft),h=parseFloat(a.marginRight);let d=0,p=0;switch(r){case"top":d=o.top-(e.offsetHeight+l+c);break;case"bottom":d=o.top+o.height;break;case"left":p=o.left-(e.offsetWidth+u+h);break;case"right":p=o.left+o.width}switch(s){case"top":d=o.top;break;case"bottom":d=o.top+o.height-e.offsetHeight;break;case"left":p=o.left;break;case"right":p=o.left+o.width-e.offsetWidth;break;case"center":"top"===r||"bottom"===r?p=o.left+o.width/2-e.offsetWidth/2:d=o.top+o.height/2-e.offsetHeight/2}e.style.transform=`translate(${Math.round(p)}px, ${Math.round(d)}px)`;const f=e.getBoundingClientRect(),m=document.documentElement,g=window.innerHeight||m.clientHeight,_=window.innerWidth||m.clientWidth;return f.left>=0&&f.top>=0&&f.right<=_&&f.bottom<=g}},new Date(1882,10,12),new Date(2174,10,25);let v_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc,Zh]]}),t})(),x_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Wt({type:t,selectors:[["",8,"navbar"]]}),t})(),b_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})(),w_=(()=>{class t{constructor(t){this._ngbConfig=t,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return t.\u0275fac=function(e){return new(e||t)(ai(o_))},t.\u0275prov=ut({factory:function(){return new t(ai(o_))},token:t,providedIn:"root"}),t})();class C_{constructor(t,e,n){this.nodes=t,this.viewRef=e,this.componentRef=n}}const E_=()=>{};let S_=(()=>{class t{constructor(t){this._document=t}compensate(){const t=this._getWidth();return this._isPresent(t)?this._adjustBody(t):E_}_adjustBody(t){const e=this._document.body,n=e.style.paddingRight,i=parseFloat(window.getComputedStyle(e)["padding-right"]);return e.style["padding-right"]=`${i+t}px`,()=>e.style["padding-right"]=n}_isPresent(t){const e=this._document.body.getBoundingClientRect();return window.innerWidth-(e.left+e.right)>=t-.1*t}_getWidth(){const t=this._document.createElement("div");t.className="modal-scrollbar-measure";const e=this._document.body;e.appendChild(t);const n=t.getBoundingClientRect().width-t.clientWidth;return e.removeChild(t),n}}return t.\u0275fac=function(e){return new(e||t)(ai(cc))},t.\u0275prov=ut({factory:function(){return new t(ai(cc))},token:t,providedIn:"root"}),t})(),T_=(()=>{class t{constructor(t,e){this._el=t,this._zone=e}ngOnInit(){this._zone.onStable.asObservable().pipe(fd(1)).subscribe(()=>{u_(this._zone,this._el.nativeElement,(t,e)=>{e&&r_(t),t.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return u_(this._zone,this._el.nativeElement,({classList:t})=>t.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Go),Ns(Il))},t.\u0275cmp=jt({type:t,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1050"],hostVars:6,hostBindings:function(t,e){2&t&&(lo("modal-backdrop"+(e.backdropClass?" "+e.backdropClass:"")),ao("show",!e.animation)("fade",e.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();class M_{close(t){}dismiss(t){}}class A_{constructor(t,e,n,i){this._windowCmptRef=t,this._contentRef=e,this._backdropCmptRef=n,this._beforeDismiss=i,this._closed=new C,this._dismissed=new C,this._hidden=new C,t.instance.dismissEvent.subscribe(t=>{this.dismiss(t)}),this.result=new Promise((t,e)=>{this._resolve=t,this._reject=e}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Xg(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Xg(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();e&&e.then?e.then(e=>{!1!==e&&this._dismiss(t)},()=>{}):!1!==e&&this._dismiss(t)}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():Qh(void 0);t.subscribe(()=>{const{nativeElement:t}=this._windowCmptRef.location;t.parentNode.removeChild(t),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:t}=this._backdropCmptRef.location;t.parentNode.removeChild(t),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),qg(t,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var k_=function(t){return t[t.BACKDROP_CLICK=0]="BACKDROP_CLICK",t[t.ESC=1]="ESC",t}({});let P_=(()=>{class t{constructor(t,e,n){this._document=t,this._elRef=e,this._zone=n,this._closed$=new C,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Za,this.shown=new C,this.hidden=new C}dismiss(t){this.dismissEvent.emit(t)}ngOnInit(){this._elWithFocus=this._document.activeElement}ngAfterViewInit(){this._show()}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:t}=this._elRef,e={animation:this.animation,runningTransition:"stop"},n=qg(u_(this._zone,t,()=>t.classList.remove("show"),e),u_(this._zone,this._dialogEl.nativeElement,()=>{},e));return n.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),n}_show(){const t={animation:this.animation,runningTransition:"continue"};qg(u_(this._zone,this._elRef.nativeElement,(t,e)=>{e&&r_(t),t.classList.add("show")},t),u_(this._zone,this._dialogEl.nativeElement,()=>{},t)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:t}=this._elRef;this._zone.runOutsideAngular(()=>{Og(t,"keydown").pipe(Xg(this._closed$),xd(t=>t.which===g_.Escape)).subscribe(t=>{this.keyboard?requestAnimationFrame(()=>{t.defaultPrevented||this._zone.run(()=>this.dismiss(k_.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let e=!1;Og(this._dialogEl.nativeElement,"mousedown").pipe(Xg(this._closed$),Nd(()=>e=!1),ud(()=>Og(t,"mouseup").pipe(Xg(this._closed$),fd(1))),xd(({target:e})=>t===e)).subscribe(()=>{e=!0}),Og(t,"click").pipe(Xg(this._closed$)).subscribe(({target:n})=>{t===n&&("static"===this.backdrop?this._bumpBackdrop():!0!==this.backdrop||e||this._zone.run(()=>this.dismiss(k_.BACKDROP_CLICK))),e=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:t}=this._elRef;if(!t.contains(document.activeElement)){const e=t.querySelector("[ngbAutofocus]"),n=y_(t)[0];(e||n||t).focus()}}_restoreFocus(){const t=this._document.body,e=this._elWithFocus;let n;n=e&&e.focus&&t.contains(e)?e:t,this._zone.runOutsideAngular(()=>{setTimeout(()=>n.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&u_(this._zone,this._elRef.nativeElement,({classList:t})=>(t.add("modal-static"),()=>t.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return t.\u0275fac=function(e){return new(e||t)(Ns(cc),Ns(Go),Ns(Il))},t.\u0275cmp=jt({type:t,selectors:[["ngb-modal-window"]],viewQuery:function(t,e){if(1&t&&function(t,e,n){const i=ke();i.firstCreatePass&&(ll(i,new Qa(t,3,void 0),-1),i.staticViewQueries=!0),al(i,Ae(),3)}(n_),2&t){let t;rl(t=ol())&&(e._dialogEl=t.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(t,e){2&t&&(Fs("aria-modal",!0)("aria-labelledby",e.ariaLabelledBy)("aria-describedby",e.ariaDescribedBy),lo("modal d-block"+(e.windowClass?" "+e.windowClass:"")),ao("fade",e.animation))},inputs:{backdrop:"backdrop",keyboard:"keyboard",animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",centered:"centered",scrollable:"scrollable",size:"size",windowClass:"windowClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:e_,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(t,e){1&t&&(Js(),js(0,"div",0,1),js(2,"div",2),to(3),qs(),qs()),2&t&&lo("modal-dialog"+(e.size?" modal-"+e.size:"")+(e.centered?" modal-dialog-centered":"")+(e.scrollable?" modal-dialog-scrollable":""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}"],encapsulation:2}),t})(),I_=(()=>{class t{constructor(t,e,n,i,r,s){this._applicationRef=t,this._injector=e,this._document=n,this._scrollBar=i,this._rendererFactory=r,this._ngZone=s,this._activeWindowCmptHasChanged=new C,this._ariaHiddenValues=new Map,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass"],this._windowCmpts=[],this._activeInstances=new Za,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const t=this._windowCmpts[this._windowCmpts.length-1];((t,e,n,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const t=Og(e,"focusin").pipe(Xg(n),T(t=>t.target));Og(e,"keydown").pipe(Xg(n),xd(t=>t.which===g_.Tab),Yg(t)).subscribe(([t,n])=>{const[i,r]=y_(e);n!==i&&n!==e||!t.shiftKey||(r.focus(),t.preventDefault()),n!==r||t.shiftKey||(i.focus(),t.preventDefault())}),i&&Og(e,"click").pipe(Xg(n),Yg(t),T(t=>t[1])).subscribe(t=>t.focus())})})(0,t.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(t.location.nativeElement)}})}open(t,e,n,i){const r=i.container instanceof HTMLElement?i.container:i_(i.container)?this._document.querySelector(i.container):this._document.body,s=this._rendererFactory.createRenderer(null,null),o=this._scrollBar.compensate(),a=()=>{this._modalRefs.length||(s.removeClass(this._document.body,"modal-open"),this._revertAriaHidden())};if(!r)throw new Error(`The specified modal container "${i.container||"body"}" was not found in the DOM.`);const l=new M_,c=this._getContentRef(t,i.injector||e,n,l,i);let u=!1!==i.backdrop?this._attachBackdrop(t,r):void 0,h=this._attachWindowComponent(t,r,c),d=new A_(h,c,u,i.beforeDismiss);return this._registerModalRef(d),this._registerWindowCmpt(h),d.result.then(o,o),d.result.then(a,a),l.close=t=>{d.close(t)},l.dismiss=t=>{d.dismiss(t)},this._applyWindowOptions(h.instance,i),1===this._modalRefs.length&&s.addClass(this._document.body,"modal-open"),u&&u.instance&&this._applyBackdropOptions(u.instance,i),d}get activeInstances(){return this._activeInstances}dismissAll(t){this._modalRefs.forEach(e=>e.dismiss(t))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(t,e){let n=t.resolveComponentFactory(T_).create(this._injector);return this._applicationRef.attachView(n.hostView),e.appendChild(n.location.nativeElement),n}_attachWindowComponent(t,e,n){let i=t.resolveComponentFactory(P_).create(this._injector,n.nodes);return this._applicationRef.attachView(i.hostView),e.appendChild(i.location.nativeElement),i}_applyWindowOptions(t,e){this._windowAttributes.forEach(n=>{i_(e[n])&&(t[n]=e[n])})}_applyBackdropOptions(t,e){this._backdropAttributes.forEach(n=>{i_(e[n])&&(t[n]=e[n])})}_getContentRef(t,e,n,i,r){return n?n instanceof wa?this._createFromTemplateRef(n,i):"string"==typeof n?this._createFromString(n):this._createFromComponent(t,e,n,i,r):new C_([])}_createFromTemplateRef(t,e){const n=t.createEmbeddedView({$implicit:e,close(t){e.close(t)},dismiss(t){e.dismiss(t)}});return this._applicationRef.attachView(n),new C_([n.rootNodes],n)}_createFromString(t){const e=this._document.createTextNode(`${t}`);return new C_([[e]])}_createFromComponent(t,e,n,i,r){const s=t.resolveComponentFactory(n),o=Es.create({providers:[{provide:M_,useValue:i}],parent:e}),a=s.create(o),l=a.location.nativeElement;return r.scrollable&&l.classList.add("component-host-scrollable"),this._applicationRef.attachView(a.hostView),new C_([[l]],a.hostView,a)}_setAriaHidden(t){const e=t.parentElement;e&&t!==this._document.body&&(Array.from(e.children).forEach(e=>{e!==t&&"SCRIPT"!==e.nodeName&&(this._ariaHiddenValues.set(e,e.getAttribute("aria-hidden")),e.setAttribute("aria-hidden","true"))}),this._setAriaHidden(e))}_revertAriaHidden(){this._ariaHiddenValues.forEach((t,e)=>{t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(t){const e=()=>{const e=this._modalRefs.indexOf(t);e>-1&&(this._modalRefs.splice(e,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(t),this._activeInstances.emit(this._modalRefs),t.result.then(e,e)}_registerWindowCmpt(t){this._windowCmpts.push(t),this._activeWindowCmptHasChanged.next(),t.onDestroy(()=>{const e=this._windowCmpts.indexOf(t);e>-1&&(this._windowCmpts.splice(e,1),this._activeWindowCmptHasChanged.next())})}}return t.\u0275fac=function(e){return new(e||t)(ai(Ql),ai(Es),ai(cc),ai(S_),ai(Ho),ai(Il))},t.\u0275prov=ut({factory:function(){return new t(ai(Ql),ai(ls),ai(cc),ai(S_),ai(Ho),ai(Il))},token:t,providedIn:"root"}),t})(),O_=(()=>{class t{constructor(t,e,n,i){this._moduleCFR=t,this._injector=e,this._modalStack=n,this._config=i}open(t,e={}){const n=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),e);return this._modalStack.open(this._moduleCFR,this._injector,t,n)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(t){this._modalStack.dismissAll(t)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return t.\u0275fac=function(e){return new(e||t)(ai(Uo),ai(Es),ai(I_),ai(w_))},t.\u0275prov=ut({factory:function(){return new t(ai(Uo),ai(ls),ai(I_),ai(w_))},token:t,providedIn:"root"}),t})(),z_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:[O_]}),t})(),D_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),R_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),L_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),F_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),B_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),N_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),V_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})(),U_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({}),t})();new qn("live announcer delay",{providedIn:"root",factory:function(){return 100}});let j_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Bc]]}),t})();const q_=[h_,d_,p_,f_,m_,v_,b_,z_,D_,R_,L_,F_,B_,N_,V_,U_,j_];let $_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[q_,h_,d_,p_,f_,m_,v_,b_,z_,D_,R_,L_,F_,B_,N_,V_,U_,j_]}),t})();const G_=["*"];let Z_=(()=>{class t{constructor(t,e){this.modalService=t,this.el=e,this.element=e.nativeElement}ngOnInit(){this.id?(document.body.appendChild(this.element),this.element.addEventListener("click",t=>{"jw-modal"===t.target.className&&this.close()}),this.modalService.add(this)):console.error("modal must have an id")}ngOnDestroy(){this.modalService.remove(this.id),this.element.remove()}open(){this.element.style.display="block",document.body.classList.add("jw-modal-open")}close(){this.element.style.display="none",document.body.classList.remove("jw-modal-open")}}return t.\u0275fac=function(e){return new(e||t)(Ns(Kh),Ns(Go))},t.\u0275cmp=jt({type:t,selectors:[["jw-modal"]],inputs:{id:"id"},ngContentSelectors:G_,decls:4,vars:0,consts:[[1,"jw-modal"],[1,"jw-modal-body"],[1,"jw-modal-background"]],template:function(t,e){1&t&&(Js(),js(0,"div",0),js(1,"div",1),to(2),qs(),qs(),$s(3,"div",2))},styles:["jw-modal{display:none}jw-modal .jw-modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000;overflow:auto}jw-modal .jw-modal .jw-modal-body{padding:20px;background:#fff;margin:40px}jw-modal .jw-modal-background{position:fixed;top:0;right:0;bottom:0;left:0;background-color:#000;opacity:.75;z-index:900}body.jw-modal-open{overflow:hidden}"],encapsulation:2}),t})();function H_(t,e){if(1&t){const t=Gs();js(0,"div"),js(1,"div",43),js(2,"div",44),vo(3),qs(),js(4,"div",45),js(5,"h4"),vo(6),qs(),$s(7,"br"),js(8,"h4"),vo(9),qs(),$s(10,"br"),js(11,"h4"),vo(12),qs(),$s(13,"br"),qs(),js(14,"button",46),Ws("click",function(){return Pe(t),Qs().openModal("modal1")}),js(15,"h3"),vo(16,"Plus de D\xe9tails"),qs(),qs(),qs(),js(17,"jw-modal",47),js(18,"h3"),vo(19),qs(),js(20,"h3"),vo(21),qs(),js(22,"h3"),vo(23),qs(),$s(24,"div",48),js(25,"button",49),Ws("click",function(){return Pe(t),Qs().closeModal("modal1")}),vo(26,"Retour"),qs(),qs(),$s(27,"br"),qs()}if(2&t){const t=e.$implicit;pr(3),bo("",t.nom," ",t.prenom,""),pr(3),xo("Num tel :",t.numtel,""),pr(3),xo("Sexe : ",t.sexe,""),pr(3),xo("Date de Naissance : ",t.datedenaissance," "),pr(7),xo("Nom Buisness : ",t.nom_buisness,""),pr(2),xo("N\xb0 Tel(Travail) : ",t.numtel_travail,""),pr(2),xo("Region : ",t.adresse,"")}}function W_(t,e){if(1&t){const t=Gs();js(0,"div"),js(1,"div",43),js(2,"div",44),vo(3),qs(),js(4,"div",45),js(5,"h4"),vo(6),qs(),$s(7,"br"),js(8,"h4"),vo(9),qs(),$s(10,"br"),js(11,"h4"),vo(12),qs(),$s(13,"br"),js(14,"h4"),vo(15),qs(),$s(16,"br"),js(17,"h4"),vo(18),qs(),qs(),js(19,"button",46),Ws("click",function(){return Pe(t),Qs().openModal("modal2")}),js(20,"h3"),vo(21,"Plus de D\xe9tails"),qs(),qs(),qs(),js(22,"jw-modal",50),js(23,"h3"),vo(24),qs(),js(25,"h3"),vo(26),qs(),js(27,"h3"),vo(28),qs(),js(29,"h3"),vo(30),qs(),$s(31,"div",48),js(32,"button",49),Ws("click",function(){return Pe(t),Qs().closeModal("modal2")}),vo(33,"Retour"),qs(),qs(),$s(34,"br"),qs()}if(2&t){const t=e.$implicit;pr(3),bo("",t.nom," ",t.prenom,""),pr(3),xo("Sexe : ",t.sexe,""),pr(3),xo("Num tel :",t.numtel,""),pr(3),xo("Date de Naissance : ",t.datedenaissance," "),pr(3),xo("Niveau d'Education : ",t.niveau_education,""),pr(3),xo("Nom Buisness: ",t.nom_buisness," "),pr(6),xo("Sp\xe9cialit\xe9 : ",t.specialite,""),pr(2),xo("N\xb0 Tel(Travail) : ",t.numtel_travail,""),pr(2),xo("Langue : ",t.langue,""),pr(2),xo("Region : ",t.adresse,"")}}const X_=function(){return{standalone:!0}};let K_=(()=>{class t{constructor(t,e,n,i){this.httpClient=t,this.d=e,this.route=n,this.modalService=i}ngOnInit(){}toSearch(){this.getchom(),this.getchef();var t=n("4ZJM");t.accessToken="pk.eyJ1IjoiYmFoYWVkZGluZTEyMyIsImEiOiJja251ZXluOWcwY2I3Mnduam5xdmt1aGZ1In0.s3Pu_B4CTjaLJQlodzbvAg";var e=new t.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[9.561555499999997,33.892166],zoom:5}),i=new Jm.a({accessToken:t.accessToken,placeholder:this.region,mapboxgl:t,marker:!1});e.invalidatesize(),e.addControl(i),e.addControl(new t.NavigationControl),i.on("result",function(t){e.getSource("single-point").setData(t.result.geometry)}),e.on("click",n=>{this.d.address=JSON.stringify(n.lngLat);var i=document.createElement("div");i.className="marker",i.style.height="50px",i.style.width="50px",i.style.backgroundImage="url(/assets/img/marker.png)",i.style.backgroundSize="100%",new t.Marker(i).setLngLat(n.lngLat).addTo(e)})}openModal(t){this.modalService.open(t)}closeModal(t){this.modalService.close(t)}getchom(){return Nm(this,void 0,void 0,function*(){var t=`{"region":"${this.region}","dom":"${this.dom}"}`;const e=yield fetch("http://127.0.0.1:8000/searchchom",{method:"POST",body:t,headers:{"Content-Type":"application/json"}});e.ok&&e.json().then(t=>{console.log(t),this.chomeurs=t})})}getchef(){return Nm(this,void 0,void 0,function*(){var t=`{"region":"${this.region}","dom":"${this.dom}"}`;const e=yield fetch("http://127.0.0.1:8000/searchchef",{method:"POST",body:t,headers:{"Content-Type":"application/json"}});e.ok&&e.json().then(t=>{console.log(t),this.chefs=t})})}onDelete(){return Nm(this,void 0,void 0,function*(){var t=`{"email":"${this.d.getemail()}","statut":"${this.d.getvalue()}"}`;alert(t);const e=yield fetch("http://127.0.0.1:8000/delete_user",{method:"POST",body:t,headers:{"Content-Type":"application/json"}});e.ok&&(e.json().then(t=>{console.log(t)}),this.route.navigateByUrl("/accueil"))})}}return t.\u0275fac=function(e){return new(e||t)(Ns(gg),Ns(Vm),Ns(mm),Ns(Kh))},t.\u0275cmp=jt({type:t,selectors:[["app-consultation-chef"]],decls:85,vars:8,consts:[[1,"navbar","navbar-expand-lg","navbar-dark",2,"background-color","#000000"],[1,"logo"],["src","assets/img/LOGOo (1).png","alt","","width","80%"],[1,"container"],[1,"container-fluid"],[1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","href","/accueil",1,"nav-link"],["href","/information",1,"nav-link"],["href","/contact",1,"nav-link"],["id","recherche"],["id","dom-select","name","domaine",3,"ngModel","ngModelOptions","ngModelChange"],["disabled","disabled","selected","selected"],["value","Medecine"],["value","Architecture"],["value","Agriculture"],["value","Commerce"],["value","Informatique"],["value","M\xe9canique"],["value","El\xe9ctronique"],["value","Industrie"],["value","secr\xe9tariat"],["value","Transport"],["name","region","id","reg-select",3,"ngModel","ngModelOptions","ngModelChange"],["value","","selected","selected"],["value","tunis"],["value","sousse"],["value","sfax"],["value","ben arous"],["value","beja"],["value","kef"],["type","submit",3,"click"],[1,"fas","fa-search"],[1,"consultation","l"],[1,"c"],[1,"fas","fa-building",2,"color","gold"],[4,"ngFor","ngForOf"],[1,"consultation","r"],[1,"fas","fa-user-tie",2,"color","gold"],[1,"wrapper"],["routerLinkActive","active","routerLink","/profil",1,"btn-1"],[1,"btn-2",3,"click"],[1,"card","border-primary","mb-3"],[1,"card-title"],[1,"card-body"],[1,"btn","btn-light",2,"padding","3%",3,"click"],["id","modal1",1,"jw-modal"],["id","map",1,"map"],[3,"click"],["id","modal2",1,"jw-modal"]],template:function(t,e){1&t&&(js(0,"nav",0),js(1,"div",1),$s(2,"img",2),qs(),js(3,"div",3),js(4,"p"),vo(5,"Dream Job"),qs(),qs(),js(6,"div",4),js(7,"div",5),js(8,"ul",6),js(9,"li",7),js(10,"a",8),vo(11,"Accueil"),qs(),qs(),js(12,"li",7),js(13,"a",9),vo(14,"information"),qs(),qs(),js(15,"li",7),js(16,"a",10),vo(17,"Contact"),qs(),qs(),qs(),qs(),qs(),qs(),$s(18,"br"),js(19,"div",11),js(20,"form"),js(21,"select",12),Ws("ngModelChange",function(t){return e.dom=t}),js(22,"option",13),vo(23,"Domaine "),qs(),js(24,"option",14),vo(25,"M\xe9decine"),qs(),js(26,"option",15),vo(27,"Architecture"),qs(),js(28,"option",16),vo(29,"Agriculture"),qs(),js(30,"option",17),vo(31,"Commerce"),qs(),js(32,"option",18),vo(33,"Informatique"),qs(),js(34,"option",19),vo(35,"M\xe9canique"),qs(),js(36,"option",20),vo(37,"El\xe9ctronique"),qs(),js(38,"option",21),vo(39,"Industrie"),qs(),js(40,"option",22),vo(41,"secr\xe9tariat"),qs(),js(42,"option",23),vo(43,"Transport"),qs(),qs(),vo(44," \xa0\xa0 "),js(45,"select",24),Ws("ngModelChange",function(t){return e.region=t}),js(46,"option",25),vo(47,"--votre region--"),qs(),js(48,"option",26),vo(49,"Tunis"),qs(),js(50,"option",27),vo(51,"Sousse"),qs(),js(52,"option",28),vo(53,"Sfax"),qs(),js(54,"option",29),vo(55,"Ben arous"),qs(),js(56,"option",30),vo(57,"Beja"),qs(),js(58,"option",31),vo(59,"Kef"),qs(),qs(),vo(60," \xa0\xa0 "),js(61,"button",32),Ws("click",function(){return e.toSearch()}),vo(62,"Search "),$s(63,"i",33),qs(),qs(),qs(),$s(64,"br"),$s(65,"br"),js(66,"div",34),js(67,"div",35),$s(68,"i",36),vo(69," Entreprises qui embauchent maintenant "),qs(),$s(70,"br"),js(71,"div",4),Bs(72,H_,28,8,"div",37),qs(),qs(),js(73,"div",38),js(74,"div",35),$s(75,"i",39),vo(76," Futur employ\xe9 "),qs(),$s(77,"br"),js(78,"div",4),Bs(79,W_,35,11,"div",37),qs(),qs(),js(80,"div",40),js(81,"button",41),vo(82,"Modifier Compte"),qs(),js(83,"button",42),Ws("click",function(){return e.onDelete()}),vo(84,"Supprimer Compte"),qs(),qs()),2&t&&(pr(21),Vs("ngModel",e.dom)("ngModelOptions",$a(6,X_)),pr(24),Vs("ngModel",e.region)("ngModelOptions",$a(7,X_)),pr(27),Vs("ngForOf",e.chefs),pr(7),Vs("ngForOf",e.chomeurs))},directives:[x_,Mh,Xu,Ch,Nh,Wu,Th,Vh,$h,zc,vm,gm,Z_],styles:[".container[_ngcontent-%COMP%]{width:15%;text-align:center;font-weight:700;font-size:xx-large;margin-right:17%}.container-fluid[_ngcontent-%COMP%]{width:70%;text-align:center}.wrapper[_ngcontent-%COMP%]{width:50%;margin-left:50%}.nav-link[_ngcontent-%COMP%]{font-weight:bolder;font-size:large}.logo[_ngcontent-%COMP%]{width:20%;padding-left:200px}.nav-item[_ngcontent-%COMP%]{display:inline;padding-right:120px}#map[_ngcontent-%COMP%]{height:200px;width:100%}select[_ngcontent-%COMP%]{padding:15px 20px;margin:20px 30px;border:1px solid #000;border-radius:100px;width:30%;overflow:hidden;background-color:#fff;background:#fff;position:relative;color:#000;font-weight:bolder;font-size:12pt}.card-title[_ngcontent-%COMP%]{text-align:center;font-size:17pt;background-color:#0c0f0f;padding:5%;color:#ff0}.card-body[_ngcontent-%COMP%]{background-color:#e5f0f7}.far[_ngcontent-%COMP%]{float:right}.underline-title[_ngcontent-%COMP%]{background:-webkit-linear-gradient(right,#a1aa98,#7b857d);height:1px;margin-left:15%;width:300px}button[type=submit][_ngcontent-%COMP%]{padding:15px 20px;margin:20px 1px;border:1px solid #000;border-radius:100px;width:15%;overflow:hidden;background-color:#fff;background:#fff;position:relative;color:#000;font-weight:bolder;font-size:12pt}#recherche[_ngcontent-%COMP%]{border:1px solid #fff;width:50%;align-items:center;margin:0 400px}.consultation[_ngcontent-%COMP%]{width:40%;position:absolute;z-index:1;top:2;overflow-x:hidden;padding-top:20px;height:500px}.l[_ngcontent-%COMP%]{left:15%}.l[_ngcontent-%COMP%], .r[_ngcontent-%COMP%]{font-weight:bolder;font-size:15pt}.r[_ngcontent-%COMP%]{right:10%}.c[_ngcontent-%COMP%]{position:relative;left:150px;overflow:hidden}#modal1[_ngcontent-%COMP%], #modal2[_ngcontent-%COMP%]{height:300px;width:50%}.btn-1[_ngcontent-%COMP%]{position:absolute;right:5%;bottom:0;background:-webkit-linear-gradient(right,#0d0e0b,#000);border:none;border-radius:21px;box-shadow:0 1px 8px #151615;cursor:pointer;color:#fff;font-weight:700;font-family:Raleway,sans-serif;font-size:11pt;height:42.3px;transition:.25s;width:153px;margin:30px auto 10px}.btn-1[_ngcontent-%COMP%]:hover{box-shadow:0 1px 18px #050505;background:-webkit-linear-gradient(right,#043c7c,#0361dd)}.btn-2[_ngcontent-%COMP%]{position:absolute;left:5%;bottom:0;background:-webkit-linear-gradient(right,#0d0e0b,#000);border:none;border-radius:21px;box-shadow:0 1px 8px #151615;cursor:pointer;color:#fff;font-weight:700;font-family:Raleway,sans-serif;font-size:11pt;height:42.3px;transition:.25s;width:153px;margin:30px auto 10px}.btn-2[_ngcontent-%COMP%]:hover{box-shadow:0 1px 18px #050505;background:-webkit-linear-gradient(right,#043c7c,#0361dd)}.card[_ngcontent-%COMP%]{width:100%;border-radius:20px;white-space:nowrap;border-style:dotted}h4[_ngcontent-%COMP%]{background-color:#c7c7c3;padding:3%}@media(max-width:767px){select[_ngcontent-%COMP%]{display:flex;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.l[_ngcontent-%COMP%]   .c[_ngcontent-%COMP%]{width:100%;text-align:start}}"]}),t})(),Q_=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["app-contact"]],decls:34,vars:0,consts:[[1,"split","right"],[1,"container-fluid"],[1,"row","card-deck"],[1,"card","col-lg-4"],["src","assets/img/MedEmine.png",1,"card-img-top"],[1,"card-title",2,"font-weight","bolder"],[1,"card-body"],[2,"text-align","center"],[2,"text-align","center","font-weight","bolder"],["src","assets/img/Taha.png",1,"card-img-top"],["src","assets/img/Baha.png",1,"card-img-top"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"div",0),js(3,"h2"),vo(4,"Notre Equipe"),qs(),js(5,"div",1),js(6,"div",2),js(7,"div",3),$s(8,"img",4),js(9,"h4",5),vo(10,"Med Emine Benali"),qs(),js(11,"div",6),js(12,"h5",7),vo(13,"56 371 088"),qs(),js(14,"h5",8),vo(15,"Eminebenali22@gmail.com"),qs(),qs(),qs(),js(16,"div",3),$s(17,"img",9),js(18,"h4",5),vo(19,"Taha Rouis"),qs(),js(20,"div",6),js(21,"h5",7),vo(22,"26 199 148"),qs(),js(23,"h5",8),vo(24,"rouis1019@gmail.com"),qs(),qs(),qs(),js(25,"div",3),$s(26,"img",10),js(27,"h4",5),vo(28,"Bahaeddine Mejri"),qs(),js(29,"div",6),js(30,"h5",7),vo(31,"54 264 607"),qs(),js(32,"h5",8),vo(33,"Bahaeddine571@gmail.com"),qs(),qs(),qs(),qs(),qs(),qs())},directives:[Um,jm],styles:[".split[_ngcontent-%COMP%]{height:100%;width:40%;position:fixed;z-index:1;top:1;overflow-x:hidden;padding-top:10px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:#fff}.column[_ngcontent-%COMP%]{float:left;width:33.33%;padding:25px}.row[_ngcontent-%COMP%]{position:absolute;top:40%;left:11%}.card[_ngcontent-%COMP%]{border-radius:1rem;border-color:#f1f1f8}h2[_ngcontent-%COMP%]{position:absolute;left:40%;top:20%;color:#ff9a04;font-family:Franklin Gothic Medium,Arial Narrow,Arial,sans-serif;font-weight:bolder;font-size:300%}h4[_ngcontent-%COMP%]{color:red;font-style:italic}h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{font-size:150%;font-weight:bolder;text-align:center}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}h2[_ngcontent-%COMP%]{position:absolute;left:30%;top:10%}.row[_ngcontent-%COMP%]{top:30%}.container-fluid[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{display:block}.row[_ngcontent-%COMP%]{top:25%;width:90%;white-space:nowrap;overflow-x:scroll;overflow-y:hidden}.card[_ngcontent-%COMP%]{width:100%;display:inline-block}}"]}),t})();function Y_(t,e){return n=>{const i=n.controls[e];i.errors&&!i.errors.mustMatch||i.setErrors(n.controls[t].value!==i.value?{mustMatch:!0}:null)}}function J_(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function ty(t,e){if(1&t&&(js(0,"div",28),Bs(1,J_,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.lastname.errors.required)}}function ey(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function ny(t,e){if(1&t&&(js(0,"div",28),Bs(1,ey,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.firstname.errors.required)}}function iy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function ry(t,e){1&t&&(js(0,"div"),vo(1,"8 Numbers "),qs())}function sy(t,e){if(1&t&&(js(0,"div",28),Bs(1,iy,2,0,"div",29),Bs(2,ry,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cin.errors.required),pr(1),Vs("ngIf",t.f.cin.errors.pattern)}}function oy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function ay(t,e){1&t&&(js(0,"div"),vo(1,"8 Numbers "),qs())}function ly(t,e){if(1&t&&(js(0,"div",28),Bs(1,oy,2,0,"div",29),Bs(2,ay,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.tel.errors.required),pr(1),Vs("ngIf",t.f.tel.errors.pattern)}}function cy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function uy(t,e){if(1&t&&(js(0,"div",28),Bs(1,cy,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.email.errors.required)}}function hy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function dy(t,e){1&t&&(js(0,"div"),vo(1,"Emails must match"),qs())}function py(t,e){if(1&t&&(js(0,"div",28),Bs(1,hy,2,0,"div",29),Bs(2,dy,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cemail.errors.required),pr(1),Vs("ngIf",t.f.cemail.errors.mustMatch)}}function fy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function my(t,e){1&t&&(js(0,"div"),vo(1,"min length = 6 characters"),qs())}function gy(t,e){if(1&t&&(js(0,"div",28),Bs(1,fy,2,0,"div",29),Bs(2,my,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.password.errors.required),pr(1),Vs("ngIf",t.f.password.errors.minlength)}}function _y(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function yy(t,e){1&t&&(js(0,"div"),vo(1,"Passwords must match"),qs())}function vy(t,e){if(1&t&&(js(0,"div",28),Bs(1,_y,2,0,"div",29),Bs(2,yy,2,0,"div",29),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cpass.errors.required),pr(1),Vs("ngIf",t.f.cpass.errors.mustMatch)}}const xy=function(t){return{"is-invalid":t}},by=function(){return{standalone:!0}};function wy(t,e){if(1&t){const t=Gs();js(0,"button",37),Ws("click",function(){return Pe(t),Qs().add()}),vo(1,"Suivant"),qs()}}function Cy(t,e){if(1&t){const t=Gs();js(0,"button",37),Ws("click",function(){return Pe(t),Qs().add()}),vo(1,"Valider"),qs()}}const Ey=function(){return{standalone:!0}},Sy=function(){return{standalone:!0}};function Ty(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function My(t,e){if(1&t&&(js(0,"div",59),Bs(1,Ty,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.email.errors.required)}}function Ay(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function ky(t,e){1&t&&(js(0,"div"),vo(1,"Emails must match"),qs())}function Py(t,e){if(1&t&&(js(0,"div",59),Bs(1,Ay,2,0,"div",56),Bs(2,ky,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cemail.errors.required),pr(1),Vs("ngIf",t.f.cemail.errors.mustMatch)}}function Iy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function Oy(t,e){1&t&&(js(0,"div"),vo(1,"min length = 6 characters"),qs())}function zy(t,e){if(1&t&&(js(0,"div",59),Bs(1,Iy,2,0,"div",56),Bs(2,Oy,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.password.errors.required),pr(1),Vs("ngIf",t.f.password.errors.minlength)}}function Dy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function Ry(t,e){1&t&&(js(0,"div"),vo(1,"Passwords must match"),qs())}function Ly(t,e){if(1&t&&(js(0,"div",59),Bs(1,Dy,2,0,"div",56),Bs(2,Ry,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cpass.errors.required),pr(1),Vs("ngIf",t.f.cpass.errors.mustMatch)}}function Fy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function By(t,e){if(1&t&&(js(0,"div",59),Bs(1,Fy,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.lastname.errors.required)}}function Ny(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function Vy(t,e){if(1&t&&(js(0,"div",59),Bs(1,Ny,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.firstname.errors.required)}}function Uy(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function jy(t,e){1&t&&(js(0,"div"),vo(1,"8 Numbers "),qs())}function qy(t,e){if(1&t&&(js(0,"div",59),Bs(1,Uy,2,0,"div",56),Bs(2,jy,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.cin.errors.required),pr(1),Vs("ngIf",t.f.cin.errors.pattern)}}function $y(t,e){1&t&&(js(0,"div"),vo(1,"required"),qs())}function Gy(t,e){1&t&&(js(0,"div"),vo(1,"8 Numbers "),qs())}function Zy(t,e){if(1&t&&(js(0,"div",59),Bs(1,$y,2,0,"div",56),Bs(2,Gy,2,0,"div",56),qs()),2&t){const t=Qs();pr(1),Vs("ngIf",t.f.tel.errors.required),pr(1),Vs("ngIf",t.f.tel.errors.pattern)}}const Hy=function(){return{standalone:!0}};function Wy(t,e){if(1&t){const t=Gs();js(0,"div"),js(1,"div",15),js(2,"div",16),js(3,"label",60),js(4,"h5"),vo(5,"-- Votre Niveau d'Education -- "),qs(),js(6,"select",61),Ws("ngModelChange",function(e){return Pe(t),Qs().niv=e}),js(7,"option",30),vo(8,"Niveau d'Education"),qs(),js(9,"option",62),vo(10,"Secondaire"),qs(),js(11,"option",63),vo(12,"Baccalaur\xe9at"),qs(),js(13,"option",64),vo(14,"License"),qs(),js(15,"option",65),vo(16,"Master "),qs(),js(17,"option",66),vo(18,"Doctorat"),qs(),qs(),qs(),$s(19,"div",31),qs(),js(20,"div",16),js(21,"label",67),js(22,"h5"),vo(23,"-- Votre Sp\xe9cialit\xe9 -- "),qs(),js(24,"select",68),Ws("ngModelChange",function(e){return Pe(t),Qs().sp=e}),js(25,"option",30),vo(26,"Sp\xe9cialit\xe9"),qs(),js(27,"optgroup",69),js(28,"option",70),vo(29,"Infirmerie"),qs(),js(30,"option",71),vo(31,"Chirurgie"),qs(),js(32,"option",72),vo(33,"M.g\xe9n\xe9rale"),qs(),js(34,"option",73),vo(35,"Neurologie"),qs(),js(36,"option",74),vo(37,"Pediathrie"),qs(),js(38,"option",75),vo(39,"Psychiatrie"),qs(),qs(),js(40,"optgroup",76),js(41,"option",77),vo(42,"Developpement Web"),qs(),js(43,"option",78),vo(44,"Developpement Mobile"),qs(),js(45,"option",79),vo(46,"WebDesign"),qs(),js(47,"option",80),vo(48,"Cybers\xe9curit\xe9"),qs(),js(49,"option",81),vo(50,"Web Analytique"),qs(),js(51,"option",82),vo(52,"R\xe9seaux et T\xe9l\xe9communications"),qs(),js(53,"option",83),vo(54,"Multimedia"),qs(),qs(),js(55,"optgroup",84),js(56,"option",85),vo(57,"Chaudronnerie"),qs(),js(58,"option",86),vo(59,"Tuyauterie"),qs(),js(60,"option",87),vo(61,"Maintenance Industrielle"),qs(),qs(),js(62,"option",42),vo(63,"M\xe9canique"),qs(),js(64,"optgroup",88),js(65,"option",89),vo(66,"E.de puissance"),qs(),js(67,"option",90),vo(68,"E.analogique"),qs(),js(69,"option",91),vo(70,"E.num\xe9rique"),qs(),js(71,"option",92),vo(72,"E.organique"),qs(),js(73,"option",93),vo(74,"E.quantique"),qs(),qs(),js(75,"optgroup",94),js(76,"option",95),vo(77,"Secr\xe9taire Comptable"),qs(),js(78,"option",96),vo(79,"Secr\xe9taire Juridique"),qs(),js(80,"option",97),vo(81,"Secr\xe9taire Administrative"),qs(),js(82,"option",98),vo(83,"Secr\xe9taire M\xe9dical"),qs(),qs(),js(84,"optgroup",99),js(85,"option",100),vo(86,"Chauffeur Taxi"),qs(),js(87,"option",101),vo(88,"Ambulancier"),qs(),js(89,"option",102),vo(90,"Livreur"),qs(),js(91,"option",103),vo(92,"Officier de Marine"),qs(),js(93,"option",104),vo(94,"Battelier"),qs(),js(95,"option",105),vo(96,"Conducteur Bus"),qs(),js(97,"option",106),vo(98,"D\xe9m\xe9nageur"),qs(),qs(),js(99,"optgroup",107),js(100,"option",108),vo(101,"Architecte d'Int\xe9rieur"),qs(),js(102,"option",109),vo(103,"Architecte Urbaniste"),qs(),js(104,"option",110),vo(105,"Architecte Paysagiste"),qs(),qs(),qs(),qs(),$s(106,"div",31),qs(),qs(),$s(107,"br"),js(108,"div",111),$s(109,"br"),js(110,"div"),js(111,"label",112),js(112,"h4"),vo(113,"Ajouter"),qs(),qs(),$s(114,"br"),$s(115,"textarea",113),qs(),qs(),qs()}if(2&t){const t=Qs();pr(6),Vs("ngModel",t.niv)("ngModelOptions",$a(4,Hy)),pr(18),Vs("ngModel",t.sp)("ngModelOptions",$a(5,Hy))}}const Xy=function(t){return{"is-invalid":t}},Ky=[{path:"accueil",component:Qm},{path:"information",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["app-information"]],decls:7,vars:0,consts:[[1,"split","right"],[1,"centre"],[2,"text-align","justify","font-family","'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif","font-size","200%"],["src","assets/img/contact-us (1).png",1,"center",2,"width","45%"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"div",0),js(3,"div",1),js(4,"h1",2),vo(5,"Trouver un emploi de nos jours avec la conjoncture actuelle est tr\xe8s difficile. C'est pourquoi nous avons pens\xe9 \xe0 cr\xe9er ce site pour faciliter la rencontre entre les soci\xe9t\xe9s et les demandeurs d'emploi. Que vous soyez une entreprise de grande taille ou un petit commerce du coin, vous trouverez les comp\xe9tences que vous recherchez."),qs(),qs(),$s(6,"img",3),qs())},directives:[Um,jm],styles:[".split[_ngcontent-%COMP%]{height:100%;width:40%;position:fixed;z-index:1;top:5;overflow-x:hidden;padding-top:20px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:#fff}.centre[_ngcontent-%COMP%]{top:20%;left:15%;width:70%}.center[_ngcontent-%COMP%], .centre[_ngcontent-%COMP%]{position:absolute}.center[_ngcontent-%COMP%]{top:50%;left:30%}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}.center[_ngcontent-%COMP%]{top:70%;left:25%}.center[_ngcontent-%COMP%], .centre[_ngcontent-%COMP%]{position:absolute}.centre[_ngcontent-%COMP%]{top:10%;left:3%}}"]}),t})()},{path:"contact",component:Q_},{path:"inscription1",component:(()=>{class t{constructor(t,e,n){this.fb=t,this.route=e,this.d=n,this.submitted=!1}ngOnInit(){this.form=this.fb.group({lastname:["",ku.required],firstname:["",ku.required],cin:["",[ku.pattern("[0-9]{8}"),ku.required]],tel:["",[ku.pattern("[0-9]{8}"),ku.required]],email:["",[ku.required,ku.email]],password:["",[ku.minLength(6),ku.required]],cemail:["",ku.required],cpass:["",ku.required]},{validator:[Y_("email","cemail"),Y_("password","cpass")]})}get f(){return this.form.controls}onSubmit(){return Nm(this,void 0,void 0,function*(){if(this.submitted=!0,this.form.valid){var t=document.getElementById("nom").value,e=document.getElementById("prenom").value,n=document.getElementById("cin").value,i=document.getElementById("numtel").value,r=document.getElementById("email").value,s=document.getElementById("pwd").value,o=document.getElementById("dn").value,a=this.genre;if("Chomeur"===this.d.getvalue())var l="chomeur";else l="chef";var c=`{"statut":"${l}","nom":"${t}","prenom":"${e}","cin":"${n}","numtel":"${i}","email":"${r}","password":"${s}","gender":"${a}","dn":"${o}"}`;alert(c);const u=yield fetch("http://127.0.0.1:8000/add1",{method:"POST",body:c,headers:{"Content-Type":"application/json"}});u.ok&&(u.json().then(t=>{console.log(t)}),this.route.navigateByUrl("/inscription2")),this.d.setcin(n)}})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Wh),Ns(mm),Ns(Vm))},t.\u0275cmp=jt({type:t,selectors:[["app-inscription1"]],decls:74,vars:36,consts:[[1,"split","right"],[1,"page-wrapper","bg-blue","font-robo"],[1,"wrapper","wrapper--w680"],[1,"card","card-1"],[1,"card-heading"],["src","assets/img/bg-head-02.jpg","width","100%"],[1,"card-body"],[1,"title"],["name","form",3,"formGroup","ngSubmit"],[1,"row","row-space"],[1,"col-lg-4","col-sm-12"],[1,"input-group"],["type","text","placeholder","Nom","name","nom","id","nom","formControlName","lastname",1,"input--style-1",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","placeholder","Prenom","id","prenom","formControlName","firstname","name","prenom",1,"input--style-1",3,"ngClass"],["type","text","placeholder","CIN","formControlName","cin","id","cin","name","cin",1,"input--style-1",3,"ngClass"],["type","tel","placeholder","N\xb0 Telephone","id","numtel","formControlName","tel","name","numtel",1,"input--style-1",3,"ngClass"],["name","gender",3,"ngModel","ngModelOptions","ngModelChange"],["disabled","disabled","selected","selected"],[1,"select-dropdown"],["type","date","placeholder","Date de Naissance","id","dn","name","birthday",1,"input--style-1","js-datepicker"],[1,"zmdi","zmdi-calendar-note","input-icon","js-btn-calendar"],["type","email","placeholder","Email","ng-model","12email","id","email","formControlName","email","name","mail",1,"input--style-1",3,"ngClass"],["type","email","placeholder","Confirmer Email","formControlName","cemail","match","12email","name","cmail",1,"input--style-1",3,"ngClass"],["type","password","formControlName","password","placeholder","Mot de Passe","id","pwd","name","mdp",1,"input--style-1",3,"ngClass"],["type","password","formControlName","cpass","placeholder","Confirmer Mot de Passe","name","cmdp",1,"input--style-1",3,"ngClass"],["type","button","routerLinkActive","active","routerLink","/accueil",1,"btn","btn--radius","btn--green"],["type","button",1,"btn","btn--radius","btn--green",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"body"),js(3,"div",0),js(4,"div",1),js(5,"h2"),vo(6,"Inscrivez-vous ici !"),qs(),js(7,"h1"),vo(8,"Profitez de nos services"),qs(),js(9,"div",2),js(10,"div",3),js(11,"div",4),$s(12,"img",5),qs(),js(13,"div",6),js(14,"h2",7),vo(15,"Veuillez remplir ces champs !"),qs(),js(16,"form",8),Ws("ngSubmit",function(){return e.onSubmit()}),js(17,"div",9),js(18,"div",10),js(19,"div",11),$s(20,"input",12),Bs(21,ty,2,1,"div",13),qs(),qs(),js(22,"div",10),js(23,"div",11),$s(24,"input",14),Bs(25,ny,2,1,"div",13),qs(),qs(),qs(),js(26,"div",9),js(27,"div",10),js(28,"div",11),$s(29,"input",15),Bs(30,sy,3,2,"div",13),qs(),qs(),js(31,"div",10),js(32,"div",11),$s(33,"input",16),Bs(34,ly,3,2,"div",13),qs(),qs(),qs(),js(35,"div",9),js(36,"div",10),js(37,"select",17),Ws("ngModelChange",function(t){return e.genre=t}),js(38,"option",18),vo(39,"Sexe "),qs(),js(40,"option"),vo(41,"Homme"),qs(),js(42,"option"),vo(43,"Femme"),qs(),qs(),$s(44,"div",19),qs(),js(45,"div",10),js(46,"div",11),$s(47,"input",20),$s(48,"i",21),qs(),qs(),qs(),js(49,"div",9),js(50,"div",10),js(51,"div",11),$s(52,"input",22),Bs(53,uy,2,1,"div",13),qs(),qs(),js(54,"div",10),js(55,"div",11),$s(56,"input",23),Bs(57,py,3,2,"div",13),qs(),qs(),qs(),js(58,"div",9),js(59,"div",10),js(60,"div",11),$s(61,"input",24),Bs(62,gy,3,2,"div",13),qs(),qs(),js(63,"div",10),js(64,"div",11),$s(65,"input",25),Bs(66,vy,3,2,"div",13),qs(),qs(),qs(),js(67,"div",9),js(68,"div",10),js(69,"button",26),vo(70,"Retour"),qs(),qs(),js(71,"div",10),js(72,"button",27),Ws("click",function(){return e.onSubmit()}),vo(73,"Suivant"),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs()),2&t&&(pr(16),Vs("formGroup",e.form),pr(4),Vs("ngClass",Ga(19,xy,e.submitted&&e.f.lastname.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.lastname.errors),pr(3),Vs("ngClass",Ga(21,xy,e.submitted&&e.f.firstname.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.firstname.errors),pr(4),Vs("ngClass",Ga(23,xy,e.submitted&&e.f.cin.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cin.errors),pr(3),Vs("ngClass",Ga(25,xy,e.submitted&&e.f.tel.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.tel.errors),pr(3),Vs("ngModel",e.genre)("ngModelOptions",$a(27,by)),pr(15),Vs("ngClass",Ga(28,xy,e.submitted&&e.f.email.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.email.errors),pr(3),Vs("ngClass",Ga(30,xy,e.submitted&&e.f.cemail.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cemail.errors),pr(4),Vs("ngClass",Ga(32,xy,e.submitted&&e.f.password.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.password.errors),pr(3),Vs("ngClass",Ga(34,xy,e.submitted&&e.f.cpass.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cpass.errors))},directives:[Um,jm,Mh,Xu,Dh,Cu,Wu,Lh,Ic,Rc,Nh,Th,Vh,$h,vm,gm],styles:['.split[_ngcontent-%COMP%]{height:100%;width:40%;position:fixed;z-index:1;top:1;overflow-x:hidden;padding-top:10px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:#fff}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{text-align:center;color:#b8860b}.font-robo[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif}.row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.row-space[_ngcontent-%COMP%]{justify-content:space-between}.col-2[_ngcontent-%COMP%]{width:calc((100% - 60px) / 2)}@media (max-width:767px){.col-2[_ngcontent-%COMP%]{width:100%}}html[_ngcontent-%COMP%]{box-sizing:border-box}*[_ngcontent-%COMP%]{padding:0;margin:0}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:inherit}blockquote[_ngcontent-%COMP%], body[_ngcontent-%COMP%], dd[_ngcontent-%COMP%], dl[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], hr[_ngcontent-%COMP%], legend[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], p[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{margin:0;padding:0}li[_ngcontent-%COMP%] > ol[_ngcontent-%COMP%], li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{margin-bottom:0}table[_ngcontent-%COMP%]{border-collapse:collapse;border-spacing:0}fieldset[_ngcontent-%COMP%]{min-width:1;border:0}button[_ngcontent-%COMP%]{outline:none;background:none;border:none}.page-wrapper[_ngcontent-%COMP%]{min-height:100vh}body[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-size:14px}body[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-weight:400}h1[_ngcontent-%COMP%]{font-size:36px}h2[_ngcontent-%COMP%]{font-size:30px}h3[_ngcontent-%COMP%]{font-size:24px}h4[_ngcontent-%COMP%]{font-size:18px}h5[_ngcontent-%COMP%]{font-size:15px}h6[_ngcontent-%COMP%]{font-size:13px}.bg-blue[_ngcontent-%COMP%]{background:#fff}.p-t-100[_ngcontent-%COMP%]{padding-top:150px}.p-t-20[_ngcontent-%COMP%]{padding-top:120px}.p-b-100[_ngcontent-%COMP%]{padding-bottom:150px}.wrapper[_ngcontent-%COMP%]{margin:0 auto}.wrapper--w680[_ngcontent-%COMP%]{max-width:1000px}.btn[_ngcontent-%COMP%]{line-height:40px;display:inline-block;padding:0 25px;cursor:pointer;font-family:Roboto,Arial,Helvetica Neue,sans-serif;color:#ebfc00;transition:all .4s ease;font-size:14px;font-weight:700}.btn--radius[_ngcontent-%COMP%]{border-radius:3px}.btn--green[_ngcontent-%COMP%]{background:#050a04}.btn--green[_ngcontent-%COMP%]:hover{background:#0d0e0d}td.active[_ngcontent-%COMP%]{background-color:#1e1f20}input[type=date i][_ngcontent-%COMP%]{padding:14px}.table-condensed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-weight:400}.daterangepicker[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:40px;height:30px}.daterangepicker[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15);display:none;border:1px solid #e0e0e0;margin-top:5px}.daterangepicker[_ngcontent-%COMP%]:after, .daterangepicker[_ngcontent-%COMP%]:before{display:none}.daterangepicker[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 0}.daterangepicker[_ngcontent-%COMP%]   .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:3px;font-size:14px;padding:5px;outline:none}input[_ngcontent-%COMP%]{outline:none;margin:0;border:none;box-shadow:none;width:120%;font-size:15px;font-family:inherit}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;border-bottom:2px solid #c9bcbc}.input-icon[_ngcontent-%COMP%]{position:absolute;font-size:18px;color:#e2d9d9;right:8px;top:50%;transform:translateY(-50%);cursor:pointer}.input--style-1[_ngcontent-%COMP%]{padding:2px 0;color:#666}.input--style-1[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#555}.input--style-1[_ngcontent-%COMP%]:-moz-placeholder, .input--style-1[_ngcontent-%COMP%]::-moz-placeholder{color:#555;opacity:1}.input--style-1[_ngcontent-%COMP%]:-ms-input-placeholder{color:#555}.select--no-search[_ngcontent-%COMP%]   .select2-search[_ngcontent-%COMP%]{display:none!important}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]{width:50%!important;outline:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]{outline:none;border:none;height:34px}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__rendered[_ngcontent-%COMP%]{line-height:34px;padding-left:0;color:#555}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]{height:32px;right:4px;display:flex;justify-content:center;align-items:center}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{display:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{font-family:Material-Design-Iconic-Font;content:"\\f2f9";font-size:20px;color:#ccc;transition:all .4s ease}.rs-select2[_ngcontent-%COMP%]   .select2-container.select2-container--open[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{transform:rotate(-180deg)}.select2-container--open[_ngcontent-%COMP%]   .select2-dropdown--below[_ngcontent-%COMP%]{border-radius:3px;box-shadow:0 8px 20px 0 rgba(0,0,0,.15);border:1px solid #e0e0e0;margin-top:5px;overflow:hidden}.title[_ngcontent-%COMP%]{margin-bottom:30px}.card[_ngcontent-%COMP%]{overflow:hidden;border-radius:7px;background:rgba(14,11,11,.034)}.card-1[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15)}span[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:35px 90px 65px}@media (max-width:767px){.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:40px}}select[_ngcontent-%COMP%]{padding:13px 12px;margin:0 50px;border:1px solid #000;border-radius:100px;width:60%;font-size:medium;overflow:hidden;background-color:#fff;background:#fff;position:relative;color:#000}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}.title[_ngcontent-%COMP%]{margin-bottom:5px}select[_ngcontent-%COMP%]{width:100%;height:40px;margin:0;padding:7px 11px}[_ngcontent-%COMP%]::placeholder, select[_ngcontent-%COMP%]{font-size:medium}button[_ngcontent-%COMP%]{width:100%;margin:2%}}']}),t})()},{path:"inscription2",component:(()=>{class t{constructor(t,e){this.d=t,this.route=e,this.ok=!1,this.submitted=!1,this.coordinates={sfax:{lng:10.76028,lat:34.74056},tunis:{lng:10.16579,lat:36.81897},"ben arous":{lng:10.21889,lat:36.75306},beja:{lng:9.18169,lat:36.72564},sousse:{lng:10.63699,lat:35.82539},kef:{lng:8.70486,lat:36.17424}}}ngOnInit(){return Nm(this,void 0,void 0,function*(){"Chomeur"===this.d.getvalue()&&(this.ok=!0)})}getmap(t){this.mapinitialiser(this.coordinates[t].lng,this.coordinates[t].lat)}mapinitialiser(t,e){var i=n("4ZJM");i.accessToken="pk.eyJ1IjoiYmFoYWVkZGluZTEyMyIsImEiOiJja251ZXluOWcwY2I3Mnduam5xdmt1aGZ1In0.s3Pu_B4CTjaLJQlodzbvAg";var r=new i.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[t,e],zoom:5}),s=new Jm.a({accessToken:i.accessToken,placeholder:this.region,mapboxgl:i,marker:!1});r.addControl(s),r.addControl(new i.NavigationControl),s.on("result",function(t){r.getSource("single-point").setData(t.result.geometry)}),r.on("click",t=>{this.d.address=JSON.stringify(t.lngLat);var e=document.createElement("div");e.className="marker",e.style.height="50px",e.style.width="50px",e.style.backgroundImage="url(/assets/img/marker.png)",e.style.backgroundSize="100%",new i.Marker(e).setLngLat(t.lngLat).addTo(r)})}add(){return Nm(this,void 0,void 0,function*(){var t=document.getElementById("nom_buis").value,e=document.getElementById("worktel").value,n=this.domaine,i=this.d.getcin();if(this.ok)var r="chomeur";else r="chef";this.d.address=this.region;var s=`{"statut":"${r}","cin":"${i}","nom_buisness":"${t}","numtel_travail":"${e}","domaine":"${n}","adresse":"${this.region}"}`;const o=yield fetch("http://127.0.0.1:8000/add2",{method:"POST",body:s,headers:{"Content-Type":"application/json"}});o.ok&&(o.json().then(t=>{console.log(t)}),this.route.navigateByUrl(this.ok?"/inscription3-chom":"/accueil"))})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Vm),Ns(mm))},t.\u0275cmp=jt({type:t,selectors:[["app-inscription2"]],decls:79,vars:8,consts:[[1,"split","right"],[1,"page-wrapper","bg-blue","font-robo"],[1,"wrapper","wrapper--w680"],[1,"card","card-1"],[1,"card-heading"],["src","assets/img/bg-head-02.jpg","width","100%"],[1,"card-body"],[1,"title"],[1,"row","row-space"],[1,"col-lg-4","col-sm-12"],[1,"input-group"],["type","text","placeholder","Nom Buisness","name","nomB","id","nom_buis",1,"input--style-1"],["type","tel","placeholder","N\xb0 Telephone (Travail)","name","numteltravail","id","worktel",1,"input--style-1"],["for","i1"],["id","i1","name","Domaine",3,"ngModel","ngModelOptions","ngModelChange"],["value","Medecine"],["value","Architecture"],["value","Agriculture"],["value","Commerce"],["value","Informatique"],["value","M\xe9canique"],["value","El\xe9ctronique"],["value","Industrie"],["value","secr\xe9tariat"],["value","Transport"],["for","reg-select"],["name","region","id","reg-select",3,"ngModel","ngModelOptions","ngModelChange","change"],["value","tunis"],["value","sousse"],["value","sfax"],["value","ben arous"],["value","beja"],["value","kef"],["id","map",1,"map"],[1,"col-lg-3","col-sm-12"],["routerLinkActive","active","routerLink","/inscription1",1,"btn","btn--radius","btn--green"],["class","btn btn--radius btn--green","type","submit",3,"click",4,"ngIf"],["type","submit",1,"btn","btn--radius","btn--green",3,"click"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"div",0),js(3,"div",1),js(4,"div",2),js(5,"div",3),js(6,"div",4),$s(7,"img",5),qs(),js(8,"div",6),js(9,"h2",7),vo(10,"Veuillez remplir ces champs !"),qs(),js(11,"form"),js(12,"div",8),js(13,"div",9),js(14,"div",10),$s(15,"input",11),qs(),qs(),js(16,"div",9),js(17,"div",10),$s(18,"input",12),qs(),qs(),qs(),$s(19,"br"),js(20,"div",8),js(21,"div",9),js(22,"label",13),js(23,"h5"),vo(24,"-- Votre domaine de travail -- "),qs(),js(25,"select",14),Ws("ngModelChange",function(t){return e.domaine=t}),js(26,"option",15),vo(27,"M\xe9decine"),qs(),js(28,"option",16),vo(29,"Architecture"),qs(),js(30,"option",17),vo(31,"Agriculture"),qs(),js(32,"option",18),vo(33,"Commerce"),qs(),js(34,"option",19),vo(35,"Informatique"),qs(),js(36,"option",20),vo(37,"M\xe9canique"),qs(),js(38,"option",21),vo(39,"El\xe9ctronique"),qs(),js(40,"option",22),vo(41,"Industrie"),qs(),js(42,"option",23),vo(43,"secr\xe9tariat"),qs(),js(44,"option",24),vo(45,"Transport"),qs(),qs(),qs(),qs(),js(46,"div",9),js(47,"label",25),js(48,"h5"),vo(49,"-- Votre region -- "),qs(),js(50,"select",26),Ws("ngModelChange",function(t){return e.region=t})("change",function(t){return e.getmap(t.target.value)}),js(51,"option",27),vo(52,"Tunis"),qs(),js(53,"option",28),vo(54,"Sousse"),qs(),js(55,"option",29),vo(56,"Sfax"),qs(),js(57,"option",30),vo(58,"Ben arous"),qs(),js(59,"option",31),vo(60,"Beja"),qs(),js(61,"option",32),vo(62,"Kef"),qs(),qs(),qs(),vo(63," \xa0\xa0 "),qs(),qs(),$s(64,"br"),js(65,"div",8),js(66,"div",9),js(67,"h5"),vo(68,"Adresse de Votre lieu de travail"),qs(),$s(69,"div",33),qs(),qs(),$s(70,"br"),js(71,"div",8),js(72,"div",34),js(73,"button",35),vo(74,"Retour"),qs(),$s(75,"br"),qs(),js(76,"div",34),Bs(77,wy,2,0,"button",36),Bs(78,Cy,2,0,"button",36),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs()),2&t&&(pr(25),Vs("ngModel",e.domaine)("ngModelOptions",$a(6,Ey)),pr(25),Vs("ngModel",e.region)("ngModelOptions",$a(7,Ey)),pr(27),Vs("ngIf",e.ok),pr(1),Vs("ngIf",!e.ok))},directives:[Um,jm,Mh,Xu,Ch,Nh,Wu,Th,Vh,$h,vm,gm,Rc],styles:['.split[_ngcontent-%COMP%]{height:100%;width:40%;position:fixed;z-index:1;top:1;overflow-x:hidden;padding-top:10px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:#fff}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{color:#b8860b}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{font-weight:bolder;font-family:Roboto,Arial,Helvetica Neue,sans-serif;color:#000}#map[_ngcontent-%COMP%]{height:350px;width:550px;right:50%}.mapboxgl-popup[_ngcontent-%COMP%]{max-width:200px}.mapboxgl-popup-content[_ngcontent-%COMP%]{text-align:center;font-family:Open Sans,sans-serif}select[_ngcontent-%COMP%]{padding:5px 15px;margin:0 50px;border:1px solid #000;border-radius:100px;width:70%;font-size:medium;overflow:hidden;background-color:#fff;background:#fff;position:relative;color:#000}.font-robo[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif}.row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.row-space[_ngcontent-%COMP%]{justify-content:space-between}.col-2[_ngcontent-%COMP%]{width:calc((100% - 60px) / 2)}@media (max-width:767px){.col-2[_ngcontent-%COMP%]{width:100%}}html[_ngcontent-%COMP%]{box-sizing:border-box}*[_ngcontent-%COMP%]{padding:0;margin:0}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:inherit}blockquote[_ngcontent-%COMP%], body[_ngcontent-%COMP%], dd[_ngcontent-%COMP%], dl[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], hr[_ngcontent-%COMP%], legend[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], p[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{margin:0;padding:0}li[_ngcontent-%COMP%] > ol[_ngcontent-%COMP%], li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{margin-bottom:0}table[_ngcontent-%COMP%]{border-collapse:collapse;border-spacing:0}fieldset[_ngcontent-%COMP%]{min-width:1;border:0}button[_ngcontent-%COMP%]{outline:none;background:none;border:none}.page-wrapper[_ngcontent-%COMP%]{min-height:100vh}body[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-size:14px}body[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-weight:400}h1[_ngcontent-%COMP%]{font-size:36px}h2[_ngcontent-%COMP%]{font-size:30px}h3[_ngcontent-%COMP%]{font-size:24px}h4[_ngcontent-%COMP%]{font-size:18px}h5[_ngcontent-%COMP%]{font-size:15px}h6[_ngcontent-%COMP%]{font-size:13px}.bg-blue[_ngcontent-%COMP%]{background:#fff}.p-t-100[_ngcontent-%COMP%]{padding-top:150px}.p-t-20[_ngcontent-%COMP%]{padding-top:120px}.p-b-100[_ngcontent-%COMP%]{padding-bottom:150px}.wrapper[_ngcontent-%COMP%]{margin:0 auto}.wrapper--w680[_ngcontent-%COMP%]{max-width:1000px}.btn[_ngcontent-%COMP%]{line-height:40px;display:inline-block;padding:0 25px;cursor:pointer;font-family:Roboto,Arial,Helvetica Neue,sans-serif;color:#ebfc00;transition:all .4s ease;font-size:14px;font-weight:700}.btn--radius[_ngcontent-%COMP%]{border-radius:3px}.btn--green[_ngcontent-%COMP%]{background:#050a04}.btn--green[_ngcontent-%COMP%]:hover{background:#0d0e0d}td.active[_ngcontent-%COMP%]{background-color:#1e1f20}input[type=date i][_ngcontent-%COMP%]{padding:14px}.table-condensed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-weight:400}.daterangepicker[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:40px;height:30px}.daterangepicker[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15);display:none;border:1px solid #e0e0e0;margin-top:5px}.daterangepicker[_ngcontent-%COMP%]:after, .daterangepicker[_ngcontent-%COMP%]:before{display:none}.daterangepicker[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 0}.daterangepicker[_ngcontent-%COMP%]   .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:3px;font-size:14px;padding:5px;outline:none}input[_ngcontent-%COMP%]{outline:none;margin:0;border:none;box-shadow:none;width:120%;font-size:15px;font-family:inherit}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;border-bottom:2px solid #c9bcbc}.input-icon[_ngcontent-%COMP%]{position:absolute;font-size:18px;color:#e2d9d9;right:8px;top:50%;transform:translateY(-50%);cursor:pointer}.input--style-1[_ngcontent-%COMP%]{padding:9px 0;color:#666}.input--style-1[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#555}.input--style-1[_ngcontent-%COMP%]:-moz-placeholder, .input--style-1[_ngcontent-%COMP%]::-moz-placeholder{color:#555;opacity:1}.input--style-1[_ngcontent-%COMP%]:-ms-input-placeholder{color:#555}.select--no-search[_ngcontent-%COMP%]   .select2-search[_ngcontent-%COMP%]{display:none!important}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]{width:150%!important;outline:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]{outline:none;border:none;height:34px}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__rendered[_ngcontent-%COMP%]{line-height:34px;padding-left:0;color:#555}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]{height:32px;right:4px;display:flex;justify-content:center;align-items:center}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{display:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{font-family:Material-Design-Iconic-Font;content:"\\f2f9";font-size:20px;color:#ccc;transition:all .4s ease}.rs-select2[_ngcontent-%COMP%]   .select2-container.select2-container--open[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{transform:rotate(-180deg)}.select2-container--open[_ngcontent-%COMP%]   .select2-dropdown--below[_ngcontent-%COMP%]{border-radius:3px;box-shadow:0 8px 20px 0 rgba(0,0,0,.15);border:1px solid #e0e0e0;margin-top:5px;overflow:hidden}.title[_ngcontent-%COMP%]{margin-bottom:30px}.card[_ngcontent-%COMP%]{overflow:hidden;border-radius:7px;background:rgba(14,11,11,.034)}.card-1[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15)}img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:5px 90px 80px}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:40px}#map[_ngcontent-%COMP%]{height:200px;width:500px;margin:auto;padding:auto}.title[_ngcontent-%COMP%]{margin-bottom:5px}select[_ngcontent-%COMP%]{width:100%;height:40px;margin:0;padding:7px 11px;font-size:small}[_ngcontent-%COMP%]::placeholder{font-size:medium}button[_ngcontent-%COMP%]{width:100%;margin:2%}}']}),t})()},{path:"consultation-chef",component:K_},{path:"inscription3-chom",component:(()=>{class t{constructor(t,e){this.d=t,this.route=e,this.sp="",this.niv="",this.ch="",this.text=""}ngOnInit(){}add(){return Nm(this,void 0,void 0,function*(){var t=this.d.getcin();this.text=document.getElementById("txt").value,this.ar&&(this.ch=this.ch+" arabe"),this.fr&&(this.ch=this.ch+" fran\xe7ais"),this.eng&&(this.ch=this.ch+" anglais");var e=`{"cin":"${t}","niveau":"${this.niv}","sp":"${this.sp}","texte":"${this.text}","lng":"${this.ch}"}`;const n=yield fetch("http://127.0.0.1:8000/add3",{method:"POST",body:e,headers:{"Content-Type":"application/json"}});n.ok&&n.json().then(t=>{console.log(t),this.route.navigateByUrl("/accueil")})})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Vm),Ns(mm))},t.\u0275cmp=jt({type:t,selectors:[["app-inscription3-chom"]],decls:149,vars:15,consts:[[1,"split","right"],[1,"page-wrapper","bg-blue","font-robo"],[1,"wrapper","wrapper--w680"],[1,"card","card-1"],[1,"card-heading"],["src","assets/img/bg-head-02.jpg","width","100%"],[1,"card-body"],[1,"title"],["method","POST"],[1,"row","row-space"],[1,"col-lg-4","col-sm-12"],["for","i1"],["id","i1","name","Niveau Education",3,"ngModel","ngModelOptions","ngModelChange"],["value","secondaire"],["value","baccalaur\xe9at"],["value","license"],["value","master"],["value","doctorat"],["for","i2"],["id","i2","name","Sp\xe9cialit\xe9",3,"ngModel","ngModelOptions","ngModelChange"],["label","Medecine"],["value","infirmerie"],["value","chirurgie"],["value","g\xe9n\xe9rale"],["value","neuro"],["value","pediathrie"],["value","psychiatrie"],["label","Informatique"],["value","DevWeb"],["value","DevMob"],["value","webdesign"],["value","cybersecurit\xe9"],["value","webanalytique"],["value","r\xe9seau"],["value","multimedia"],["label","Industrie"],["value","chaudronnerie"],["value","tuyauterie"],["value","maintenance"],["value","M\xe9canique"],["label","El\xe9ctronique"],["value","puissance"],["value","analogique"],["value","num\xe9rique"],["value","organique"],["value","quantique"],["label","secr\xe9tariat"],["value","seccomptable"],["value","secjuridique"],["value","secadmin"],["value","secmedical"],["label","Transport"],["value","taxi"],["value","ambulancier"],["value","livreur"],["value","offmarine"],["value","battelier"],["value","bus"],["value","d\xe9m\xe9nageur"],["label","Architecture"],["value","interieur"],["value","urbain"],["value","paysagiste"],["type","checkbox","id","ar","value","arabe",3,"ngModel","ngModelOptions","ngModelChange"],["for","fr"],["type","checkbox","id","fr","value","fran\xe7ais",3,"ngModel","ngModelOptions","ngModelChange"],["for","en"],["type","checkbox","id","en","value","anglais",3,"ngModel","ngModelOptions","ngModelChange"],[1,"row"],["cols","80","rows","6","placeholder","autre langue , description ... ","id","txt",2,"font-size","medium"],["type","button","routerLinkActive","active","routerLink","/inscription1",1,"btn","btn--radius","btn--green"],["type","submit",1,"btn","btn--radius","btn--green",3,"click"]],template:function(t,e){1&t&&($s(0,"app-navbar"),$s(1,"app-leftside"),js(2,"div",0),js(3,"div",1),js(4,"div",2),js(5,"div",3),js(6,"div",4),$s(7,"img",5),qs(),js(8,"div",6),js(9,"h2",7),vo(10,"Veuillez remplir ces champs !"),qs(),js(11,"form",8),js(12,"div",9),js(13,"div",10),js(14,"label",11),js(15,"h4"),vo(16,"Niveau d'Education "),qs(),qs(),$s(17,"br"),js(18,"select",12),Ws("ngModelChange",function(t){return e.niv=t}),js(19,"option",13),vo(20,"Secondaire"),qs(),js(21,"option",14),vo(22,"Baccalaur\xe9at"),qs(),js(23,"option",15),vo(24,"License"),qs(),js(25,"option",16),vo(26,"Master "),qs(),js(27,"option",17),vo(28,"Doctorat"),qs(),qs(),qs(),js(29,"div",10),js(30,"label",18),js(31,"h4"),vo(32,"Sp\xe9cialit\xe9 "),qs(),qs(),$s(33,"br"),js(34,"select",19),Ws("ngModelChange",function(t){return e.sp=t}),js(35,"optgroup",20),js(36,"option",21),vo(37,"Infirmerie"),qs(),js(38,"option",22),vo(39,"Chirurgie"),qs(),js(40,"option",23),vo(41,"M.g\xe9n\xe9rale"),qs(),js(42,"option",24),vo(43,"Neurologie"),qs(),js(44,"option",25),vo(45,"Pediathrie"),qs(),js(46,"option",26),vo(47,"Psychiatrie"),qs(),qs(),js(48,"optgroup",27),js(49,"option",28),vo(50,"Developpement Web"),qs(),js(51,"option",29),vo(52,"Developpement Mobile"),qs(),js(53,"option",30),vo(54,"WebDesign"),qs(),js(55,"option",31),vo(56,"Cybers\xe9curit\xe9"),qs(),js(57,"option",32),vo(58,"Web Analytique"),qs(),js(59,"option",33),vo(60,"R\xe9seaux et T\xe9l\xe9communications"),qs(),js(61,"option",34),vo(62,"Multimedia"),qs(),qs(),js(63,"optgroup",35),js(64,"option",36),vo(65,"Chaudronnerie"),qs(),js(66,"option",37),vo(67,"Tuyauterie"),qs(),js(68,"option",38),vo(69,"Maintenance Industrielle"),qs(),qs(),js(70,"option",39),vo(71,"M\xe9canique"),qs(),js(72,"optgroup",40),js(73,"option",41),vo(74,"E.de puissance"),qs(),js(75,"option",42),vo(76,"E.analogique"),qs(),js(77,"option",43),vo(78,"E.num\xe9rique"),qs(),js(79,"option",44),vo(80,"E.organique"),qs(),js(81,"option",45),vo(82,"E.quantique"),qs(),qs(),js(83,"optgroup",46),js(84,"option",47),vo(85,"Secr\xe9taire Comptable"),qs(),js(86,"option",48),vo(87,"Secr\xe9taire Juridique"),qs(),js(88,"option",49),vo(89,"Secr\xe9taire Administrative"),qs(),js(90,"option",50),vo(91,"Secr\xe9taire M\xe9dical"),qs(),qs(),js(92,"optgroup",51),js(93,"option",52),vo(94,"Chauffeur Taxi"),qs(),js(95,"option",53),vo(96,"Ambulancier"),qs(),js(97,"option",54),vo(98,"Livreur"),qs(),js(99,"option",55),vo(100,"Officier de Marine"),qs(),js(101,"option",56),vo(102,"Battelier"),qs(),js(103,"option",57),vo(104,"Conducteur Bus"),qs(),js(105,"option",58),vo(106,"D\xe9m\xe9nageur"),qs(),qs(),js(107,"optgroup",59),js(108,"option",60),vo(109,"Architecte d'Int\xe9rieur"),qs(),js(110,"option",61),vo(111,"Architecte Urbaniste"),qs(),js(112,"option",62),vo(113,"Architecte Paysagiste"),qs(),qs(),qs(),qs(),qs(),$s(114,"br"),js(115,"h3"),vo(116,"Langue :"),qs(),$s(117,"br"),js(118,"div",9),js(119,"label"),js(120,"h5"),vo(121,"Arabe"),qs(),js(122,"input",63),Ws("ngModelChange",function(t){return e.ar=t}),qs(),qs(),js(123,"label",64),js(124,"h5"),vo(125,"Fran\xe7ais"),qs(),js(126,"input",65),Ws("ngModelChange",function(t){return e.fr=t}),qs(),qs(),js(127,"label",66),js(128,"h5"),vo(129,"Anglais"),qs(),js(130,"input",67),Ws("ngModelChange",function(t){return e.eng=t}),qs(),qs(),qs(),$s(131,"br"),js(132,"div",68),js(133,"div",10),js(134,"h3"),vo(135,"Autre :"),qs(),qs(),$s(136,"br"),$s(137,"br"),$s(138,"textarea",69),qs(),$s(139,"br"),$s(140,"br"),js(141,"div",9),js(142,"div",10),js(143,"button",70),vo(144,"Retour"),qs(),$s(145,"br"),qs(),js(146,"div",10),js(147,"button",71),Ws("click",function(){return e.add()}),vo(148,"valider"),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs(),qs()),2&t&&(pr(18),Vs("ngModel",e.niv)("ngModelOptions",$a(10,Sy)),pr(16),Vs("ngModel",e.sp)("ngModelOptions",$a(11,Sy)),pr(88),Vs("ngModel",e.ar)("ngModelOptions",$a(12,Sy)),pr(4),Vs("ngModel",e.fr)("ngModelOptions",$a(13,Sy)),pr(4),Vs("ngModel",e.eng)("ngModelOptions",$a(14,Sy)))},directives:[Um,jm,Mh,Xu,Ch,Nh,Wu,Th,Vh,$h,xu,vm,gm],styles:['.split[_ngcontent-%COMP%]{height:100%;width:40%;position:fixed;z-index:1;top:1;overflow-x:hidden;padding-top:10px}.right[_ngcontent-%COMP%]{width:65%;right:0;background-color:#fff}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{color:#b8860b}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{font-weight:bolder;font-family:Roboto,Arial,Helvetica Neue,sans-serif;color:#000}#map[_ngcontent-%COMP%]{height:200px;width:500px;right:70%}select[_ngcontent-%COMP%]{padding:5px 15px;margin:10px 15px;border:1px solid #000;border-radius:100px;width:80%;font-size:medium;overflow:hidden;background-color:#fff;background:#fff;position:relative;color:#000}.font-robo[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif}.row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.row-space[_ngcontent-%COMP%]{justify-content:space-between}.col-2[_ngcontent-%COMP%]{width:calc((100% - 60px) / 2)}@media (max-width:767px){.col-2[_ngcontent-%COMP%]{width:100%}}html[_ngcontent-%COMP%]{box-sizing:border-box}*[_ngcontent-%COMP%]{padding:0;margin:0}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:inherit}blockquote[_ngcontent-%COMP%], body[_ngcontent-%COMP%], dd[_ngcontent-%COMP%], dl[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], hr[_ngcontent-%COMP%], legend[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], p[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{margin:0;padding:0}li[_ngcontent-%COMP%] > ol[_ngcontent-%COMP%], li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{margin-bottom:0}table[_ngcontent-%COMP%]{border-collapse:collapse;border-spacing:0}fieldset[_ngcontent-%COMP%]{min-width:1;border:0}button[_ngcontent-%COMP%]{outline:none;background:none;border:none}.page-wrapper[_ngcontent-%COMP%]{min-height:100vh}body[_ngcontent-%COMP%]{font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-size:14px}body[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-weight:400}h1[_ngcontent-%COMP%]{font-size:36px}h2[_ngcontent-%COMP%]{font-size:30px}h3[_ngcontent-%COMP%]{font-size:24px}h4[_ngcontent-%COMP%]{font-size:18px}h5[_ngcontent-%COMP%]{font-size:15px}h6[_ngcontent-%COMP%]{font-size:13px}.bg-blue[_ngcontent-%COMP%]{background:#fff}.p-t-100[_ngcontent-%COMP%]{padding-top:150px}.p-t-20[_ngcontent-%COMP%]{padding-top:120px}.p-b-100[_ngcontent-%COMP%]{padding-bottom:150px}.wrapper[_ngcontent-%COMP%]{margin:0 auto}.wrapper--w680[_ngcontent-%COMP%]{max-width:1000px}.btn[_ngcontent-%COMP%]{line-height:40px;display:inline-block;padding:0 25px;cursor:pointer;font-family:Roboto,Arial,Helvetica Neue,sans-serif;color:#ebfc00;transition:all .4s ease;font-size:14px;font-weight:700}.btn--radius[_ngcontent-%COMP%]{border-radius:3px}.btn--green[_ngcontent-%COMP%]{background:#050a04}.btn--green[_ngcontent-%COMP%]:hover{background:#0d0e0d}td.active[_ngcontent-%COMP%]{background-color:#1e1f20}input[type=date i][_ngcontent-%COMP%]{padding:14px}.table-condensed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-family:Roboto,Arial,Helvetica Neue,sans-serif;font-weight:400}.daterangepicker[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:40px;height:30px}.daterangepicker[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15);display:none;border:1px solid #e0e0e0;margin-top:5px}.daterangepicker[_ngcontent-%COMP%]:after, .daterangepicker[_ngcontent-%COMP%]:before{display:none}.daterangepicker[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 0}.daterangepicker[_ngcontent-%COMP%]   .table-condensed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:3px;font-size:14px;padding:5px;outline:none}input[_ngcontent-%COMP%]{outline:none;margin:0;border:none;box-shadow:none;width:120%;font-size:15px;font-family:inherit}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;border-bottom:2px solid #c9bcbc}.input-icon[_ngcontent-%COMP%]{position:absolute;font-size:18px;color:#e2d9d9;right:8px;top:50%;transform:translateY(-50%);cursor:pointer}.input--style-1[_ngcontent-%COMP%]{padding:9px 0;color:#666}.input--style-1[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#555}.input--style-1[_ngcontent-%COMP%]:-moz-placeholder, .input--style-1[_ngcontent-%COMP%]::-moz-placeholder{color:#555;opacity:1}.input--style-1[_ngcontent-%COMP%]:-ms-input-placeholder{color:#555}.select--no-search[_ngcontent-%COMP%]   .select2-search[_ngcontent-%COMP%]{display:none!important}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]{width:150%!important;outline:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]{outline:none;border:none;height:34px}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__rendered[_ngcontent-%COMP%]{line-height:34px;padding-left:0;color:#555}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]{height:32px;right:4px;display:flex;justify-content:center;align-items:center}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{display:none}.rs-select2[_ngcontent-%COMP%]   .select2-container[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{font-family:Material-Design-Iconic-Font;content:"\\f2f9";font-size:20px;color:#ccc;transition:all .4s ease}.rs-select2[_ngcontent-%COMP%]   .select2-container.select2-container--open[_ngcontent-%COMP%]   .select2-selection--single[_ngcontent-%COMP%]   .select2-selection__arrow[_ngcontent-%COMP%]:after{transform:rotate(-180deg)}.select2-container--open[_ngcontent-%COMP%]   .select2-dropdown--below[_ngcontent-%COMP%]{border-radius:3px;box-shadow:0 8px 20px 0 rgba(0,0,0,.15);border:1px solid #e0e0e0;margin-top:5px;overflow:hidden}.title[_ngcontent-%COMP%]{margin-bottom:30px}.card[_ngcontent-%COMP%]{overflow:hidden;border-radius:7px;background:rgba(14,11,11,.034)}.card-1[_ngcontent-%COMP%]{box-shadow:0 8px 20px 0 rgba(0,0,0,.15)}img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:5px 90px 80px}@media (max-width:767px){.right[_ngcontent-%COMP%]{width:100%}.card-1[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:40px}button[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{margin:2%}}']}),t})()},{path:"profil",component:(()=>{class t{constructor(t,e,n){this.d=t,this.fb=e,this.route=n,this.genre="",this.submitted=!1,this.ok=!1,this.prenom="",this.nom="",this.domaine="",this.sp="",this.niv="",this.coordinates={sfax:{lng:10.76028,lat:34.74056},tunis:{lng:10.16579,lat:36.81897},"ben arous":{lng:10.21889,lat:36.75306},beja:{lng:9.18169,lat:36.72564},sousse:{lng:10.63699,lat:35.82539},kef:{lng:8.70486,lat:36.17424}}}ngOnInit(){return Nm(this,void 0,void 0,function*(){"Chomeur"===this.d.getvalue()&&(this.ok=!0);var t=`{"email":"${this.d.getemail()}","statut":"${this.d.getvalue()}"}`;const e=yield fetch("http://127.0.0.1:8000/profil",{method:"POST",body:t,headers:{"Content-Type":"application/json"}});e.ok&&e.json().then(t=>{this.cord=t;var e=this.cord[0].adresse,n=this.coordinates[e].lat,i=this.coordinates[e].lng;if(console.log(n),this.mapinitialiser(i,n,e),document.getElementById("email").value=String(this.cord[0].email),document.getElementById("cemail").value=String(this.cord[0].email),document.getElementById("pwd").value=String(this.cord[0].password),document.getElementById("cpwd").value=String(this.cord[0].password),document.getElementById("prenom").value=String(this.cord[0].prenom),document.getElementById("nom").value=String(this.cord[0].nom),this.ok)var r="numcin_chomeur";else r="numcin_chef";document.getElementById("cin").value=String(this.cord[0][r]),document.getElementById("numtel").value=String(this.cord[0].numtel),document.getElementById("genre").value=String(this.cord[0].sexe),document.getElementById("dn").value=String(this.cord[0].datedenaissance),document.getElementById("domaine").value=String(this.cord[0].domaine_travail),document.getElementById("nom_buis").value=String(this.cord[0].nom_buisness),document.getElementById("worktel").value=String(this.cord[0].numtel_travail),document.getElementById("reg-select").value=String(this.cord[0].adresse),document.getElementById("niv-select").value=String(this.cord[0].niveau_education),document.getElementById("i2").value=String(this.cord[0].specialite),document.getElementById("text").value=String(this.cord[0].ajouter)}),this.form=this.fb.group({lastname:["",ku.required],firstname:["",ku.required],cin:["",[ku.pattern("[0-9]{8}"),ku.required]],tel:["",[ku.pattern("[0-9]{8}"),ku.required]],email:["",[ku.required,ku.email]],password:["",[ku.minLength(6),ku.required]],cemail:["",ku.required],cpass:["",ku.required]},{validator:[Y_("email","cemail"),Y_("password","cpass")]})})}getmap(t){}mapinitialiser(t,e,i){var r=n("4ZJM");r.accessToken="pk.eyJ1IjoiYmFoYWVkZGluZTEyMyIsImEiOiJja251ZXluOWcwY2I3Mnduam5xdmt1aGZ1In0.s3Pu_B4CTjaLJQlodzbvAg";var s=new r.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[t,e],zoom:10}),o=new Jm.a({accessToken:r.accessToken,placeholder:i,mapboxgl:r,marker:!1});s.addControl(o),s.addControl(new r.NavigationControl),o.on("result",function(t){s.getSource("single-point").setData(t.result.geometry)}),s.on("click",t=>{this.d.address=JSON.stringify(t.lngLat);var e=document.createElement("div");e.className="marker",e.style.height="50px",e.style.width="50px",e.style.backgroundImage="url(/assets/img/marker.png)",e.style.backgroundSize="100%",new r.Marker(e).setLngLat(t.lngLat).addTo(s)})}get f(){return this.form.controls}onSubmit(){return Nm(this,void 0,void 0,function*(){this.submitted=!0;var t=document.getElementById("nom").value,e=document.getElementById("prenom").value,n=document.getElementById("cin").value,i=document.getElementById("numtel").value,r=document.getElementById("email").value,s=document.getElementById("pwd").value,o=document.getElementById("dn").value,a=this.genre,l=this.domaine;if(this.ok)var c=document.getElementById("nom_buis").value,u=document.getElementById("worktel").value,h=this.niv,d=document.getElementById("text").value,p=this.sp;var f=this.region,m=this.d.getemail();if(this.ok)var g=`{"statut":"chomeur","anc_email":"${m}","nom":"${t}","prenom":"${e}","cin":"${n}","numtel":"${i}","email":"${r}","password":"${s}","gender":"${a}","dn":"${o}","domaine":"${l}","nom_buisness":"${c}","tel_travail":"${u}","niveau":"${h}","ajouter":"${d}","adresse":"${f}","specialite":"${p}"}`;else g=`{"statut":"chef","anc_email":"${m}","nom":"${t}","prenom":"${e}","cin":"${n}","numtel":"${i}","email":"${r}","password":"${s}","gender":"${a}","dn":"${o}","domaine":"${l}","adresse":"${f}"}`;alert(g);const _=yield fetch("http://127.0.0.1:8000/update",{method:"POST",body:g,headers:{"Content-Type":"application/json"}});_.ok&&(_.json().then(t=>{console.log(t)}),this.route.navigateByUrl("/consultation-chef"))})}}return t.\u0275fac=function(e){return new(e||t)(Ns(Vm),Ns(Wh),Ns(mm))},t.\u0275cmp=jt({type:t,selectors:[["app-profil"]],decls:173,vars:44,consts:[[1,"navbar","navbar-expand-lg","navbar-dark",2,"background-color","#000000"],[1,"logo"],["src","assets/img/LOGOo (1).png","alt","","width","80%"],[1,"container"],[1,"container-fluid"],[1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","href","/accueil",1,"nav-link"],["href","/information",1,"nav-link"],["href","/contact",1,"nav-link"],[1,"wrapper"],[1,"card","shadow-nohover"],[1,"card-title",2,"color","rgb(19, 19, 17)","text-align","center"],["formGroup","form"],[1,"row","row-space"],[1,"col-lg-4","col-sm-12"],[1,"input-group"],["type","email","placeholder","Email","ng-model","12email","id","email","formControlName","email","name","mail",1,"input--style-1",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","email","placeholder","Confirmer Email","id","cemail","formControlName","cemail","match","12email","name","cmail",1,"input--style-1",3,"ngClass"],["type","password","formControlName","password","placeholder","Mot de Passe","id","pwd","name","mdp",1,"input--style-1",3,"ngClass"],["type","password","formControlName","cpass","placeholder","Confirmer Mot de Passe","name","cmdp","id","cpwd",1,"input--style-1",3,"ngClass"],[1,"card-title",2,"color","rgb(8, 8, 4)","text-align","center"],["type","text","placeholder","Nom","name","nom","id","nom","formControlName","lastname",1,"input--style-1",3,"ngClass"],["type","text","placeholder","Prenom","id","prenom","formControlName","firstname","name","prenom",1,"input--style-1",3,"ngClass"],["type","text","placeholder","CIN","formControlName","cin","id","cin","name","cin",1,"input--style-1",3,"ngClass"],["type","tel","placeholder","N\xb0 Telephone","id","numtel","formControlName","tel","name","numtel",1,"input--style-1",3,"ngClass"],["for","genre"],["name","gender","id","genre",3,"ngModel","ngModelOptions","ngModelChange"],["disabled","disabled","selected","selected"],[1,"select-dropdown"],["type","date","placeholder","Date de Naissance","id","dn","name","birthday",1,"input--style-1","js-datepicker"],[1,"zmdi","zmdi-calendar-note","input-icon","js-btn-calendar"],["type","text","placeholder","Nom Buisness","name","nomB","id","nom_buis",1,"input--style-1"],["for","domaine"],["id","domaine","name","Domaine",3,"ngModel","ngModelOptions","ngModelChange"],["value","Medecine"],["value","Architecture"],["value","Agriculture"],["value","Commerce"],["value","Informatique"],["value","M\xe9canique"],["value","El\xe9ctronique"],["value","Industrie"],["value","secr\xe9tariat"],["value","Transport"],["type","tel","placeholder","N\xb0 Telephone (Travail)","name","numteltravail","id","worktel",1,"input--style-1"],["for","reg-select"],["name","region","id","reg-select",3,"ngModel","ngModelOptions","ngModelChange","change"],["value","tunis"],["value","sousse"],["value","sfax"],["value","ben arous"],["value","beja"],["value","kef"],[4,"ngIf"],["id","map",1,"map"],["type","button",1,"btn","btn-primary",3,"click"],[1,"invalid-feedback"],["for","niv-select"],["name","Niveau Education","id","niv-select",3,"ngModel","ngModelOptions","ngModelChange"],["value","secondaire"],["value","baccalaur\xe9at"],["value","license"],["value","master"],["value","doctorat"],["for","i2"],["id","i2","name","Sp\xe9cialit\xe9",3,"ngModel","ngModelOptions","ngModelChange"],["label","Medecine"],["value","infirmerie"],["value","chirurgie"],["value","g\xe9n\xe9rale"],["value","neuro"],["value","pediathrie"],["value","psychiatrie"],["label","Informatique"],["value","DevWeb"],["value","DevMob"],["value","webdesign"],["value","cybersecurit\xe9"],["value","webanalytique"],["value","r\xe9seau"],["value","multimedia"],["label","Industrie"],["value","chaudronnerie"],["value","tuyauterie"],["value","maintenance"],["label","El\xe9ctronique"],["value","puissance"],["value","analogique"],["value","num\xe9rique"],["value","organique"],["value","quantique"],["label","secr\xe9tariat"],["value","seccomptable"],["value","secjuridique"],["value","secadmin"],["value","secmedical"],["label","Transport"],["value","taxi"],["value","ambulancier"],["value","livreur"],["value","offmarine"],["value","battelier"],["value","bus"],["value","d\xe9m\xe9nageur"],["label","Architecture"],["value","interieur"],["value","urbain"],["value","paysagiste"],[1,"row"],["for","text"],["name","","id","text","cols","100","rows","10"]],template:function(t,e){1&t&&(js(0,"nav",0),js(1,"div",1),$s(2,"img",2),qs(),js(3,"div",3),js(4,"p"),vo(5,"Dream Job"),qs(),qs(),js(6,"div",4),js(7,"div",5),js(8,"ul",6),js(9,"li",7),js(10,"a",8),vo(11,"Accueil"),qs(),qs(),js(12,"li",7),js(13,"a",9),vo(14,"information"),qs(),qs(),js(15,"li",7),js(16,"a",10),vo(17,"Contact"),qs(),qs(),qs(),qs(),qs(),qs(),js(18,"body"),js(19,"div",11),$s(20,"br"),$s(21,"br"),$s(22,"br"),$s(23,"br"),$s(24,"br"),js(25,"h1"),vo(26),qs(),js(27,"div",12),js(28,"div",13),js(29,"h1"),vo(30,"Identifiants du compte"),qs(),qs(),$s(31,"br"),$s(32,"br"),js(33,"form",14),js(34,"div",15),js(35,"div",16),js(36,"div",17),$s(37,"input",18),Bs(38,My,2,1,"div",19),qs(),qs(),js(39,"div",16),js(40,"div",17),$s(41,"input",20),Bs(42,Py,3,2,"div",19),qs(),qs(),qs(),js(43,"div",15),js(44,"div",16),js(45,"div",17),$s(46,"input",21),Bs(47,zy,3,2,"div",19),qs(),qs(),js(48,"div",16),js(49,"div",17),$s(50,"input",22),Bs(51,Ly,3,2,"div",19),qs(),qs(),qs(),qs(),qs(),$s(52,"br"),$s(53,"br"),js(54,"div",12),js(55,"div",23),js(56,"h1"),vo(57,"Informations Personnelles "),qs(),qs(),$s(58,"br"),$s(59,"br"),js(60,"form",14),js(61,"div",15),js(62,"div",16),js(63,"div",17),$s(64,"input",24),Bs(65,By,2,1,"div",19),qs(),qs(),js(66,"div",16),js(67,"div",17),$s(68,"input",25),Bs(69,Vy,2,1,"div",19),qs(),qs(),qs(),js(70,"div",15),js(71,"div",16),js(72,"div",17),$s(73,"input",26),Bs(74,qy,3,2,"div",19),qs(),qs(),js(75,"div",16),js(76,"div",17),$s(77,"input",27),Bs(78,Zy,3,2,"div",19),qs(),qs(),qs(),js(79,"div",15),js(80,"div",16),js(81,"label",28),js(82,"h5"),vo(83,"-- Votre Sexe -- "),qs(),js(84,"select",29),Ws("ngModelChange",function(t){return e.genre=t}),js(85,"option",30),vo(86,"Sexe "),qs(),js(87,"option"),vo(88,"Homme"),qs(),js(89,"option"),vo(90,"Femme"),qs(),qs(),qs(),$s(91,"div",31),qs(),js(92,"div",16),$s(93,"br"),js(94,"div",17),$s(95,"input",32),$s(96,"i",33),qs(),qs(),qs(),qs(),qs(),$s(97,"br"),$s(98,"br"),js(99,"div",12),js(100,"div",23),js(101,"h1"),vo(102,"D\xe9tails Suppl\xe9mentaires "),qs(),qs(),$s(103,"br"),$s(104,"br"),js(105,"form"),js(106,"div",15),js(107,"div",16),$s(108,"br"),js(109,"div",17),$s(110,"input",34),qs(),qs(),js(111,"div",16),js(112,"label",35),js(113,"h5"),vo(114,"-- Votre Domaine -- "),qs(),js(115,"select",36),Ws("ngModelChange",function(t){return e.domaine=t}),js(116,"option",30),vo(117,"Domaine "),qs(),js(118,"option",37),vo(119,"M\xe9decine"),qs(),js(120,"option",38),vo(121,"Architecture"),qs(),js(122,"option",39),vo(123,"Agriculture"),qs(),js(124,"option",40),vo(125,"Commerce"),qs(),js(126,"option",41),vo(127,"Informatique"),qs(),js(128,"option",42),vo(129,"M\xe9canique"),qs(),js(130,"option",43),vo(131,"El\xe9ctronique"),qs(),js(132,"option",44),vo(133,"Industrie"),qs(),js(134,"option",45),vo(135,"secr\xe9tariat"),qs(),js(136,"option",46),vo(137,"Transport"),qs(),qs(),qs(),$s(138,"div",31),qs(),qs(),$s(139,"br"),js(140,"div",15),js(141,"div",16),$s(142,"br"),js(143,"div",17),$s(144,"input",47),qs(),qs(),js(145,"div",16),js(146,"label",48),js(147,"h5"),vo(148,"-- Votre region -- "),qs(),js(149,"select",49),Ws("ngModelChange",function(t){return e.region=t})("change",function(t){return e.getmap(t.target.value)}),js(150,"option",50),vo(151,"Tunis"),qs(),js(152,"option",51),vo(153,"Sousse"),qs(),js(154,"option",52),vo(155,"Sfax"),qs(),js(156,"option",53),vo(157,"Ben arous"),qs(),js(158,"option",54),vo(159,"Beja"),qs(),js(160,"option",55),vo(161,"Kef"),qs(),qs(),qs(),$s(162,"div",31),qs(),qs(),$s(163,"br"),Bs(164,Wy,116,6,"div",56),$s(165,"div",57),$s(166,"br"),$s(167,"br"),js(168,"button",58),Ws("click",function(){return e.onSubmit()}),vo(169,"Valider "),qs(),$s(170,"br"),qs(),qs(),$s(171,"br"),$s(172,"br"),qs(),qs()),2&t&&(pr(26),bo("Salut ",e.nom," ",e.prenom," !"),pr(11),Vs("ngClass",Ga(25,Xy,e.submitted&&e.f.email.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.email.errors),pr(3),Vs("ngClass",Ga(27,Xy,e.submitted&&e.f.cemail.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cemail.errors),pr(4),Vs("ngClass",Ga(29,Xy,e.submitted&&e.f.password.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.password.errors),pr(3),Vs("ngClass",Ga(31,Xy,e.submitted&&e.f.cpass.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cpass.errors),pr(13),Vs("ngClass",Ga(33,Xy,e.submitted&&e.f.lastname.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.lastname.errors),pr(3),Vs("ngClass",Ga(35,Xy,e.submitted&&e.f.firstname.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.firstname.errors),pr(4),Vs("ngClass",Ga(37,Xy,e.submitted&&e.f.cin.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.cin.errors),pr(3),Vs("ngClass",Ga(39,Xy,e.submitted&&e.f.tel.errors)),pr(1),Vs("ngIf",e.submitted&&e.f.tel.errors),pr(6),Vs("ngModel",e.genre)("ngModelOptions",$a(41,Hy)),pr(31),Vs("ngModel",e.domaine)("ngModelOptions",$a(42,Hy)),pr(34),Vs("ngModel",e.region)("ngModelOptions",$a(43,Hy)),pr(15),Vs("ngIf",e.ok))},directives:[x_,Mh,Xu,Dh,Cu,Wu,Lh,Ic,Rc,Nh,Th,Vh,$h,Ch],styles:["body[_ngcontent-%COMP%]{background-image:url(/assets/img/profil2.jpg);background-repeat:no-repeat;background-size:cover}.nav-link[_ngcontent-%COMP%]{font-weight:bolder;font-size:large}.logo[_ngcontent-%COMP%]{width:20%;padding-left:200px}.nav-item[_ngcontent-%COMP%]{display:inline;padding-right:120px}.container[_ngcontent-%COMP%]{width:15%;color:#ddd;text-align:center;font-weight:700;font-size:xx-large;margin-right:17%}.container-fluid[_ngcontent-%COMP%]{width:70%;text-align:center}.wrapper[_ngcontent-%COMP%]{width:60%;margin:auto}#map[_ngcontent-%COMP%]{height:200px;width:500px}input[_ngcontent-%COMP%]{outline:none;margin:0;border:2px solid #000;box-shadow:none;width:150%;font-size:15px;font-family:inherit;border-radius:6px}.btn[_ngcontent-%COMP%]{line-height:40px;display:inline-block;padding:0 25px;border-radius:4px;cursor:pointer;font-family:Roboto,Arial,Helvetica Neue,sans-serif;transition:all .4s ease;font-size:20px;font-weight:700;margin-left:25%;width:150px}.input--style-1[_ngcontent-%COMP%]{padding:2px 0;color:#666}select[_ngcontent-%COMP%]{padding:1px 12px;margin:0 20px;border:2px solid #0f0f0f;width:80%;height:60%;font-size:small;overflow:hidden;background-color:#706d6d;background:#fffcfc;position:relative;color:#000}.input--style-1[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#555}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.card[_ngcontent-%COMP%]{border-radius:5px}.shadow-nohover[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px rgba(99,98,98,.979),0 4px 5px 0 rgba(94,93,93,.959),0 1px 10px 0 rgba(70,68,68,.904);transition:box-shadow .28s cubic-bezier(.4,0,.2,1)}.left[_ngcontent-%COMP%]{left:10px;background-color:#0c0c0b}.left[_ngcontent-%COMP%], .right[_ngcontent-%COMP%]{width:49%;position:absolute}.right[_ngcontent-%COMP%]{right:10px;background-color:#c2c20d}form[_ngcontent-%COMP%]{margin-left:25%}"]}),t})()}];let Qy=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({imports:[[Pm.forRoot(Ky),Zh,Hh],Pm]}),t})(),Yy=(()=>{class t{constructor(){this.title="testprojet"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=jt({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&$s(0,"router-outlet")},directives:[xm],styles:[""]}),t})();class Jy{}const tv="*";function ev(t,e=null){return{type:2,steps:t,options:e}}function nv(t){return{type:6,styles:t,offset:null}}function iv(t){Promise.resolve(null).then(t)}class rv{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){iv(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class sv{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,i=0;const r=this.players.length;0==r?iv(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==r&&this._onFinish()}),t.onDestroy(()=>{++n==r&&this._onDestroy()}),t.onStart(()=>{++i==r&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){const t=this.players.reduce((t,e)=>null===t||e.totalTime>t.totalTime?e:t,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function ov(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function av(t){switch(t.length){case 0:return new rv;case 1:return t[0];default:return new sv(t)}}function lv(t,e,n,i,r={},s={}){const o=[],a=[];let l=-1,c=null;if(i.forEach(t=>{const n=t.offset,i=n==l,u=i&&c||{};Object.keys(t).forEach(n=>{let i=n,a=t[n];if("offset"!==n)switch(i=e.normalizePropertyName(i,o),a){case"!":a=r[n];break;case tv:a=s[n];break;default:a=e.normalizeStyleValue(n,i,a,o)}u[i]=a}),i||a.push(u),c=u,l=n}),o.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${o.join(t)}`)}return a}function cv(t,e,n,i){switch(e){case"start":t.onStart(()=>i(n&&uv(n,"start",t)));break;case"done":t.onDone(()=>i(n&&uv(n,"done",t)));break;case"destroy":t.onDestroy(()=>i(n&&uv(n,"destroy",t)))}}function uv(t,e,n){const i=n.totalTime,r=hv(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==i?t.totalTime:i,!!n.disabled),s=t._data;return null!=s&&(r._data=s),r}function hv(t,e,n,i,r="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function dv(t,e,n){let i;return t instanceof Map?(i=t.get(e),i||t.set(e,i=n)):(i=t[e],i||(i=t[e]=n)),i}function pv(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let fv=(t,e)=>!1,mv=(t,e)=>!1,gv=(t,e,n)=>[];const _v=ov();(_v||"undefined"!=typeof Element)&&(fv=(t,e)=>t.contains(e),mv=(()=>{if(_v||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):mv}})(),gv=(t,e,n)=>{let i=[];if(n){const n=t.querySelectorAll(e);for(let t=0;t<n.length;t++)i.push(n[t])}else{const n=t.querySelector(e);n&&i.push(n)}return i});let yv=null,vv=!1;function xv(t){yv||(yv=("undefined"!=typeof document?document.body:null)||{},vv=!!yv.style&&"WebkitAppearance"in yv.style);let e=!0;return yv.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in yv.style,!e&&vv)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in yv.style),e}const bv=mv,wv=fv,Cv=gv;function Ev(t){const e={};return Object.keys(t).forEach(n=>{const i=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[i]=t[n]}),e}let Sv=(()=>{class t{validateStyleProperty(t){return xv(t)}matchesElement(t,e){return bv(t,e)}containsElement(t,e){return wv(t,e)}query(t,e,n){return Cv(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,i,r,s=[],o){return new rv(n,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})(),Tv=(()=>{class t{}return t.NOOP=new Sv,t})();const Mv="ng-enter",Av="ng-leave",kv="ng-trigger",Pv=".ng-trigger",Iv="ng-animating",Ov=".ng-animating";function zv(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Dv(parseFloat(e[1]),e[2])}function Dv(t,e){switch(e){case"s":return 1e3*t;default:return t}}function Rv(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let i,r=0,s="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};i=Dv(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(r=Dv(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else i=t;if(!n){let n=!1,s=e.length;i<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),r<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(s,0,`The provided timing value "${t}" is invalid.`)}return{duration:i,delay:r,easing:s}}(t,e,n)}function Lv(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function Fv(t,e,n={}){if(e)for(let i in t)n[i]=t[i];else Lv(t,n);return n}function Bv(t,e,n){return n?e+":"+n+";":""}function Nv(t){let e="";for(let n=0;n<t.style.length;n++){const i=t.style.item(n);e+=Bv(0,i,t.style.getPropertyValue(i))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=Bv(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function Vv(t,e,n){t.style&&(Object.keys(e).forEach(i=>{const r=Wv(i);n&&!n.hasOwnProperty(i)&&(n[i]=t.style[r]),t.style[r]=e[i]}),ov()&&Nv(t))}function Uv(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=Wv(e);t.style[n]=""}),ov()&&Nv(t))}function jv(t){return Array.isArray(t)?1==t.length?t[0]:ev(t):t}const qv=new RegExp("{{\\s*(.+?)\\s*}}","g");function $v(t){let e=[];if("string"==typeof t){let n;for(;n=qv.exec(t);)e.push(n[1]);qv.lastIndex=0}return e}function Gv(t,e,n){const i=t.toString(),r=i.replace(qv,(t,i)=>{let r=e[i];return e.hasOwnProperty(i)||(n.push(`Please provide a value for the animation param ${i}`),r=""),r.toString()});return r==i?t:r}function Zv(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const Hv=/-+([a-z0-9])/g;function Wv(t){return t.replace(Hv,(...t)=>t[1].toUpperCase())}function Xv(t,e){return 0===t||0===e}function Kv(t,e,n){const i=Object.keys(n);if(i.length&&e.length){let s=e[0],o=[];if(i.forEach(t=>{s.hasOwnProperty(t)||o.push(t),s[t]=n[t]}),o.length)for(var r=1;r<e.length;r++){let n=e[r];o.forEach(function(e){n[e]=Yv(t,e)})}}return e}function Qv(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function Yv(t,e){return window.getComputedStyle(t)[e]}const Jv="*";function tx(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const i=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof i)return void e.push(i);t=i}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const r=i[1],s=i[2],o=i[3];e.push(ix(r,o)),"<"!=s[0]||r==Jv&&o==Jv||e.push(ix(o,r))}(t,n,e)):n.push(t),n}const ex=new Set(["true","1"]),nx=new Set(["false","0"]);function ix(t,e){const n=ex.has(t)||nx.has(t),i=ex.has(e)||nx.has(e);return(r,s)=>{let o=t==Jv||t==r,a=e==Jv||e==s;return!o&&n&&"boolean"==typeof r&&(o=r?ex.has(t):nx.has(t)),!a&&i&&"boolean"==typeof s&&(a=s?ex.has(e):nx.has(e)),o&&a}}const rx=new RegExp("s*:selfs*,?","g");function sx(t,e,n){return new ox(t).build(e,n)}class ox{constructor(t){this._driver=t}build(t,e){const n=new ax(e);return this._resetContextStyleTimingState(n),Qv(this,jv(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,i=e.depCount=0;const r=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,i=n.name;i.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,r.push(this.visitState(n,e))}),n.name=i}else if(1==t.type){const r=this.visitTransition(t,e);n+=r.queryCount,i+=r.depCount,s.push(r)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:r,transitions:s,queryCount:n,depCount:i,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),i=t.options&&t.options.params||null;if(n.containsDynamicStyles){const r=new Set,s=i||{};if(n.styles.forEach(t=>{if(lx(t)){const e=t;Object.keys(e).forEach(t=>{$v(e[t]).forEach(t=>{s.hasOwnProperty(t)||r.add(t)})})}}),r.size){const n=Zv(r.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:i?{params:i}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Qv(this,jv(t.animation),e);return{type:1,matchers:tx(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:cx(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>Qv(this,t,e)),options:cx(t.options)}}visitGroup(t,e){const n=e.currentTime;let i=0;const r=t.steps.map(t=>{e.currentTime=n;const r=Qv(this,t,e);return i=Math.max(i,e.currentTime),r});return e.currentTime=i,{type:3,steps:r,options:cx(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return ux(Rv(t,e).duration,0,"");const i=t;if(i.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=ux(0,0,"");return t.dynamic=!0,t.strValue=i,t}return n=n||Rv(i,e),ux(n.duration,n.delay,n.easing)}(t.timings,e.errors);let i;e.currentAnimateTimings=n;let r=t.styles?t.styles:nv({});if(5==r.type)i=this.visitKeyframes(r,e);else{let r=t.styles,s=!1;if(!r){s=!0;const t={};n.easing&&(t.easing=n.easing),r=nv(t)}e.currentTime+=n.duration+n.delay;const o=this.visitStyle(r,e);o.isEmptyStep=s,i=o}return e.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==tv?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let i=!1,r=null;return n.forEach(t=>{if(lx(t)){const e=t,n=e.easing;if(n&&(r=n,delete e.easing),!i)for(let t in e)if(e[t].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:n,easing:r,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let i=e.currentTime,r=e.currentTime;n&&r>0&&(r-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=e.collectedStyles[e.currentQuerySelector],o=s[n];let a=!0;o&&(r!=i&&r>=o.startTime&&i<=o.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${r}ms" and "${i}ms"`),a=!1),r=o.startTime),a&&(s[n]={startTime:r,endTime:i}),e.options&&function(t,e,n){const i=e.params||{},r=$v(t);r.length&&r.forEach(t=>{i.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let i=0;const r=[];let s=!1,o=!1,a=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(lx(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(lx(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),c=0;return null!=l&&(i++,c=n.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,r.push(c),n});o&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&e.errors.push("Please ensure that all keyframe offsets are in order");const c=t.steps.length;let u=0;i>0&&i<c?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(u=1/(c-1));const h=c-1,d=e.currentTime,p=e.currentAnimateTimings,f=p.duration;return l.forEach((t,i)=>{const s=u>0?i==h?1:u*i:r[i],o=s*f;e.currentTime=d+p.delay+o,p.duration=o,this._validateStyleAst(t,e),t.offset=s,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:Qv(this,jv(t.animation),e),options:cx(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:cx(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:cx(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,i=t.options||{};e.queryCount++,e.currentQuery=t;const[r,s]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(rx,"")),[t=t.replace(/@\*/g,Pv).replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,Ov),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+r:r,dv(e.collectedStyles,e.currentQuerySelector,{});const o=Qv(this,jv(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:r,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:o,originalSelector:t.selector,options:cx(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:Rv(t.timings,e.errors,!0);return{type:12,animation:Qv(this,jv(t.animation),e),timings:n,options:null}}}class ax{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function lx(t){return!Array.isArray(t)&&"object"==typeof t}function cx(t){var e;return t?(t=Lv(t)).params&&(t.params=(e=t.params)?Lv(e):null):t={},t}function ux(t,e,n){return{duration:t,delay:e,easing:n}}function hx(t,e,n,i,r,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class dx{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const px=new RegExp(":enter","g"),fx=new RegExp(":leave","g");function mx(t,e,n,i,r,s={},o={},a,l,c=[]){return(new gx).buildKeyframes(t,e,n,i,r,s,o,a,l,c)}class gx{buildKeyframes(t,e,n,i,r,s,o,a,l,c=[]){l=l||new dx;const u=new yx(t,e,l,i,r,c,[]);u.options=a,u.currentTimeline.setStyles([s],null,u.errors,a),Qv(this,n,u);const h=u.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(o).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([o],null,u.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[hx(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const i=e.createSubContext(t.options),r=e.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);r!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let i=e.currentTimeline.currentTime;const r=null!=n.duration?zv(n.duration):null,s=null!=n.delay?zv(n.delay):null;return 0!==r&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,r,s);i=Math.max(i,n.duration+n.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Qv(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let i=e;const r=t.options;if(r&&(r.params||r.delay)&&(i=e.createSubContext(r),i.transformIntoNewTimeline(),null!=r.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=_x);const t=zv(r.delay);i.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>Qv(this,t,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let i=e.currentTimeline.currentTime;const r=t.options&&t.options.delay?zv(t.options.delay):0;t.steps.forEach(s=>{const o=e.createSubContext(t.options);r&&o.delayNextStep(r),Qv(this,s,o),i=Math.max(i,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(i),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return Rv(e.params?Gv(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),i=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),i.snapshotCurrentStyles());const r=t.style;5==r.type?this.visitKeyframes(r,e):(e.incrementTime(n.duration),this.visitStyle(r,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,i=e.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();const r=i&&i.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(r):n.setStyles(t.styles,r,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,i=e.currentTimeline.duration,r=n.duration,s=e.createSubContext().currentTimeline;s.easing=n.easing,t.styles.forEach(t=>{s.forwardTime((t.offset||0)*r),s.setStyles(t.styles,t.easing,e.errors,e.options),s.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(s),e.transformIntoNewTimeline(i+r),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,i=t.options||{},r=i.delay?zv(i.delay):0;r&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=_x);let s=n;const o=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=o.length;let a=null;o.forEach((n,i)=>{e.currentQueryIndex=i;const o=e.createSubContext(t.options,n);r&&o.delayNextStep(r),n===e.element&&(a=o.currentTimeline),Qv(this,t.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,i=e.currentTimeline,r=t.timings,s=Math.abs(r.duration),o=s*(e.currentQueryTotal-1);let a=s*e.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=e.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;Qv(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=i.currentTime-c+(i.startTime-n.currentTimeline.startTime)}}const _x={};class yx{constructor(t,e,n,i,r,s,o,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=r,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=_x,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new vx(this._driver,e,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let i=this.options;null!=n.duration&&(i.duration=zv(n.duration)),null!=n.delay&&(i.delay=zv(n.delay));const r=n.params;if(r){let t=i.params;t||(t=this.options.params={}),Object.keys(r).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=Gv(r[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const i=e||this.element,r=new yx(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(t),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(t){return this.previousNode=_x,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const i={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},r=new xx(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(r),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,i,r,s){let o=[];if(i&&o.push(this.element),t.length>0){t=(t=t.replace(px,"."+this._enterClassName)).replace(fx,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),o.push(...e)}return r||0!=o.length||s.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),o}}class vx{constructor(t,e,n,i){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new vx(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||tv,this._currentKeyframe[t]=tv}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,i){e&&(this._previousKeyframe.easing=e);const r=i&&i.params||{},s=function(t,e){const n={};let i;return t.forEach(t=>{"*"===t?(i=i||Object.keys(e),i.forEach(t=>{n[t]=tv})):Fv(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(s).forEach(t=>{const e=Gv(s[t],r,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:tv),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],i=t._styleSummary[e];(!n||i.time>n.time)&&this._updateStyle(e,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((r,s)=>{const o=Fv(r,!0);Object.keys(o).forEach(n=>{const i=o[n];"!"==i?t.add(n):i==tv&&e.add(n)}),n||(o.offset=s/this.duration),i.push(o)});const r=t.size?Zv(t.values()):[],s=e.size?Zv(e.values()):[];if(n){const t=i[0],e=Lv(t);t.offset=0,e.offset=1,i=[t,e]}return hx(this.element,i,r,s,this.duration,this.startTime,this.easing,!1)}}class xx extends vx{constructor(t,e,n,i,r,s,o=!1){super(t,e,s.delay),this.element=e,this.keyframes=n,this.preStyleProps=i,this.postStyleProps=r,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const r=[],s=n+e,o=e/s,a=Fv(t[0],!1);a.offset=0,r.push(a);const l=Fv(t[0],!1);l.offset=bx(o),r.push(l);const c=t.length-1;for(let i=1;i<=c;i++){let o=Fv(t[i],!1);o.offset=bx((e+o.offset*n)/s),r.push(o)}n=s,e=0,i="",t=r}return hx(this.element,t,this.preStyleProps,this.postStyleProps,n,e,i,!0)}}function bx(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class wx{}class Cx extends wx{normalizePropertyName(t,e){return Wv(t)}normalizeStyleValue(t,e,n,i){let r="";const s=n.toString().trim();if(Ex[e]&&0!==n&&"0"!==n)if("number"==typeof n)r="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&i.push(`Please provide a CSS unit value for ${t}:${n}`)}return s+r}}const Ex=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Sx(t,e,n,i,r,s,o,a,l,c,u,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const Tx={};class Mx{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,i){return function(t,e,n,i,r){return t.some(t=>t(e,n,i,r))}(this.ast.matchers,t,e,n,i)}buildStyles(t,e,n){const i=this._stateStyles["*"],r=this._stateStyles[t],s=i?i.buildStyles(e,n):{};return r?r.buildStyles(e,n):s}build(t,e,n,i,r,s,o,a,l,c){const u=[],h=this.ast.options&&this.ast.options.params||Tx,d=this.buildStyles(n,o&&o.params||Tx,u),p=a&&a.params||Tx,f=this.buildStyles(i,p,u),m=new Set,g=new Map,_=new Map,y="void"===i,v={params:Object.assign(Object.assign({},h),p)},x=c?[]:mx(t,e,this.ast.animation,r,s,d,f,v,l,u);let b=0;if(x.forEach(t=>{b=Math.max(t.duration+t.delay,b)}),u.length)return Sx(e,this._triggerName,n,i,y,d,f,[],[],g,_,b,u);x.forEach(t=>{const n=t.element,i=dv(g,n,{});t.preStyleProps.forEach(t=>i[t]=!0);const r=dv(_,n,{});t.postStyleProps.forEach(t=>r[t]=!0),n!==e&&m.add(n)});const w=Zv(m.values());return Sx(e,this._triggerName,n,i,y,d,f,x,w,g,_,b)}}class Ax{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},i=Lv(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(i[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const r=t;Object.keys(r).forEach(t=>{let s=r[t];s.length>1&&(s=Gv(s,i,e)),n[t]=s})}}),n}}class kx{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new Ax(t.style,t.options&&t.options.params||{})}),Px(this.states,"true","1"),Px(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new Mx(t,e,this.states))}),this.fallbackTransition=new Mx(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,i){return this.transitionFactories.find(r=>r.match(t,e,n,i))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function Px(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const Ix=new dx;class Ox{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],i=sx(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=i}_buildPlayer(t,e,n){const i=t.element,r=lv(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(i,r,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const i=[],r=this._animations[t];let s;const o=new Map;if(r?(s=mx(this._driver,e,r,Mv,Av,{},{},n,Ix,i),s.forEach(t=>{const e=dv(o,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(i.push("The requested animation doesn't exist or has already been destroyed"),s=[]),i.length)throw new Error(`Unable to create the animation due to the following errors: ${i.join("\n")}`);o.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,tv)})});const a=av(s.map(t=>{const e=o.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,i){const r=hv(e,"","","");return cv(this._getPlayer(t),n,r,i),()=>{}}command(t,e,n,i){if("register"==n)return void this.register(t,i[0]);if("create"==n)return void this.create(t,e,i[0]||{});const r=this._getPlayer(t);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const zx="ng-animate-queued",Dx="ng-animate-disabled",Rx=".ng-animate-disabled",Lx=[],Fx={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Bx={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class Nx{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(i=n?t.value:t)?i:null,n){const e=Lv(t);delete e.value,this.options=e}else this.options={};var i;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const Vx="void",Ux=new Nx(Vx);class jx{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Xx(e,this._hostClassName)}listen(t,e,n,i){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(r=n)&&"done"!=r)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var r;const s=dv(this._elementListeners,t,[]),o={name:e,phase:n,callback:i};s.push(o);const a=dv(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(Xx(t,kv),Xx(t,"ng-trigger-"+e),a[e]=Ux),()=>{this._engine.afterFlush(()=>{const t=s.indexOf(o);t>=0&&s.splice(t,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,i=!0){const r=this._getTrigger(e),s=new $x(this.id,e,t);let o=this._engine.statesByElement.get(t);o||(Xx(t,kv),Xx(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,o={}));let a=o[e];const l=new Nx(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[e]=l,a||(a=Ux),l.value!==Vx&&a.value===l.value){if(!function(t,e){const n=Object.keys(t),i=Object.keys(e);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(!e.hasOwnProperty(i)||t[i]!==e[i])return!1}return!0}(a.params,l.params)){const e=[],n=r.matchStyles(a.value,a.params,e),i=r.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{Uv(t,n),Vv(t,i)})}return}const c=dv(this._engine.playersByElement,t,[]);c.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let u=r.matchTransition(a.value,l.value,t,l.params),h=!1;if(!u){if(!i)return;u=r.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:u,fromState:a,toState:l,player:s,isFallbackTransition:h}),h||(Xx(t,zx),s.onStart(()=>{Kx(t,zx)})),s.onDone(()=>{let e=this.players.indexOf(s);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(s);t>=0&&n.splice(t,1)}}),this.players.push(s),c.push(s),s}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,Pv,!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,i){const r=this._engine.statesByElement.get(t);if(r){const s=[];if(Object.keys(r).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,Vx,i);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&av(s).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const i=new Set;e.forEach(e=>{const r=e.name;if(i.has(r))return;i.add(r);const s=this._triggers[r].fallbackTransition,o=n[r]||Ux,a=new Nx(Vx),l=new $x(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let i=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)i=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)n.markElementAsRemoved(this.id,t,!1,e);else{const i=t.__ng_removed;i&&i!==Fx||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Xx(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const r=n.element,s=this._elementListeners.get(r);s&&s.forEach(e=>{if(e.name==n.triggerName){const i=hv(r,n.triggerName,n.fromState.value,n.toState.value);i._data=t,cv(n.player,e.phase,i,e.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,i=e.transition.ast.depCount;return 0==n||0==i?n-i:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class qx{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new jx(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let i=!1;for(let r=n;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,e)){this._namespaceList.splice(r+1,0,t),i=!0;break}i||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let i=this._namespaceLookup[t];i&&i.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let i=0;i<t.length;i++){const r=n[t[i]].namespaceId;if(r){const t=this._fetchNamespace(r);t&&e.add(t)}}}return e}trigger(t,e,n,i){if(Gx(e)){const r=this._fetchNamespace(t);if(r)return r.trigger(e,n,i),!0}return!1}insertNode(t,e,n,i){if(!Gx(e))return;const r=e.__ng_removed;if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const i=this._fetchNamespace(t);i&&i.insertNode(e,n)}i&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Xx(t,Dx)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Kx(t,Dx))}removeNode(t,e,n,i){if(Gx(e)){const r=t?this._fetchNamespace(t):null;if(r?r.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,i)}}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,n,i){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,i,r){return Gx(e)?this._fetchNamespace(t).listen(e,n,i,r):()=>{}}_buildInstruction(t,e,n,i,r){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,i,t.fromState.options,t.toState.options,e,r)}destroyInnerAnimations(t){let e=this.driver.query(t,Pv,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,Ov,!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return av(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=Fx,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,Rx)&&this.markElementAsDisabled(t,!1),this.driver.query(t,Rx,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Xx(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?av(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new dx,i=[],r=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(t=>{c.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)c.add(e[n])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Wx(h,this.collectedEnterElements),p=new Map;let f=0;d.forEach((t,e)=>{const n=Mv+f++;p.set(e,n),t.forEach(t=>Xx(t,n))});const m=[],g=new Set,_=new Set;for(let P=0;P<this.collectedLeaveElements.length;P++){const t=this.collectedLeaveElements[P],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):_.add(t))}const y=new Map,v=Wx(h,Array.from(g));v.forEach((t,e)=>{const n=Av+f++;y.set(e,n),t.forEach(t=>Xx(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=p.get(e);t.forEach(t=>Kx(t,n))}),v.forEach((t,e)=>{const n=y.get(e);t.forEach(t=>Kx(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const x=[],b=[];for(let P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(e).forEach(t=>{const e=t.player,r=t.element;if(x.push(e),this.collectedEnterElements.length){const t=r.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const c=!u||!this.driver.containsElement(u,r),h=y.get(r),d=p.get(r),f=this._buildInstruction(t,n,d,h,c);if(f.errors&&f.errors.length)b.push(f);else{if(c)return e.onStart(()=>Uv(r,f.fromStyles)),e.onDestroy(()=>Vv(r,f.toStyles)),void i.push(e);if(t.isFallbackTransition)return e.onStart(()=>Uv(r,f.fromStyles)),e.onDestroy(()=>Vv(r,f.toStyles)),void i.push(e);f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(r,f.timelines),s.push({instruction:f,player:e,element:r}),f.queriedElements.forEach(t=>dv(o,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let i=l.get(e);i||l.set(e,i=new Set),n.forEach(t=>i.add(t))})}});if(b.length){const t=[];b.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),x.forEach(t=>t.destroy()),this.reportError(t)}const w=new Map,C=new Map;s.forEach(t=>{const e=t.element;n.has(e)&&(C.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,w))}),i.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{dv(w,e,[]).push(t),t.destroy()})});const E=m.filter(t=>Jx(t,a,l)),S=new Map;Hx(S,this.driver,_,l,tv).forEach(t=>{Jx(t,a,l)&&E.push(t)});const T=new Map;d.forEach((t,e)=>{Hx(T,this.driver,new Set(t),a,"!")}),E.forEach(t=>{const e=S.get(t),n=T.get(t);S.set(t,Object.assign(Object.assign({},e),n))});const M=[],A=[],k={};s.forEach(t=>{const{element:e,player:s,instruction:o}=t;if(n.has(e)){if(c.has(e))return s.onDestroy(()=>Vv(e,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void i.push(s);let t=k;if(C.size>1){let n=e;const i=[];for(;n=n.parentNode;){const e=C.get(n);if(e){t=e;break}i.push(n)}i.forEach(e=>C.set(e,t))}const n=this._buildAnimation(s.namespaceId,o,w,r,T,S);if(s.setRealPlayer(n),t===k)M.push(s);else{const e=this.playersByElement.get(t);e&&e.length&&(s.parentPlayer=av(e)),i.push(s)}}else Uv(e,o.fromStyles),s.onDestroy(()=>Vv(e,o.toStyles)),A.push(s),c.has(e)&&i.push(s)}),A.forEach(t=>{const e=r.get(t.element);if(e&&e.length){const n=av(e);t.setRealPlayer(n)}}),i.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let P=0;P<m.length;P++){const t=m[P],e=t.__ng_removed;if(Kx(t,Av),e&&e.hasAnimation)continue;let n=[];if(o.size){let e=o.get(t);e&&e.length&&n.push(...e);let i=this.driver.query(t,Ov,!0);for(let t=0;t<i.length;t++){let e=o.get(i[t]);e&&e.length&&n.push(...e)}}const i=n.filter(t=>!t.destroyed);i.length?Qx(this,t,i):this.processLeaveNode(t)}return m.length=0,M.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),M}elementContainsData(t,e){let n=!1;const i=e.__ng_removed;return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,i,r){let s=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(s=e)}else{const e=this.playersByElement.get(t);if(e){const t=!r||r==Vx;e.forEach(e=>{e.queued||(t||e.triggerName==i)&&s.push(e)})}}return(n||i)&&(s=s.filter(t=>!(n&&n!=t.namespaceId||i&&i!=t.triggerName))),s}_beforeAnimationBuild(t,e,n){const i=e.element,r=e.isRemovalTransition?void 0:t,s=e.isRemovalTransition?void 0:e.triggerName;for(const o of e.timelines){const t=o.element,a=t!==i,l=dv(n,t,[]);this._getPreviousPlayers(t,a,r,s,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}Uv(i,e.fromStyles)}_buildAnimation(t,e,n,i,r,s){const o=e.triggerName,a=e.element,l=[],c=new Set,u=new Set,h=e.timelines.map(e=>{const h=e.element;c.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new rv(e.duration,e.delay);const p=h!==a,f=function(t){const e=[];return Yx(t,e),e}((n.get(h)||Lx).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=r.get(h),g=s.get(h),_=lv(0,this._normalizer,0,e.keyframes,m,g),y=this._buildPlayer(e,_,f);if(e.subTimeline&&i&&u.add(h),p){const e=new $x(t,o,h);e.setRealPlayer(y),l.push(e)}return y});l.forEach(t=>{dv(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let i;if(t instanceof Map){if(i=t.get(e),i){if(i.length){const t=i.indexOf(n);i.splice(t,1)}0==i.length&&t.delete(e)}}else if(i=t[e],i){if(i.length){const t=i.indexOf(n);i.splice(t,1)}0==i.length&&delete t[e]}return i}(this.playersByQueriedElement,t.element,t))}),c.forEach(t=>Xx(t,Iv));const d=av(h);return d.onDestroy(()=>{c.forEach(t=>Kx(t,Iv)),Vv(a,e.toStyles)}),u.forEach(t=>{dv(i,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new rv(t.duration,t.delay)}}class $x{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new rv,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>cv(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){dv(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Gx(t){return t&&1===t.nodeType}function Zx(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function Hx(t,e,n,i,r){const s=[];n.forEach(t=>s.push(Zx(t)));const o=[];i.forEach((n,i)=>{const s={};n.forEach(t=>{const n=s[t]=e.computeStyle(i,t,r);n&&0!=n.length||(i.__ng_removed=Bx,o.push(i))}),t.set(i,s)});let a=0;return n.forEach(t=>Zx(t,s[a++])),o}function Wx(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const i=new Set(e),r=new Map;function s(t){if(!t)return 1;let e=r.get(t);if(e)return e;const o=t.parentNode;return e=n.has(o)?o:i.has(o)?1:s(o),r.set(t,e),e}return e.forEach(t=>{const e=s(t);1!==e&&n.get(e).push(t)}),n}function Xx(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function Kx(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function Qx(t,e,n){av(n).onDone(()=>t.processLeaveNode(e))}function Yx(t,e){for(let n=0;n<t.length;n++){const i=t[n];i instanceof sv?Yx(i.players,e):e.push(i)}}function Jx(t,e,n){const i=n.get(t);if(!i)return!1;let r=e.get(t);return r?i.forEach(t=>r.add(t)):e.set(t,i),n.delete(t),!0}class tb{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new qx(t,e,n),this._timelineEngine=new Ox(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,i,r){const s=t+"-"+i;let o=this._triggerCache[s];if(!o){const t=[],e=sx(this._driver,r,t);if(t.length)throw new Error(`The animation trigger "${i}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);o=function(t,e){return new kx(t,e)}(i,e),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(e,i,o)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,i){this._transitionEngine.insertNode(t,e,n,i)}onRemove(t,e,n,i){this._transitionEngine.removeNode(t,e,i||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,i){if("@"==n.charAt(0)){const[t,r]=pv(n);this._timelineEngine.command(t,e,r,i)}else this._transitionEngine.trigger(t,e,n,i)}listen(t,e,n,i,r){if("@"==n.charAt(0)){const[t,i]=pv(n);return this._timelineEngine.listen(t,e,i,r)}return this._transitionEngine.listen(t,e,n,i,r)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function eb(t,e){let n=null,i=null;return Array.isArray(e)&&e.length?(n=ib(e[0]),e.length>1&&(i=ib(e[e.length-1]))):e&&(n=ib(e)),n||i?new nb(t,n,i):null}let nb=(()=>{class t{constructor(e,n,i){this._element=e,this._startStyles=n,this._endStyles=i,this._state=0;let r=t.initialStylesByElement.get(e);r||t.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Vv(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Vv(this._element,this._initialStyles),this._endStyles&&(Vv(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Uv(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Uv(this._element,this._endStyles),this._endStyles=null),Vv(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function ib(t){let e=null;const n=Object.keys(t);for(let i=0;i<n.length;i++){const r=n[i];rb(r)&&(e=e||{},e[r]=t[r])}return e}function rb(t){return"display"===t||"position"===t}const sb="animation",ob="animationend";class ab{constructor(t,e,n,i,r,s,o){this._element=t,this._name=e,this._duration=n,this._delay=i,this._easing=r,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=pb(t,"").trim();n.length&&(function(t,e){let n=0;for(let i=0;i<t.length;i++)","===t.charAt(i)&&n++}(n),e=`${n}, ${e}`),db(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),hb(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){lb(this._element,this._name,"paused")}resume(){lb(this._element,this._name,"running")}setPosition(t){const e=cb(this._element,this._name);this._position=t*this._duration,db(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),hb(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=pb(t,"").split(","),i=ub(n,e);i>=0&&(n.splice(i,1),db(t,"",n.join(",")))}(this._element,this._name))}}function lb(t,e,n){db(t,"PlayState",n,cb(t,e))}function cb(t,e){const n=pb(t,"");return n.indexOf(",")>0?ub(n.split(","),e):ub([n],e)}function ub(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function hb(t,e,n){n?t.removeEventListener(ob,e):t.addEventListener(ob,e)}function db(t,e,n,i){const r=sb+e;if(null!=i){const e=t.style[r];if(e.length){const t=e.split(",");t[i]=n,n=t.join(",")}}t.style[r]=n}function pb(t,e){return t.style[sb+e]||""}class fb{constructor(t,e,n,i,r,s,o,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=i,this._delay=r,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=i+r,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new ab(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:Yv(this.element,n))})}this.currentSnapshot=t}}class mb extends rv{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Ev(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class gb{constructor(){this._count=0,this._head=document.querySelector("head")}validateStyleProperty(t){return xv(t)}matchesElement(t,e){return bv(t,e)}containsElement(t,e){return wv(t,e)}query(t,e,n){return Cv(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Ev(t));let i=`@keyframes ${e} {\n`,r="";n.forEach(t=>{r=" ";const e=parseFloat(t.offset);i+=`${r}${100*e}% {\n`,r+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(i+=`${r}animation-timing-function: ${n};\n`));default:return void(i+=`${r}${e}: ${n};\n`)}}),i+=`${r}}\n`}),i+="}\n";const s=document.createElement("style");return s.textContent=i,s}animate(t,e,n,i,r,s=[],o){const a=s.filter(t=>t instanceof fb),l={};Xv(n,i)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=Kv(t,e,l));if(0==n)return new mb(t,c);const u="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(t,u,e);document.querySelector("head").appendChild(h);const d=eb(t,e),p=new fb(t,e,u,n,i,r,c,d);return p.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),p}}class _b{constructor(t,e,n,i){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:Yv(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class yb{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(vb().toString()),this._cssKeyframesDriver=new gb}validateStyleProperty(t){return xv(t)}matchesElement(t,e){return bv(t,e)}containsElement(t,e){return wv(t,e)}query(t,e,n){return Cv(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,i,r,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,i,r,s);const a={duration:n,delay:i,fill:0==i?"both":"forwards"};r&&(a.easing=r);const l={},c=s.filter(t=>t instanceof _b);Xv(n,i)&&c.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=eb(t,e=Kv(t,e=e.map(t=>Fv(t,!1)),l));return new _b(t,e,a,u)}}function vb(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let xb=(()=>{class t extends Jy{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:St.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?ev(t):t;return Cb(this._renderer,null,e,"register",[n]),new bb(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(ai(Ho),ai(cc))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class bb extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new wb(this._id,t,e||{},this._renderer)}}class wb{constructor(t,e,n,i){this.id=t,this.element=e,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Cb(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function Cb(t,e,n,i,r){return t.setProperty(e,`@@${n}:${i}`,r)}const Eb="@",Sb="@.disabled";let Tb=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new Mb("",n,this.engine),this._rendererCache.set(n,t)),t}const i=e.id,r=e.id+"-"+this._currentId;this._currentId++,this.engine.register(r,t);const s=e=>{Array.isArray(e)?e.forEach(s):this.engine.registerTrigger(i,r,t,e.name,e)};return e.data.animation.forEach(s),new Ab(this,r,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(ai(Ho),ai(tb),ai(Il))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();class Mb{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,i=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,i)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,i){this.delegate.setAttribute(t,e,n,i)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,i){this.delegate.setStyle(t,e,n,i)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==Eb&&e==Sb?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Ab extends Mb{constructor(t,e,n,i){super(e,n,i),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==Eb?"."==e.charAt(1)&&e==Sb?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if(e.charAt(0)==Eb){const i=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let r=e.substr(1),s="";return r.charAt(0)!=Eb&&([r,s]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(r)),this.engine.listen(this.namespaceId,i,r,s,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let kb=(()=>{class t extends tb{constructor(t,e,n){super(t.body,e,n)}}return t.\u0275fac=function(e){return new(e||t)(ai(cc),ai(Tv),ai(wx))},t.\u0275prov=ut({token:t,factory:t.\u0275fac}),t})();const Pb=[{provide:Tv,useFactory:function(){return"function"==typeof vb()?new yb:new gb}},{provide:new qn("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:Jy,useClass:xb},{provide:wx,useFactory:function(){return new Cx}},{provide:tb,useClass:kb},{provide:Ho,useFactory:function(t,e,n){return new Tb(t,e,n)},deps:[iu,tb,Il]}];let Ib=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=ht({providers:Pb,imports:[mu]}),t})(),Ob=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t,bootstrap:[Yy]}),t.\u0275inj=ht({providers:[Vm],imports:[[mu,Qy,Ib,Hh,$_,Ig,Zh,Xh]]}),t})();(function(){if($l)throw new Error("Cannot enable prod mode after platform setup.");ql=!1})(),pu().bootstrapModule(Ob).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);